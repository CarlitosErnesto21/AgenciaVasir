import{A as H}from"./AuthenticatedLayout-CKpdD70J.js";import{r as c,E as w,o as q,h as D,d as P,x as d,p as n,e,$ as t,a0 as W,t as a,a1 as K,j as N,c as X,q as m,y as J}from"./vendor-CqKcGHPa.js";import{z as Q,A as Y,a as ee,F as i,e as se,f as _,h as te,o as le,g as ae}from"./ui-DrLUz167.js";import{H as oe,a7 as ne,g as re,B as de,r as ie,G as ue,b as ce,D as me,e as M,l as ge}from"./index-t8PHqkOa.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const pe={class:"container mx-auto px-4 py-6"},be={class:"mb-6 bg-white rounded-lg shadow-md p-6"},xe={class:"flex items-center justify-between"},ve={class:"flex items-center gap-4"},fe={class:"flex items-center gap-2"},he={class:"text-lg font-semibold text-gray-800"},ye={class:"flex items-center gap-2"},we={class:"text-sm text-gray-600"},_e={class:"grid grid-cols-3 sm:grid-cols-3 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-6"},Ae={class:"bg-white rounded-lg shadow-md p-3"},Pe={class:"flex flex-col items-center text-center"},Ce={class:"p-1.5 rounded-full bg-blue-100 mb-2"},Re={class:"text-lg font-bold text-gray-900"},De={class:"bg-white rounded-lg shadow-md p-3"},Ne={class:"flex flex-col items-center text-center"},Fe={class:"p-1.5 rounded-full bg-green-100 mb-2"},Ee={class:"text-lg font-bold text-gray-900"},Ie={class:"bg-white rounded-lg shadow-md p-3"},Le={class:"flex flex-col items-center text-center"},ke={class:"p-1.5 rounded-full bg-yellow-100 mb-2"},Te={class:"text-lg font-bold text-gray-900"},Me={class:"bg-white rounded-lg shadow-md p-3"},Oe={class:"flex flex-col items-center text-center"},Ve={class:"p-1.5 rounded-full bg-green-100 mb-2"},$e={class:"text-lg font-bold text-gray-900"},Se={class:"bg-white rounded-lg shadow-md p-3"},je={class:"flex flex-col items-center text-center"},ze={class:"p-1.5 rounded-full bg-blue-100 mb-2"},Be={class:"text-lg font-bold text-gray-900"},Ue={class:"bg-white rounded-lg shadow-md"},Ze={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},Ge={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},He={class:"flex items-center gap-3"},qe={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},We=["disabled"],Ke=["disabled"],Xe={class:"space-y-3"},Je={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Qe={class:"font-medium text-blue-600"},Ye={class:"text-sm"},es={class:"text-sm"},ss={class:"text-sm font-semibold text-green-600"},ts={class:"text-sm"},ls={key:0,class:"space-y-4"},as={class:"grid grid-cols-1 gap-4"},os={class:"bg-gray-50 p-4 rounded-lg"},ns={class:"space-y-2"},rs={class:"text-lg font-semibold text-green-600"},ds={class:"bg-gray-50 p-4 rounded-lg"},is={class:"space-y-2"},us={class:"bg-gray-50 p-4 rounded-lg"},cs={class:"space-y-2"},ms={class:"flex justify-center w-full"},fs={__name:"ReservasCliente",props:{cliente:{type:Object,required:!0},reservas:{type:Array,default:()=>[]}},setup(b){const g=b,F=Q(),C=c(10),O=c([5,10,20,50]),x=c(""),r=c(null),A=c(!1),u=c(!1),V=c([{label:"Todos los estados",value:""},{label:"Pendientes",value:"PENDIENTE"},{label:"Confirmadas",value:"CONFIRMADA"},{label:"Rechazadas",value:"RECHAZADA"},{label:"Reprogramadas",value:"REPROGRAMADA"},{label:"Finalizadas",value:"FINALIZADA"}]),v=c({global:{value:null,matchMode:Y.CONTAINS}}),R=w(()=>{let l=g.reservas;if(x.value&&(l=l.filter(s=>s.estado===x.value)),v.value.global.value){const s=v.value.global.value.toLowerCase();l=l.filter(p=>{var f,h;return p.id.toString().includes(s)||((h=(f=p.empleado)==null?void 0:f.user)==null?void 0:h.name)&&p.empleado.user.name.toLowerCase().includes(s)})}return l}),$=w(()=>g.reservas.reduce((l,s)=>l+parseFloat(s.total),0)),S=w(()=>g.reservas.filter(l=>l.estado==="PENDIENTE").length),j=w(()=>g.reservas.filter(l=>l.estado==="CONFIRMADA").length),z=w(()=>g.reservas.reduce((l,s)=>l+s.mayores_edad+(s.menores_edad||0),0)),E=l=>new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"}),B=l=>{switch(l){case"CONFIRMADA":return"bg-green-100 text-green-800";case"PENDIENTE":return"bg-yellow-100 text-yellow-800";case"RECHAZADA":return"bg-red-100 text-red-800";case"REPROGRAMADA":return"bg-blue-100 text-blue-800";case"FINALIZADA":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},U=l=>{switch(l){case"CONFIRMADA":return"Confirmada";case"PENDIENTE":return"Pendiente";case"RECHAZADA":return"Rechazada";case"REPROGRAMADA":return"Reprogramada";case"FINALIZADA":return"Finalizada";default:return l}},Z=l=>{r.value=l.data,A.value=!0},G=()=>{A.value=!1,r.value=null},I=async()=>{u.value=!0;try{await new Promise(l=>setTimeout(l,300)),x.value="",v.value.global.value=null,F.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{u.value=!1}};return q(()=>{F.add({severity:"success",summary:"Reservas cargadas",detail:`Se encontraron ${g.reservas.length} reservas para este cliente.`,life:3e3})}),(l,s)=>(P(),D(H,null,{default:d(()=>{var p,f,h,L,k;return[n(t(W),{title:`Reservas de ${((f=(p=b.cliente)==null?void 0:p.user)==null?void 0:f.name)||"Cliente"}`},null,8,["title"]),n(t(ee),{class:"z-[9999]"}),e("div",pe,[e("div",be,[e("div",xe,[e("div",null,[s[4]||(s[4]=e("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Reservas del Cliente",-1)),e("div",ve,[e("div",fe,[n(t(i),{icon:t(oe),class:"text-blue-500"},null,8,["icon"]),e("span",he,a(((L=(h=b.cliente)==null?void 0:h.user)==null?void 0:L.name)||"Cliente no encontrado"),1)]),e("div",ye,[n(t(i),{icon:t(ne),class:"text-gray-500"},null,8,["icon"]),e("span",we,a(((k=b.cliente)==null?void 0:k.numero_identificacion)||"N/A"),1)])])]),n(t(K),{href:l.route("clientes"),class:"bg-blue-500 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 text-sm"},{default:d(()=>[n(t(i),{icon:t(re),class:"h-4 w-4"},null,8,["icon"]),s[5]||(s[5]=e("span",{class:"hidden sm:inline"},"Volver a Clientes",-1)),s[6]||(s[6]=e("span",{class:"sm:hidden"},"Volver",-1))]),_:1,__:[5,6]},8,["href"])])]),e("div",_e,[e("div",Ae,[e("div",Pe,[e("div",Ce,[n(t(i),{icon:t(de),class:"h-4 w-4 text-blue-600"},null,8,["icon"])]),s[7]||(s[7]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Total",-1)),e("p",Re,a(b.reservas.length),1)])]),e("div",De,[e("div",Ne,[e("div",Fe,[n(t(i),{icon:t(ie),class:"h-4 w-4 text-green-600"},null,8,["icon"])]),s[8]||(s[8]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Monto",-1)),e("p",Ee,"$"+a($.value.toFixed(0)),1)])]),e("div",Ie,[e("div",Le,[e("div",ke,[n(t(i),{icon:t(ue),class:"h-4 w-4 text-yellow-600"},null,8,["icon"])]),s[9]||(s[9]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Pendientes",-1)),e("p",Te,a(S.value),1)])]),e("div",Me,[e("div",Oe,[e("div",Ve,[n(t(i),{icon:t(ce),class:"h-4 w-4 text-green-600"},null,8,["icon"])]),s[10]||(s[10]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Confirmadas",-1)),e("p",$e,a(j.value),1)])]),e("div",Se,[e("div",je,[e("div",ze,[n(t(i),{icon:t(me),class:"h-4 w-4 text-blue-600"},null,8,["icon"])]),s[11]||(s[11]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Personas",-1)),e("p",Be,a(z.value),1)])])]),e("div",Ue,[s[13]||(s[13]=e("h3",{class:"text-2xl text-blue-600 font-bold mb-4"},"Historial de Reservas",-1)),n(t(se),{value:R.value,dataKey:"id",paginator:!0,rows:C.value,rowsPerPageOptions:O.value,rowsPerPage:C.value,"onUpdate:rowsPerPage":s[2]||(s[2]=o=>C.value=o),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} reservas",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:Z,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-16 text-sm hover:bg-blue-50 transition-colors duration-200 cursor-pointer"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:d(()=>[e("div",Ze,[e("div",Ge,[e("div",He,[s[12]||(s[12]=e("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[e("i",{class:"pi pi-filter text-blue-600 text-sm"}),e("span",null,"Filtros")],-1)),e("div",qe,a(R.value.length)+" resultado"+a(R.value.length!==1?"s":""),1),e("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:I,disabled:u.value},[u.value?(P(),D(t(i),{key:0,icon:t(M),class:"animate-spin h-3 w-3"},null,8,["icon"])):N("",!0),e("span",null,a(u.value?"Limpiando...":"Limpiar filtros"),1)],8,We)]),e("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:I,disabled:u.value},[u.value?(P(),D(t(i),{key:0,icon:t(M),class:"animate-spin h-3 w-3"},null,8,["icon"])):N("",!0),e("span",null,a(u.value?"Limpiando...":"Limpiar filtros"),1)],8,Ke)]),e("div",Xe,[e("div",Je,[n(t(te),{modelValue:v.value.global.value,"onUpdate:modelValue":s[0]||(s[0]=o=>v.value.global.value=o),placeholder:"游댌 Buscar reservas...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"]),n(t(le),{modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=o=>x.value=o),options:V.value,optionLabel:"label",optionValue:"value",placeholder:"Filtrar por estado",class:"w-full text-sm border border-blue-300",pt:{root:{class:"h-9"},input:{class:"text-sm"},dropdown:{class:"text-sm"}}},null,8,["modelValue","options"])])])])]),default:d(()=>[n(t(_),{field:"id",header:"ID",sortable:"",class:"w-16"},{body:d(o=>[e("span",Qe,"#"+a(o.data.id),1)]),_:1}),n(t(_),{field:"fecha",header:"Fecha",sortable:"",class:"w-28"},{body:d(o=>[e("span",Ye,a(E(o.data.fecha)),1)]),_:1}),n(t(_),{field:"personas",header:"Personas",class:"w-20 hidden sm:table-cell"},{body:d(o=>[e("span",es,a(o.data.mayores_edad+(o.data.menores_edad||0)),1)]),_:1}),n(t(_),{field:"total",header:"Total",sortable:"",class:"w-24"},{body:d(o=>[e("span",ss," $"+a(Number(o.data.total).toFixed(2)),1)]),_:1}),n(t(_),{field:"empleado.user.name",header:"Agente",class:"w-32 hidden md:table-cell"},{body:d(o=>{var y,T;return[e("span",ts,a(((T=(y=o.data.empleado)==null?void 0:y.user)==null?void 0:T.name)||"N/A"),1)]}),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"])])]),n(t(ae),{visible:A.value,"onUpdate:visible":s[3]||(s[3]=o=>A.value=o),header:"Detalles de la Reserva",modal:!0,style:{width:"90vw",maxWidth:"600px"},closable:!0,draggable:!1},{footer:d(()=>[e("div",ms,[e("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:G},[n(t(i),{icon:t(ge),class:"h-5"},null,8,["icon"]),s[25]||(s[25]=m(" Cerrar "))])])]),default:d(()=>{var o,y;return[r.value?(P(),X("div",ls,[e("div",as,[e("div",os,[s[18]||(s[18]=e("h4",{class:"font-semibold text-gray-800 mb-3"},"Informaci칩n General",-1)),e("div",ns,[e("p",null,[s[14]||(s[14]=e("strong",null,"ID de Reserva:",-1)),m(" #"+a(r.value.id),1)]),e("p",null,[s[15]||(s[15]=e("strong",null,"Fecha:",-1)),m(" "+a(E(r.value.fecha)),1)]),e("p",null,[s[16]||(s[16]=e("strong",null,"Estado:",-1)),e("span",{class:J([B(r.value.estado),"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-2"])},a(U(r.value.estado)),3)]),e("p",null,[s[17]||(s[17]=e("strong",null,"Total:",-1)),e("span",rs,"$"+a(Number(r.value.total).toFixed(2)),1)])])]),e("div",ds,[s[22]||(s[22]=e("h4",{class:"font-semibold text-gray-800 mb-3"},"Informaci칩n de Participantes",-1)),e("div",is,[e("p",null,[s[19]||(s[19]=e("strong",null,"Adultos:",-1)),m(" "+a(r.value.mayores_edad),1)]),e("p",null,[s[20]||(s[20]=e("strong",null,"Ni침os:",-1)),m(" "+a(r.value.menores_edad||0),1)]),e("p",null,[s[21]||(s[21]=e("strong",null,"Total de Personas:",-1)),m(" "+a(r.value.mayores_edad+(r.value.menores_edad||0)),1)])])]),e("div",us,[s[24]||(s[24]=e("h4",{class:"font-semibold text-gray-800 mb-3"},"Informaci칩n del Agente",-1)),e("div",cs,[e("p",null,[s[23]||(s[23]=e("strong",null,"Agente:",-1)),m(" "+a(((y=(o=r.value.empleado)==null?void 0:o.user)==null?void 0:y.name)||"No asignado"),1)])])])])])):N("",!0)]}),_:1},8,["visible"])]}),_:1}))}};export{fs as default};
