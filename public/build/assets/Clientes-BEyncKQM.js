import{r as u,s as Y,i as _,c as Z,o as f,w as ee,b as e,f as b,h as V,a as i,e as k,u as a,j as d,C as p,t as n,F as $,y as D,n as E,d as te,D as T,B as y,W as se}from"./app-DP8tsAem.js";import{_ as oe}from"./AuthenticatedLayout-BvfF3yw2.js";import{F as c,h as A,i as le,j as ae,k as L,l as ne,m as q,n as re,g as ie}from"./index-ClJ1gEnJ.js";import"./logo-DN1bLr27.js";const de={class:"container mx-auto px-4 py-8"},ce={class:"bg-white rounded-lg shadow-lg overflow-hidden"},ue={class:"bg-gradient-to-r from-red-600 to-red-700 px-6 py-4"},pe={class:"flex justify-between items-center"},me={class:"text-2xl font-bold text-white flex items-center"},xe={class:"flex space-x-3"},ge={class:"p-6"},fe={class:"mb-6"},ve={class:"flex-1 min-w-64"},be={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},ye={class:"bg-blue-50 p-4 rounded-lg"},we={class:"flex items-center"},_e={class:"text-2xl font-bold text-blue-800"},he={class:"bg-green-50 p-4 rounded-lg"},Ce={class:"flex items-center"},ke={class:"text-2xl font-bold text-green-800"},Ee={class:"bg-yellow-50 p-4 rounded-lg"},Ue={class:"flex items-center"},Ve={class:"text-2xl font-bold text-yellow-800"},$e={class:"bg-red-50 p-4 rounded-lg"},De={class:"flex items-center"},Te={class:"text-2xl font-bold text-red-800"},Ae={class:"overflow-x-auto"},Le={class:"min-w-full bg-white border border-gray-200 rounded-lg"},qe={class:"divide-y divide-gray-200"},Ie={class:"px-6 py-4 whitespace-nowrap"},Me={class:"flex items-center"},Ne={class:"flex-shrink-0 h-10 w-10"},Se=["src","alt"],Fe={class:"ml-4"},ze={class:"text-sm font-medium text-gray-900"},Be={class:"text-sm text-gray-500"},je={class:"px-6 py-4 whitespace-nowrap"},Re={class:"text-sm text-gray-900"},Ge={class:"text-sm text-gray-500"},Pe={class:"px-6 py-4 whitespace-nowrap"},We={class:"px-6 py-4 whitespace-nowrap"},He={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Je={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ke={class:"flex space-x-2"},Oe=["onClick"],Qe=["onClick","title"],Xe=["onClick"],Ye={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ze={class:"bg-white rounded-lg p-6 w-96 max-w-full mx-4 max-h-screen overflow-y-auto"},et={class:"text-lg font-semibold mb-4"},tt=["value"],st={key:0},ot={class:"flex justify-end space-x-3 pt-4"},lt=["disabled"],ct={__name:"Clientes",setup(at){const v=u(""),m=u(!1),h=u(!1),w=u(null),x=u(!1),r=u([]),U=u([]),l=u({name:"",email:"",identification:"",phone:"",address:"",birth_date:"",gender:"",tipo_documento_id:"",password:""}),I=async()=>{try{const o=await y.get("/api/clientes");o.data.success&&(r.value=o.data.clientes)}catch(o){console.error("Error loading clientes:",o),alert("Error al cargar los clientes")}},M=async()=>{try{const o=await y.get("/api/tipos-documento-options");o.data.success&&(U.value=o.data.tipos)}catch(o){console.error("Error loading tipos documento:",o)}};Y(()=>{I(),M()});const N=_(()=>r.value.filter(o=>!v.value||o.name.toLowerCase().includes(v.value.toLowerCase())||o.email.toLowerCase().includes(v.value.toLowerCase())||o.identification.toLowerCase().includes(v.value.toLowerCase()))),S=_(()=>r.value.length),F=_(()=>r.value.filter(o=>o.status==="active").length),z=_(()=>r.value.filter(o=>o.status==="pending").length),B=_(()=>r.value.filter(o=>o.status==="inactive").length),j=o=>({admin:"bg-purple-100 text-purple-800",empleado:"bg-blue-100 text-blue-800",cliente:"bg-green-100 text-green-800"})[o]||"bg-gray-100 text-gray-800",R=o=>({admin:"Administrador",empleado:"Empleado",cliente:"Cliente"})[o]||o,G=o=>({active:"bg-green-100 text-green-800",inactive:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"})[o]||"bg-gray-100 text-gray-800",P=o=>({active:"Activo",inactive:"Inactivo",pending:"Pendiente"})[o]||o,W=()=>{se.visit("/configuracion/tipos-documento")},H=async()=>{var o,t;x.value=!0;try{const s=await y.post("/api/clientes",{...l.value,role:"cliente"});s.data.success&&(r.value.push(s.data.cliente),C(),alert("Cliente creado exitosamente"))}catch(s){console.error("Error al crear cliente:",s),alert(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||"Error al crear el cliente")}finally{x.value=!1}},J=o=>{w.value=o,l.value={...o,tipo_documento_id:o.tipo_documento_id||""},h.value=!0},K=async()=>{var o,t;if(w.value){x.value=!0;try{const s=await y.put(`/api/clientes/${w.value.id}`,l.value);if(s.data.success){const g=r.value.findIndex(X=>X.id===w.value.id);g!==-1&&(r.value[g]=s.data.cliente),C(),alert("Cliente actualizado exitosamente")}}catch(s){console.error("Error al actualizar cliente:",s),alert(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||"Error al actualizar el cliente")}finally{x.value=!1}}},O=async o=>{const t=o.status==="active"?"desactivar":"activar";if(confirm(`¿Está seguro de ${t} este cliente?`))try{const s=await y.patch(`/api/clientes/${o.id}/toggle-status`);s.data.success&&(o.status=s.data.cliente.status,alert(`Cliente ${t}do exitosamente`))}catch(s){console.error("Error al cambiar estado del cliente:",s),alert("Error al cambiar el estado del cliente")}},Q=async o=>{if(confirm("¿Está seguro de eliminar este cliente? Esta acción no se puede deshacer."))try{if((await y.delete(`/api/clientes/${o.id}`)).data.success){const s=r.value.findIndex(g=>g.id===o.id);s!==-1&&r.value.splice(s,1),alert("Cliente eliminado exitosamente")}}catch(t){console.error("Error al eliminar cliente:",t),alert("Error al eliminar el cliente")}},C=()=>{m.value=!1,h.value=!1,w.value=null,x.value=!1,l.value={name:"",email:"",identification:"",phone:"",address:"",birth_date:"",gender:"",tipo_documento_id:"",password:""}};return(o,t)=>(f(),Z(oe,null,{default:ee(()=>[e("div",de,[e("div",ce,[e("div",ue,[e("div",pe,[e("div",null,[e("h1",me,[i(a(c),{icon:a(A),class:"mr-3"},null,8,["icon"]),t[12]||(t[12]=k(" Gestión de Clientes "))]),t[13]||(t[13]=e("p",{class:"text-red-100 mt-2"},"Administre clientes, perfiles y accesos del sistema",-1))]),e("div",xe,[e("button",{onClick:W,class:"bg-white text-red-600 px-4 py-2 rounded-lg font-semibold hover:bg-red-50 transition-colors duration-200 flex items-center"},[i(a(c),{icon:a(le),class:"mr-2"},null,8,["icon"]),t[14]||(t[14]=k(" Tipos de Documentos "))]),e("button",{onClick:t[0]||(t[0]=s=>m.value=!0),class:"bg-white text-red-600 px-4 py-2 rounded-lg font-semibold hover:bg-red-50 transition-colors duration-200 flex items-center"},[i(a(c),{icon:a(ae),class:"mr-2"},null,8,["icon"]),t[15]||(t[15]=k(" Agregar Cliente "))])])])]),e("div",ge,[e("div",fe,[e("div",ve,[d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),type:"text",placeholder:"Buscar por nombre, email o identificación...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},null,512),[[p,v.value]])])]),e("div",be,[e("div",ye,[e("div",we,[i(a(c),{icon:a(A),class:"text-blue-500 text-2xl mr-3"},null,8,["icon"]),e("div",null,[t[16]||(t[16]=e("p",{class:"text-blue-600 text-sm font-medium"},"Total Clientes",-1)),e("p",_e,n(S.value),1)])])]),e("div",he,[e("div",Ce,[i(a(c),{icon:a(L),class:"text-green-500 text-2xl mr-3"},null,8,["icon"]),e("div",null,[t[17]||(t[17]=e("p",{class:"text-green-600 text-sm font-medium"},"Activos",-1)),e("p",ke,n(F.value),1)])])]),e("div",Ee,[e("div",Ue,[i(a(c),{icon:a(ne),class:"text-yellow-500 text-2xl mr-3"},null,8,["icon"]),e("div",null,[t[18]||(t[18]=e("p",{class:"text-yellow-600 text-sm font-medium"},"Pendientes",-1)),e("p",Ve,n(z.value),1)])])]),e("div",$e,[e("div",De,[i(a(c),{icon:a(q),class:"text-red-500 text-2xl mr-3"},null,8,["icon"]),e("div",null,[t[19]||(t[19]=e("p",{class:"text-red-600 text-sm font-medium"},"Inactivos",-1)),e("p",Te,n(B.value),1)])])])]),e("div",Ae,[e("table",Le,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usuario "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Contacto "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rol "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Estado "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Último Acceso "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acciones ")])],-1)),e("tbody",qe,[(f(!0),b($,null,D(N.value,s=>(f(),b("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Ie,[e("div",Me,[e("div",Ne,[e("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=dc2626&color=fff&size=40`,class:"h-10 w-10 rounded-full",alt:s.name},null,8,Se)]),e("div",Fe,[e("div",ze,n(s.name),1),e("div",Be,"ID: "+n(s.identification),1)])])]),e("td",je,[e("div",Re,n(s.email),1),e("div",Ge,n(s.phone||"No registrado"),1)]),e("td",Pe,[e("span",{class:E([j(s.role),"px-2 py-1 text-xs font-semibold rounded-full"])},n(R(s.role)),3)]),e("td",We,[e("span",{class:E([G(s.status),"px-2 py-1 text-xs font-semibold rounded-full"])},n(P(s.status)),3)]),e("td",He,n(s.lastLogin||"Nunca"),1),e("td",Je,[e("div",Ke,[e("button",{onClick:g=>J(s),class:"text-red-600 hover:text-red-900",title:"Editar"},[i(a(c),{icon:a(re)},null,8,["icon"])],8,Oe),e("button",{onClick:g=>O(s),class:E(s.status==="active"?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"),title:s.status==="active"?"Desactivar":"Activar"},[i(a(c),{icon:s.status==="active"?a(q):a(L)},null,8,["icon"])],10,Qe),e("button",{onClick:g=>Q(s),class:"text-red-600 hover:text-red-900",title:"Eliminar"},[i(a(c),{icon:a(ie)},null,8,["icon"])],8,Xe)])])]))),128))])])])])]),m.value||h.value?(f(),b("div",Ye,[e("div",Ze,[e("h3",et,n(m.value?"Crear Nuevo Cliente":"Editar Cliente"),1),e("form",{onSubmit:t[11]||(t[11]=te(s=>m.value?H():K(),["prevent"])),class:"space-y-4"},[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nombre Completo",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.name=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},null,512),[[p,l.value.name]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.email=s),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},null,512),[[p,l.value.email]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Identificación",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.identification=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},null,512),[[p,l.value.identification]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Teléfono",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.phone=s),type:"tel",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},null,512),[[p,l.value.phone]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Dirección",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.address=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},null,512),[[p,l.value.address]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha de Nacimiento",-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.value.birth_date=s),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},null,512),[[p,l.value.birth_date]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Género",-1)),d(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.value.gender=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},t[27]||(t[27]=[e("option",{value:""},"Seleccione género",-1),e("option",{value:"Masculino"},"Masculino",-1),e("option",{value:"Femenino"},"Femenino",-1)]),512),[[T,l.value.gender]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de Documento",-1)),d(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>l.value.tipo_documento_id=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},[t[29]||(t[29]=e("option",{value:""},"Seleccione tipo de documento",-1)),(f(!0),b($,null,D(U.value,s=>(f(),b("option",{key:s.id,value:s.id},n(s.nombre),9,tt))),128))],512),[[T,l.value.tipo_documento_id]])]),m.value?(f(),b("div",st,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Contraseña",-1)),d(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>l.value.password=s),type:"password",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"},null,512),[[p,l.value.password]])])):V("",!0),e("div",ot,[e("button",{type:"button",onClick:C,class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50"}," Cancelar "),e("button",{type:"submit",disabled:x.value,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 transition-colors duration-200"},n(x.value?"Guardando...":m.value?"Crear Cliente":"Actualizar Cliente"),9,lt)])],32)])])):V("",!0)])]),_:1}))}};export{ct as default};
