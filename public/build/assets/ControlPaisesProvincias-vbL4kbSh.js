import{r as v,o as Y,N as w,E as J,c as g,d as b,p as r,$ as l,a0 as Q,x as p,e as s,a1 as ee,h as z,j as P,t as h,q as m,y as V,F as ae}from"./vendor-BOi6Gr0G.js";import{A as se}from"./AuthenticatedLayout-Dso7IuN5.js";import{z as le,a as te,A as f,e as re,f as q,n as L,h as D,g as R}from"./ui-BibPgP1I.js";import{f as oe,a as ie,b as ne,c as F,i as de,d as I,e as T}from"./index-B7S65CUL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"py-4 sm:py-6 px-4 sm:px-7 mt-6 sm:mt-10 mx-auto bg-red-50 shadow-md rounded-lg"},me={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2 sm:gap-0"},ce={class:"flex items-center gap-3"},ve={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},pe={class:"flex items-center justify-between mb-3"},be={class:"flex items-center gap-3"},fe={class:"text-base font-medium text-gray-800 flex items-center gap-2"},xe={class:"bg-blue-100 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},ge={class:"flex items-center gap-2"},ye={class:"space-y-3"},we={class:"text-sm font-medium leading-relaxed"},Pe={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},he={class:"flex gap-1 justify-center items-center"},ke=["onClick"],_e=["onClick"],Ce={class:"flex flex-col gap-4"},Ee={class:"w-full flex flex-col"},Ve={key:0,class:"text-red-500 mt-1"},Ne={class:"w-full flex flex-col"},$e={key:0,class:"text-red-500 mt-1"},Ae={key:1,class:"text-orange-500 mt-1"},Le={key:0,class:"w-full flex flex-col"},De={key:0,class:"text-red-500 mt-1"},Ue={class:"flex justify-center gap-4 w-full"},je=["disabled"],ze={class:"flex flex-col gap-4"},qe={key:0,class:"w-full flex flex-col"},Re={key:0,class:"text-red-500 mt-1"},Fe={class:"w-full flex flex-col"},Ie={key:0,class:"text-red-500 mt-1"},Se={key:1,class:"text-orange-500 mt-1"},Te={class:"flex justify-center gap-4 w-full"},Be=["disabled"],Me={class:"flex items-center gap-3 mb-4"},Ge={class:"flex flex-col"},Ke={class:"flex justify-center gap-4 w-full"},Oe=["disabled"],Qe={__name:"ControlPaisesProvincias",setup(Ze){const n=le(),N=v([]),S=v([]),d=v("País"),k=v(""),C=v(!1),_=v(!1),E=v(!1),U=v(10),B=v([5,10,15,20,30]),o=v({id:null,nombre:"",pais_id:null}),t=v({id:null,nombre:"",pais_id:null}),y=v(null),M=v([{label:"Países",value:"País"},{label:"Provincias",value:"Provincia"}]);Y(()=>{$(),A()});const $=async()=>{try{const i=await w.get("/api/paises");N.value=i.data}catch{n.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los países",life:3e3})}},A=async()=>{try{const i=await w.get("/api/provincias");S.value=i.data}catch{n.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las provincias",life:3e3})}},j=J(()=>{let i=d.value==="País"?N.value:S.value;return k.value&&(i=i.filter(e=>e.nombre.toLowerCase().includes(k.value.toLowerCase()))),i}),u=v(null);function G(){u.value=null,o.value={id:null,nombre:"",pais_id:null},C.value=!0}async function K(){var i;try{if(!u.value){n.add({severity:"warn",summary:"Atención",detail:"Debe seleccionar qué desea agregar (País o Provincia)",life:4e3});return}if(!o.value.nombre||o.value.nombre.trim()===""){n.add({severity:"warn",summary:"Campo requerido",detail:"El nombre es obligatorio",life:4e3});return}if(o.value.nombre.trim().length>50){n.add({severity:"warn",summary:"Límite excedido",detail:"El nombre no puede tener más de 50 caracteres",life:4e3});return}if(u.value==="Provincia"&&!o.value.pais_id){n.add({severity:"warn",summary:"Campo requerido",detail:"Debe seleccionar un país para la provincia",life:4e3});return}if(u.value==="País"){const e=await w.post("/api/paises",{nombre:o.value.nombre.trim()});await $(),n.add({severity:"success",summary:"Guardado",detail:"País agregado correctamente",life:3e3})}else if(u.value==="Provincia"){const e=await w.post("/api/provincias",{nombre:o.value.nombre.trim(),pais_id:o.value.pais_id});await A(),n.add({severity:"success",summary:"Guardado",detail:"Provincia agregada correctamente",life:3e3})}C.value=!1,o.value={id:null,nombre:"",pais_id:null},u.value=null}catch(e){if(((i=e.response)==null?void 0:i.status)===422){const a=e.response.data.errors;a!=null&&a.nombre?n.add({severity:"error",summary:"Ya existe",detail:a.nombre[0],life:5e3}):n.add({severity:"error",summary:"Error de validación",detail:e.response.data.message||"Datos inválidos",life:5e3})}else n.add({severity:"error",summary:"Error",detail:"No se pudo guardar. Intente nuevamente.",life:4e3})}}function O(i){t.value={...i},d.value==="Provincia"&&i.pais&&(t.value.pais_id=i.pais.id),_.value=!0}async function Z(){var i,e,a;try{if(!t.value.nombre||t.value.nombre.trim()===""){n.add({severity:"warn",summary:"Campo requerido",detail:"El nombre es obligatorio",life:4e3});return}if(t.value.nombre.trim().length>50){n.add({severity:"warn",summary:"Límite excedido",detail:"El nombre no puede tener más de 50 caracteres",life:4e3});return}if(d.value==="Provincia"&&!t.value.pais_id){n.add({severity:"warn",summary:"Campo requerido",detail:"Debe seleccionar un país para la provincia",life:4e3});return}d.value==="País"?(await w.put(`/api/paises/${t.value.id}`,{nombre:t.value.nombre.trim()}),await $(),n.add({severity:"success",summary:"Actualizado",detail:"País actualizado correctamente",life:3e3}),_.value=!1):(await w.put(`/api/provincias/${t.value.id}`,{nombre:t.value.nombre.trim(),pais_id:t.value.pais_id}),await A(),n.add({severity:"success",summary:"Actualizado",detail:"Provincia actualizada correctamente",life:3e3}),_.value=!1)}catch(c){if(((i=c.response)==null?void 0:i.status)===422){const x=c.response.data.errors;x!=null&&x.nombre?n.add({severity:"error",summary:"Error de validación",detail:x.nombre[0],life:5e3}):n.add({severity:"error",summary:"Error de validación",detail:c.response.data.message||"Datos inválidos",life:5e3})}else{const x=((a=(e=c.response)==null?void 0:e.data)==null?void 0:a.message)||"No se pudo actualizar";n.add({severity:"error",summary:"Error",detail:x,life:4e3})}}}async function H(){var i,e,a,c;try{if(!((i=y.value)!=null&&i.id)){n.add({severity:"error",summary:"Error",detail:"No se puede eliminar: ID no válido",life:3e3});return}d.value==="País"?(await w.delete(`/api/paises/${y.value.id}`),await $(),n.add({severity:"success",summary:"Eliminado",detail:"País eliminado correctamente",life:3e3})):(await w.delete(`/api/provincias/${y.value.id}`),await A(),n.add({severity:"success",summary:"Eliminado",detail:"Provincia eliminada correctamente",life:3e3})),E.value=!1,y.value=null}catch(x){if(((e=x.response)==null?void 0:e.status)===422)n.add({severity:"warn",summary:"No se puede eliminar",detail:x.response.data.message,life:5e3});else{const X=((c=(a=x.response)==null?void 0:a.data)==null?void 0:c.message)||"No se pudo eliminar";n.add({severity:"error",summary:"Error",detail:X,life:4e3})}}}function W(i){y.value=i,E.value=!0}return(i,e)=>(b(),g(ae,null,[r(l(Q),{title:"Países y Provincias"}),r(se,null,{default:p(()=>[r(l(te)),s("div",ue,[s("div",me,[s("div",ce,[r(l(ee),{href:i.route("hoteles"),class:"flex items-center text-blue-600 hover:text-blue-700 transition-colors duration-200 px-4 rounded-lg",title:"Regresar a Hoteles"},{default:p(()=>[r(l(f),{icon:l(oe),class:"h-8"},null,8,["icon"])]),_:1},8,["href"]),e[17]||(e[17]=s("h3",{class:"text-lg sm:text-2xl text-blue-600 font-bold"},"Control de Países y Provincias",-1))]),s("button",{class:"bg-red-500 border border-red-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:G},[r(l(f),{icon:l(ie),class:"h-4 w-4 text-white"},null,8,["icon"]),e[18]||(e[18]=s("span",null," Agregar",-1))])]),r(l(re),{value:j.value,dataKey:"id",paginator:!0,rows:U.value,rowsPerPageOptions:B.value,rowsPerPage:U.value,"onUpdate:rowsPerPage":e[3]||(e[3]=a=>U.value=a),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:`Mostrando {first} a {last} de {totalRecords} ${d.value==="País"?"países":"provincias"}`,class:"overflow-x-auto",responsiveLayout:"scroll",pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-16 text-sm"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:p(()=>[s("div",ve,[s("div",pe,[s("div",be,[s("h3",fe,[r(l(f),{icon:l(de),class:"text-blue-600 text-sm"},null,8,["icon"]),e[19]||(e[19]=s("span",null,"Filtros",-1))]),s("div",xe,h(j.value.length)+" resultado"+h(j.value.length!==1?"s":""),1)]),s("div",ge,[e[20]||(e[20]=s("label",{for:"tipo-estado",class:"text-sm font-medium text-gray-700"},"Mostrar:",-1)),r(l(L),{id:"tipo-estado",modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),options:M.value,optionValue:"value",optionLabel:"label",class:"w-32 h-8 text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue","options"])])]),s("div",ye,[s("div",null,[d.value==="Provincia"?(b(),z(l(D),{key:0,modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=a=>k.value=a),placeholder:"🔍 Buscar provincias...",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])):(b(),z(l(D),{key:1,modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=a=>k.value=a),placeholder:"🔍 Buscar países...",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"]))])])])]),default:p(()=>[r(l(q),{field:"nombre",header:"Nombre",sortable:""},{body:p(a=>[s("div",we,h(a.data.nombre),1)]),_:1}),d.value==="Provincia"?(b(),z(l(q),{key:0,field:"pais.nombre",header:"País",sortable:""},{body:p(a=>{var c;return[s("span",Pe,h(((c=a.data.pais)==null?void 0:c.nombre)||"Sin país"),1)]}),_:1})):P("",!0),r(l(q),{exportable:!1},{header:p(()=>e[21]||(e[21]=[s("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:p(a=>[s("div",he,[s("button",{class:"bg-orange-200/30 border py-2 px-3 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:c=>O(a.data)},[r(l(f),{icon:l(ne),class:"h-4 w-4 text-orange-600"},null,8,["icon"]),e[22]||(e[22]=m("  Editar "))],8,ke),s("button",{class:"bg-red-200/30 border py-2 px-3 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:c=>W(a.data)},[r(l(f),{icon:l(F),class:"h-4 w-4 text-red-600"},null,8,["icon"]),e[23]||(e[23]=m("  Eliminar "))],8,_e)])]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage","currentPageReportTemplate"]),r(l(R),{visible:C.value,"onUpdate:visible":e[9]||(e[9]=a=>C.value=a),header:"Agregar",modal:!0,closable:!1,style:{width:"400px"}},{footer:p(()=>{var a;return[s("div",Ue,[s("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:e[8]||(e[8]=c=>C.value=!1)},[r(l(f),{icon:l(I),class:"h-5 text-green-600"},null,8,["icon"]),e[27]||(e[27]=m(" Cancelar "))]),s("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:K,disabled:!((a=o.value.nombre)!=null&&a.trim())||!u.value||o.value.nombre.trim().length>50||u.value==="Provincia"&&!o.value.pais_id},[r(l(f),{icon:l(T),class:"h-5 text-white"},null,8,["icon"]),e[28]||(e[28]=m(" Guardar "))],8,je)])]}),default:p(()=>[s("div",Ce,[s("div",Ee,[e[24]||(e[24]=s("label",{class:"text-sm font-medium text-gray-700 mb-2"},[m(" Tipo: "),s("span",{class:"text-red-500"},"*")],-1)),r(l(L),{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),options:[{label:"País",value:"País"},{label:"Provincia",value:"Provincia"}],optionLabel:"label",optionValue:"value",placeholder:"Seleccione qué desea agregar",class:V(["w-full",{"border-red-300":!u.value}])},null,8,["modelValue","class"]),u.value?P("",!0):(b(),g("small",Ve," ⚠️ Debe seleccionar el tipo "))]),s("div",Ne,[e[25]||(e[25]=s("label",{class:"text-sm font-medium text-gray-700 mb-2"},[m(" Nombre: "),s("span",{class:"text-red-500"},"*")],-1)),r(l(D),{modelValue:o.value.nombre,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.nombre=a),placeholder:"Nombre (máximo 50 caracteres)",class:V(["w-full",{"border-red-300":!o.value.nombre||o.value.nombre.trim()===""}]),disabled:!u.value,maxlength:"50",onKeypress:e[6]||(e[6]=a=>{/[A-Za-zÀ-ÿ\s]/.test(a.key)||a.preventDefault()})},null,8,["modelValue","class","disabled"]),!o.value.nombre||o.value.nombre.trim()===""?(b(),g("small",$e," ⚠️ El nombre es obligatorio ")):o.value.nombre&&o.value.nombre.length>=40&&o.value.nombre.length<=50?(b(),g("small",Ae," Caracteres restantes: "+h(50-o.value.nombre.length),1)):P("",!0)]),u.value==="Provincia"?(b(),g("div",Le,[e[26]||(e[26]=s("label",{class:"text-sm font-medium text-gray-700 mb-2"},[m(" País: "),s("span",{class:"text-red-500"},"*")],-1)),r(l(L),{modelValue:o.value.pais_id,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.pais_id=a),options:N.value,optionLabel:"nombre",optionValue:"id",placeholder:"Seleccione un país",class:V(["w-full",{"border-red-300":u.value==="Provincia"&&!o.value.pais_id}])},null,8,["modelValue","options","class"]),u.value==="Provincia"&&!o.value.pais_id?(b(),g("small",De," ⚠️ Debe seleccionar un país ")):P("",!0)])):P("",!0)])]),_:1},8,["visible"]),r(l(R),{visible:_.value,"onUpdate:visible":e[14]||(e[14]=a=>_.value=a),header:`Editar ${d.value}`,modal:!0,closable:!1,style:{width:"400px"}},{footer:p(()=>{var a;return[s("div",Te,[s("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:e[13]||(e[13]=c=>_.value=!1)},[r(l(f),{icon:l(I),class:"h-5 text-green-600"},null,8,["icon"]),e[31]||(e[31]=m(" Cancelar "))]),s("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:Z,disabled:!((a=t.value.nombre)!=null&&a.trim())||t.value.nombre.trim().length>50||d.value==="Provincia"&&!t.value.pais_id},[r(l(f),{icon:l(T),class:"h-5 text-white"},null,8,["icon"]),e[32]||(e[32]=m(" Actualizar "))],8,Be)])]}),default:p(()=>[s("div",ze,[d.value==="Provincia"?(b(),g("div",qe,[e[29]||(e[29]=s("label",{class:"text-sm font-medium text-gray-700 mb-2"},[m(" País: "),s("span",{class:"text-red-500"},"*")],-1)),r(l(L),{modelValue:t.value.pais_id,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.pais_id=a),options:N.value,optionLabel:"nombre",optionValue:"id",placeholder:"Seleccione un país",class:V(["w-full",{"border-red-300":d.value==="Provincia"&&!t.value.pais_id}])},null,8,["modelValue","options","class"]),d.value==="Provincia"&&!t.value.pais_id?(b(),g("small",Re," ⚠️ Debe seleccionar un país ")):P("",!0)])):P("",!0),s("div",Fe,[e[30]||(e[30]=s("label",{class:"text-sm font-medium text-gray-700 mb-2"},[m(" Nombre: "),s("span",{class:"text-red-500"},"*")],-1)),r(l(D),{modelValue:t.value.nombre,"onUpdate:modelValue":e[11]||(e[11]=a=>t.value.nombre=a),placeholder:"Nombre (máximo 50 caracteres)",class:V(["w-full",{"border-red-300":!t.value.nombre||t.value.nombre.trim()===""}]),maxlength:"50",onKeypress:e[12]||(e[12]=a=>{/[A-Za-zÀ-ÿ\s]/.test(a.key)||a.preventDefault()})},null,8,["modelValue","class"]),!t.value.nombre||t.value.nombre.trim()===""?(b(),g("small",Ie," ⚠️ El nombre es obligatorio ")):t.value.nombre&&t.value.nombre.length>=40&&t.value.nombre.length<=50?(b(),g("small",Se," Caracteres restantes: "+h(50-t.value.nombre.length),1)):P("",!0)])])]),_:1},8,["visible","header"]),r(l(R),{visible:E.value,"onUpdate:visible":e[16]||(e[16]=a=>E.value=a),header:`Eliminar ${d.value}`,modal:!0,closable:!1,style:{width:"400px"}},{footer:p(()=>[s("div",Ke,[s("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:e[15]||(e[15]=a=>E.value=!1)},[r(l(f),{icon:l(I),class:"h-5 text-green-600"},null,8,["icon"]),e[36]||(e[36]=m(" Cancelar "))]),s("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:H,disabled:!y.value||!y.value.nombre},[r(l(f),{icon:l(F),class:"h-5 text-white"},null,8,["icon"]),e[37]||(e[37]=m(" Eliminar "))],8,Oe)])]),default:p(()=>{var a;return[s("div",Me,[r(l(f),{icon:l(F),class:"h-8 w-8 text-red-500"},null,8,["icon"]),s("div",Ge,[s("span",null,[e[33]||(e[33]=m("¿Estás seguro de eliminar ")),s("b",null,h((a=y.value)==null?void 0:a.nombre),1),e[34]||(e[34]=m("?"))]),e[35]||(e[35]=s("span",{class:"text-red-600 text-sm font-medium mt-1"},"Esta acción es irreversible.",-1))])])]}),_:1},8,["visible","header"])])]),_:1})],64))}};export{Qe as default};
