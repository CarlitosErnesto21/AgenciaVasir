import{r as c,E as W,w as fe,o as je,k as F,h as N,d as y,x as g,p as i,e as s,$ as r,a0 as He,t as u,j as M,y as X,c as J,v as pe,a7 as xe,F as $e,l as qe,N as w,n as Pe}from"./vendor-DcS5GX9S.js";import{A as Ue}from"./AuthenticatedLayout-BR2eBtsN.js";import{A as Ge,D as x}from"./ui-DN6aYgk-.js";import{w as ge,e as be,x as he,g as ye,r as we,f as k,y as _e,z as K,A as Re,l as Be,u as Ze}from"./index-00cYtq1U.js";import We from"./Modales-COcjm6cB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Xe={class:"container mx-auto px-4 py-6"},Je={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 sm:gap-6 mb-8"},Ke={class:"flex items-center justify-between text-white p-2 sm:p-4"},Qe={class:"text-xl sm:text-3xl font-bold"},Ye={class:"flex items-center justify-between text-white p-2 sm:p-4"},ea={class:"text-xl sm:text-3xl font-bold"},aa={class:"flex items-center justify-between text-white p-2 sm:p-4"},sa={class:"text-xl sm:text-3xl font-bold"},ta={class:"flex items-center justify-between text-white p-2 sm:p-4"},la={class:"text-xl sm:text-3xl font-bold"},ra={class:"flex items-center justify-between text-white p-2 sm:p-4"},oa={class:"text-sm sm:text-3xl font-bold"},ia={class:"bg-white rounded-lg shadow-md"},na={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4 mx-4"},da={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},ca={class:"flex items-center gap-3"},ua={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},ma={class:"grid grid-cols-3 gap-2 w-full sm:hidden mt-2"},va=["disabled"],fa={class:"truncate"},pa=["disabled"],xa={class:"truncate"},ga=["disabled"],ba={key:2,class:"truncate"},ha={class:"flex gap-2"},ya=["disabled"],wa=["disabled"],_a=["disabled"],Ra={key:2,class:"hidden sm:inline"},Aa={class:"space-y-3"},Da={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-5 lg:grid-cols-5 gap-3"},Ca={class:"col-span-1"},Ea={class:"col-span-1"},za=["value"],Na={class:"col-span-1 hidden md:block"},Fa={class:"col-span-1 hidden md:block"},ka={class:"col-span-2 flex gap-3 md:hidden"},Ta={class:"text-center py-12"},Ia={class:"text-xs sm:text-sm"},La={class:"font-medium"},Oa={class:"text-xs text-gray-500 hidden sm:block"},Va={class:"flex items-center gap-1 sm:gap-3"},Sa={class:"w-6 h-6 sm:w-8 sm:h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0"},Ma={class:"min-w-0 flex-1"},ja=["title"],Ha=["title"],$a={class:"min-w-0"},qa=["title"],Pa={class:"text-xs text-gray-500 capitalize hidden sm:block"},Ua={class:"text-center"},Ga={class:"text-xs sm:text-sm flex items-center justify-center gap-1"},Ba={class:"font-medium"},Za={class:"text-xs text-gray-500"},Wa={class:"text-right"},Xa={class:"font-medium text-green-600 flex items-center justify-end gap-1 text-xs sm:text-sm"},Ja={class:"truncate"},Ka={class:"hidden xl:inline"},Qa={class:"xl:hidden"},Ya={class:"flex justify-center"},es=["onClick"],ns={__name:"Reservas",setup(as){const f=Ge(),m=c([]),j=c([]),O=c(!1),Q=c(!1),o=c({tipo:"",busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:"",estadoTour:null}),D=c(!1),H=c(!1),$=c(!1),q=c(!1);c(!1);const P=c(null),C=c(null);c(""),c(null),c(""),c("");const Y=c(typeof window<"u"?window.innerWidth:1024),_=c(!1),T=c(!1),U=c(!1),G=c(!1),B=c(!1),Z=c(!1),h=c(!1),R=c(!1),I=[{label:"Pendientes",value:"PENDIENTE",severity:"warn",color:"bg-yellow-100 text-yellow-800",icon:ge},{label:"Confirmadas",value:"CONFIRMADA",severity:"success",color:"bg-green-100 text-green-800",icon:be},{label:"Rechazadas",value:"RECHAZADA",severity:"danger",color:"bg-red-100 text-red-800",icon:ye},{label:"Reprogramadas",value:"REPROGRAMADA",severity:"info",color:"bg-blue-100 text-blue-800",icon:he},{label:"Finalizadas",value:"FINALIZADA",severity:"secondary",color:"bg-gray-100 text-gray-800",icon:K}],Ae=[{label:"Disponible",value:"DISPONIBLE",color:"bg-green-100 text-green-800"},{label:"Agotado",value:"AGOTADO",color:"bg-red-100 text-red-800"},{label:"En Curso",value:"EN_CURSO",color:"bg-blue-100 text-blue-800"},{label:"Completado",value:"COMPLETADO",color:"bg-gray-100 text-gray-800"},{label:"Cancelado",value:"CANCELADO",color:"bg-red-100 text-red-800"},{label:"Suspendido",value:"SUSPENDIDO",color:"bg-orange-100 text-orange-800"},{label:"Reprogramado",value:"REPROGRAMADO",color:"bg-purple-100 text-purple-800"}],De=W(()=>{let e=m.value;if(o.value.estadoReserva&&(e=e.filter(a=>a.estado===o.value.estadoReserva)),o.value.busqueda){const a=o.value.busqueda.toLowerCase();e=e.filter(l=>{var n,p,v,d,b,t;return(((p=(n=l.cliente)==null?void 0:n.user)==null?void 0:p.name)||((v=l.cliente)==null?void 0:v.nombres)||"").toLowerCase().includes(a)||(l.entidad_nombre||"").toLowerCase().includes(a)||(((b=(d=l.cliente)==null?void 0:d.user)==null?void 0:b.email)||((t=l.cliente)==null?void 0:t.correo)||"").toLowerCase().includes(a)})}return o.value.fechaDesde&&(e=e.filter(a=>new Date(a.fecha_reserva)>=new Date(o.value.fechaDesde))),o.value.fechaHasta&&(e=e.filter(a=>new Date(a.fecha_reserva)<=new Date(o.value.fechaHasta))),e.sort((a,l)=>{const n={PENDIENTE:1,CONFIRMADA:2,REPROGRAMADA:3,FINALIZADA:4,RECHAZADA:5},p=n[a.estado]||6,v=n[l.estado]||6;return p!==v?p-v:new Date(l.fecha_reserva)-new Date(a.fecha_reserva)})}),L=W(()=>({pendientes:m.value.filter(e=>e.estado==="PENDIENTE").length,confirmadas:m.value.filter(e=>e.estado==="CONFIRMADA").length,reprogramadas:m.value.filter(e=>e.estado==="REPROGRAMADA").length,rechazadas:m.value.filter(e=>e.estado==="RECHAZADA").length,finalizadas:m.value.filter(e=>e.estado==="FINALIZADA").length,totalIngresos:m.value.filter(e=>["CONFIRMADA","FINALIZADA"].includes(e.estado)).reduce((e,a)=>e+(Number(a.total)||0),0)})),Ce=W(()=>Y.value<640?{width:"95vw",maxWidth:"380px"}:Y.value<768?{width:"400px"}:{width:"450px"}),V=async()=>{O.value=!0;try{const e={tipo:o.value.tipo,busqueda:o.value.busqueda||void 0,fecha_inicio:o.value.fechaDesde||void 0,fecha_fin:o.value.fechaHasta||void 0},a=await w.get("/api/reservas",{params:e,withCredentials:!0});m.value=a.data.data||[]}catch(e){console.error("Error cargando reservas:",e),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:4e3}),m.value=[]}finally{O.value=!1}},Ee=async()=>{O.value=!0,f.add({severity:"info",summary:"Cargando reservas...",life:2e3});try{const e={tipo:o.value.tipo,busqueda:o.value.busqueda||void 0,fecha_inicio:o.value.fechaDesde||void 0,fecha_fin:o.value.fechaHasta||void 0},a=await w.get("/api/reservas",{params:e,withCredentials:!0});m.value=a.data.data||[],f.add({severity:"success",summary:"Reservas cargadas",life:2e3})}catch(e){console.error("Error cargando reservas:",e),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:4e3}),m.value=[]}finally{O.value=!1}},ee=async()=>{Q.value=!0;try{const e=await w.get("/api/tours");j.value=e.data||[]}catch(e){console.error("Error cargando tours:",e),j.value=[]}finally{Q.value=!1}},ze=async e=>{var a,l,n,p,v;U.value=!0;try{const d=await w.put(`/api/reservas/${e.id}/confirmar`),b=m.value.findIndex(t=>t.id===e.id);b!==-1&&(m.value[b].estado="CONFIRMADA"),f.add({severity:"success",summary:"Â¡Confirmada!",detail:`Reserva de ${((l=(a=e.cliente)==null?void 0:a.user)==null?void 0:l.name)||((n=e.cliente)==null?void 0:n.nombres)} confirmada correctamente`,life:4e3})}catch(d){console.error("Error confirmando reserva:",d),f.add({severity:"error",summary:"Error",detail:((v=(p=d.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo confirmar la reserva",life:4e3})}finally{U.value=!1}},Ne=async e=>{var a,l,n,p,v;Z.value=!0;try{await w.put(`/api/reservas/${e.id}/finalizar`);const d=m.value.findIndex(b=>b.id===e.id);d!==-1&&(m.value[d].estado="FINALIZADA"),f.add({severity:"success",summary:"Â¡Finalizada!",detail:`Reserva de ${((l=(a=e.cliente)==null?void 0:a.user)==null?void 0:l.name)||((n=e.cliente)==null?void 0:n.nombres)} finalizada correctamente. Email de confirmaciÃ³n enviado.`,life:4e3})}catch(d){console.error("Error finalizando reserva:",d),f.add({severity:"error",summary:"Error",detail:((v=(p=d.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo finalizar la reserva",life:4e3})}finally{Z.value=!1}},ae=e=>{P.value=e,q.value=!0},Fe=e=>{P.value=e;const a=j.value.find(l=>{var n;return((n=e.detallesTours)==null?void 0:n.some(p=>p.tour_id===l.id))||e.entidad_nombre===l.nombre});C.value=a,D.value=!0},ke=e=>{e.originalEvent.target.closest("button")||ae(e.data)},Te=e=>{const a=I.find(l=>l.value===e);return(a==null?void 0:a.color)||"bg-gray-100 text-gray-800"},Ie=e=>e?new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",se=async()=>{_.value=!0;try{await new Promise(e=>setTimeout(e,300)),o.value={tipo:"",busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:"",estadoTour:null},f.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{_.value=!1}},te=async()=>{h.value=!0,f.add({severity:"info",summary:"Cargando reservas...",life:2e3});try{await V(),setTimeout(()=>{f.add({severity:"success",summary:"Reservas actualizadas",detail:`${m.value.length} registros cargados`,life:2e3})},300)}catch(e){console.error("Error al cargar las reservas:",e),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:3e3})}finally{setTimeout(()=>{h.value=!1},500)}},le=async()=>{var e,a;try{R.value=!0;const n=(await w.post("/api/reservas/finalizar-automaticamente")).data;n.success?(f.add({severity:"success",summary:"Â¡FinalizaciÃ³n automÃ¡tica completada!",detail:`${n.reservas_finalizadas} reserva(s) finalizada(s) de ${n.reservas_procesadas} procesada(s)`,life:6e3}),await V()):f.add({severity:"warn",summary:"Sin cambios",detail:n.message||"No hay reservas pendientes de finalizaciÃ³n",life:4e3})}catch(l){console.error("Error en finalizaciÃ³n automÃ¡tica:",l),f.add({severity:"error",summary:"Error",detail:((a=(e=l.response)==null?void 0:e.data)==null?void 0:a.message)||"Error al ejecutar la finalizaciÃ³n automÃ¡tica",life:4e3})}finally{R.value=!1}},Le=async e=>{await ze(e),D.value=!1},Oe=async e=>{var a,l,n,p,v;G.value=!0,T.value=!0;try{await w.put(`/api/reservas/${e.reserva.id}/rechazar`,{motivo:e.motivo});const d=m.value.findIndex(b=>b.id===e.reserva.id);d!==-1&&(m.value[d].estado="RECHAZADA"),$.value=!1,D.value=!1,f.add({severity:"success",summary:"Â¡Rechazada!",detail:`Reserva de ${((l=(a=e.reserva.cliente)==null?void 0:a.user)==null?void 0:l.name)||((n=e.reserva.cliente)==null?void 0:n.nombres)} rechazada correctamente`,life:4e3})}catch(d){console.error("Error rechazando reserva:",d),f.add({severity:"error",summary:"Error",detail:((v=(p=d.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo rechazar la reserva",life:4e3})}finally{T.value=!1,G.value=!1}},Ve=async e=>{var a,l,n,p,v;B.value=!0,T.value=!0;try{const d={fecha_nueva:e.fechaNueva,motivo:e.motivo,observaciones:e.observaciones};if(await w.put(`/api/reservas/${e.reserva.id}/reprogramar`,d),C.value)try{const t=new Date(C.value.fecha_salida),z=new Date(C.value.fecha_regreso).getTime()-t.getTime(),A=new Date(new Date(e.fechaNueva).getTime()+z),S={estado:"REPROGRAMADO",fecha_salida:e.fechaNueva,fecha_regreso:A,motivo_reprogramacion:`Reprogramado por reserva: ${e.motivo}`,observaciones:e.observaciones};await w.put(`/api/tours/${C.value.id}/cambiar-estado`,S),f.add({severity:"info",summary:"Tour actualizado",detail:`El tour "${C.value.nombre}" tambiÃ©n ha sido reprogramado`,life:4e3})}catch(t){console.error("Error reprogramando tour:",t),f.add({severity:"warn",summary:"Advertencia",detail:"La reserva fue reprogramada pero hubo un error al actualizar el tour",life:4e3})}const b=m.value.findIndex(t=>t.id===e.reserva.id);b!==-1&&(m.value[b].estado="REPROGRAMADA",m.value[b].fecha_reserva=e.fechaNueva),H.value=!1,D.value=!1,await Promise.all([V(),ee()]),f.add({severity:"success",summary:"Â¡Reprogramada!",detail:`Reserva de ${((l=(a=e.reserva.cliente)==null?void 0:a.user)==null?void 0:l.name)||((n=e.reserva.cliente)==null?void 0:n.nombres)} reprogramada correctamente`,life:4e3})}catch(d){console.error("Error reprogramando reserva:",d),f.add({severity:"error",summary:"Error",detail:((v=(p=d.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo reprogramar la reserva",life:4e3})}finally{T.value=!1,B.value=!1}},Se=async e=>{await Ne(e),D.value=!1},Me=e=>{ae(e)};fe(()=>[o.value.busqueda,o.value.fechaDesde,o.value.fechaHasta],()=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{V()},500)},{deep:!0});const re=()=>{Pe(()=>{setTimeout(()=>{document.querySelectorAll(".p-select").forEach(a=>{const l=a.querySelector(".p-select-label, .p-placeholder");l&&(l.style.overflow="hidden",l.style.textOverflow="ellipsis",l.style.whiteSpace="nowrap",l.style.maxWidth="calc(100% - 2.5rem)",l.style.display="block")})},100)})};return fe([o],()=>{re()},{deep:!0}),je(()=>{Promise.all([Ee(),ee()]),re()}),(e,a)=>{const l=F("Toast"),n=F("Card"),p=F("InputText"),v=F("DatePicker"),d=F("Column"),b=F("DataTable");return y(),N(Ue,null,{default:g(()=>[i(r(He),{title:"GestiÃ³n de Reservas"}),i(l,{class:"z-[9999]"}),s("div",Xe,[a[26]||(a[26]=s("div",{class:"mb-6"},[s("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"GestiÃ³n de Reservas"),s("p",{class:"text-gray-600"},"Administra todas las reservas de tours y hoteles")],-1)),s("div",Je,[i(n,{class:"bg-gradient-to-r from-yellow-500 to-yellow-600"},{content:g(()=>[s("div",Ke,[s("div",null,[a[13]||(a[13]=s("p",{class:"text-xs sm:text-sm opacity-90"},"Pendientes",-1)),s("p",Qe,u(L.value.pendientes),1)]),i(r(x),{icon:r(ge),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(n,{class:"bg-gradient-to-r from-green-500 to-green-600"},{content:g(()=>[s("div",Ye,[s("div",null,[a[14]||(a[14]=s("p",{class:"text-xs sm:text-sm opacity-90"},"Confirmadas",-1)),s("p",ea,u(L.value.confirmadas),1)]),i(r(x),{icon:r(be),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(n,{class:"bg-gradient-to-r from-blue-500 to-blue-600"},{content:g(()=>[s("div",aa,[s("div",null,[a[15]||(a[15]=s("p",{class:"text-xs sm:text-sm opacity-90"},"Reprogramadas",-1)),s("p",sa,u(L.value.reprogramadas),1)]),i(r(x),{icon:r(he),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(n,{class:"bg-gradient-to-r from-red-500 to-red-600"},{content:g(()=>[s("div",ta,[s("div",null,[a[16]||(a[16]=s("p",{class:"text-xs sm:text-sm opacity-90"},"Rechazadas",-1)),s("p",la,u(L.value.rechazadas),1)]),i(r(x),{icon:r(ye),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(n,{class:"bg-gradient-to-r from-purple-500 to-purple-600"},{content:g(()=>[s("div",ra,[s("div",null,[a[17]||(a[17]=s("p",{class:"text-xs sm:text-sm opacity-90"},"Ingresos",-1)),s("p",oa,"$"+u(L.value.totalIngresos.toFixed(2)),1)]),i(r(x),{icon:r(we),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1})]),s("div",ia,[a[25]||(a[25]=s("div",{class:"flex flex-col sm:flex-row lg:justify-between lg:items-center mb-4 gap-4 p-6"},[s("div",null,[s("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold text-center sm:text-start"},"Reservas por Estado"),s("p",{class:"text-gray-500 text-sm text-center sm:text-start mt-1"}," ðŸ“Š Gestiona las reservas organizadas por su estado actual "),s("p",{class:"text-blue-600 text-xs text-center sm:text-start mt-1 font-medium"}," ðŸ‘† Haz clic en cualquier fila para ver los detalles de la reserva ")])],-1)),s("div",na,[s("div",da,[s("div",ca,[a[18]||(a[18]=s("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[s("i",{class:"pi pi-filter text-blue-600 text-sm"}),s("span",null,"Filtros")],-1)),s("div",ua,u(m.value.length)+" resultado"+u(m.value.length!==1?"s":""),1)]),s("div",ma,[s("button",{onClick:se,disabled:_.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-2 py-1 text-xs text-white shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1"},[_.value?(y(),N(r(x),{key:0,icon:r(k),class:"animate-spin h-3 w-3"},null,8,["icon"])):M("",!0),s("span",fa,u(_.value?"Limpiando...":"Limpiar"),1)],8,va),s("button",{onClick:te,disabled:h.value,class:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 text-xs shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1"},[i(r(x),{icon:h.value?r(k):r(_e),class:X([{"animate-spin":h.value},"h-3 w-3"])},null,8,["icon","class"]),s("span",xa,u(h.value?"Recargando...":"Recargar"),1)],8,pa),s("button",{onClick:le,disabled:R.value,class:"bg-purple-500 hover:bg-purple-600 text-white px-2 py-1 text-xs shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1",title:"Finaliza automÃ¡ticamente las reservas cuyas fechas de tour han pasado"},[R.value?(y(),N(r(x),{key:0,icon:r(k),class:"animate-spin h-3 w-3"},null,8,["icon"])):(y(),N(r(x),{key:1,icon:r(K),class:"h-3"},null,8,["icon"])),R.value?M("",!0):(y(),J("span",ba,"Finalizar"))],8,ga)]),s("div",ha,[s("button",{onClick:se,disabled:_.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[_.value?(y(),N(r(x),{key:0,icon:r(k),class:"animate-spin h-3 w-3"},null,8,["icon"])):M("",!0),s("span",null,u(_.value?"Limpiando...":"Limpiar filtros"),1)],8,ya),s("button",{onClick:te,disabled:h.value,class:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 text-sm shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2 hidden sm:flex"},[i(r(x),{icon:h.value?r(k):r(_e),class:X([{"animate-spin":h.value},"h-3 w-3"])},null,8,["icon","class"]),s("span",null,u(h.value?"Recargando...":"Recargar"),1)],8,wa),s("button",{onClick:le,disabled:R.value,class:"bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 text-sm shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2 hidden sm:flex",title:"Finaliza automÃ¡ticamente las reservas cuyas fechas de tour han pasado"},[R.value?(y(),N(r(x),{key:0,icon:r(k),class:"animate-spin h-3 w-3"},null,8,["icon"])):(y(),N(r(x),{key:1,icon:r(K),class:"h-3"},null,8,["icon"])),R.value?M("",!0):(y(),J("span",Ra,"FinalizaciÃ³n AutomÃ¡tica"))],8,_a)])]),s("div",Aa,[s("div",null,[i(p,{modelValue:o.value.busqueda,"onUpdate:modelValue":a[0]||(a[0]=t=>o.value.busqueda=t),placeholder:"ðŸ” Buscar reservas...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),s("div",Da,[s("div",Ca,[pe(s("select",{"onUpdate:modelValue":a[1]||(a[1]=t=>o.value.tipo=t),onChange:a[2]||(a[2]=(...t)=>e.aplicarFiltros&&e.aplicarFiltros(...t)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},a[19]||(a[19]=[s("option",{value:"",disabled:"",selected:"",hidden:""},"Tipo",-1),s("option",{value:"tours",class:"truncate text-gray-900"},"Tours",-1),s("option",{value:"hoteles",class:"truncate text-gray-900"},"Hoteles",-1)]),544),[[xe,o.value.tipo]])]),s("div",Ea,[pe(s("select",{"onUpdate:modelValue":a[3]||(a[3]=t=>o.value.estadoReserva=t),onChange:a[4]||(a[4]=(...t)=>e.aplicarFiltros&&e.aplicarFiltros(...t)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[a[20]||(a[20]=s("option",{value:"",disabled:"",selected:"",hidden:""},"Estado",-1)),(y(),J($e,null,qe(I,t=>s("option",{key:t.value,value:t.value,class:"truncate text-gray-900"},u(t.label),9,za)),64))],544),[[xe,o.value.estadoReserva]])]),s("div",Na,[i(v,{modelValue:o.value.fechaDesde,"onUpdate:modelValue":a[5]||(a[5]=t=>o.value.fechaDesde=t),placeholder:"Fecha desde",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),s("div",Fa,[i(v,{modelValue:o.value.fechaHasta,"onUpdate:modelValue":a[6]||(a[6]=t=>o.value.fechaHasta=t),placeholder:"Fecha hasta",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),s("div",ka,[i(v,{modelValue:o.value.fechaDesde,"onUpdate:modelValue":a[7]||(a[7]=t=>o.value.fechaDesde=t),placeholder:"Fecha desde",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"]),i(v,{modelValue:o.value.fechaHasta,"onUpdate:modelValue":a[8]||(a[8]=t=>o.value.fechaHasta=t),placeholder:"Fecha hasta",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"])])])])]),i(b,{value:De.value,paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} reservas",responsiveLayout:"scroll",class:"mt-2 sm:mt-4 overflow-x-auto",onRowClick:ke,pt:{root:{class:"text-xs sm:text-sm"},wrapper:{class:"text-xs sm:text-sm overflow-x-auto"},table:{class:"text-xs sm:text-sm min-w-full"},thead:{class:"text-xs sm:text-sm"},headerRow:{class:"text-xs sm:text-sm"},headerCell:{class:"text-xs sm:text-sm font-medium py-2 sm:py-3 px-1 sm:px-2"},tbody:{class:"text-xs sm:text-sm"},bodyRow:{class:"text-xs sm:text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-2 sm:py-3 px-1 sm:px-2 text-xs sm:text-sm"}}},{empty:g(()=>[s("div",Ta,[i(r(x),{icon:r(Ze),class:"text-4xl text-gray-400 mb-4"},null,8,["icon"]),a[21]||(a[21]=s("p",{class:"text-gray-500 text-lg"},"No se encontraron reservas",-1)),a[22]||(a[22]=s("p",{class:"text-gray-400 text-sm mt-2"}," Ajusta los filtros para encontrar las reservas que buscas ",-1))])]),loading:g(()=>a[23]||(a[23]=[s("div",{class:"text-center py-12"},[s("i",{class:"pi pi-spin pi-spinner text-3xl text-blue-500 mb-4"}),s("p",{class:"text-gray-500 text-lg"},"Cargando reservas...")],-1)])),default:g(()=>[i(d,{field:"fecha_reserva",header:"Fecha",sortable:"",class:"w-16 sm:w-20 lg:w-24 min-w-14"},{body:g(t=>[s("div",Ia,[s("div",La,u(Ie(t.data.fecha_reserva)),1),s("div",Oa,u(new Date(t.data.fecha_reserva).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})),1)])]),_:1}),i(d,{field:"cliente.nombres",header:"Cliente",sortable:"",class:"w-24 sm:w-32 lg:w-40 min-w-20 hidden sm:table-cell"},{body:g(t=>{var E,z,A,S,oe,ie,ne,de,ce,ue,me,ve;return[s("div",Va,[s("div",Sa,[i(r(x),{icon:r(Re),class:"text-blue-600 text-xs sm:text-sm"},null,8,["icon"])]),s("div",Ma,[s("div",{class:"font-medium text-gray-900 text-xs sm:text-sm truncate",title:((z=(E=t.data.cliente)==null?void 0:E.user)==null?void 0:z.name)||((A=t.data.cliente)==null?void 0:A.nombres)||"N/A"},u(((oe=(S=t.data.cliente)==null?void 0:S.user)==null?void 0:oe.name)||((ie=t.data.cliente)==null?void 0:ie.nombres)||"N/A"),9,ja),s("div",{class:"text-xs text-gray-500 truncate hidden sm:block",title:((de=(ne=t.data.cliente)==null?void 0:ne.user)==null?void 0:de.email)||((ce=t.data.cliente)==null?void 0:ce.correo)||"N/A"},u(((me=(ue=t.data.cliente)==null?void 0:ue.user)==null?void 0:me.email)||((ve=t.data.cliente)==null?void 0:ve.correo)||"N/A"),9,Ha)])])]}),_:1}),i(d,{field:"entidad_nombre",header:"Servicio",sortable:"",class:"w-24 sm:w-32 lg:w-48 min-w-20"},{body:g(t=>[s("div",$a,[s("div",{class:"text-xs sm:text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"120px","text-overflow":"ellipsis","white-space":"nowrap"},title:t.data.entidad_nombre},u(t.data.entidad_nombre||"N/A"),9,qa),s("div",Pa,u(t.data.tipo||"N/A"),1)])]),_:1}),i(d,{header:"Personas",class:"w-16 sm:w-20 lg:w-24 min-w-14 hidden md:table-cell"},{body:g(t=>[s("div",Ua,[s("div",Ga,[i(r(x),{icon:r(Re),class:"text-gray-400 text-xs"},null,8,["icon"]),s("span",Ba,u((t.data.mayores_edad||0)+(t.data.menores_edad||0)),1)]),s("div",Za,u(t.data.mayores_edad||0)+"A â€¢ "+u(t.data.menores_edad||0)+"N ",1)])]),_:1}),i(d,{field:"total",header:"Total",sortable:"",class:"w-16 sm:w-20 lg:w-24 min-w-14"},{body:g(t=>[s("div",Wa,[s("div",Xa,[i(r(x),{icon:r(we),class:"text-xs"},null,8,["icon"]),s("span",Ja,u(Number(t.data.total||0).toFixed(2)),1)])])]),_:1}),i(d,{field:"estado",header:"Estado",class:"w-20 sm:w-24 lg:w-32 min-w-16 hidden lg:table-cell"},{body:g(t=>{var E,z;return[s("span",{class:X([Te(t.data.estado),"px-1 sm:px-2 py-1 rounded-full text-xs font-medium"])},[s("span",Ka,u(((E=I.find(A=>A.value===t.data.estado))==null?void 0:E.label)||t.data.estado),1),s("span",Qa,u((((z=I.find(A=>A.value===t.data.estado))==null?void 0:z.label)||t.data.estado).substring(0,4)),1)],2)]}),_:1}),i(d,{header:"Acciones",class:"w-20 sm:w-24 lg:w-28 min-w-16"},{body:g(t=>[s("div",Ya,[s("button",{class:"bg-green-500 hover:bg-green-600 text-white px-2 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-1 text-xs shadow-md hover:shadow-lg hover:-translate-y-1",onClick:E=>Fe(t.data),title:"MÃ¡s acciones"},[i(r(x),{icon:r(Be),class:"h-3 w-4 sm:h-4 sm:w-5"},null,8,["icon"]),a[24]||(a[24]=s("span",{class:"hidden md:inline"},"MÃ¡s",-1))],8,es)])]),_:1})]),_:1},8,["value"]),i(We,{visible:D.value,"onUpdate:visible":a[9]||(a[9]=t=>D.value=t),"detalles-visible":q.value,"onUpdate:detallesVisible":a[10]||(a[10]=t=>q.value=t),"rechazar-visible":$.value,"onUpdate:rechazarVisible":a[11]||(a[11]=t=>$.value=t),"reprogramar-visible":H.value,"onUpdate:reprogramarVisible":a[12]||(a[12]=t=>H.value=t),reserva:P.value,tour:C.value,"dialog-style":Ce.value,procesando:T.value,"confirmando-reserva":U.value,"rechazando-reserva":G.value,"reprogramando-reserva":B.value,"finalizando-reserva":Z.value,"estados-reservas":I,"estados-tours":Ae,onConfirmar:Le,onRechazar:Oe,onReprogramar:Ve,onFinalizar:Se,onVerDetalles:Me},null,8,["visible","detalles-visible","rechazar-visible","reprogramar-visible","reserva","tour","dialog-style","procesando","confirmando-reserva","rechazando-reserva","reprogramando-reserva","finalizando-reserva"])])])]),_:1})}}};export{ns as default};
