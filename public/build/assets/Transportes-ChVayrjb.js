import{q as ae,r as i,F as V,i as le,m as te,D as B,s as se,E as D,y as P,c,o as m,a as s,u as o,g as re,w as n,b as l,S as oe,t as d,n as T,h as p,f as b,j as ne,ae as de,A as ie}from"./app-WKwrJkJC.js";import{_ as ue}from"./AuthenticatedLayout-baeqBx4a.js";import{F as v,f as ce,o as me,b as F,c as pe,e as R,g as $,h as ve,i as fe}from"./index-Cz7jU3Cp.js";import"./logo-DN1bLr27.js";const be={class:"py-4 sm:py-6 px-4 sm:px-7 mt-6 sm:mt-10 mx-auto bg-red-50 shadow-lg rounded-lg h-screen-full"},ge={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2 sm:gap-0"},xe={class:"flex items-center gap-3"},ye={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},he={class:"flex items-center justify-between mb-3"},we={class:"flex items-center gap-3"},_e={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Ce={class:"space-y-3"},Pe={class:"text-sm font-mono leading-relaxed"},Ee={class:"text-sm font-medium leading-relaxed"},Ne={class:"text-sm leading-relaxed text-center"},Te={class:"text-sm leading-relaxed"},ke={class:"flex gap-2 h-full justify-center items-center"},Le=["onClick"],De=["onClick"],Ie={class:"space-y-4"},Oe={class:"w-full flex flex-col"},Se={class:"flex items-center gap-4"},Ae={key:0,class:"text-red-500 ml-28"},Ve={key:1,class:"text-orange-500 ml-28"},Be={key:2,class:"text-red-500 ml-28"},Me={class:"w-full flex flex-col"},je={class:"flex items-center gap-4"},Ue={key:0,class:"text-red-500 ml-28"},Fe={key:1,class:"text-orange-500 ml-28"},Re={key:2,class:"text-red-500 ml-28"},$e={class:"w-full flex flex-col"},qe={class:"flex items-center gap-4"},ze={key:0,class:"text-red-500 ml-28"},Ge={class:"w-full flex flex-col"},Je={class:"flex items-center gap-4"},We={key:0,class:"text-red-500 ml-28"},Ke={key:1,class:"text-orange-500 ml-28"},Qe={key:2,class:"text-red-500 ml-28"},Xe={class:"w-full flex flex-col"},He={class:"flex items-center gap-4"},Ye={class:"flex justify-center gap-4 w-full"},Ze={class:"flex items-center gap-3"},ea={class:"flex flex-col"},aa={class:"flex justify-center gap-4 w-full"},la={class:"flex justify-center gap-3 w-full"},da={__name:"Transportes",setup(ta){const u=ae(),M=i([]),e=i({id:null,numero_placa:"",nombre:"",capacidad:null,marca:"",estado:"DISPONIBLE"}),j=i(null),y=i(!1),E=i(!1),N=i(!1),f=i(!1),w=i(!1),h=i(null),x=i({global:{value:null,matchMode:V.CONTAINS},nombre:{value:null,matchMode:V.CONTAINS},capacidad:{value:null,matchMode:V.EQUALS}}),I=i(10),q=i([5,10,20,50]),k=i("Guardar"),O=le(()=>{let r=M.value;if(x.value.global.value){const a=x.value.global.value.toLowerCase();r=r.filter(g=>g.nombre.toLowerCase().includes(a)||g.capacidad&&g.capacidad.toString().includes(a))}return x.value.nombre.value&&(r=r.filter(a=>a.nombre.toLowerCase().includes(x.value.nombre.value.toLowerCase()))),x.value.capacidad.value&&(r=r.filter(a=>a.capacidad==x.value.capacidad.value)),r});te([e],()=>{h.value&&y.value&&B(()=>{const r={...e.value},a=JSON.stringify(r)!==JSON.stringify(h.value),g=!h.value.id,_=e.value.nombre||e.value.capacidad;w.value=a||g&&_})},{deep:!0});function L(){e.value={id:null,numero_placa:"",nombre:"",capacidad:null,marca:"",estado:"DISPONIBLE"},f.value=!1}se(()=>{S()});const S=async()=>{try{const r=await D.get("/api/transportes");M.value=r.data.sort((a,g)=>g.id-a.id)}catch{u.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los transportes.",life:4e3})}},z=()=>{L(),k.value="Guardar",y.value=!0,B(()=>{h.value={...e.value},w.value=!1})},G=r=>{L(),e.value={...r},k.value="Actualizar",y.value=!0,B(()=>{h.value={...e.value},w.value=!1})},J=/^(P|M|C|A|R|D|V|G|AB|MB|CD|CC|CR|MI|FA|PE|OF|OI)[ -]?[0-9A-F]{6}$/i,W=async()=>{if(f.value=!0,!e.value.numero_placa||e.value.numero_placa.length<5||e.value.numero_placa.length>10){u.add({severity:"warn",summary:"Campos requeridos",detail:"La placa debe tener entre 5 y 10 caracteres.",life:4e3});return}if(!J.test(e.value.numero_placa)){u.add({severity:"warn",summary:"Formato inv√°lido",detail:"La placa debe iniciar con un prefijo v√°lido y tener 6 caracteres alfanum√©ricos. Ejemplo: P 123456, AB-12A3F",life:5e3});return}if(!e.value.nombre||e.value.nombre.length<3||e.value.nombre.length>50){u.add({severity:"warn",summary:"Campos requeridos",detail:"El nombre debe tener entre 3 y 50 caracteres.",life:4e3});return}if(!e.value.capacidad||e.value.capacidad<1){u.add({severity:"warn",summary:"Campos requeridos",detail:"La capacidad debe ser al menos 1.",life:4e3});return}if(!e.value.marca||e.value.marca.length<2||e.value.marca.length>30){u.add({severity:"warn",summary:"Campos requeridos",detail:"La marca debe tener entre 2 y 30 caracteres.",life:4e3});return}try{let r;e.value.id?(r=await D.put(`/api/transportes/${e.value.id}`,{numero_placa:e.value.numero_placa,nombre:e.value.nombre,capacidad:e.value.capacidad,marca:e.value.marca,estado:e.value.estado}),u.add({severity:"success",summary:"¬°√âxito!",detail:"Transporte actualizado correctamente.",life:4e3})):(r=await D.post("/api/transportes",{numero_placa:e.value.numero_placa,nombre:e.value.nombre,capacidad:e.value.capacidad,marca:e.value.marca,estado:e.value.estado}),u.add({severity:"success",summary:"¬°√âxito!",detail:"Transporte creado correctamente.",life:4e3})),await S(),y.value=!1,w.value=!1,h.value=null,L()}catch(r){r.response&&r.response.data&&r.response.data.errors&&r.response.data.errors.numero_placa?u.add({severity:"error",summary:"Error",detail:r.response.data.errors.numero_placa[0],life:4e3}):u.add({severity:"error",summary:"Error",detail:"No se pudo guardar el transporte.",life:4e3})}},K=r=>{e.value={...r},E.value=!0},Q=async()=>{try{await D.delete(`/api/transportes/${e.value.id}`),await S(),E.value=!1,u.add({severity:"success",summary:"¬°Eliminado!",detail:"Transporte eliminado correctamente.",life:4e3})}catch{u.add({severity:"error",summary:"Error",detail:"No se pudo eliminar el transporte.",life:4e3})}},X=()=>{w.value?N.value=!0:U()},U=()=>{y.value=!1,N.value=!1,w.value=!1,h.value=null,L()},H=()=>{N.value=!1};return(r,a)=>{const g=P("Toast"),_=P("InputText"),C=P("Column"),Y=P("DataTable"),Z=P("InputNumber"),A=P("Dialog");return m(),c(ie,null,[s(o(re),{title:"Cat√°logo de Transportes"}),s(ue,null,{default:n(()=>[s(g,{class:"z-[9999]"}),l("div",be,[l("div",ge,[l("div",xe,[s(o(oe),{href:r.route("tours"),class:"flex items-center text-blue-600 hover:text-blue-700 transition-colors duration-200 px-4 rounded-lg",title:"Regresar a Tours"},{default:n(()=>[s(o(v),{icon:o(ce),class:"h-8"},null,8,["icon"])]),_:1},8,["href"]),a[12]||(a[12]=l("h3",{class:"text-lg sm:text-2xl text-blue-600 font-bold"},"Cat√°logo de Transportes",-1))]),l("button",{class:"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:z},[s(o(v),{icon:o(me),class:"h-4 w-4 text-white"},null,8,["icon"]),a[13]||(a[13]=l("span",null,"¬†Agregar transporte",-1))])]),s(Y,{value:O.value,selection:j.value,"onUpdate:selection":a[1]||(a[1]=t=>j.value=t),dataKey:"id",paginator:!0,rows:I.value,rowsPerPageOptions:q.value,rowsPerPage:I.value,"onUpdate:rowsPerPage":a[2]||(a[2]=t=>I.value=t),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} transportes",class:"overflow-x-auto max-w-full",style:{display:"block","max-width":"84vw"},responsiveLayout:"scroll",pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:n(()=>[l("div",ye,[l("div",he,[l("div",we,[a[14]||(a[14]=l("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[l("i",{class:"pi pi-filter text-blue-600 text-sm"}),l("span",null,"Filtros")],-1)),l("div",_e,d(O.value.length)+" resultado"+d(O.value.length!==1?"s":""),1)])]),l("div",Ce,[l("div",null,[s(_,{modelValue:x.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=t=>x.value.global.value=t),placeholder:"üîç Buscar transportes...",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])])])])]),default:n(()=>[s(C,{field:"numero_placa",header:"Placa",sortable:"",class:"w-32 min-w-24"},{body:n(t=>[l("div",Pe,d(t.data.numero_placa),1)]),_:1}),s(C,{field:"nombre",header:"Nombre",sortable:"",class:"w-40 min-w-34"},{body:n(t=>[l("div",Ee,d(t.data.nombre),1)]),_:1}),s(C,{field:"capacidad",header:"Capacidad",class:"w-32 min-w-20"},{body:n(t=>[l("div",Ne,d(t.data.capacidad),1)]),_:1}),s(C,{field:"marca",header:"Marca",sortable:"",class:"w-32 min-w-24"},{body:n(t=>[l("div",Te,d(t.data.marca),1)]),_:1}),s(C,{field:"estado",header:"Estado",sortable:"",class:"w-32 min-w-24"},{body:n(t=>[l("span",{class:T(t.data.estado==="DISPONIBLE"?"bg-green-100 text-green-800 px-2 py-1 rounded-full":"bg-red-100 text-red-800 px-2 py-1 rounded-full")},d(t.data.estado==="NO_DISPONIBLE"?"NO DISPONIBLE":t.data.estado),3)]),_:1}),s(C,{exportable:!1,class:"w-40 min-w-52"},{header:n(()=>a[15]||(a[15]=[l("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:n(t=>[l("div",ke,[l("button",{class:"bg-orange-200/30 border p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:ee=>G(t.data)},[s(o(v),{icon:o(F),class:"h-4 w-4 text-orange-600"},null,8,["icon"]),a[16]||(a[16]=p(" ¬†Editar "))],8,Le),l("button",{class:"bg-red-200/30 border p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:ee=>K(t.data)},[s(o(v),{icon:o(pe),class:"h-4 w-4 text-red-600"},null,8,["icon"]),a[17]||(a[17]=p(" ¬†Eliminar "))],8,De)])]),_:1})]),_:1},8,["value","selection","rows","rowsPerPageOptions","rowsPerPage"]),s(A,{visible:y.value,"onUpdate:visible":a[8]||(a[8]=t=>y.value=t),header:k.value+" Transporte",modal:!0,style:{width:"400px"},closable:!1},{footer:n(()=>[l("div",Ye,[l("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:X},[s(o(v),{icon:o(R),class:"h-5 text-green-600"},null,8,["icon"]),a[24]||(a[24]=p("Cancelar "))]),l("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:W},[s(o(v),{icon:o($),class:"h-5 text-white"},null,8,["icon"]),p(d(k.value),1)])])]),default:n(()=>[l("div",Ie,[l("div",Oe,[l("div",Se,[a[18]||(a[18]=l("label",{for:"numero_placa",class:"w-24 flex items-center gap-1"},[p(" Placa: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),s(_,{modelValue:e.value.numero_placa,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.numero_placa=t),modelModifiers:{trim:!0},id:"numero_placa",name:"numero_placa",maxlength:10,class:T([{"p-invalid":f.value&&(!e.value.numero_placa||e.value.numero_placa.length<5||e.value.numero_placa.length>10)},"flex-1"]),placeholder:"Ej. ABC123, 12A345"},null,8,["modelValue","class"])]),e.value.numero_placa&&e.value.numero_placa.length<5?(m(),c("small",Ae," La placa debe tener al menos 5 caracteres. Actual: "+d(e.value.numero_placa.length)+"/5 ",1)):b("",!0),e.value.numero_placa&&e.value.numero_placa.length>10?(m(),c("small",Ve," Caracteres restantes: "+d(10-e.value.numero_placa.length),1)):b("",!0),f.value&&!e.value.numero_placa?(m(),c("small",Be," La placa es obligatoria. ")):b("",!0)]),l("div",Me,[l("div",je,[a[19]||(a[19]=l("label",{for:"nombre",class:"w-24 flex items-center gap-1"},[p(" Nombre: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),s(_,{modelValue:e.value.nombre,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.nombre=t),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:50,class:T([{"p-invalid":f.value&&(!e.value.nombre||e.value.nombre.length<3||e.value.nombre.length>50)},"flex-1"]),placeholder:"Ej. Autob√∫s, Carro, etc."},null,8,["modelValue","class"])]),e.value.nombre&&e.value.nombre.length<3?(m(),c("small",Ue," El nombre debe tener al menos 3 caracteres. Actual: "+d(e.value.nombre.length)+"/3 ",1)):b("",!0),e.value.nombre&&e.value.nombre.length>45?(m(),c("small",Fe," Caracteres restantes: "+d(50-e.value.nombre.length),1)):b("",!0),f.value&&!e.value.nombre?(m(),c("small",Re," El nombre es obligatorio. ")):b("",!0)]),l("div",$e,[l("div",qe,[a[20]||(a[20]=l("label",{for:"capacidad",class:"w-24 flex items-center gap-1"},[p(" Capacidad: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),s(Z,{modelValue:e.value.capacidad,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.capacidad=t),id:"capacidad",name:"capacidad",min:1,max:500,step:1,class:T(["flex-1",{"p-invalid":f.value&&(!e.value.capacidad||e.value.capacidad<1)}]),placeholder:"Cantidad"},null,8,["modelValue","class"])]),f.value&&(!e.value.capacidad||e.value.capacidad<1)?(m(),c("small",ze," La capacidad es obligatoria y debe ser mayor o igual a 1. ")):b("",!0)]),l("div",Ge,[l("div",Je,[a[21]||(a[21]=l("label",{for:"marca",class:"w-24 flex items-center gap-1"},[p(" Marca: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),s(_,{modelValue:e.value.marca,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.marca=t),modelModifiers:{trim:!0},id:"marca",name:"marca",maxlength:30,class:T([{"p-invalid":f.value&&(!e.value.marca||e.value.marca.length<2||e.value.marca.length>30)},"flex-1"]),placeholder:"Ej. Toyota, Mercedes"},null,8,["modelValue","class"])]),e.value.marca&&e.value.marca.length<2?(m(),c("small",We," La marca debe tener al menos 2 caracteres. Actual: "+d(e.value.marca.length)+"/2 ",1)):b("",!0),e.value.marca&&e.value.marca.length>30?(m(),c("small",Ke," Caracteres restantes: "+d(30-e.value.marca.length),1)):b("",!0),f.value&&!e.value.marca?(m(),c("small",Qe," La marca es obligatoria. ")):b("",!0)]),l("div",Xe,[l("div",He,[a[23]||(a[23]=l("label",{for:"estado",class:"w-24 flex items-center gap-1"},[p(" Estado: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),ne(l("select",{"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.estado=t),id:"estado",name:"estado",class:"flex-1 border rounded px-2 py-1"},a[22]||(a[22]=[l("option",{value:"DISPONIBLE"},"DISPONIBLE",-1),l("option",{value:"NO_DISPONIBLE"},"NO DISPONIBLE",-1)]),512),[[de,e.value.estado]])])])])]),_:1},8,["visible","header"]),s(A,{visible:E.value,"onUpdate:visible":a[10]||(a[10]=t=>E.value=t),header:"Eliminar transporte",modal:!0,style:{width:"350px"},closable:!1},{footer:n(()=>[l("div",aa,[l("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:a[9]||(a[9]=t=>E.value=!1)},[s(o(v),{icon:o(R),class:"h-5"},null,8,["icon"]),a[28]||(a[28]=l("span",null,"No",-1))]),l("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Q},[s(o(v),{icon:o($),class:"h-5"},null,8,["icon"]),a[29]||(a[29]=l("span",null,"S√≠",-1))])])]),default:n(()=>[l("div",Ze,[s(o(v),{icon:o(ve),class:"h-8 w-8 text-red-500"},null,8,["icon"]),l("div",ea,[l("span",null,[a[25]||(a[25]=p("¬øEst√°s seguro de eliminar el transporte: ")),l("b",null,d(e.value.nombre),1),a[26]||(a[26]=p("?"))]),a[27]||(a[27]=l("span",{class:"text-red-600 text-sm font-medium mt-1"},"Esta acci√≥n es irreversible.",-1))])])]),_:1},8,["visible"]),s(A,{visible:N.value,"onUpdate:visible":a[11]||(a[11]=t=>N.value=t),header:"Cambios sin guardar",modal:!0,style:{width:"400px"},closable:!1},{footer:n(()=>[l("div",la,[l("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:H},[s(o(v),{icon:o(F),class:"h-4"},null,8,["icon"]),a[30]||(a[30]=l("span",null,"Continuar",-1))]),l("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:U},[s(o(v),{icon:o(fe),class:"h-4"},null,8,["icon"]),a[31]||(a[31]=l("span",null,"Salir sin guardar",-1))])])]),default:n(()=>[a[32]||(a[32]=l("div",{class:"flex items-center gap-3"},[l("i",{class:"pi pi-exclamation-triangle text-gray-800",style:{"font-size":"24px"}}),l("span",null,"Tienes informaci√≥n sin guardar. ¬øDeseas salir sin guardar?")],-1))]),_:1,__:[32]},8,["visible"])])]),_:1})],64)}}};export{da as default};
