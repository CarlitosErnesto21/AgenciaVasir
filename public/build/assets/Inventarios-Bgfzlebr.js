import{r as d,E as me,w as Ce,o as Ee,k as C,h as q,d as f,x as m,p as a,e as t,$ as l,a0 as De,q as r,t as i,c as g,y as F,j as _,v as ve,F as oe,l as se,a7 as pe,A as le,N as B,a5 as Te}from"./vendor-gbh1WW5n.js";import{A as Pe}from"./AuthenticatedLayout-CSuYxj7F.js";import{z as Se,F as u}from"./ui-BrU4k96Z.js";import{n as j,h as Fe,t as je,i as H,u as Le,c as L,m as fe,o as Me,v as ae,s as Ve}from"./index-B6nVaz6S.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ie={class:"container mx-auto px-4 py-6"},Ne={class:"mb-3 text-center sm:text-left"},Re={class:"bg-blue-50 border-l-4 border-blue-400 p-3 mt-3 rounded-r-md"},Ue={class:"text-blue-700 text-sm"},$e={class:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-8"},Be={class:"flex items-center justify-between text-white p-2 sm:p-4"},ze={class:"text-xl sm:text-3xl font-bold"},Oe={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},We={class:"flex items-center justify-between text-white p-2 sm:p-4"},qe={class:"text-xl sm:text-3xl font-bold"},He={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},Ge={class:"flex items-center justify-between text-white p-2 sm:p-4"},Je={class:"text-xl sm:text-3xl font-bold"},Ke={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},Qe={class:"flex items-center justify-between text-white p-2 sm:p-4"},Ye={class:"text-sm sm:text-3xl font-bold"},Xe={class:"bg-white rounded-lg shadow-md"},Ze={key:0,class:"flex flex-col items-center justify-center py-12"},et={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},tt={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},ot={class:"flex items-center gap-3"},st={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},lt=["disabled"],at=["disabled"],it={class:"space-y-3"},nt={class:"relative"},rt={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-3"},dt={class:"col-span-1"},ut=["value"],ct={class:"col-span-1"},mt=["value"],vt={class:"col-span-1 hidden md:block"},pt={class:"col-span-1 hidden md:block"},ft={class:"col-span-2 flex gap-3 md:hidden"},gt={class:"px-1 mt-3"},bt={class:"text-blue-600 text-xs font-medium flex items-center gap-1"},xt={class:"text-sm font-medium leading-relaxed"},yt=["title"],ht={class:"block text-xs text-gray-500"},wt=["title"],_t={class:"flex justify-center items-center"},kt=["onClick"],At={class:"flex flex-col items-center justify-center py-12 text-center"},Ct={key:0,class:"space-y-4"},Et={class:"grid grid-cols-2 gap-4"},Dt={class:"text-green-600 font-medium"},Tt={class:"col-span-2"},Pt={class:"text-sm text-gray-600"},St={key:0,class:"text-sm text-gray-600 mt-1"},Ft={key:0},jt={key:0},Lt={class:"mt-1 p-3 bg-gray-50 rounded-lg"},Mt={key:1,class:"p-3 bg-blue-50 rounded-lg"},Vt={class:"flex justify-center gap-4 w-full mt-6"},It={key:0,class:"text-center py-8"},Nt={key:1,class:"text-center py-8"},Rt={key:2,class:"space-y-4"},Ut={class:"max-h-96 overflow-y-auto"},$t={class:"flex-1"},Bt={class:"font-semibold text-gray-800"},zt={class:"text-sm text-gray-500"},Ot={class:"flex gap-4 text-xs text-gray-600 mt-1"},Wt={key:0},qt={class:"ml-4"},Ht={class:"border-t pt-4"},Gt={class:"text-sm text-gray-600 mb-3"},Jt={class:"flex justify-center gap-4 w-full mt-6"},Kt=["disabled"],Qt={key:0,class:"space-y-4"},Yt={class:"flex items-center gap-3 p-4 rounded-lg border bg-red-50 border-red-200"},Xt={class:"bg-gray-50 p-4 rounded-lg border"},Zt={class:"space-y-2 text-sm"},eo={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},to={class:"flex items-start gap-2"},oo={class:"flex justify-center gap-4 w-full mt-6"},so=["disabled"],lo=["disabled"],mo={__name:"Inventarios",setup(ao){const E=Se(),M=d([]),k=d([]),x=d({}),ie=d(!1);d(!1);const z=d(""),A=d(!1);d(!1),d(!1);const O=d(!1),v=d(null),V=d(!1),P=d([]),I=d(""),S=d(""),G=d(!1),N=d(!1),b=d(null),D=d(!1),R=d(!1),J=d(!0),n=d({producto_id:"",tipo_movimiento:"",fecha_desde:null,fecha_hasta:null});d({});const ge=[{label:"Entrada",value:"ENTRADA"},{label:"Salida",value:"SALIDA"},{label:"Ajuste",value:"AJUSTE"}],ne=d(typeof window<"u"?window.innerWidth:1024),K=me(()=>{let s=M.value;if(n.value.producto_id&&n.value.producto_id!==""&&(s=s.filter(e=>e.producto_id==n.value.producto_id)),n.value.tipo_movimiento&&n.value.tipo_movimiento!==""&&(s=s.filter(e=>e.tipo_movimiento===n.value.tipo_movimiento)),n.value.fecha_desde&&(s=s.filter(e=>{const c=new Date(e.fecha_movimiento),p=new Date(n.value.fecha_desde);return c>=p})),n.value.fecha_hasta&&(s=s.filter(e=>{const c=new Date(e.fecha_movimiento),p=new Date(n.value.fecha_hasta);return c<=p})),z.value){const e=z.value.toLowerCase();s=s.filter(c=>{var p,y,T,h,U;return((y=(p=c.producto)==null?void 0:p.nombre)==null?void 0:y.toLowerCase().includes(e))||((T=c.motivo)==null?void 0:T.toLowerCase().includes(e))||((U=(h=c.user)==null?void 0:h.name)==null?void 0:U.toLowerCase().includes(e))})}return s}),Q=me(()=>ne.value<640?{width:"95vw",maxWidth:"380px"}:ne.value<768?{width:"400px"}:{width:"450px"}),Y=async()=>{try{const s={};n.value.producto_id&&n.value.producto_id!==""&&(s.producto_id=n.value.producto_id),n.value.tipo_movimiento&&n.value.tipo_movimiento!==""&&(s.tipo_movimiento=n.value.tipo_movimiento),n.value.fecha_desde&&(s.fecha_desde=n.value.fecha_desde),n.value.fecha_hasta&&(s.fecha_hasta=n.value.fecha_hasta);const[e,c,p]=await Promise.all([B.get("/api/inventario",{params:s}),B.get("/api/productos"),B.get("/api/inventario/resumen")]);M.value=e.data.data||e.data||[];const y=c.data.data||c.data||[];k.value=Array.isArray(y)?y:[],k.value.length>0&&!Array.isArray(k.value)&&(console.warn("Los productos no tienen el formato esperado:",k.value),k.value=[]),x.value=p.data||{}}catch(s){console.error("Error al cargar datos:",s),M.value=[],k.value=[],x.value={},E.add({severity:"error",summary:"Error",detail:"Error al cargar los datos del inventario",life:4e3})}},be=async()=>{ie.value=!0,J.value=!0;try{await Y()}catch{E.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los datos del inventario",life:3e3})}finally{ie.value=!1,J.value=!1}},re=async()=>{A.value=!0;try{await new Promise(s=>setTimeout(s,300)),n.value={producto_id:"",tipo_movimiento:"",fecha_desde:null,fecha_hasta:null},E.add({severity:"success",summary:"Filtros limpiados",life:2e3}),await Y()}finally{A.value=!1}},X=async s=>{let e=0,c="";switch(s){case"disponibles":e=x.value.productos_disponibles||0,c="/api/admin/productos/disponibles",I.value="Productos Disponibles";break;case"agotados":e=x.value.productos_agotados||0,c="/api/inventario/agotados",I.value="Productos Agotados";break;case"stock_bajo":e=x.value.productos_stock_bajo||0,c="/api/inventario/stock-bajo",I.value="Productos con Stock Bajo";break}if(e===0){E.add({severity:"info",summary:"Sin registros",detail:`No hay productos en estado: ${I.value.toLowerCase()}`,life:3e3});return}S.value=s,G.value=!0;try{const p=await B.get(c);P.value=p.data.data||p.data||[],V.value=!0}catch{E.add({severity:"error",summary:"Error",detail:"Error al cargar los productos",life:4e3})}finally{G.value=!1}},xe=s=>{s.originalEvent.target.closest("button")||(v.value=s.data,O.value=!0)},ye=s=>{b.value=s,N.value=!0},he=async()=>{var s,e;if(b.value){D.value=!0;try{const c=await B.delete(`/api/inventario/${b.value.id}`),p=M.value.findIndex(y=>y.id===b.value.id);p!==-1&&M.value.splice(p,1),E.add({severity:"success",summary:"Éxito",detail:"Movimiento de inventario eliminado correctamente",life:3e3}),N.value=!1,b.value=null}catch(c){console.error("Error al eliminar movimiento:",c),E.add({severity:"error",summary:"Error",detail:((e=(s=c.response)==null?void 0:s.data)==null?void 0:e.message)||"Error al eliminar el movimiento de inventario",life:4e3})}finally{D.value=!1}}},we=()=>{N.value=!1,b.value=null},_e=()=>{R.value=!0,V.value=!1,Te.visit("/productos")},Z=s=>{const e=new Date(s);return window.innerWidth<640?e.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):e.toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},ee=s=>new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),W=s=>{const e={venta:"Venta",ajuste_aumento:"Ajuste (Aumento)",ajuste_reduccion:"Ajuste (Reducción)",entrada_manual:"Entrada Manual",cancelacion_venta:"Cancelación de Venta",eliminacion_venta:"Eliminación de Venta","":"Sin especificar",null:"Sin especificar",undefined:"Sin especificar"};return!e[s]&&s?s.charAt(0).toUpperCase()+s.slice(1).replace(/_/g," "):e[s]||"Sin especificar"},de=s=>s.tipo_movimiento||"Sin definir",ke=s=>{const e=s.tipo_movimiento;return e==="ENTRADA"?"success":e==="SALIDA"?"danger":e==="AJUSTE"?"warning":"secondary"};return Ce(n,()=>{Y()},{deep:!0}),Ee(()=>{be()}),(s,e)=>{const c=C("Toast"),p=C("Card"),y=C("InputText"),T=C("DatePicker"),h=C("Column"),U=C("Tag"),Ae=C("DataTable"),te=C("Dialog");return f(),q(Pe,null,{default:m(()=>[a(l(De),{title:"Inventarios"}),a(c,{class:"z-[9999]"}),t("div",Ie,[t("div",Ne,[e[19]||(e[19]=t("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Inventario",-1)),e[20]||(e[20]=t("p",{class:"text-gray-600"},"Monitoreo y análisis del estado del inventario",-1)),t("div",Re,[t("p",Ue,[a(l(u),{icon:l(j),class:"mr-2 text-yellow-500"},null,8,["icon"]),e[17]||(e[17]=t("strong",null,"Tip:",-1)),e[18]||(e[18]=r(" Para gestionar stock, ve a Productos > Más Acciones > Actualizar Stock "))])])]),t("div",$e,[a(p,{class:"bg-gradient-to-r from-green-500 to-green-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[0]||(e[0]=o=>X("disponibles"))},{content:m(()=>[t("div",Be,[t("div",null,[e[22]||(e[22]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Productos Disponibles",-1)),t("p",ze,i(x.value.productos_disponibles||0),1),t("p",Oe,[a(l(u),{icon:l(j),class:"h-3 w-3"},null,8,["icon"]),e[21]||(e[21]=r(" Clic para ver detalles "))])]),a(l(u),{icon:l(Fe),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),a(p,{class:"bg-gradient-to-r from-red-500 to-red-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[1]||(e[1]=o=>X("agotados"))},{content:m(()=>[t("div",We,[t("div",null,[e[24]||(e[24]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Productos Agotados",-1)),t("p",qe,i(x.value.productos_agotados||0),1),t("p",He,[a(l(u),{icon:l(j),class:"h-3 w-3"},null,8,["icon"]),e[23]||(e[23]=r(" Clic para ver detalles "))])]),a(l(u),{icon:l(je),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),a(p,{class:"bg-gradient-to-r from-yellow-500 to-yellow-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[2]||(e[2]=o=>X("stock_bajo"))},{content:m(()=>[t("div",Ge,[t("div",null,[e[26]||(e[26]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Stock Bajo",-1)),t("p",Je,i(x.value.productos_stock_bajo||0),1),t("p",Ke,[a(l(u),{icon:l(j),class:"h-3 w-3"},null,8,["icon"]),e[25]||(e[25]=r(" Clic para ver detalles "))])]),a(l(u),{icon:l(H),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),a(p,{class:"bg-gradient-to-r from-blue-500 to-blue-600"},{content:m(()=>[t("div",Qe,[t("div",null,[e[27]||(e[27]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Valor Total",-1)),t("p",Ye,"$"+i(ee(x.value.valor_total_inventario)),1)]),a(l(u),{icon:l(Le),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1})]),t("div",Xe,[J.value?(f(),g("div",Ze,[a(l(u),{icon:l(L),class:"animate-spin h-8 w-8 text-blue-600 mb-3"},null,8,["icon"]),e[28]||(e[28]=t("p",{class:"text-gray-600 font-medium"},"Cargando inventario...",-1))])):(f(),q(Ae,{key:1,value:K.value,dataKey:"id",paginator:!0,rows:10,rowsPerPageOptions:[10,25,50],globalFilterFields:["producto.nombre","motivo","user.name"],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} movimientos",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:xe,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:m(()=>[t("div",et,[t("div",tt,[t("div",ot,[e[29]||(e[29]=t("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[t("i",{class:"pi pi-filter text-blue-600 text-sm"}),t("span",null,"Filtros")],-1)),t("div",st,i(K.value.length)+" resultado"+i(K.value.length!==1?"s":""),1),t("button",{onClick:re,disabled:A.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[A.value?(f(),q(l(u),{key:0,icon:l(L),class:"animate-spin h-3 w-3"},null,8,["icon"])):_("",!0),t("span",null,i(A.value?"Limpiando...":"Limpiar filtros"),1)],8,lt)]),t("button",{onClick:re,disabled:A.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[A.value?(f(),q(l(u),{key:0,icon:l(L),class:"animate-spin h-3 w-3"},null,8,["icon"])):_("",!0),t("span",null,i(A.value?"Limpiando...":"Limpiar filtros"),1)],8,at)]),t("div",it,[t("div",nt,[a(l(u),{icon:l(Me),class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"},null,8,["icon"]),a(y,{modelValue:z.value,"onUpdate:modelValue":e[3]||(e[3]=o=>z.value=o),placeholder:"Buscar movimientos...",class:"w-full h-9 text-sm rounded-md pl-10",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),t("div",rt,[t("div",dt,[ve(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>n.value.producto_id=o),onChange:e[5]||(e[5]=(...o)=>s.aplicarFiltros&&s.aplicarFiltros(...o)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-700 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[30]||(e[30]=t("option",{value:"",disabled:"",selected:"",hidden:""},"Producto",-1)),(f(!0),g(oe,null,se(Array.isArray(k.value)?k.value:[],o=>(f(),g("option",{key:o.id,value:o.id,class:"truncate"},i(o.nombre),9,ut))),128))],544),[[pe,n.value.producto_id]])]),t("div",ct,[ve(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>n.value.tipo_movimiento=o),onChange:e[7]||(e[7]=(...o)=>s.aplicarFiltros&&s.aplicarFiltros(...o)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-700 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[31]||(e[31]=t("option",{value:"",disabled:"",selected:"",hidden:""},"Tipo",-1)),(f(),g(oe,null,se(ge,o=>t("option",{key:o.value,value:o.value,class:"truncate"},i(o.label),9,mt)),64))],544),[[pe,n.value.tipo_movimiento]])]),t("div",vt,[a(T,{modelValue:n.value.fecha_desde,"onUpdate:modelValue":e[8]||(e[8]=o=>n.value.fecha_desde=o),placeholder:"Fecha desde",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),t("div",pt,[a(T,{modelValue:n.value.fecha_hasta,"onUpdate:modelValue":e[9]||(e[9]=o=>n.value.fecha_hasta=o),placeholder:"Fecha hasta",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),t("div",ft,[a(T,{modelValue:n.value.fecha_desde,"onUpdate:modelValue":e[10]||(e[10]=o=>n.value.fecha_desde=o),placeholder:"Fecha desde",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"]),a(T,{modelValue:n.value.fecha_hasta,"onUpdate:modelValue":e[11]||(e[11]=o=>n.value.fecha_hasta=o),placeholder:"Fecha hasta",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"])])]),t("div",gt,[t("p",bt,[a(l(u),{icon:l(j),class:"h-3 w-3 text-yellow-500"},null,8,["icon"]),e[32]||(e[32]=r(" Haz clic en cualquier fila para ver los detalles. "))])])])])]),empty:m(()=>[t("div",At,[a(l(u),{icon:l(j),class:"h-16 w-16 text-gray-400 mb-4"},null,8,["icon"]),e[35]||(e[35]=t("p",{class:"text-xl font-semibold text-gray-600 mb-2"},"NO HAY MOVIMIENTOS DE INVENTARIO",-1)),e[36]||(e[36]=t("p",{class:"text-gray-500 mb-6"},"Los movimientos aparecerán aquí cuando se realicen cambios de stock",-1))])]),default:m(()=>[a(h,{field:"fecha_movimiento",header:"Fecha",sortable:"",class:"w-32"},{body:m(({data:o})=>[t("div",xt,i(Z(o.fecha_movimiento)),1)]),_:1}),a(h,{field:"producto.nombre",header:"Producto",sortable:"",class:"w-40"},{body:m(({data:o})=>{var w,$,ue,ce;return[t("div",null,[t("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"150px","text-overflow":"ellipsis","white-space":"nowrap"},title:(w=o.producto)==null?void 0:w.nombre},i(($=o.producto)==null?void 0:$.nombre),9,yt),t("span",ht,i((ce=(ue=o.producto)==null?void 0:ue.categoria)==null?void 0:ce.nombre),1)])]}),_:1}),a(h,{field:"tipo_movimiento",header:"Tipo",sortable:"",class:"w-24 hidden sm:table-cell"},{body:m(({data:o})=>[a(U,{value:o.tipo_movimiento,severity:o.tipo_movimiento==="ENTRADA"?"success":o.tipo_movimiento==="SALIDA"?"danger":"warning",class:"text-xs"},null,8,["value","severity"])]),_:1}),a(h,{field:"cantidad",header:"Cantidad",sortable:"",class:"w-20 hidden sm:table-cell"},{body:m(({data:o})=>[t("span",{class:F([o.tipo_movimiento==="ENTRADA"?"text-green-600":o.tipo_movimiento==="SALIDA"?"text-red-600":"text-orange-600","text-sm font-medium"])},i(o.tipo_movimiento==="ENTRADA"?"+":o.tipo_movimiento==="SALIDA"?"-":"±")+i(o.cantidad),3)]),_:1}),a(h,{field:"motivo",header:"Motivo",sortable:"",class:"w-32 hidden md:table-cell"},{body:m(({data:o})=>[t("div",{class:"text-sm leading-relaxed overflow-hidden",style:{"max-width":"120px","text-overflow":"ellipsis","white-space":"nowrap"},title:W(o.motivo)},i(W(o.motivo)),9,wt)]),_:1}),a(h,{exportable:!1,class:"w-32 min-w-24"},{header:m(()=>e[33]||(e[33]=[t("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:m(({data:o})=>[t("div",_t,[t("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:w=>ye(o),title:"Eliminar movimiento"},[a(l(u),{icon:l(fe),class:"h-4 w-5 sm:h-4 sm:w-6 text-white"},null,8,["icon"]),e[34]||(e[34]=t("span",{class:"hidden lg:block text-white ml-1"},"Eliminar",-1))],8,kt)])]),_:1})]),_:1},8,["value"]))])]),a(te,{visible:O.value,"onUpdate:visible":e[13]||(e[13]=o=>O.value=o),modal:"",header:"Detalle del Movimiento",style:le(Q.value),closable:!1,draggable:!1},{footer:m(()=>[t("div",Vt,[t("button",{type:"button",onClick:e[12]||(e[12]=o=>O.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[a(l(u),{icon:l(ae),class:"h-5"},null,8,["icon"]),e[49]||(e[49]=r("Cerrar "))])])]),default:m(()=>{var o,w,$;return[v.value?(f(),g("div",Ct,[t("div",Et,[t("div",null,[e[37]||(e[37]=t("strong",null,"Fecha:",-1)),r(" "+i(Z(v.value.fecha_movimiento)),1)]),t("div",null,[e[38]||(e[38]=t("strong",null,"Tipo:",-1)),a(U,{value:de(v.value),severity:ke(v.value)},{default:m(()=>[r(i(de(v.value)),1)]),_:1},8,["value","severity"])]),t("div",null,[e[39]||(e[39]=t("strong",null,"Producto:",-1)),r(" "+i((o=v.value.producto)==null?void 0:o.nombre),1)]),t("div",null,[e[40]||(e[40]=t("strong",null,"Precio:",-1)),t("span",Dt," $"+i(ee((w=v.value.producto)==null?void 0:w.precio)),1)]),t("div",null,[e[41]||(e[41]=t("strong",null,"Cantidad: ",-1)),t("span",{class:F(v.value.tipo_movimiento==="ENTRADA"?"text-green-600":"text-red-600")},i(v.value.tipo_movimiento==="ENTRADA"?"+":"-")+i(v.value.cantidad),3)]),t("div",Tt,[e[43]||(e[43]=t("strong",null,"¿Quién realizó el movimiento?",-1)),e[44]||(e[44]=t("br",null,null,-1)),e[45]||(e[45]=t("strong",{class:"text-sm text-gray-600"},"Usuario:",-1)),e[46]||(e[46]=r()),t("span",Pt,i((($=v.value.user)==null?void 0:$.name)||"Sistema"),1),v.value.user?(f(),g("div",St,[v.value.user.roles&&v.value.user.roles.length>0?(f(),g("div",Ft,[e[42]||(e[42]=t("strong",null,"Rol:",-1)),r(" "+i(v.value.user.roles[0].name),1)])):_("",!0)])):_("",!0)]),t("div",null,[e[47]||(e[47]=t("strong",null,"Motivo:",-1)),r(" "+i(W(v.value.motivo)),1)])]),v.value.observacion?(f(),g("div",jt,[e[48]||(e[48]=t("strong",null,"Observaciones:",-1)),t("p",Lt,i(v.value.observacion),1)])):_("",!0),v.value.venta_id?(f(),g("div",Mt,[t("strong",null,"Relacionado con venta #"+i(v.value.venta_id),1)])):_("",!0)])):_("",!0)]}),_:1},8,["visible","style"]),a(te,{visible:V.value,"onUpdate:visible":e[15]||(e[15]=o=>V.value=o),modal:"",header:I.value,style:le(Q.value),closable:!1,draggable:!1},{footer:m(()=>[t("div",Jt,[t("button",{onClick:_e,disabled:R.value,class:"bg-red-500 hover:bg-red-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a(l(u),{icon:R.value?l(L):l(Ve),class:F([{"animate-spin":R.value},"h-5"])},null,8,["icon","class"]),r(" "+i(R.value?"Cargando...":"Gestionar Productos"),1)],8,Kt),t("button",{type:"button",onClick:e[14]||(e[14]=o=>V.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[a(l(u),{icon:l(ae),class:"h-5"},null,8,["icon"]),e[55]||(e[55]=r("Cerrar "))])])]),default:m(()=>[G.value?(f(),g("div",It,[a(l(u),{icon:l(L),class:"animate-spin h-8 w-8 text-blue-600 mb-3"},null,8,["icon"]),e[50]||(e[50]=t("p",{class:"text-gray-600"},"Cargando productos...",-1))])):P.value.length===0?(f(),g("div",Nt,[a(l(u),{icon:l(H),class:"h-12 w-12 text-gray-400 mb-3"},null,8,["icon"]),e[51]||(e[51]=t("p",{class:"text-gray-600"},"No se encontraron productos en este estado.",-1))])):(f(),g("div",Rt,[t("div",Ut,[(f(!0),g(oe,null,se(P.value,o=>{var w;return f(),g("div",{key:o.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50"},[t("div",$t,[t("h4",Bt,i(o.nombre),1),t("p",zt,i(((w=o.categoria)==null?void 0:w.nombre)||"Sin categoría"),1),t("div",Ot,[t("span",null,[e[52]||(e[52]=r("Stock: ")),t("strong",null,i(o.stock_actual||0),1)]),t("span",null,[e[53]||(e[53]=r("Mínimo: ")),t("strong",null,i(o.stock_minimo||1),1)]),o.precio?(f(),g("span",Wt,[e[54]||(e[54]=r("Precio: ")),t("strong",null,"$"+i(ee(o.precio)),1)])):_("",!0)])]),t("div",qt,[t("span",{class:F(["px-2 py-1 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":S.value==="disponibles","bg-red-100 text-red-800":S.value==="agotados","bg-yellow-100 text-yellow-800":S.value==="stock_bajo"}])},i(S.value==="disponibles"?"Disponible":S.value==="agotados"?"Agotado":"Stock Bajo"),3)])])}),128))]),t("div",Ht,[t("p",Gt,[t("strong",null,i(P.value.length),1),r(" producto"+i(P.value.length!==1?"s":"")+" encontrado"+i(P.value.length!==1?"s":""),1)])])]))]),_:1},8,["visible","header","style"]),a(te,{visible:N.value,"onUpdate:visible":e[16]||(e[16]=o=>N.value=o),header:"Eliminar movimiento de inventario",modal:!0,style:le(Q.value),closable:!1,draggable:!1},{footer:m(()=>[t("div",oo,[t("button",{class:"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:he,disabled:D.value},[a(l(u),{icon:D.value?l(L):l(fe),class:F(["h-4",{"animate-spin":D.value}])},null,8,["icon","class"]),r(" "+i(D.value?"Eliminando...":"Eliminar"),1)],8,so),t("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:we,disabled:D.value},[a(l(u),{icon:l(ae),class:"h-4"},null,8,["icon"]),e[65]||(e[65]=r(" Cancelar "))],8,lo)])]),default:m(()=>{var o;return[b.value?(f(),g("div",Qt,[t("div",Yt,[a(l(u),{icon:l(H),class:"text-2xl text-red-500"},null,8,["icon"]),e[56]||(e[56]=t("div",null,[t("h4",{class:"text-lg font-semibold text-red-800"},"Eliminar Movimiento"),t("p",{class:"text-red-700"},"Esta acción no se puede deshacer.")],-1))]),t("div",Xt,[e[63]||(e[63]=t("h5",{class:"font-semibold text-gray-800 mb-2"},"Información del movimiento:",-1)),t("div",Zt,[t("div",null,[e[57]||(e[57]=t("strong",null,"ID:",-1)),r(" #"+i(b.value.id),1)]),t("div",null,[e[58]||(e[58]=t("strong",null,"Producto:",-1)),r(" "+i(((o=b.value.producto)==null?void 0:o.nombre)||"N/A"),1)]),t("div",null,[e[59]||(e[59]=t("strong",null,"Tipo:",-1)),t("span",{class:F("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-1 "+(b.value.tipo_movimiento==="ENTRADA"?"bg-green-100 text-green-800":b.value.tipo_movimiento==="SALIDA"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"))},i(b.value.tipo_movimiento),3)]),t("div",null,[e[60]||(e[60]=t("strong",null,"Cantidad:",-1)),r(" "+i(b.value.cantidad),1)]),t("div",null,[e[61]||(e[61]=t("strong",null,"Fecha:",-1)),r(" "+i(Z(b.value.fecha_movimiento)),1)]),t("div",null,[e[62]||(e[62]=t("strong",null,"Motivo:",-1)),r(" "+i(W(b.value.motivo)),1)])])]),t("div",eo,[t("div",to,[a(l(u),{icon:l(H),class:"text-yellow-500 text-sm mt-0.5"},null,8,["icon"]),e[64]||(e[64]=t("div",{class:"text-sm text-yellow-800"},[t("strong",null,"Importante:"),r(" Al eliminar este movimiento se perderá el historial del cambio de inventario. Esta acción es irreversible y puede afectar la trazabilidad del producto. ")],-1))])])])):_("",!0)]}),_:1},8,["visible","style"])]),_:1})}}};export{mo as default};
