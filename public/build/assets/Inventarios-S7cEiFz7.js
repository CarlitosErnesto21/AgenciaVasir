import{r as d,E as ce,w as Ae,o as Ce,k as D,h as ee,d as f,x as v,p as i,e as t,$ as l,a0 as De,q as r,t as a,y as F,j as w,v as me,c as b,F as te,l as oe,a7 as ve,A as se,N as U,a5 as Ee}from"./vendor-gbh1WW5n.js";import{A as Te}from"./AuthenticatedLayout-DOWK-Iyn.js";import{z as Pe,F as c}from"./ui-BrU4k96Z.js";import{r as $,h as Se,t as Fe,i as H,u as je,m as pe,c as B,n as Le,v as le,s as Me}from"./index-BL4yA-eF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={class:"container mx-auto px-4 py-6"},Ie={class:"mb-3 text-center sm:text-left"},Re={class:"bg-blue-50 border-l-4 border-blue-400 p-3 mt-3 rounded-r-md"},Ne={class:"text-blue-700 text-sm"},Ue={class:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-8"},$e={class:"flex items-center justify-between text-white p-2 sm:p-4"},Be={class:"text-xl sm:text-3xl font-bold"},ze={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},We={class:"flex items-center justify-between text-white p-2 sm:p-4"},qe={class:"text-xl sm:text-3xl font-bold"},He={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},Oe={class:"flex items-center justify-between text-white p-2 sm:p-4"},Ge={class:"text-xl sm:text-3xl font-bold"},Je={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},Ke={class:"flex items-center justify-between text-white p-2 sm:p-4"},Qe={class:"text-sm sm:text-3xl font-bold"},Xe={class:"bg-white rounded-lg shadow-md"},Ye={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},Ze={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},et={class:"flex items-center gap-3"},tt={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},ot=["disabled"],st=["disabled"],lt={class:"space-y-3"},at={class:"relative"},it={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-3"},nt={class:"col-span-1"},rt=["value"],dt={class:"col-span-1"},ut=["value"],ct={class:"col-span-1 hidden md:block"},mt={class:"col-span-1 hidden md:block"},vt={class:"col-span-2 flex gap-3 md:hidden"},pt={class:"px-1 mt-3"},ft={class:"text-blue-600 text-xs font-medium flex items-center gap-1"},gt={class:"text-sm font-medium leading-relaxed"},bt=["title"],xt={class:"block text-xs text-gray-500"},yt=["title"],ht={class:"flex justify-center items-center"},_t=["onClick"],wt={key:0,class:"space-y-4"},kt={class:"grid grid-cols-2 gap-4"},At={class:"text-green-600 font-medium"},Ct={class:"col-span-2"},Dt={class:"text-sm text-gray-600"},Et={key:0,class:"text-sm text-gray-600 mt-1"},Tt={key:0},Pt={key:0},St={class:"mt-1 p-3 bg-gray-50 rounded-lg"},Ft={key:1,class:"p-3 bg-blue-50 rounded-lg"},jt={class:"flex justify-center gap-4 w-full mt-6"},Lt={key:0,class:"text-center py-8"},Mt={key:1,class:"text-center py-8"},Vt={key:2,class:"space-y-4"},It={class:"max-h-96 overflow-y-auto"},Rt={class:"flex-1"},Nt={class:"font-semibold text-gray-800"},Ut={class:"text-sm text-gray-500"},$t={class:"flex gap-4 text-xs text-gray-600 mt-1"},Bt={key:0},zt={class:"ml-4"},Wt={class:"border-t pt-4"},qt={class:"text-sm text-gray-600 mb-3"},Ht={class:"flex justify-center gap-4 w-full mt-6"},Ot=["disabled"],Gt={key:0,class:"space-y-4"},Jt={class:"flex items-center gap-3 p-4 rounded-lg border bg-red-50 border-red-200"},Kt={class:"bg-gray-50 p-4 rounded-lg border"},Qt={class:"space-y-2 text-sm"},Xt={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},Yt={class:"flex items-start gap-2"},Zt={class:"flex justify-center gap-4 w-full mt-6"},eo=["disabled"],to=["disabled"],ro={__name:"Inventarios",setup(oo){const k=Pe(),j=d([]),A=d([]),x=d({}),ae=d(!1);d(!1);const z=d(""),C=d(!1);d(!1),d(!1);const W=d(!1),m=d(null),L=d(!1),P=d([]),M=d(""),S=d(""),O=d(!1),V=d(!1),g=d(null),E=d(!1),I=d(!1),n=d({producto_id:"",tipo_movimiento:"",fecha_desde:null,fecha_hasta:null});d({});const fe=[{label:"Entrada",value:"ENTRADA"},{label:"Salida",value:"SALIDA"},{label:"Ajuste",value:"AJUSTE"}],ie=d(typeof window<"u"?window.innerWidth:1024),G=ce(()=>{let s=j.value;if(n.value.producto_id&&n.value.producto_id!==""&&(s=s.filter(e=>e.producto_id==n.value.producto_id)),n.value.tipo_movimiento&&n.value.tipo_movimiento!==""&&(s=s.filter(e=>e.tipo_movimiento===n.value.tipo_movimiento)),n.value.fecha_desde&&(s=s.filter(e=>{const u=new Date(e.fecha_movimiento),p=new Date(n.value.fecha_desde);return u>=p})),n.value.fecha_hasta&&(s=s.filter(e=>{const u=new Date(e.fecha_movimiento),p=new Date(n.value.fecha_hasta);return u<=p})),z.value){const e=z.value.toLowerCase();s=s.filter(u=>{var p,y,T,h,R;return((y=(p=u.producto)==null?void 0:p.nombre)==null?void 0:y.toLowerCase().includes(e))||((T=u.motivo)==null?void 0:T.toLowerCase().includes(e))||((R=(h=u.user)==null?void 0:h.name)==null?void 0:R.toLowerCase().includes(e))})}return s}),J=ce(()=>ie.value<640?{width:"95vw",maxWidth:"380px"}:ie.value<768?{width:"400px"}:{width:"450px"}),K=async()=>{try{const s={};n.value.producto_id&&n.value.producto_id!==""&&(s.producto_id=n.value.producto_id),n.value.tipo_movimiento&&n.value.tipo_movimiento!==""&&(s.tipo_movimiento=n.value.tipo_movimiento),n.value.fecha_desde&&(s.fecha_desde=n.value.fecha_desde),n.value.fecha_hasta&&(s.fecha_hasta=n.value.fecha_hasta);const[e,u,p]=await Promise.all([U.get("/api/inventario",{params:s}),U.get("/api/productos"),U.get("/api/inventario/resumen")]);j.value=e.data.data||e.data||[];const y=u.data.data||u.data||[];A.value=Array.isArray(y)?y:[],A.value.length>0&&!Array.isArray(A.value)&&(console.warn("Los productos no tienen el formato esperado:",A.value),A.value=[]),x.value=p.data||{}}catch(s){console.error("Error al cargar datos:",s),j.value=[],A.value=[],x.value={},k.add({severity:"error",summary:"Error",detail:"Error al cargar los datos del inventario",life:4e3})}},ge=async()=>{ae.value=!0,k.add({severity:"info",summary:"Cargando inventario...",life:2e3});try{await K(),k.add({severity:"success",summary:"Inventario cargado",life:2e3})}finally{ae.value=!1}},ne=async()=>{C.value=!0;try{await new Promise(s=>setTimeout(s,300)),n.value={producto_id:"",tipo_movimiento:"",fecha_desde:null,fecha_hasta:null},k.add({severity:"success",summary:"Filtros limpiados",life:2e3}),await K()}finally{C.value=!1}},Q=async s=>{let e=0,u="";switch(s){case"disponibles":e=x.value.productos_disponibles||0,u="/api/admin/productos/disponibles",M.value="Productos Disponibles";break;case"agotados":e=x.value.productos_agotados||0,u="/api/inventario/agotados",M.value="Productos Agotados";break;case"stock_bajo":e=x.value.productos_stock_bajo||0,u="/api/inventario/stock-bajo",M.value="Productos con Stock Bajo";break}if(e===0){k.add({severity:"info",summary:"Sin registros",detail:`No hay productos en estado: ${M.value.toLowerCase()}`,life:3e3});return}S.value=s,O.value=!0;try{const p=await U.get(u);P.value=p.data.data||p.data||[],L.value=!0}catch{k.add({severity:"error",summary:"Error",detail:"Error al cargar los productos",life:4e3})}finally{O.value=!1}},be=s=>{s.originalEvent.target.closest("button")||(m.value=s.data,W.value=!0)},xe=s=>{g.value=s,V.value=!0},ye=async()=>{var s,e;if(g.value){E.value=!0;try{const u=await U.delete(`/api/inventario/${g.value.id}`),p=j.value.findIndex(y=>y.id===g.value.id);p!==-1&&j.value.splice(p,1),k.add({severity:"success",summary:"Éxito",detail:"Movimiento de inventario eliminado correctamente",life:3e3}),V.value=!1,g.value=null}catch(u){console.error("Error al eliminar movimiento:",u),k.add({severity:"error",summary:"Error",detail:((e=(s=u.response)==null?void 0:s.data)==null?void 0:e.message)||"Error al eliminar el movimiento de inventario",life:4e3})}finally{E.value=!1}}},he=()=>{V.value=!1,g.value=null},_e=()=>{I.value=!0,L.value=!1,Ee.visit("/productos")},X=s=>{const e=new Date(s);return window.innerWidth<640?e.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):e.toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},Y=s=>new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),q=s=>{const e={venta:"Venta",ajuste_aumento:"Ajuste (Aumento)",ajuste_reduccion:"Ajuste (Reducción)",entrada_manual:"Entrada Manual",cancelacion_venta:"Cancelación de Venta",eliminacion_venta:"Eliminación de Venta","":"Sin especificar",null:"Sin especificar",undefined:"Sin especificar"};return!e[s]&&s?s.charAt(0).toUpperCase()+s.slice(1).replace(/_/g," "):e[s]||"Sin especificar"},re=s=>s.tipo_movimiento||"Sin definir",we=s=>{const e=s.tipo_movimiento;return e==="ENTRADA"?"success":e==="SALIDA"?"danger":e==="AJUSTE"?"warning":"secondary"};return Ae(n,()=>{K()},{deep:!0}),Ce(()=>{ge()}),(s,e)=>{const u=D("Toast"),p=D("Card"),y=D("InputText"),T=D("DatePicker"),h=D("Column"),R=D("Tag"),ke=D("DataTable"),Z=D("Dialog");return f(),ee(Te,null,{default:v(()=>[i(l(De),{title:"Inventarios"}),i(u,{class:"z-[9999]"}),t("div",Ve,[t("div",Ie,[e[19]||(e[19]=t("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Inventario",-1)),e[20]||(e[20]=t("p",{class:"text-gray-600"},"Monitoreo y análisis del estado del inventario",-1)),t("div",Re,[t("p",Ne,[i(l(c),{icon:l($),class:"mr-2 text-yellow-500"},null,8,["icon"]),e[17]||(e[17]=t("strong",null,"Tip:",-1)),e[18]||(e[18]=r(" Para gestionar stock, ve a Productos > Más Acciones > Actualizar Stock "))])])]),t("div",Ue,[i(p,{class:"bg-gradient-to-r from-green-500 to-green-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[0]||(e[0]=o=>Q("disponibles"))},{content:v(()=>[t("div",$e,[t("div",null,[e[22]||(e[22]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Productos Disponibles",-1)),t("p",Be,a(x.value.productos_disponibles||0),1),t("p",ze,[i(l(c),{icon:l($),class:"h-3 w-3"},null,8,["icon"]),e[21]||(e[21]=r(" Clic para ver detalles "))])]),i(l(c),{icon:l(Se),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(p,{class:"bg-gradient-to-r from-red-500 to-red-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[1]||(e[1]=o=>Q("agotados"))},{content:v(()=>[t("div",We,[t("div",null,[e[24]||(e[24]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Productos Agotados",-1)),t("p",qe,a(x.value.productos_agotados||0),1),t("p",He,[i(l(c),{icon:l($),class:"h-3 w-3"},null,8,["icon"]),e[23]||(e[23]=r(" Clic para ver detalles "))])]),i(l(c),{icon:l(Fe),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(p,{class:"bg-gradient-to-r from-yellow-500 to-yellow-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[2]||(e[2]=o=>Q("stock_bajo"))},{content:v(()=>[t("div",Oe,[t("div",null,[e[26]||(e[26]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Stock Bajo",-1)),t("p",Ge,a(x.value.productos_stock_bajo||0),1),t("p",Je,[i(l(c),{icon:l($),class:"h-3 w-3"},null,8,["icon"]),e[25]||(e[25]=r(" Clic para ver detalles "))])]),i(l(c),{icon:l(H),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(p,{class:"bg-gradient-to-r from-blue-500 to-blue-600"},{content:v(()=>[t("div",Ke,[t("div",null,[e[27]||(e[27]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Valor Total",-1)),t("p",Qe,"$"+a(Y(x.value.valor_total_inventario)),1)]),i(l(c),{icon:l(je),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1})]),t("div",Xe,[i(ke,{value:G.value,dataKey:"id",paginator:!0,rows:10,rowsPerPageOptions:[10,25,50],globalFilterFields:["producto.nombre","motivo","user.name"],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} movimientos",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:be,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:v(()=>[t("div",Ye,[t("div",Ze,[t("div",et,[e[28]||(e[28]=t("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[t("i",{class:"pi pi-filter text-blue-600 text-sm"}),t("span",null,"Filtros")],-1)),t("div",tt,a(G.value.length)+" resultado"+a(G.value.length!==1?"s":""),1),t("button",{onClick:ne,disabled:C.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[C.value?(f(),ee(l(c),{key:0,icon:l(B),class:"animate-spin h-3 w-3"},null,8,["icon"])):w("",!0),t("span",null,a(C.value?"Limpiando...":"Limpiar filtros"),1)],8,ot)]),t("button",{onClick:ne,disabled:C.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[C.value?(f(),ee(l(c),{key:0,icon:l(B),class:"animate-spin h-3 w-3"},null,8,["icon"])):w("",!0),t("span",null,a(C.value?"Limpiando...":"Limpiar filtros"),1)],8,st)]),t("div",lt,[t("div",at,[i(l(c),{icon:l(Le),class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"},null,8,["icon"]),i(y,{modelValue:z.value,"onUpdate:modelValue":e[3]||(e[3]=o=>z.value=o),placeholder:"Buscar movimientos...",class:"w-full h-9 text-sm rounded-md pl-10",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),t("div",it,[t("div",nt,[me(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>n.value.producto_id=o),onChange:e[5]||(e[5]=(...o)=>s.aplicarFiltros&&s.aplicarFiltros(...o)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-700 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[29]||(e[29]=t("option",{value:"",disabled:"",selected:"",hidden:""},"Producto",-1)),(f(!0),b(te,null,oe(Array.isArray(A.value)?A.value:[],o=>(f(),b("option",{key:o.id,value:o.id,class:"truncate"},a(o.nombre),9,rt))),128))],544),[[ve,n.value.producto_id]])]),t("div",dt,[me(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>n.value.tipo_movimiento=o),onChange:e[7]||(e[7]=(...o)=>s.aplicarFiltros&&s.aplicarFiltros(...o)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-700 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[30]||(e[30]=t("option",{value:"",disabled:"",selected:"",hidden:""},"Tipo",-1)),(f(),b(te,null,oe(fe,o=>t("option",{key:o.value,value:o.value,class:"truncate"},a(o.label),9,ut)),64))],544),[[ve,n.value.tipo_movimiento]])]),t("div",ct,[i(T,{modelValue:n.value.fecha_desde,"onUpdate:modelValue":e[8]||(e[8]=o=>n.value.fecha_desde=o),placeholder:"Fecha desde",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),t("div",mt,[i(T,{modelValue:n.value.fecha_hasta,"onUpdate:modelValue":e[9]||(e[9]=o=>n.value.fecha_hasta=o),placeholder:"Fecha hasta",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),t("div",vt,[i(T,{modelValue:n.value.fecha_desde,"onUpdate:modelValue":e[10]||(e[10]=o=>n.value.fecha_desde=o),placeholder:"Fecha desde",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"]),i(T,{modelValue:n.value.fecha_hasta,"onUpdate:modelValue":e[11]||(e[11]=o=>n.value.fecha_hasta=o),placeholder:"Fecha hasta",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"])])]),t("div",pt,[t("p",ft,[i(l(c),{icon:l($),class:"h-3 w-3 text-yellow-500"},null,8,["icon"]),e[31]||(e[31]=r(" Haz clic en cualquier fila para ver los detalles. "))])])])])]),default:v(()=>[i(h,{field:"fecha_movimiento",header:"Fecha",sortable:"",class:"w-32"},{body:v(({data:o})=>[t("div",gt,a(X(o.fecha_movimiento)),1)]),_:1}),i(h,{field:"producto.nombre",header:"Producto",sortable:"",class:"w-40"},{body:v(({data:o})=>{var _,N,de,ue;return[t("div",null,[t("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"150px","text-overflow":"ellipsis","white-space":"nowrap"},title:(_=o.producto)==null?void 0:_.nombre},a((N=o.producto)==null?void 0:N.nombre),9,bt),t("span",xt,a((ue=(de=o.producto)==null?void 0:de.categoria)==null?void 0:ue.nombre),1)])]}),_:1}),i(h,{field:"tipo_movimiento",header:"Tipo",sortable:"",class:"w-24 hidden sm:table-cell"},{body:v(({data:o})=>[i(R,{value:o.tipo_movimiento,severity:o.tipo_movimiento==="ENTRADA"?"success":o.tipo_movimiento==="SALIDA"?"danger":"warning",class:"text-xs"},null,8,["value","severity"])]),_:1}),i(h,{field:"cantidad",header:"Cantidad",sortable:"",class:"w-20 hidden sm:table-cell"},{body:v(({data:o})=>[t("span",{class:F([o.tipo_movimiento==="ENTRADA"?"text-green-600":o.tipo_movimiento==="SALIDA"?"text-red-600":"text-orange-600","text-sm font-medium"])},a(o.tipo_movimiento==="ENTRADA"?"+":o.tipo_movimiento==="SALIDA"?"-":"±")+a(o.cantidad),3)]),_:1}),i(h,{field:"motivo",header:"Motivo",sortable:"",class:"w-32 hidden md:table-cell"},{body:v(({data:o})=>[t("div",{class:"text-sm leading-relaxed overflow-hidden",style:{"max-width":"120px","text-overflow":"ellipsis","white-space":"nowrap"},title:q(o.motivo)},a(q(o.motivo)),9,yt)]),_:1}),i(h,{exportable:!1,class:"w-32 min-w-24"},{header:v(()=>e[32]||(e[32]=[t("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:v(({data:o})=>[t("div",ht,[t("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:_=>xe(o),title:"Eliminar movimiento"},[i(l(c),{icon:l(pe),class:"h-4 w-5 sm:h-4 sm:w-6 text-white"},null,8,["icon"]),e[33]||(e[33]=t("span",{class:"hidden lg:block text-white ml-1"},"Eliminar",-1))],8,_t)])]),_:1})]),_:1},8,["value"])])]),i(Z,{visible:W.value,"onUpdate:visible":e[13]||(e[13]=o=>W.value=o),modal:"",header:"Detalle del Movimiento",style:se(J.value),closable:!1,draggable:!1},{footer:v(()=>[t("div",jt,[t("button",{type:"button",onClick:e[12]||(e[12]=o=>W.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[i(l(c),{icon:l(le),class:"h-5"},null,8,["icon"]),e[46]||(e[46]=r("Cerrar "))])])]),default:v(()=>{var o,_,N;return[m.value?(f(),b("div",wt,[t("div",kt,[t("div",null,[e[34]||(e[34]=t("strong",null,"Fecha:",-1)),r(" "+a(X(m.value.fecha_movimiento)),1)]),t("div",null,[e[35]||(e[35]=t("strong",null,"Tipo:",-1)),i(R,{value:re(m.value),severity:we(m.value)},{default:v(()=>[r(a(re(m.value)),1)]),_:1},8,["value","severity"])]),t("div",null,[e[36]||(e[36]=t("strong",null,"Producto:",-1)),r(" "+a((o=m.value.producto)==null?void 0:o.nombre),1)]),t("div",null,[e[37]||(e[37]=t("strong",null,"Precio:",-1)),t("span",At," $"+a(Y((_=m.value.producto)==null?void 0:_.precio)),1)]),t("div",null,[e[38]||(e[38]=t("strong",null,"Cantidad: ",-1)),t("span",{class:F(m.value.tipo_movimiento==="ENTRADA"?"text-green-600":"text-red-600")},a(m.value.tipo_movimiento==="ENTRADA"?"+":"-")+a(m.value.cantidad),3)]),t("div",Ct,[e[40]||(e[40]=t("strong",null,"¿Quién realizó el movimiento?",-1)),e[41]||(e[41]=t("br",null,null,-1)),e[42]||(e[42]=t("strong",{class:"text-sm text-gray-600"},"Usuario:",-1)),e[43]||(e[43]=r()),t("span",Dt,a(((N=m.value.user)==null?void 0:N.name)||"Sistema"),1),m.value.user?(f(),b("div",Et,[m.value.user.roles&&m.value.user.roles.length>0?(f(),b("div",Tt,[e[39]||(e[39]=t("strong",null,"Rol:",-1)),r(" "+a(m.value.user.roles[0].name),1)])):w("",!0)])):w("",!0)]),t("div",null,[e[44]||(e[44]=t("strong",null,"Motivo:",-1)),r(" "+a(q(m.value.motivo)),1)])]),m.value.observacion?(f(),b("div",Pt,[e[45]||(e[45]=t("strong",null,"Observaciones:",-1)),t("p",St,a(m.value.observacion),1)])):w("",!0),m.value.venta_id?(f(),b("div",Ft,[t("strong",null,"Relacionado con venta #"+a(m.value.venta_id),1)])):w("",!0)])):w("",!0)]}),_:1},8,["visible","style"]),i(Z,{visible:L.value,"onUpdate:visible":e[15]||(e[15]=o=>L.value=o),modal:"",header:M.value,style:se(J.value),closable:!1,draggable:!1},{footer:v(()=>[t("div",Ht,[t("button",{onClick:_e,disabled:I.value,class:"bg-red-500 hover:bg-red-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[i(l(c),{icon:I.value?l(B):l(Me),class:F([{"animate-spin":I.value},"h-5"])},null,8,["icon","class"]),r(" "+a(I.value?"Cargando...":"Gestionar Productos"),1)],8,Ot),t("button",{type:"button",onClick:e[14]||(e[14]=o=>L.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[i(l(c),{icon:l(le),class:"h-5"},null,8,["icon"]),e[52]||(e[52]=r("Cerrar "))])])]),default:v(()=>[O.value?(f(),b("div",Lt,[i(l(c),{icon:l(B),class:"animate-spin h-8 w-8 text-blue-600 mb-3"},null,8,["icon"]),e[47]||(e[47]=t("p",{class:"text-gray-600"},"Cargando productos...",-1))])):P.value.length===0?(f(),b("div",Mt,[i(l(c),{icon:l(H),class:"h-12 w-12 text-gray-400 mb-3"},null,8,["icon"]),e[48]||(e[48]=t("p",{class:"text-gray-600"},"No se encontraron productos en este estado.",-1))])):(f(),b("div",Vt,[t("div",It,[(f(!0),b(te,null,oe(P.value,o=>{var _;return f(),b("div",{key:o.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50"},[t("div",Rt,[t("h4",Nt,a(o.nombre),1),t("p",Ut,a(((_=o.categoria)==null?void 0:_.nombre)||"Sin categoría"),1),t("div",$t,[t("span",null,[e[49]||(e[49]=r("Stock: ")),t("strong",null,a(o.stock_actual||0),1)]),t("span",null,[e[50]||(e[50]=r("Mínimo: ")),t("strong",null,a(o.stock_minimo||1),1)]),o.precio?(f(),b("span",Bt,[e[51]||(e[51]=r("Precio: ")),t("strong",null,"$"+a(Y(o.precio)),1)])):w("",!0)])]),t("div",zt,[t("span",{class:F(["px-2 py-1 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":S.value==="disponibles","bg-red-100 text-red-800":S.value==="agotados","bg-yellow-100 text-yellow-800":S.value==="stock_bajo"}])},a(S.value==="disponibles"?"Disponible":S.value==="agotados"?"Agotado":"Stock Bajo"),3)])])}),128))]),t("div",Wt,[t("p",qt,[t("strong",null,a(P.value.length),1),r(" producto"+a(P.value.length!==1?"s":"")+" encontrado"+a(P.value.length!==1?"s":""),1)])])]))]),_:1},8,["visible","header","style"]),i(Z,{visible:V.value,"onUpdate:visible":e[16]||(e[16]=o=>V.value=o),header:"Eliminar movimiento de inventario",modal:!0,style:se(J.value),closable:!1,draggable:!1},{footer:v(()=>[t("div",Zt,[t("button",{class:"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:ye,disabled:E.value},[i(l(c),{icon:E.value?l(B):l(pe),class:F(["h-4",{"animate-spin":E.value}])},null,8,["icon","class"]),r(" "+a(E.value?"Eliminando...":"Eliminar"),1)],8,eo),t("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:he,disabled:E.value},[i(l(c),{icon:l(le),class:"h-4"},null,8,["icon"]),e[62]||(e[62]=r(" Cancelar "))],8,to)])]),default:v(()=>{var o;return[g.value?(f(),b("div",Gt,[t("div",Jt,[i(l(c),{icon:l(H),class:"text-2xl text-red-500"},null,8,["icon"]),e[53]||(e[53]=t("div",null,[t("h4",{class:"text-lg font-semibold text-red-800"},"Eliminar Movimiento"),t("p",{class:"text-red-700"},"Esta acción no se puede deshacer.")],-1))]),t("div",Kt,[e[60]||(e[60]=t("h5",{class:"font-semibold text-gray-800 mb-2"},"Información del movimiento:",-1)),t("div",Qt,[t("div",null,[e[54]||(e[54]=t("strong",null,"ID:",-1)),r(" #"+a(g.value.id),1)]),t("div",null,[e[55]||(e[55]=t("strong",null,"Producto:",-1)),r(" "+a(((o=g.value.producto)==null?void 0:o.nombre)||"N/A"),1)]),t("div",null,[e[56]||(e[56]=t("strong",null,"Tipo:",-1)),t("span",{class:F("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-1 "+(g.value.tipo_movimiento==="ENTRADA"?"bg-green-100 text-green-800":g.value.tipo_movimiento==="SALIDA"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"))},a(g.value.tipo_movimiento),3)]),t("div",null,[e[57]||(e[57]=t("strong",null,"Cantidad:",-1)),r(" "+a(g.value.cantidad),1)]),t("div",null,[e[58]||(e[58]=t("strong",null,"Fecha:",-1)),r(" "+a(X(g.value.fecha_movimiento)),1)]),t("div",null,[e[59]||(e[59]=t("strong",null,"Motivo:",-1)),r(" "+a(q(g.value.motivo)),1)])])]),t("div",Xt,[t("div",Yt,[i(l(c),{icon:l(H),class:"text-yellow-500 text-sm mt-0.5"},null,8,["icon"]),e[61]||(e[61]=t("div",{class:"text-sm text-yellow-800"},[t("strong",null,"Importante:"),r(" Al eliminar este movimiento se perderá el historial del cambio de inventario. Esta acción es irreversible y puede afectar la trazabilidad del producto. ")],-1))])])])):w("",!0)]}),_:1},8,["visible","style"])]),_:1})}}};export{ro as default};
