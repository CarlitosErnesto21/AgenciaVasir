import{ac as L,r as w,m as T,i as k,y as m,p as U,o as r,w as D,c as n,f as u,b as e,t as c,a as p,n as v,h as f}from"./app-WKwrJkJC.js";const j={key:0,class:"p-6"},M={class:"bg-gray-50 rounded-lg p-4 mb-6"},A={class:"grid grid-cols-2 gap-4 text-sm"},z={class:"block text-gray-900"},H={class:"block text-gray-900"},G={class:"block text-gray-900"},J={class:"block text-gray-900 font-medium"},K={class:"space-y-6"},Q={key:0,class:"text-red-600 mt-1 block"},W={key:0,class:"text-red-600 mt-1 block"},X={class:"block text-sm font-medium text-gray-700 mb-2"},Y={key:0,class:"text-red-500"},Z={key:0,class:"text-red-600 mt-1 block"},$={key:1,class:"text-gray-500 mt-1 block"},ee={class:"flex justify-between"},ae=["disabled"],oe=["disabled"],te={key:0},se={key:1},le={__name:"ModalReprogramar",props:{visible:{type:Boolean,default:!1},reserva:{type:Object,default:()=>null}},emits:["update:visible","confirmarReprogramacion"],setup(l,{emit:V}){const g=l,y=V,o=L({fecha_nueva:null,motivo:"",observaciones:""}),s=w({}),i=w(!1),C=["Cancelación del tour por parte de la agencia","Solicitud del cliente","Condiciones climáticas adversas","Problemas de transporte","Otro motivo"];T(()=>g.reserva,t=>{t&&(o.fecha_nueva=null,o.motivo="",o.observaciones="",s.value={})},{deep:!0});const S=k(()=>{const t=new Date;return t.setDate(t.getDate()+1),t}),R=k(()=>o.fecha_nueva&&o.motivo&&Object.keys(s.value).length===0),O=()=>{const t={};return o.fecha_nueva?new Date(o.fecha_nueva)<=new Date&&(t.fecha_nueva="La fecha debe ser posterior a hoy"):t.fecha_nueva="La nueva fecha es requerida",o.motivo||(t.motivo="El motivo es requerido"),o.motivo==="Otro motivo"&&!o.observaciones&&(t.observaciones='Las observaciones son requeridas cuando se selecciona "Otro motivo"'),s.value=t,Object.keys(t).length===0},E=t=>t?new Date(t).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",F=t=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(t||0),b=()=>{o.fecha_nueva=null,o.motivo="",o.observaciones="",s.value={},i.value=!1,y("update:visible",!1)},N=async()=>{if(O()){i.value=!0;try{const t={reserva_id:g.reserva.id,fecha_nueva:o.fecha_nueva,motivo:o.motivo,observaciones:o.observaciones};y("confirmarReprogramacion",t),b()}catch(t){console.error("Error al reprogramar:",t)}finally{i.value=!1}}};return(t,a)=>{const P=m("DatePicker"),q=m("Select"),B=m("Textarea"),I=m("Dialog");return r(),U(I,{visible:l.visible,"onUpdate:visible":b,modal:"",header:"Reprogramar Reserva",style:{width:"600px"},draggable:!1,position:"center",pt:{root:{class:"rounded-lg border border-gray-200"},header:{class:"bg-red-50 border-b px-6 py-4"},content:{class:"p-0"},footer:{class:"border-t px-6 py-4 bg-gray-50"}}},{footer:D(()=>[e("div",ee,[e("button",{class:"bg-gray-500 border border-gray-500 text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 px-4 py-2 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:b,disabled:i.value},a[12]||(a[12]=[e("i",{class:"pi pi-times"},null,-1),f(" Cancelar ")]),8,ae),e("button",{class:"bg-yellow-500 border border-yellow-500 text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 px-4 py-2 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:N,disabled:!R.value||i.value},[e("i",{class:v(["pi pi-calendar",{"animate-spin":i.value}])},null,2),i.value?(r(),n("span",te,"Procesando...")):(r(),n("span",se,"Confirmar Reprogramación"))],8,oe)])]),default:D(()=>{var h,x,_;return[l.reserva?(r(),n("div",j,[e("div",M,[a[7]||(a[7]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Información Actual",-1)),e("div",A,[e("div",null,[a[3]||(a[3]=e("span",{class:"font-medium text-gray-600"},"Cliente:",-1)),e("span",z,c(((h=l.reserva.cliente)==null?void 0:h.nombres)||"-"),1)]),e("div",null,[a[4]||(a[4]=e("span",{class:"font-medium text-gray-600"},"Fecha Actual:",-1)),e("span",H,c(E(l.reserva.fecha_reserva)),1)]),e("div",null,[a[5]||(a[5]=e("span",{class:"font-medium text-gray-600"},"Tour/Hotel:",-1)),e("span",G,c(((x=l.reserva.tour)==null?void 0:x.nombre)||((_=l.reserva.hotel)==null?void 0:_.nombre)||"-"),1)]),e("div",null,[a[6]||(a[6]=e("span",{class:"font-medium text-gray-600"},"Precio Total:",-1)),e("span",J,c(F(l.reserva.precio_total)),1)])])]),e("div",K,[e("div",null,[a[8]||(a[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nueva Fecha * ",-1)),p(P,{modelValue:o.fecha_nueva,"onUpdate:modelValue":a[0]||(a[0]=d=>o.fecha_nueva=d),minDate:S.value,placeholder:"Seleccionar nueva fecha...",dateFormat:"dd/mm/yy",class:v(["w-full",{"p-invalid":s.value.fecha_nueva}]),showIcon:""},null,8,["modelValue","minDate","class"]),s.value.fecha_nueva?(r(),n("small",Q,c(s.value.fecha_nueva),1)):u("",!0)]),e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Motivo de la Reprogramación * ",-1)),p(q,{modelValue:o.motivo,"onUpdate:modelValue":a[1]||(a[1]=d=>o.motivo=d),options:C,placeholder:"Seleccionar motivo...",class:v(["w-full",{"p-invalid":s.value.motivo}])},null,8,["modelValue","class"]),s.value.motivo?(r(),n("small",W,c(s.value.motivo),1)):u("",!0)]),e("div",null,[e("label",X,[a[10]||(a[10]=f(" Observaciones ")),o.motivo==="Otro motivo"?(r(),n("span",Y,"*")):u("",!0)]),p(B,{modelValue:o.observaciones,"onUpdate:modelValue":a[2]||(a[2]=d=>o.observaciones=d),placeholder:"Detalles adicionales sobre la reprogramación...",rows:"3",class:v(["w-full",{"p-invalid":s.value.observaciones}])},null,8,["modelValue","class"]),s.value.observaciones?(r(),n("small",Z,c(s.value.observaciones),1)):(r(),n("small",$," Información adicional que será enviada al cliente "))]),a[11]||(a[11]=e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("div",{class:"flex"},[e("i",{class:"pi pi-exclamation-triangle text-yellow-400 mr-2 mt-0.5"}),e("div",{class:"text-sm text-yellow-800"},[e("strong",null,"Importante:"),f(" La reprogramación será notificada automáticamente al cliente por correo electrónico. Asegúrate de que la nueva fecha esté disponible antes de confirmar. ")])])],-1))])])):u("",!0)]}),_:1},8,["visible"])}}};export{le as default};
