import{r as c,E as X,w as fe,o as Se,k,h as N,d as w,x as g,p as n,e as a,$ as r,a0 as Me,t as m,q as je,j as M,y as J,c as K,v as qe,F as He,l as $e,a7 as Pe,N as _,n as Ue}from"./vendor-CqKcGHPa.js";import{A as Be}from"./AuthenticatedLayout-CQ7S6qGK.js";import{z as Ge,A as x}from"./ui-CVJOYm3g.js";import{z as pe,e as xe,A as ge,g as he,r as be,s as Ze,f as F,B as ye,C as Q,D as we,l as We,x as Xe}from"./index-mhZfaEHg.js";import Je from"./Modales-B503Snpr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ke={class:"container mx-auto px-4 py-6"},Qe={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 sm:gap-6 mb-8"},Ye={class:"flex items-center justify-between text-white p-2 sm:p-4"},ea={class:"text-xl sm:text-3xl font-bold"},aa={class:"flex items-center justify-between text-white p-2 sm:p-4"},sa={class:"text-xl sm:text-3xl font-bold"},ta={class:"flex items-center justify-between text-white p-2 sm:p-4"},la={class:"text-xl sm:text-3xl font-bold"},ra={class:"flex items-center justify-between text-white p-2 sm:p-4"},oa={class:"text-xl sm:text-3xl font-bold"},ia={class:"flex items-center justify-between text-white p-2 sm:p-4"},na={class:"text-sm sm:text-3xl font-bold"},da={class:"bg-white rounded-lg shadow-md"},ca={class:"flex flex-col sm:flex-row lg:justify-between lg:items-center mb-4 gap-4 p-6"},ua={class:"text-blue-600 text-xs text-center sm:text-start mt-1 font-medium"},ma={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4 mx-4"},va={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},fa={class:"flex items-center gap-3"},pa={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},xa={class:"grid grid-cols-3 gap-2 w-full sm:hidden mt-2"},ga=["disabled"],ha={class:"truncate"},ba=["disabled"],ya={class:"truncate"},wa=["disabled"],_a={key:2,class:"truncate"},Ra={class:"flex gap-2"},Aa=["disabled"],Da=["disabled"],Ca=["disabled"],Ea={key:2,class:"hidden sm:inline"},za={class:"space-y-3"},Na={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-3"},ka={class:"col-span-1"},Fa=["value"],Ta={class:"col-span-1 hidden md:block"},Ia={class:"col-span-1 hidden md:block"},La={class:"col-span-2 flex gap-3 md:hidden"},Oa={class:"text-center py-12"},Va={class:"text-xs sm:text-sm"},Sa={class:"font-medium"},Ma={class:"text-xs text-gray-500 hidden sm:block"},ja={class:"flex items-center gap-1 sm:gap-3"},qa={class:"w-6 h-6 sm:w-8 sm:h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0"},Ha={class:"min-w-0 flex-1"},$a=["title"],Pa=["title"],Ua={class:"min-w-0"},Ba=["title"],Ga={class:"text-center"},Za={class:"text-xs sm:text-sm flex items-center justify-center gap-1"},Wa={class:"font-medium"},Xa={class:"text-xs text-gray-500"},Ja={class:"text-right"},Ka={class:"font-medium text-green-600 flex items-center justify-end gap-1 text-xs sm:text-sm"},Qa={class:"truncate"},Ya={class:"hidden xl:inline"},es={class:"xl:hidden"},as={class:"flex justify-center"},ss=["onClick"],cs={__name:"Reservas",setup(ts){const f=Ge(),u=c([]),j=c([]),O=c(!1),Y=c(!1),d=c({busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:"",estadoTour:null}),C=c(!1),q=c(!1),H=c(!1),$=c(!1);c(!1);const P=c(null),E=c(null);c(""),c(null),c(""),c("");const ee=c(typeof window<"u"?window.innerWidth:1024),R=c(!1),T=c(!1),U=c(!1),B=c(!1),G=c(!1),Z=c(!1),b=c(!1),A=c(!1),I=[{label:"Pendientes",value:"PENDIENTE",severity:"warn",color:"bg-yellow-100 text-yellow-800",icon:pe},{label:"Confirmadas",value:"CONFIRMADA",severity:"success",color:"bg-green-100 text-green-800",icon:xe},{label:"Rechazadas",value:"RECHAZADA",severity:"danger",color:"bg-red-100 text-red-800",icon:he},{label:"Reprogramadas",value:"REPROGRAMADA",severity:"info",color:"bg-blue-100 text-blue-800",icon:ge},{label:"Finalizadas",value:"FINALIZADA",severity:"secondary",color:"bg-gray-100 text-gray-800",icon:Q}],_e=[{label:"Disponible",value:"DISPONIBLE",color:"bg-green-100 text-green-800"},{label:"Agotado",value:"AGOTADO",color:"bg-red-100 text-red-800"},{label:"En Curso",value:"EN_CURSO",color:"bg-blue-100 text-blue-800"},{label:"Completado",value:"COMPLETADO",color:"bg-gray-100 text-gray-800"},{label:"Cancelado",value:"CANCELADO",color:"bg-red-100 text-red-800"},{label:"Suspendido",value:"SUSPENDIDO",color:"bg-orange-100 text-orange-800"},{label:"Reprogramado",value:"REPROGRAMADO",color:"bg-purple-100 text-purple-800"}],Re=X(()=>{let e=u.value;if(d.value.estadoReserva&&(e=e.filter(l=>l.estado===d.value.estadoReserva)),d.value.busqueda){const l=d.value.busqueda.toLowerCase();e=e.filter(o=>{var p,v,i,h,t,y;return(((v=(p=o.cliente)==null?void 0:p.user)==null?void 0:v.name)||((i=o.cliente)==null?void 0:i.nombres)||"").toLowerCase().includes(l)||(o.entidad_nombre||"").toLowerCase().includes(l)||(((t=(h=o.cliente)==null?void 0:h.user)==null?void 0:t.email)||((y=o.cliente)==null?void 0:y.correo)||"").toLowerCase().includes(l)})}return d.value.fechaDesde&&(e=e.filter(l=>new Date(l.fecha_reserva)>=new Date(d.value.fechaDesde))),d.value.fechaHasta&&(e=e.filter(l=>new Date(l.fecha_reserva)<=new Date(d.value.fechaHasta))),e.sort((l,o)=>{const p={PENDIENTE:1,CONFIRMADA:2,REPROGRAMADA:3,FINALIZADA:4,RECHAZADA:5},v=p[l.estado]||6,i=p[o.estado]||6;return v!==i?v-i:new Date(o.fecha_reserva)-new Date(l.fecha_reserva)})}),L=X(()=>({pendientes:u.value.filter(e=>e.estado==="PENDIENTE").length,confirmadas:u.value.filter(e=>e.estado==="CONFIRMADA").length,reprogramadas:u.value.filter(e=>e.estado==="REPROGRAMADA").length,rechazadas:u.value.filter(e=>e.estado==="RECHAZADA").length,finalizadas:u.value.filter(e=>e.estado==="FINALIZADA").length,totalIngresos:u.value.filter(e=>["CONFIRMADA","FINALIZADA"].includes(e.estado)).reduce((e,s)=>e+(Number(s.total)||0),0)})),Ae=X(()=>ee.value<640?{width:"95vw",maxWidth:"380px"}:ee.value<768?{width:"400px"}:{width:"450px"}),V=async()=>{O.value=!0;try{const e={busqueda:d.value.busqueda||void 0,fecha_inicio:d.value.fechaDesde||void 0,fecha_fin:d.value.fechaHasta||void 0},s=await _.get("/api/reservas",{params:e,withCredentials:!0});u.value=Array.isArray(s.data)?s.data:s.data.data||[]}catch(e){console.error("Error cargando reservas:",e),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:4e3}),u.value=[]}finally{O.value=!1}},De=async()=>{O.value=!0,f.add({severity:"info",summary:"Cargando reservas...",life:2e3});try{const e={busqueda:d.value.busqueda||void 0,fecha_inicio:d.value.fechaDesde||void 0,fecha_fin:d.value.fechaHasta||void 0},s=await _.get("/api/reservas",{params:e,withCredentials:!0});u.value=s.data.data||[],f.add({severity:"success",summary:"Reservas cargadas",life:2e3})}catch(e){console.error("Error cargando reservas:",e),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:4e3}),u.value=[]}finally{O.value=!1}},ae=async()=>{Y.value=!0;try{const e=await _.get("/api/tours");j.value=e.data||[]}catch(e){console.error("Error cargando tours:",e),j.value=[]}finally{Y.value=!1}},Ce=async e=>{var s,l,o,p,v;U.value=!0;try{const i=await _.put(`/api/reservas/${e.id}/confirmar`),h=u.value.findIndex(t=>t.id===e.id);h!==-1&&(u.value[h].estado="CONFIRMADA"),f.add({severity:"success",summary:"Â¡Confirmada!",detail:`Reserva de ${((l=(s=e.cliente)==null?void 0:s.user)==null?void 0:l.name)||((o=e.cliente)==null?void 0:o.nombres)} confirmada correctamente`,life:4e3})}catch(i){console.error("Error confirmando reserva:",i),f.add({severity:"error",summary:"Error",detail:((v=(p=i.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo confirmar la reserva",life:4e3})}finally{U.value=!1}},Ee=async e=>{var s,l,o,p,v;Z.value=!0;try{await _.put(`/api/reservas/${e.id}/finalizar`);const i=u.value.findIndex(h=>h.id===e.id);i!==-1&&(u.value[i].estado="FINALIZADA"),f.add({severity:"success",summary:"Â¡Finalizada!",detail:`Reserva de ${((l=(s=e.cliente)==null?void 0:s.user)==null?void 0:l.name)||((o=e.cliente)==null?void 0:o.nombres)} finalizada correctamente. Email de confirmaciÃ³n enviado.`,life:4e3})}catch(i){console.error("Error finalizando reserva:",i),f.add({severity:"error",summary:"Error",detail:((v=(p=i.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo finalizar la reserva",life:4e3})}finally{Z.value=!1}},se=e=>{P.value=e,$.value=!0},ze=e=>{P.value=e;const s=j.value.find(l=>{var o;return((o=e.detallesTours)==null?void 0:o.some(p=>p.tour_id===l.id))||e.entidad_nombre===l.nombre});E.value=s,C.value=!0},Ne=e=>{e.originalEvent.target.closest("button")||se(e.data)},ke=e=>{const s=I.find(l=>l.value===e);return(s==null?void 0:s.color)||"bg-gray-100 text-gray-800"},Fe=e=>e?new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",W=async()=>{R.value=!0;try{await new Promise(e=>setTimeout(e,300)),d.value={busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:"",estadoTour:null},f.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{R.value=!1}},te=async()=>{b.value=!0,f.add({severity:"info",summary:"Cargando reservas...",life:2e3});try{await V(),setTimeout(()=>{f.add({severity:"success",summary:"Reservas actualizadas",detail:`${u.value.length} registros cargados`,life:2e3})},300)}catch(e){console.error("Error al cargar las reservas:",e),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:3e3})}finally{setTimeout(()=>{b.value=!1},500)}},le=async()=>{var e,s;try{A.value=!0;const o=(await _.post("/api/reservas/finalizar-automaticamente")).data;o.success?(f.add({severity:"success",summary:"Â¡FinalizaciÃ³n automÃ¡tica completada!",detail:`${o.reservas_finalizadas} reserva(s) finalizada(s) de ${o.reservas_procesadas} procesada(s)`,life:6e3}),await V()):f.add({severity:"warn",summary:"Sin cambios",detail:o.message||"No hay reservas pendientes de finalizaciÃ³n",life:4e3})}catch(l){console.error("Error en finalizaciÃ³n automÃ¡tica:",l),f.add({severity:"error",summary:"Error",detail:((s=(e=l.response)==null?void 0:e.data)==null?void 0:s.message)||"Error al ejecutar la finalizaciÃ³n automÃ¡tica",life:4e3})}finally{A.value=!1}},Te=async e=>{await Ce(e),C.value=!1},Ie=async e=>{var s,l,o,p,v;B.value=!0,T.value=!0;try{await _.put(`/api/reservas/${e.reserva.id}/rechazar`,{motivo:e.motivo});const i=u.value.findIndex(h=>h.id===e.reserva.id);i!==-1&&(u.value[i].estado="RECHAZADA"),H.value=!1,C.value=!1,f.add({severity:"success",summary:"Â¡Rechazada!",detail:`Reserva de ${((l=(s=e.reserva.cliente)==null?void 0:s.user)==null?void 0:l.name)||((o=e.reserva.cliente)==null?void 0:o.nombres)} rechazada correctamente`,life:4e3})}catch(i){console.error("Error rechazando reserva:",i),f.add({severity:"error",summary:"Error",detail:((v=(p=i.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo rechazar la reserva",life:4e3})}finally{T.value=!1,B.value=!1}},Le=async e=>{var s,l,o,p,v;G.value=!0,T.value=!0;try{const i={fecha_nueva:e.fechaNueva,motivo:e.motivo,observaciones:e.observaciones};if(await _.put(`/api/reservas/${e.reserva.id}/reprogramar`,i),E.value)try{const t=new Date(E.value.fecha_salida),z=new Date(E.value.fecha_regreso).getTime()-t.getTime(),D=new Date(new Date(e.fechaNueva).getTime()+z),S={estado:"REPROGRAMADO",fecha_salida:e.fechaNueva,fecha_regreso:D,motivo_reprogramacion:`Reprogramado por reserva: ${e.motivo}`,observaciones:e.observaciones};await _.put(`/api/tours/${E.value.id}/cambiar-estado`,S),f.add({severity:"info",summary:"Tour actualizado",detail:`El tour "${E.value.nombre}" tambiÃ©n ha sido reprogramado`,life:4e3})}catch(t){console.error("Error reprogramando tour:",t),f.add({severity:"warn",summary:"Advertencia",detail:"La reserva fue reprogramada pero hubo un error al actualizar el tour",life:4e3})}const h=u.value.findIndex(t=>t.id===e.reserva.id);h!==-1&&(u.value[h].estado="REPROGRAMADA",u.value[h].fecha_reserva=e.fechaNueva),q.value=!1,C.value=!1,await Promise.all([V(),ae()]),f.add({severity:"success",summary:"Â¡Reprogramada!",detail:`Reserva de ${((l=(s=e.reserva.cliente)==null?void 0:s.user)==null?void 0:l.name)||((o=e.reserva.cliente)==null?void 0:o.nombres)} reprogramada correctamente`,life:4e3})}catch(i){console.error("Error reprogramando reserva:",i),f.add({severity:"error",summary:"Error",detail:((v=(p=i.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo reprogramar la reserva",life:4e3})}finally{T.value=!1,G.value=!1}},Oe=async e=>{await Ee(e),C.value=!1},Ve=e=>{se(e)};fe(()=>[d.value.busqueda,d.value.fechaDesde,d.value.fechaHasta],()=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{V()},500)},{deep:!0});const re=()=>{Ue(()=>{setTimeout(()=>{document.querySelectorAll(".p-select").forEach(s=>{const l=s.querySelector(".p-select-label, .p-placeholder");l&&(l.style.overflow="hidden",l.style.textOverflow="ellipsis",l.style.whiteSpace="nowrap",l.style.maxWidth="calc(100% - 2.5rem)",l.style.display="block")})},100)})};return fe([d],()=>{re()},{deep:!0}),Se(()=>{W().then(()=>{Promise.all([De(),ae()]),re()})}),(e,s)=>{const l=k("Toast"),o=k("Card"),p=k("InputText"),v=k("DatePicker"),i=k("Column"),h=k("DataTable");return w(),N(Be,null,{default:g(()=>[n(r(Me),{title:"GestiÃ³n de Reservas"}),n(l,{class:"z-[9999]"}),a("div",Ke,[s[25]||(s[25]=a("div",{class:"mb-6"},[a("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"GestiÃ³n de Reservas de Tours"),a("p",{class:"text-gray-600"},"Administra todas las reservas de tours")],-1)),a("div",Qe,[n(o,{class:"bg-gradient-to-r from-yellow-500 to-yellow-600"},{content:g(()=>[a("div",Ye,[a("div",null,[s[10]||(s[10]=a("p",{class:"text-xs sm:text-sm opacity-90"},"Pendientes",-1)),a("p",ea,m(L.value.pendientes),1)]),n(r(x),{icon:r(pe),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),n(o,{class:"bg-gradient-to-r from-green-500 to-green-600"},{content:g(()=>[a("div",aa,[a("div",null,[s[11]||(s[11]=a("p",{class:"text-xs sm:text-sm opacity-90"},"Confirmadas",-1)),a("p",sa,m(L.value.confirmadas),1)]),n(r(x),{icon:r(xe),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),n(o,{class:"bg-gradient-to-r from-blue-500 to-blue-600"},{content:g(()=>[a("div",ta,[a("div",null,[s[12]||(s[12]=a("p",{class:"text-xs sm:text-sm opacity-90"},"Reprogramadas",-1)),a("p",la,m(L.value.reprogramadas),1)]),n(r(x),{icon:r(ge),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),n(o,{class:"bg-gradient-to-r from-red-500 to-red-600"},{content:g(()=>[a("div",ra,[a("div",null,[s[13]||(s[13]=a("p",{class:"text-xs sm:text-sm opacity-90"},"Rechazadas",-1)),a("p",oa,m(L.value.rechazadas),1)]),n(r(x),{icon:r(he),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),n(o,{class:"bg-gradient-to-r from-purple-500 to-purple-600"},{content:g(()=>[a("div",ia,[a("div",null,[s[14]||(s[14]=a("p",{class:"text-xs sm:text-sm opacity-90"},"Ingresos",-1)),a("p",na,"$"+m(L.value.totalIngresos.toFixed(2)),1)]),n(r(x),{icon:r(be),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1})]),a("div",da,[a("div",ca,[a("div",null,[s[16]||(s[16]=a("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold text-center sm:text-start"},"Reservas por Estado",-1)),s[17]||(s[17]=a("p",{class:"text-gray-500 text-sm text-center sm:text-start mt-1"}," ðŸ“Š Gestiona las reservas organizadas por su estado actual ",-1)),a("p",ua,[n(r(x),{icon:r(Ze),class:"h-4 w-4 text-yellow-500"},null,8,["icon"]),s[15]||(s[15]=je(" Haz clic en cualquier fila para ver los detalles. "))])])]),a("div",ma,[a("div",va,[a("div",fa,[s[18]||(s[18]=a("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[a("i",{class:"pi pi-filter text-blue-600 text-sm"}),a("span",null,"Filtros")],-1)),a("div",pa,m(u.value.length)+" resultado"+m(u.value.length!==1?"s":""),1)]),a("div",xa,[a("button",{onClick:W,disabled:R.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-2 py-1 text-xs text-white shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1"},[R.value?(w(),N(r(x),{key:0,icon:r(F),class:"animate-spin h-3 w-3"},null,8,["icon"])):M("",!0),a("span",ha,m(R.value?"Limpiando...":"Limpiar"),1)],8,ga),a("button",{onClick:te,disabled:b.value,class:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 text-xs shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1"},[n(r(x),{icon:b.value?r(F):r(ye),class:J([{"animate-spin":b.value},"h-3 w-3"])},null,8,["icon","class"]),a("span",ya,m(b.value?"Recargando...":"Recargar"),1)],8,ba),a("button",{onClick:le,disabled:A.value,class:"bg-purple-500 hover:bg-purple-600 text-white px-2 py-1 text-xs shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1",title:"Finaliza automÃ¡ticamente las reservas cuyas fechas de tour han pasado"},[A.value?(w(),N(r(x),{key:0,icon:r(F),class:"animate-spin h-3 w-3"},null,8,["icon"])):(w(),N(r(x),{key:1,icon:r(Q),class:"h-3"},null,8,["icon"])),A.value?M("",!0):(w(),K("span",_a,"Finalizar"))],8,wa)]),a("div",Ra,[a("button",{onClick:W,disabled:R.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[R.value?(w(),N(r(x),{key:0,icon:r(F),class:"animate-spin h-3 w-3"},null,8,["icon"])):M("",!0),a("span",null,m(R.value?"Limpiando...":"Limpiar filtros"),1)],8,Aa),a("button",{onClick:te,disabled:b.value,class:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 text-sm shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2 hidden sm:flex"},[n(r(x),{icon:b.value?r(F):r(ye),class:J([{"animate-spin":b.value},"h-3 w-3"])},null,8,["icon","class"]),a("span",null,m(b.value?"Recargando...":"Recargar"),1)],8,Da),a("button",{onClick:le,disabled:A.value,class:"bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 text-sm shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2 hidden sm:flex",title:"Finaliza automÃ¡ticamente las reservas cuyas fechas de tour han pasado"},[A.value?(w(),N(r(x),{key:0,icon:r(F),class:"animate-spin h-3 w-3"},null,8,["icon"])):(w(),N(r(x),{key:1,icon:r(Q),class:"h-3"},null,8,["icon"])),A.value?M("",!0):(w(),K("span",Ea,"FinalizaciÃ³n AutomÃ¡tica"))],8,Ca)])]),a("div",za,[a("div",null,[n(p,{modelValue:d.value.busqueda,"onUpdate:modelValue":s[0]||(s[0]=t=>d.value.busqueda=t),placeholder:"ðŸ” Buscar reservas...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),a("div",Na,[a("div",ka,[qe(a("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>d.value.estadoReserva=t),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[s[19]||(s[19]=a("option",{value:"",disabled:"",selected:"",hidden:""},"Estado",-1)),(w(),K(He,null,$e(I,t=>a("option",{key:t.value,value:t.value,class:"truncate text-gray-900"},m(t.label),9,Fa)),64))],512),[[Pe,d.value.estadoReserva]])]),a("div",Ta,[n(v,{modelValue:d.value.fechaDesde,"onUpdate:modelValue":s[2]||(s[2]=t=>d.value.fechaDesde=t),placeholder:"Fecha desde",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),a("div",Ia,[n(v,{modelValue:d.value.fechaHasta,"onUpdate:modelValue":s[3]||(s[3]=t=>d.value.fechaHasta=t),placeholder:"Fecha hasta",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),a("div",La,[n(v,{modelValue:d.value.fechaDesde,"onUpdate:modelValue":s[4]||(s[4]=t=>d.value.fechaDesde=t),placeholder:"Fecha desde",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"]),n(v,{modelValue:d.value.fechaHasta,"onUpdate:modelValue":s[5]||(s[5]=t=>d.value.fechaHasta=t),placeholder:"Fecha hasta",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"])])])])]),n(h,{value:Re.value,paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} reservas",responsiveLayout:"scroll",class:"mt-2 sm:mt-4 overflow-x-auto",onRowClick:Ne,pt:{root:{class:"text-xs sm:text-sm"},wrapper:{class:"text-xs sm:text-sm overflow-x-auto"},table:{class:"text-xs sm:text-sm min-w-full"},thead:{class:"text-xs sm:text-sm"},headerRow:{class:"text-xs sm:text-sm"},headerCell:{class:"text-xs sm:text-sm font-medium py-2 sm:py-3 px-1 sm:px-2"},tbody:{class:"text-xs sm:text-sm"},bodyRow:{class:"text-xs sm:text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-2 sm:py-3 px-1 sm:px-2 text-xs sm:text-sm"}}},{empty:g(()=>[a("div",Oa,[n(r(x),{icon:r(Xe),class:"text-4xl text-gray-400 mb-4"},null,8,["icon"]),s[20]||(s[20]=a("p",{class:"text-gray-500 text-lg"},"No se encontraron reservas",-1)),s[21]||(s[21]=a("p",{class:"text-gray-400 text-sm mt-2"}," Ajusta los filtros para encontrar las reservas que buscas ",-1))])]),loading:g(()=>s[22]||(s[22]=[a("div",{class:"text-center py-12"},[a("i",{class:"pi pi-spin pi-spinner text-3xl text-blue-500 mb-4"}),a("p",{class:"text-gray-500 text-lg"},"Cargando reservas...")],-1)])),default:g(()=>[n(i,{field:"fecha_reserva",header:"Fecha",sortable:"",class:"w-16 sm:w-20 lg:w-24 min-w-14"},{body:g(t=>[a("div",Va,[a("div",Sa,m(Fe(t.data.fecha_reserva)),1),a("div",Ma,m(new Date(t.data.fecha_reserva).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})),1)])]),_:1}),n(i,{field:"cliente.nombres",header:"Cliente",sortable:"",class:"w-24 sm:w-32 lg:w-40 min-w-20 hidden sm:table-cell"},{body:g(t=>{var y,z,D,S,oe,ie,ne,de,ce,ue,me,ve;return[a("div",ja,[a("div",qa,[n(r(x),{icon:r(we),class:"text-blue-600 text-xs sm:text-sm"},null,8,["icon"])]),a("div",Ha,[a("div",{class:"font-medium text-gray-900 text-xs sm:text-sm truncate",title:((z=(y=t.data.cliente)==null?void 0:y.user)==null?void 0:z.name)||((D=t.data.cliente)==null?void 0:D.nombres)||"N/A"},m(((oe=(S=t.data.cliente)==null?void 0:S.user)==null?void 0:oe.name)||((ie=t.data.cliente)==null?void 0:ie.nombres)||"N/A"),9,$a),a("div",{class:"text-xs text-gray-500 truncate hidden sm:block",title:((de=(ne=t.data.cliente)==null?void 0:ne.user)==null?void 0:de.email)||((ce=t.data.cliente)==null?void 0:ce.correo)||"N/A"},m(((me=(ue=t.data.cliente)==null?void 0:ue.user)==null?void 0:me.email)||((ve=t.data.cliente)==null?void 0:ve.correo)||"N/A"),9,Pa)])])]}),_:1}),n(i,{field:"entidad_nombre",header:"Servicio",sortable:"",class:"w-24 sm:w-32 lg:w-48 min-w-20"},{body:g(t=>[a("div",Ua,[a("div",{class:"text-xs sm:text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"120px","text-overflow":"ellipsis","white-space":"nowrap"},title:t.data.entidad_nombre},m(t.data.entidad_nombre||"N/A"),9,Ba),s[23]||(s[23]=a("div",{class:"text-xs text-gray-500 capitalize hidden sm:block"}," Tours ",-1))])]),_:1}),n(i,{header:"Personas",class:"w-16 sm:w-20 lg:w-24 min-w-14 hidden md:table-cell"},{body:g(t=>[a("div",Ga,[a("div",Za,[n(r(x),{icon:r(we),class:"text-gray-400 text-xs"},null,8,["icon"]),a("span",Wa,m((t.data.mayores_edad||0)+(t.data.menores_edad||0)),1)]),a("div",Xa,m(t.data.mayores_edad||0)+"A â€¢ "+m(t.data.menores_edad||0)+"N ",1)])]),_:1}),n(i,{field:"total",header:"Total",sortable:"",class:"w-16 sm:w-20 lg:w-24 min-w-14"},{body:g(t=>[a("div",Ja,[a("div",Ka,[n(r(x),{icon:r(be),class:"text-xs"},null,8,["icon"]),a("span",Qa,m(Number(t.data.total||0).toFixed(2)),1)])])]),_:1}),n(i,{field:"estado",header:"Estado",class:"w-20 sm:w-24 lg:w-32 min-w-16 hidden lg:table-cell"},{body:g(t=>{var y,z;return[a("span",{class:J([ke(t.data.estado),"px-1 sm:px-2 py-1 rounded-full text-xs font-medium"])},[a("span",Ya,m(((y=I.find(D=>D.value===t.data.estado))==null?void 0:y.label)||t.data.estado),1),a("span",es,m((((z=I.find(D=>D.value===t.data.estado))==null?void 0:z.label)||t.data.estado).substring(0,4)),1)],2)]}),_:1}),n(i,{header:"Acciones",class:"w-20 sm:w-24 lg:w-28 min-w-16"},{body:g(t=>[a("div",as,[a("button",{class:"bg-green-500 hover:bg-green-600 text-white px-2 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-1 text-xs shadow-md hover:shadow-lg hover:-translate-y-1",onClick:y=>ze(t.data),title:"MÃ¡s acciones"},[n(r(x),{icon:r(We),class:"h-3 w-4 sm:h-4 sm:w-5"},null,8,["icon"]),s[24]||(s[24]=a("span",{class:"hidden md:inline"},"MÃ¡s",-1))],8,ss)])]),_:1})]),_:1},8,["value"]),n(Je,{visible:C.value,"onUpdate:visible":s[6]||(s[6]=t=>C.value=t),"detalles-visible":$.value,"onUpdate:detallesVisible":s[7]||(s[7]=t=>$.value=t),"rechazar-visible":H.value,"onUpdate:rechazarVisible":s[8]||(s[8]=t=>H.value=t),"reprogramar-visible":q.value,"onUpdate:reprogramarVisible":s[9]||(s[9]=t=>q.value=t),reserva:P.value,tour:E.value,"dialog-style":Ae.value,procesando:T.value,"confirmando-reserva":U.value,"rechazando-reserva":B.value,"reprogramando-reserva":G.value,"finalizando-reserva":Z.value,"estados-reservas":I,"estados-tours":_e,onConfirmar:Te,onRechazar:Ie,onReprogramar:Le,onFinalizar:Oe,onVerDetalles:Ve},null,8,["visible","detalles-visible","rechazar-visible","reprogramar-visible","reserva","tour","dialog-style","procesando","confirmando-reserva","rechazando-reserva","reprogramando-reserva","finalizando-reserva"])])])]),_:1})}}};export{cs as default};
