import{N as I,r as w,E as ye,w as $e,o as Se,k,c as R,d as D,p as a,$ as r,a0 as Me,x as p,e as s,t as o,j as T,F as oe,l as he,y as re,q as _}from"./vendor-BntMrX60.js";import{A as je}from"./AuthenticatedLayout-DH0Pa8es.js";import{z as qe,A as m}from"./ui-BJqxeYA1.js";import{p as Ue,e as ne,d as q,q as J,r as ie,i as He,s as de,t as we,o as Pe,u as _e,g as Ge}from"./index-Dk7fAEKz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ze={class:"px-2 sm:px-4 lg:px-6 xl:px-8 mt-4 sm:mt-6"},Be={class:"flex flex-col xl:flex-row xl:justify-between xl:items-start mb-4 sm:mb-6 gap-4 sm:gap-6"},We={class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 xl:grid-cols-5 gap-2 sm:gap-3 lg:gap-4 text-center w-full xl:w-auto"},Xe={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-2 sm:p-3 min-w-0"},Je={class:"text-base sm:text-lg font-bold text-yellow-600 truncate"},Ke={class:"bg-green-50 border border-green-200 rounded-lg p-2 sm:p-3 min-w-0"},Qe={class:"text-base sm:text-lg font-bold text-green-600 truncate"},Ye={class:"bg-blue-50 border border-blue-200 rounded-lg p-2 sm:p-3 min-w-0"},es={class:"text-base sm:text-lg font-bold text-blue-600 truncate"},ss={class:"bg-red-50 border border-red-200 rounded-lg p-2 sm:p-3 min-w-0"},ts={class:"text-base sm:text-lg font-bold text-red-600 truncate"},as={class:"bg-gray-50 border border-gray-200 rounded-lg p-2 sm:p-3 min-w-0 col-span-2 sm:col-span-1"},ls={class:"text-base sm:text-lg font-bold text-green-600 truncate"},os={class:"bg-blue-50 p-3 sm:p-4 lg:p-6 rounded-lg shadow-sm border mb-4 sm:mb-6"},rs={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-3 sm:mb-4 gap-3 sm:gap-4"},ns={class:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3"},is={class:"text-sm sm:text-base font-medium text-gray-800 flex items-center gap-2"},ds={class:"bg-blue-100 border border-blue-200 text-blue-700 px-2 sm:px-3 py-1 rounded text-xs sm:text-sm font-medium w-fit"},us={class:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto"},ms=["disabled"],cs={key:0,class:"hidden sm:inline"},xs={key:1,class:"sm:hidden"},vs={key:3,class:"sm:hidden"},ps={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},gs={class:"w-full"},fs={class:"w-full"},bs={class:"w-full"},ys={class:"w-full"},hs={class:"hidden xs:inline truncate"},ws={class:"xs:hidden truncate"},_s={class:"bg-gray-200 text-gray-700 px-1 sm:px-2 py-0.5 rounded-full text-xs flex-shrink-0"},As={class:"text-center py-12"},Rs={class:"text-gray-500 text-lg"},Ds={class:"text-gray-400 text-sm mt-2"},Cs={class:"text-xs sm:text-sm"},ks={class:"font-medium"},Es={class:"text-xs text-gray-500 hidden sm:block"},Ns={class:"flex items-center gap-1 sm:gap-3"},Ts={class:"w-6 h-6 sm:w-8 sm:h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0"},zs={class:"min-w-0 flex-1"},Fs=["title"],Is=["title"],Ls={class:"min-w-0"},Vs=["title"],Os={class:"text-xs text-gray-500 capitalize hidden sm:block"},$s={class:"text-center"},Ss={class:"text-xs sm:text-sm flex items-center justify-center gap-1"},Ms={class:"font-medium"},js={class:"text-xs text-gray-500"},qs={class:"text-right"},Us={class:"font-medium text-green-600 flex items-center justify-end gap-1 text-xs sm:text-sm"},Hs={class:"truncate"},Ps={class:"hidden xl:inline"},Gs={class:"xl:hidden"},Zs={class:"flex gap-1 flex-wrap justify-center"},Bs=["onClick"],Ws=["onClick"],Xs=["onClick"],Js=["onClick"],Ks=["onClick"],Qs={key:0,class:"space-y-4 sm:space-y-6"},Ys={class:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4"},et={class:"font-semibold text-blue-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},st={class:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 text-xs sm:text-sm"},tt={class:"break-words"},at={class:"ml-2"},lt={class:"break-words"},ot={class:"ml-2"},rt={class:"ml-2"},nt={class:"ml-2"},it={class:"bg-gray-50 border border-gray-200 rounded-lg p-3 sm:p-4"},dt={class:"font-semibold text-gray-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},ut={class:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 text-xs sm:text-sm"},mt={class:"break-words"},ct={class:"ml-2"},xt={class:"ml-2 capitalize"},vt={class:"ml-2"},pt={class:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4"},gt={class:"font-semibold text-green-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},ft={class:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3 text-xs sm:text-sm"},bt={class:"ml-2"},yt={class:"ml-2"},ht={class:"col-span-2 sm:col-span-1"},wt={class:"ml-2 font-bold text-green-600"},_t={class:"flex justify-center w-full p-2 sm:p-0"},At={class:"space-y-3 sm:space-y-4"},Rt={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4"},Dt={class:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3"},Ct={class:"text-xs sm:text-sm space-y-1"},kt={class:"break-words"},Et={class:"break-words"},Nt={class:"text-gray-500 text-xs mt-1"},Tt={class:"flex flex-col sm:flex-row justify-center gap-2 sm:gap-3 w-full p-2 sm:p-0"},zt=["disabled"],Ft={class:"space-y-6"},It={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Lt={class:"flex items-center gap-3 mb-3"},Vt={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm"},Ot={class:"ml-2"},$t={class:"ml-2"},St={class:"ml-2"},Mt={class:"ml-2 font-bold text-green-600"},jt={key:1,class:"bg-purple-50 border border-purple-200 rounded-lg p-4"},qt={class:"flex items-center gap-3 mb-3"},Ut={class:"text-sm space-y-1"},Ht={class:"grid grid-cols-1 sm:grid-cols-1 gap-4"},Pt={class:"text-gray-500 text-xs mt-1"},Gt={class:"text-gray-500 text-xs mt-1"},Zt={class:"flex justify-center gap-3 w-full"},Bt=["disabled"],ea={__name:"ReservaTours",setup(Wt){I.defaults.withCredentials=!0;const y=qe(),x=w([]),Y=w([]),L=w(!1),ue=w(!1),v=w({tipo:"tours",busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:null,estadoTour:null}),U=w(!1),H=w(!1),K=w(!1);w(!1);const n=w(null),N=w(null),O=w(""),z=w(null),V=w(""),S=w(""),ee=w(0),$=[{label:"Pendientes",value:"PENDIENTE",severity:"warn",color:"bg-yellow-100 text-yellow-800",icon:Ue},{label:"Confirmadas",value:"CONFIRMADA",severity:"success",color:"bg-green-100 text-green-800",icon:ne},{label:"Rechazadas",value:"RECHAZADA",severity:"danger",color:"bg-red-100 text-red-800",icon:q},{label:"Reprogramadas",value:"REPROGRAMADA",severity:"info",color:"bg-blue-100 text-blue-800",icon:J},{label:"Finalizadas",value:"FINALIZADA",severity:"secondary",color:"bg-gray-100 text-gray-800",icon:ie}],me=[{label:"Disponible",value:"DISPONIBLE",color:"bg-green-100 text-green-800"},{label:"Agotado",value:"AGOTADO",color:"bg-red-100 text-red-800"},{label:"En Curso",value:"EN_CURSO",color:"bg-blue-100 text-blue-800"},{label:"Completado",value:"COMPLETADO",color:"bg-gray-100 text-gray-800"},{label:"Cancelado",value:"CANCELADO",color:"bg-red-100 text-red-800"},{label:"Suspendido",value:"SUSPENDIDO",color:"bg-orange-100 text-orange-800"},{label:"Reprogramado",value:"REPROGRAMADO",color:"bg-purple-100 text-purple-800"}],Ae=ye(()=>{var u;const t=(u=$[ee.value])==null?void 0:u.value;let e=x.value.filter(d=>d.estado===t);if(v.value.busqueda){const d=v.value.busqueda.toLowerCase();e=e.filter(g=>{var c,f,A,C,M,j;return(((f=(c=g.cliente)==null?void 0:c.user)==null?void 0:f.name)||((A=g.cliente)==null?void 0:A.nombres)||"").toLowerCase().includes(d)||(g.entidad_nombre||"").toLowerCase().includes(d)||(((M=(C=g.cliente)==null?void 0:C.user)==null?void 0:M.email)||((j=g.cliente)==null?void 0:j.correo)||"").toLowerCase().includes(d)})}return v.value.fechaDesde&&(e=e.filter(d=>new Date(d.fecha_reserva)>=new Date(v.value.fechaDesde))),v.value.fechaHasta&&(e=e.filter(d=>new Date(d.fecha_reserva)<=new Date(v.value.fechaHasta))),e}),P=ye(()=>({pendientes:x.value.filter(t=>t.estado==="PENDIENTE").length,confirmadas:x.value.filter(t=>t.estado==="CONFIRMADA").length,reprogramadas:x.value.filter(t=>t.estado==="REPROGRAMADA").length,rechazadas:x.value.filter(t=>t.estado==="RECHAZADA").length,finalizadas:x.value.filter(t=>t.estado==="FINALIZADA").length,totalIngresos:x.value.filter(t=>["CONFIRMADA","FINALIZADA"].includes(t.estado)).reduce((t,e)=>t+(Number(e.total)||0),0)})),G=async()=>{L.value=!0;try{const t={tipo:v.value.tipo,busqueda:v.value.busqueda||void 0,fecha_inicio:v.value.fechaDesde||void 0,fecha_fin:v.value.fechaHasta||void 0},e=await I.get("/api/reservas",{params:t,withCredentials:!0});x.value=e.data.data||[]}catch(t){console.error("Error cargando reservas:",t),y.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:4e3}),x.value=[]}finally{L.value=!1}},ce=async()=>{ue.value=!0;try{const t=await I.get("/api/tours");Y.value=t.data||[]}catch(t){console.error("Error cargando tours:",t),Y.value=[]}finally{ue.value=!1}},Re=async t=>{var e,u,d,g,c;try{const f=await I.put(`/api/reservas/${t.id}/confirmar`),A=x.value.findIndex(C=>C.id===t.id);A!==-1&&(x.value[A].estado="CONFIRMADA"),y.add({severity:"success",summary:"¬°Confirmada!",detail:`Reserva de ${((u=(e=t.cliente)==null?void 0:e.user)==null?void 0:u.name)||((d=t.cliente)==null?void 0:d.nombres)} confirmada correctamente`,life:4e3})}catch(f){console.error("Error confirmando reserva:",f),y.add({severity:"error",summary:"Error",detail:((c=(g=f.response)==null?void 0:g.data)==null?void 0:c.message)||"No se pudo confirmar la reserva",life:4e3})}},De=t=>{n.value=t,O.value="",H.value=!0},Ce=async()=>{var t,e,u,d,g;if(!O.value.trim()){y.add({severity:"warn",summary:"Campo requerido",detail:"Debe ingresar un motivo para rechazar la reserva",life:4e3});return}try{await I.put(`/api/reservas/${n.value.id}/rechazar`,{motivo:O.value});const c=x.value.findIndex(f=>f.id===n.value.id);c!==-1&&(x.value[c].estado="RECHAZADA"),H.value=!1,y.add({severity:"success",summary:"¬°Rechazada!",detail:`Reserva de ${((e=(t=n.value.cliente)==null?void 0:t.user)==null?void 0:e.name)||((u=n.value.cliente)==null?void 0:u.nombres)} rechazada correctamente`,life:4e3})}catch(c){console.error("Error rechazando reserva:",c),y.add({severity:"error",summary:"Error",detail:((g=(d=c.response)==null?void 0:d.data)==null?void 0:g.message)||"No se pudo rechazar la reserva",life:4e3})}},ke=t=>{n.value=t,z.value=null,V.value="",S.value="";const e=Y.value.find(u=>{var d;return((d=t.detallesTours)==null?void 0:d.some(g=>g.tour_id===u.id))||t.entidad_nombre===u.nombre});N.value=e,U.value=!0},Ee=async()=>{var t,e,u,d,g;if(!z.value||!V.value.trim()){y.add({severity:"warn",summary:"Campos requeridos",detail:"Debe ingresar una nueva fecha y motivo para reprogramar",life:4e3});return}try{const c={fecha_nueva:z.value,motivo:V.value,observaciones:S.value};if(await I.put(`/api/reservas/${n.value.id}/reprogramar`,c),N.value)try{const A=new Date(N.value.fecha_salida),M=new Date(N.value.fecha_regreso).getTime()-A.getTime(),j=new Date(new Date(z.value).getTime()+M),te={estado:"REPROGRAMADO",fecha_salida:z.value,fecha_regreso:j,motivo_reprogramacion:`Reprogramado por reserva: ${V.value}`,observaciones:S.value};await I.put(`/api/tours/${N.value.id}/cambiar-estado`,te),y.add({severity:"info",summary:"Tour actualizado",detail:`El tour "${N.value.nombre}" tambi√©n ha sido reprogramado`,life:4e3})}catch(A){console.error("Error reprogramando tour:",A),y.add({severity:"warn",summary:"Advertencia",detail:"La reserva fue reprogramada pero hubo un error al actualizar el tour",life:4e3})}const f=x.value.findIndex(A=>A.id===n.value.id);f!==-1&&(x.value[f].estado="REPROGRAMADA",x.value[f].fecha_reserva=z.value),U.value=!1,await Promise.all([G(),ce()]),y.add({severity:"success",summary:"¬°Reprogramada!",detail:`Reserva de ${((e=(t=n.value.cliente)==null?void 0:t.user)==null?void 0:e.name)||((u=n.value.cliente)==null?void 0:u.nombres)} reprogramada correctamente`,life:4e3})}catch(c){console.error("Error reprogramando reserva:",c),y.add({severity:"error",summary:"Error",detail:((g=(d=c.response)==null?void 0:d.data)==null?void 0:g.message)||"No se pudo reprogramar la reserva",life:4e3})}},Ne=async t=>{var e,u,d,g,c;try{await I.put(`/api/reservas/${t.id}/finalizar`);const f=x.value.findIndex(A=>A.id===t.id);f!==-1&&(x.value[f].estado="FINALIZADA"),y.add({severity:"success",summary:"¬°Finalizada!",detail:`Reserva de ${((u=(e=t.cliente)==null?void 0:e.user)==null?void 0:u.name)||((d=t.cliente)==null?void 0:d.nombres)} finalizada correctamente. Email de confirmaci√≥n enviado.`,life:4e3})}catch(f){console.error("Error finalizando reserva:",f),y.add({severity:"error",summary:"Error",detail:((c=(g=f.response)==null?void 0:g.data)==null?void 0:c.message)||"No se pudo finalizar la reserva",life:4e3})}},Te=t=>{n.value=t,K.value=!0},Z=t=>{switch(t.estado){case"PENDIENTE":return["confirmar","rechazar","reprogramar","detalles"];case"CONFIRMADA":return["rechazar","reprogramar","finalizar","detalles"];case"REPROGRAMADA":return["rechazar","finalizar","detalles"];case"RECHAZADA":return["detalles"];case"FINALIZADA":return["detalles"];default:return["detalles"]}},xe=t=>{const e=$.find(u=>u.value===t);return(e==null?void 0:e.color)||"bg-gray-100 text-gray-800"},ze=t=>{const e=me.find(u=>u.value===t);return(e==null?void 0:e.color)||"bg-gray-100 text-gray-800"},se=t=>t?new Date(t).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",Fe=t=>t?new Date(t).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",Ie=()=>{v.value={tipo:"tours",busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:null,estadoTour:null},G()},Le=()=>new Date,Ve=async()=>{var t,e;try{L.value=!0;const d=(await I.post("/api/reservas/finalizar-automaticamente")).data;d.success?(y.add({severity:"success",summary:"¬°Finalizaci√≥n autom√°tica completada!",detail:`${d.reservas_finalizadas} reserva(s) finalizada(s) de ${d.reservas_procesadas} procesada(s)`,life:6e3}),await G()):y.add({severity:"warn",summary:"Sin cambios",detail:d.message||"No hay reservas pendientes de finalizaci√≥n",life:4e3})}catch(u){console.error("Error en finalizaci√≥n autom√°tica:",u),y.add({severity:"error",summary:"Error",detail:((e=(t=u.response)==null?void 0:t.data)==null?void 0:e.message)||"Error al ejecutar la finalizaci√≥n autom√°tica",life:4e3})}finally{L.value=!1}};return $e(()=>[v.value.busqueda,v.value.fechaDesde,v.value.fechaHasta],()=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{G()},500)},{deep:!0}),Se(()=>{Promise.all([G(),ce()])}),(t,e)=>{const u=k("Toast"),d=k("Select"),g=k("InputText"),c=k("DatePicker"),f=k("Tab"),A=k("TabList"),C=k("Column"),M=k("DataTable"),j=k("TabPanel"),te=k("TabPanels"),Oe=k("Tabs"),ae=k("Dialog"),le=k("Textarea");return D(),R(oe,null,[a(r(Me),{title:"Gesti√≥n de Reservas"}),a(je,null,{default:p(()=>[a(u,{class:"z-[9999]"}),s("div",Ze,[s("div",Be,[e[20]||(e[20]=s("div",{class:"flex-1"},[s("h3",{class:"text-xl sm:text-2xl lg:text-3xl text-blue-600 font-bold"},"Gesti√≥n de Reservas"),s("p",{class:"text-sm sm:text-base text-gray-600 mt-1"},"Administra todas las reservas de tours, hoteles y aerol√≠neas")],-1)),s("div",We,[s("div",Xe,[s("div",Je,o(P.value.pendientes),1),e[15]||(e[15]=s("div",{class:"text-xs text-yellow-600"},"Pendientes",-1))]),s("div",Ke,[s("div",Qe,o(P.value.confirmadas),1),e[16]||(e[16]=s("div",{class:"text-xs text-green-600"},"Confirmadas",-1))]),s("div",Ye,[s("div",es,o(P.value.reprogramadas),1),e[17]||(e[17]=s("div",{class:"text-xs text-blue-600"},"Reprogramadas",-1))]),s("div",ss,[s("div",ts,o(P.value.rechazadas),1),e[18]||(e[18]=s("div",{class:"text-xs text-red-600"},"Rechazadas",-1))]),s("div",as,[s("div",ls,"$"+o(P.value.totalIngresos.toFixed(2)),1),e[19]||(e[19]=s("div",{class:"text-xs text-gray-600"},"Ingresos",-1))])])]),s("div",os,[s("div",rs,[s("div",ns,[s("h3",is,[a(r(m),{icon:r(He),class:"text-blue-600 text-sm"},null,8,["icon"]),e[21]||(e[21]=s("span",null,"Filtros",-1))]),s("div",ds,o(x.value.length)+" reserva"+o(x.value.length!==1?"s":"")+" total"+o(x.value.length!==1?"es":""),1)]),s("div",us,[s("button",{class:"bg-red-500 hover:bg-red-600 text-white px-3 sm:px-4 py-2 rounded-md text-xs sm:text-sm transition-colors duration-200 flex items-center gap-2 justify-center w-full sm:w-auto",onClick:Ie},[a(r(m),{icon:r(q),class:"h-3 sm:h-4"},null,8,["icon"]),e[22]||(e[22]=s("span",{class:"hidden xs:inline"},"Limpiar filtros",-1)),e[23]||(e[23]=s("span",{class:"xs:hidden"},"Limpiar",-1))]),s("button",{class:"bg-purple-500 hover:bg-purple-600 text-white px-3 sm:px-4 py-2 rounded-md text-xs sm:text-sm transition-colors duration-200 flex items-center gap-2 justify-center w-full sm:w-auto",onClick:Ve,disabled:L.value,title:"Finaliza autom√°ticamente las reservas cuyas fechas de tour han pasado"},[a(r(m),{icon:r(ie),class:"h-3 sm:h-4"},null,8,["icon"]),L.value?T("",!0):(D(),R("span",cs,"Finalizaci√≥n Autom√°tica")),L.value?(D(),R("span",vs,"...")):(D(),R("span",xs,"Auto Finalizar"))],8,ms)])]),s("div",ps,[s("div",gs,[e[24]||(e[24]=s("label",{class:"block text-xs sm:text-sm font-medium text-gray-700 mb-1"},"Tipo de Reserva",-1)),a(d,{modelValue:v.value.tipo,"onUpdate:modelValue":e[0]||(e[0]=i=>v.value.tipo=i),options:[{label:"Tours",value:"tours"},{label:"Hoteles",value:"hoteles"},{label:"Aerol√≠neas",value:"aerolineas"}],optionLabel:"label",optionValue:"value",class:"w-full h-8 sm:h-9",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),s("div",fs,[e[25]||(e[25]=s("label",{class:"block text-xs sm:text-sm font-medium text-gray-700 mb-1"},"Buscar",-1)),a(g,{modelValue:v.value.busqueda,"onUpdate:modelValue":e[1]||(e[1]=i=>v.value.busqueda=i),placeholder:"üîç Cliente, servicio...",class:"w-full h-8 sm:h-9 text-xs sm:text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),s("div",bs,[e[26]||(e[26]=s("label",{class:"block text-xs sm:text-sm font-medium text-gray-700 mb-1"},"Fecha desde",-1)),a(c,{modelValue:v.value.fechaDesde,"onUpdate:modelValue":e[2]||(e[2]=i=>v.value.fechaDesde=i),dateFormat:"dd/mm/yy",class:"w-full h-8 sm:h-9",showIcon:"",placeholder:"Fecha inicio",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),s("div",ys,[e[27]||(e[27]=s("label",{class:"block text-xs sm:text-sm font-medium text-gray-700 mb-1"},"Fecha hasta",-1)),a(c,{modelValue:v.value.fechaHasta,"onUpdate:modelValue":e[3]||(e[3]=i=>v.value.fechaHasta=i),dateFormat:"dd/mm/yy",class:"w-full h-8 sm:h-9",showIcon:"",placeholder:"Fecha fin",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])])])]),a(Oe,{value:ee.value,"onUpdate:value":e[4]||(e[4]=i=>ee.value=i),class:"bg-white rounded-lg shadow overflow-hidden"},{default:p(()=>[a(A,{class:"flex flex-wrap justify-start overflow-x-auto scrollbar-thin"},{default:p(()=>[(D(),R(oe,null,he($,(i,E)=>a(f,{key:i.value,value:E,class:"flex items-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-medium whitespace-nowrap min-w-0"},{default:p(()=>[a(r(m),{icon:i.icon,class:"h-3 sm:h-4 flex-shrink-0"},null,8,["icon"]),s("span",hs,o(i.label),1),s("span",ws,o(i.label.substring(0,4)),1),s("span",_s,o(x.value.filter(l=>l.estado===i.value).length),1)]),_:2},1032,["value"])),64))]),_:1}),a(te,null,{default:p(()=>[(D(),R(oe,null,he($,(i,E)=>a(j,{key:i.value,value:E},{default:p(()=>[a(M,{value:Ae.value,loading:L.value,paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} reservas",responsiveLayout:"scroll",class:"mt-2 sm:mt-4 overflow-x-auto",pt:{root:{class:"text-xs sm:text-sm"},wrapper:{class:"text-xs sm:text-sm overflow-x-auto"},table:{class:"text-xs sm:text-sm min-w-full"},thead:{class:"text-xs sm:text-sm"},headerRow:{class:"text-xs sm:text-sm"},headerCell:{class:"text-xs sm:text-sm font-medium py-2 sm:py-3 px-1 sm:px-2"},tbody:{class:"text-xs sm:text-sm"},bodyRow:{class:"text-xs sm:text-sm hover:bg-gray-50 transition-colors duration-200"},bodyCell:{class:"py-2 sm:py-3 px-1 sm:px-2 text-xs sm:text-sm"}}},{empty:p(()=>[s("div",As,[a(r(m),{icon:r(_e),class:"text-4xl text-gray-400 mb-4"},null,8,["icon"]),s("p",Rs,"No hay reservas "+o(i.label.toLowerCase()),1),s("p",Ds,o(i.value==="PENDIENTE"?"Las nuevas reservas aparecer√°n aqu√≠":"No se encontraron registros"),1)])]),loading:p(()=>e[28]||(e[28]=[s("div",{class:"text-center py-12"},[s("i",{class:"pi pi-spin pi-spinner text-3xl text-blue-500 mb-4"}),s("p",{class:"text-gray-500 text-lg"},"Cargando reservas...")],-1)])),default:p(()=>[a(C,{field:"fecha_reserva",header:"Fecha",sortable:"",class:"w-16 sm:w-20 lg:w-24 min-w-14"},{body:p(l=>[s("div",Cs,[s("div",ks,o(se(l.data.fecha_reserva)),1),s("div",Es,o(new Date(l.data.fecha_reserva).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})),1)])]),_:1}),a(C,{field:"cliente.nombres",header:"Cliente",sortable:"",class:"w-24 sm:w-32 lg:w-40 min-w-20 hidden sm:table-cell"},{body:p(l=>{var b,h,F,B,W,X,Q,ve,pe,ge,fe,be;return[s("div",Ns,[s("div",Ts,[a(r(m),{icon:r(de),class:"text-blue-600 text-xs sm:text-sm"},null,8,["icon"])]),s("div",zs,[s("div",{class:"font-medium text-gray-900 text-xs sm:text-sm truncate",title:((h=(b=l.data.cliente)==null?void 0:b.user)==null?void 0:h.name)||((F=l.data.cliente)==null?void 0:F.nombres)||"N/A"},o(((W=(B=l.data.cliente)==null?void 0:B.user)==null?void 0:W.name)||((X=l.data.cliente)==null?void 0:X.nombres)||"N/A"),9,Fs),s("div",{class:"text-xs text-gray-500 truncate hidden sm:block",title:((ve=(Q=l.data.cliente)==null?void 0:Q.user)==null?void 0:ve.email)||((pe=l.data.cliente)==null?void 0:pe.correo)||"N/A"},o(((fe=(ge=l.data.cliente)==null?void 0:ge.user)==null?void 0:fe.email)||((be=l.data.cliente)==null?void 0:be.correo)||"N/A"),9,Is)])])]}),_:1}),a(C,{field:"entidad_nombre",header:"Servicio",sortable:"",class:"w-24 sm:w-32 lg:w-48 min-w-20"},{body:p(l=>[s("div",Ls,[s("div",{class:"font-medium text-gray-900 text-xs sm:text-sm truncate",title:l.data.entidad_nombre},o(l.data.entidad_nombre||"N/A"),9,Vs),s("div",Os,o(l.data.tipo||"N/A"),1)])]),_:1}),a(C,{header:"Personas",class:"w-16 sm:w-20 lg:w-24 min-w-14 hidden md:table-cell"},{body:p(l=>[s("div",$s,[s("div",Ss,[a(r(m),{icon:r(de),class:"text-gray-400 text-xs"},null,8,["icon"]),s("span",Ms,o((l.data.mayores_edad||0)+(l.data.menores_edad||0)),1)]),s("div",js,o(l.data.mayores_edad||0)+"A ‚Ä¢ "+o(l.data.menores_edad||0)+"N ",1)])]),_:1}),a(C,{field:"total",header:"Total",sortable:"",class:"w-16 sm:w-20 lg:w-24 min-w-14"},{body:p(l=>[s("div",qs,[s("div",Us,[a(r(m),{icon:r(we),class:"text-xs"},null,8,["icon"]),s("span",Hs,o(Number(l.data.total||0).toFixed(2)),1)])])]),_:1}),a(C,{field:"estado",header:"Estado",class:"w-20 sm:w-24 lg:w-32 min-w-16 hidden lg:table-cell"},{body:p(l=>{var b,h;return[s("span",{class:re([xe(l.data.estado),"px-1 sm:px-2 py-1 rounded-full text-xs font-medium"])},[s("span",Ps,o(((b=$.find(F=>F.value===l.data.estado))==null?void 0:b.label)||l.data.estado),1),s("span",Gs,o((((h=$.find(F=>F.value===l.data.estado))==null?void 0:h.label)||l.data.estado).substring(0,4)),1)],2)]}),_:2},1024),a(C,{header:"Acciones",class:"w-32 sm:w-40 lg:w-56 min-w-28"},{body:p(l=>[s("div",Zs,[Z(l.data).includes("detalles")?(D(),R("button",{key:0,class:"bg-gray-500 hover:bg-gray-600 text-white px-1 sm:px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:b=>Te(l.data),title:"Ver detalles"},[a(r(m),{icon:r(Pe),class:"text-xs"},null,8,["icon"]),e[29]||(e[29]=s("span",{class:"hidden lg:inline"},"Detalles",-1))],8,Bs)):T("",!0),Z(l.data).includes("confirmar")?(D(),R("button",{key:1,class:"bg-green-500 hover:bg-green-600 text-white px-1 sm:px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:b=>Re(l.data),title:"Confirmar reserva"},[a(r(m),{icon:r(ne),class:"text-xs"},null,8,["icon"]),e[30]||(e[30]=s("span",{class:"hidden lg:inline"},"Confirmar",-1))],8,Ws)):T("",!0),Z(l.data).includes("rechazar")?(D(),R("button",{key:2,class:"bg-red-500 hover:bg-red-600 text-white px-1 sm:px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:b=>De(l.data),title:"Rechazar reserva"},[a(r(m),{icon:r(q),class:"text-xs"},null,8,["icon"]),e[31]||(e[31]=s("span",{class:"hidden lg:inline"},"Rechazar",-1))],8,Xs)):T("",!0),Z(l.data).includes("reprogramar")?(D(),R("button",{key:3,class:"bg-blue-500 hover:bg-blue-600 text-white px-1 sm:px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:b=>ke(l.data),title:"Reprogramar reserva"},[a(r(m),{icon:r(J),class:"text-xs"},null,8,["icon"]),e[32]||(e[32]=s("span",{class:"hidden lg:inline"},"Reprogramar",-1))],8,Js)):T("",!0),Z(l.data).includes("finalizar")?(D(),R("button",{key:4,class:"bg-purple-500 hover:bg-purple-600 text-white px-1 sm:px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:b=>Ne(l.data),title:"Finalizar reserva"},[a(r(m),{icon:r(ie),class:"text-xs"},null,8,["icon"]),e[33]||(e[33]=s("span",{class:"hidden lg:inline"},"Finalizar",-1))],8,Ks)):T("",!0)])]),_:1})]),_:2},1032,["value","loading"])]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["value"]),a(ae,{visible:K.value,"onUpdate:visible":e[6]||(e[6]=i=>K.value=i),modal:"",header:"Detalles de la Reserva",style:{width:"95vw",maxWidth:"800px"},closable:!1,draggable:!1,pt:{root:"rounded-lg",header:"text-sm sm:text-base lg:text-lg p-3 sm:p-4",content:"p-2 sm:p-4 lg:p-6 max-h-[80vh] overflow-y-auto"}},{footer:p(()=>[s("div",_t,[s("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-4 sm:px-6 py-2 rounded transition-colors flex items-center gap-2 text-sm sm:text-base",onClick:e[5]||(e[5]=i=>K.value=!1)},[a(r(m),{icon:r(q),class:"h-3 sm:h-4"},null,8,["icon"]),e[48]||(e[48]=_(" Cerrar "))])])]),default:p(()=>{var i,E,l,b,h,F,B,W,X;return[n.value?(D(),R("div",Qs,[s("div",Ys,[s("h4",et,[a(r(m),{icon:r(de),class:"text-blue-600 text-sm sm:text-base"},null,8,["icon"]),e[34]||(e[34]=_(" Informaci√≥n del Cliente "))]),s("div",st,[s("div",tt,[e[35]||(e[35]=s("span",{class:"font-medium text-gray-700"},"Nombre:",-1)),s("span",at,o(((E=(i=n.value.cliente)==null?void 0:i.user)==null?void 0:E.name)||((l=n.value.cliente)==null?void 0:l.nombres)||"N/A"),1)]),s("div",lt,[e[36]||(e[36]=s("span",{class:"font-medium text-gray-700"},"Email:",-1)),s("span",ot,o(((h=(b=n.value.cliente)==null?void 0:b.user)==null?void 0:h.email)||((F=n.value.cliente)==null?void 0:F.correo)||"N/A"),1)]),s("div",null,[e[37]||(e[37]=s("span",{class:"font-medium text-gray-700"},"Tel√©fono:",-1)),s("span",rt,o(((B=n.value.cliente)==null?void 0:B.telefono)||"N/A"),1)]),s("div",null,[e[38]||(e[38]=s("span",{class:"font-medium text-gray-700"},"Documento:",-1)),s("span",nt,o(((W=n.value.cliente)==null?void 0:W.numero_documento)||"N/A"),1)])])]),s("div",it,[s("h4",dt,[a(r(m),{icon:r(J),class:"text-gray-600 text-sm sm:text-base"},null,8,["icon"]),e[39]||(e[39]=_(" Informaci√≥n del Servicio "))]),s("div",ut,[s("div",mt,[e[40]||(e[40]=s("span",{class:"font-medium text-gray-700"},"Servicio:",-1)),s("span",ct,o(n.value.entidad_nombre||"N/A"),1)]),s("div",null,[e[41]||(e[41]=s("span",{class:"font-medium text-gray-700"},"Tipo:",-1)),s("span",xt,o(n.value.tipo||"N/A"),1)]),s("div",null,[e[42]||(e[42]=s("span",{class:"font-medium text-gray-700"},"Fecha:",-1)),s("span",vt,o(Fe(n.value.fecha_reserva)),1)]),s("div",null,[e[43]||(e[43]=s("span",{class:"font-medium text-gray-700"},"Estado:",-1)),s("span",{class:re([xe(n.value.estado),"ml-2 px-2 py-1 rounded-full text-xs font-medium"])},o(((X=$.find(Q=>Q.value===n.value.estado))==null?void 0:X.label)||n.value.estado),3)])])]),s("div",pt,[s("h4",gt,[a(r(m),{icon:r(we),class:"text-green-600 text-sm sm:text-base"},null,8,["icon"]),e[44]||(e[44]=_(" Detalles de la Reserva "))]),s("div",ft,[s("div",null,[e[45]||(e[45]=s("span",{class:"font-medium text-gray-700"},"Adultos:",-1)),s("span",bt,o(n.value.mayores_edad||0),1)]),s("div",null,[e[46]||(e[46]=s("span",{class:"font-medium text-gray-700"},"Ni√±os:",-1)),s("span",yt,o(n.value.menores_edad||0),1)]),s("div",ht,[e[47]||(e[47]=s("span",{class:"font-medium text-gray-700"},"Total:",-1)),s("span",wt,"$"+o(Number(n.value.total||0).toFixed(2)),1)])])])])):T("",!0)]}),_:1},8,["visible"]),a(ae,{visible:H.value,"onUpdate:visible":e[9]||(e[9]=i=>H.value=i),modal:"",header:"Rechazar Reserva",style:{width:"95vw",maxWidth:"600px"},closable:!1,draggable:!1,pt:{root:"rounded-lg",header:"text-sm sm:text-base lg:text-lg p-3 sm:p-4",content:"p-2 sm:p-4 lg:p-6"}},{footer:p(()=>[s("div",Tt,[s("button",{class:"bg-gray-500 hover:bg-gray-600 text-white px-4 sm:px-6 py-2 rounded transition-colors flex items-center justify-center gap-2 text-sm sm:text-base order-2 sm:order-1",onClick:e[8]||(e[8]=i=>H.value=!1)},[a(r(m),{icon:r(q),class:"h-3 sm:h-4"},null,8,["icon"]),e[55]||(e[55]=_(" Cancelar "))]),s("button",{class:"bg-red-500 hover:bg-red-600 text-white px-4 sm:px-6 py-2 rounded transition-colors flex items-center justify-center gap-2 text-sm sm:text-base order-1 sm:order-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:Ce,disabled:!O.value.trim()},[a(r(m),{icon:r(ne),class:"h-3 sm:h-4"},null,8,["icon"]),e[56]||(e[56]=_(" Rechazar Reserva "))],8,zt)])]),default:p(()=>{var i,E,l;return[s("div",At,[n.value?(D(),R("div",Rt,[s("div",Dt,[a(r(m),{icon:r(Ge),class:"text-red-600 text-base sm:text-lg"},null,8,["icon"]),e[49]||(e[49]=s("h4",{class:"font-medium text-red-800 text-sm sm:text-base"},"Confirmar Rechazo",-1))]),s("div",Ct,[s("p",kt,[e[50]||(e[50]=s("strong",null,"Cliente:",-1)),_(" "+o(((E=(i=n.value.cliente)==null?void 0:i.user)==null?void 0:E.name)||((l=n.value.cliente)==null?void 0:l.nombres)||"N/A"),1)]),s("p",Et,[e[51]||(e[51]=s("strong",null,"Servicio:",-1)),_(" "+o(n.value.entidad_nombre),1)]),s("p",null,[e[52]||(e[52]=s("strong",null,"Fecha:",-1)),_(" "+o(se(n.value.fecha_reserva)),1)]),s("p",null,[e[53]||(e[53]=s("strong",null,"Total:",-1)),_(" $"+o(Number(n.value.total||0).toFixed(2)),1)])])])):T("",!0),s("div",null,[e[54]||(e[54]=s("label",{class:"block text-xs sm:text-sm font-medium text-gray-700 mb-2"},[_(" Motivo del rechazo "),s("span",{class:"text-red-500"},"*")],-1)),a(le,{modelValue:O.value,"onUpdate:modelValue":e[7]||(e[7]=b=>O.value=b),placeholder:"Especifica el motivo por el cual se rechaza esta reserva...",rows:"4",class:"w-full text-xs sm:text-sm",maxlength:"500",pt:{root:"w-full",textarea:"text-xs sm:text-sm p-2 sm:p-3"}},null,8,["modelValue"]),s("small",Nt,o(O.value.length)+"/500 caracteres ",1)])])]}),_:1},8,["visible"]),a(ae,{visible:U.value,"onUpdate:visible":e[14]||(e[14]=i=>U.value=i),modal:"",header:"Reprogramar Reserva",style:{width:"95vw",maxWidth:"800px"},pt:{root:"rounded-lg",header:"text-sm sm:text-base lg:text-lg p-3 sm:p-4",content:"p-2 sm:p-4 lg:p-6 max-h-[80vh] overflow-y-auto"},closable:!1,draggable:!1},{footer:p(()=>[s("div",Zt,[s("button",{class:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded transition-colors flex items-center gap-2",onClick:e[13]||(e[13]=i=>U.value=!1)},[a(r(m),{icon:r(q),class:"h-4"},null,8,["icon"]),e[69]||(e[69]=_(" Cancelar "))]),s("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded transition-colors flex items-center gap-2",onClick:Ee,disabled:!z.value||!V.value.trim()},[a(r(m),{icon:r(J),class:"h-4"},null,8,["icon"]),e[70]||(e[70]=_(" Reprogramar "))],8,Bt)])]),default:p(()=>{var i,E,l,b;return[s("div",Ft,[n.value?(D(),R("div",It,[s("div",Lt,[a(r(m),{icon:r(J),class:"text-blue-600 text-lg"},null,8,["icon"]),e[57]||(e[57]=s("h4",{class:"font-medium text-blue-800"},"Informaci√≥n de la Reserva",-1))]),s("div",Vt,[s("div",null,[e[58]||(e[58]=s("span",{class:"font-medium text-gray-700"},"Cliente:",-1)),s("span",Ot,o(((E=(i=n.value.cliente)==null?void 0:i.user)==null?void 0:E.name)||((l=n.value.cliente)==null?void 0:l.nombres)||"N/A"),1)]),s("div",null,[e[59]||(e[59]=s("span",{class:"font-medium text-gray-700"},"Servicio:",-1)),s("span",$t,o(n.value.entidad_nombre),1)]),s("div",null,[e[60]||(e[60]=s("span",{class:"font-medium text-gray-700"},"Fecha actual:",-1)),s("span",St,o(se(n.value.fecha_reserva)),1)]),s("div",null,[e[61]||(e[61]=s("span",{class:"font-medium text-gray-700"},"Total:",-1)),s("span",Mt,"$"+o(Number(n.value.total||0).toFixed(2)),1)])])])):T("",!0),N.value?(D(),R("div",jt,[s("div",qt,[a(r(m),{icon:r(_e),class:"text-purple-600 text-lg"},null,8,["icon"]),e[62]||(e[62]=s("h4",{class:"font-medium text-purple-800"},"Tour Asociado",-1))]),s("div",Ut,[s("p",null,[e[63]||(e[63]=s("strong",null,"Nombre:",-1)),_(" "+o(N.value.nombre),1)]),s("p",null,[e[64]||(e[64]=s("strong",null,"Estado actual:",-1)),s("span",{class:re([ze(N.value.estado),"px-2 py-1 rounded-full text-xs font-medium ml-1"])},o(((b=me.find(h=>h.value===N.value.estado))==null?void 0:b.label)||N.value.estado),3)]),e[65]||(e[65]=s("p",{class:"text-purple-600 text-xs mt-2"},' ‚ÑπÔ∏è Al reprogramar esta reserva, el tour tambi√©n ser√° marcado como "REPROGRAMADO" ',-1))])])):T("",!0),s("div",Ht,[s("div",null,[e[66]||(e[66]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[_(" Nueva fecha "),s("span",{class:"text-red-500"},"*")],-1)),a(c,{modelValue:z.value,"onUpdate:modelValue":e[10]||(e[10]=h=>z.value=h),showTime:"",dateFormat:"dd/mm/yy",class:"w-full",showIcon:"",placeholder:"Seleccione la nueva fecha y hora",minDate:Le()},null,8,["modelValue","minDate"])])]),s("div",null,[e[67]||(e[67]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[_(" Motivo de la reprogramaci√≥n "),s("span",{class:"text-red-500"},"*")],-1)),a(le,{modelValue:V.value,"onUpdate:modelValue":e[11]||(e[11]=h=>V.value=h),placeholder:"Especifica el motivo de la reprogramaci√≥n...",rows:"3",class:"w-full",maxlength:"255"},null,8,["modelValue"]),s("small",Pt,o(V.value.length)+"/255 caracteres ",1)]),s("div",null,[e[68]||(e[68]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Observaciones adicionales (opcional) ",-1)),a(le,{modelValue:S.value,"onUpdate:modelValue":e[12]||(e[12]=h=>S.value=h),placeholder:"Informaci√≥n adicional sobre la reprogramaci√≥n...",rows:"2",class:"w-full",maxlength:"500"},null,8,["modelValue"]),s("small",Gt,o(S.value.length)+"/500 caracteres ",1)])])]}),_:1},8,["visible"])])]),_:1})],64)}}};export{ea as default};
