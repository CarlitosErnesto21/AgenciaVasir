import{q as Z,r as p,s as G,E as V,i as F,y as N,Z as H,p as D,o,w as b,a as P,b as t,j as _,M as E,t as l,c as r,h as J,f as w,A as k,B as C}from"./app-WKwrJkJC.js";import K from"./Catalogo-3xOAUxvL.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo-DN1bLr27.js";import"./index-Cz7jU3Cp.js";const W={class:"p-4 bg-gray-50 min-h-screen"},X={class:"mb-6"},Y={class:"relative"},ee={class:"flex gap-6"},te={class:"w-80 bg-white rounded-lg shadow-lg p-6 h-fit border border-gray-200"},se={class:"mb-4 p-3 bg-gray-50 rounded-lg border"},ae={class:"text-xs text-gray-600 space-y-1"},oe={class:"mb-6"},re={class:"flex gap-2 items-center mb-3"},le={class:"flex-1"},ie=["placeholder","max"],ne={class:"flex-1"},de=["placeholder","max"],ce={class:"font-semibold text-gray-700 mb-3"},ue={key:0,class:"text-xs text-gray-500"},ge={key:0,class:"space-y-2"},me={key:1,class:"space-y-2"},pe=["checked","onChange"],ve={class:"text-sm text-gray-700 flex-1"},be={class:"text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded-full"},xe={key:0,class:"text-center py-4 text-gray-500 text-sm"},he={class:"flex-1"},fe={class:"mb-4 flex justify-between items-center"},ye={class:"text-sm text-gray-600 bg-white rounded-lg px-4 py-2 shadow-sm border border-gray-200"},_e={key:0,class:"text-xs text-gray-500"},we={class:"bg-blue-100 text-blue-800 px-2 py-1 rounded"},ke={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},Ce={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},$e={class:"w-full flex justify-center items-center h-32 bg-gradient-to-br from-gray-100 to-gray-200 rounded-t-lg overflow-hidden group relative"},Fe=["src","alt","onError"],Ne={class:"absolute top-2 right-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-medium shadow-sm"},Pe={class:"absolute top-2 left-2 bg-green-600 text-white px-2 py-1 rounded text-xs font-medium shadow-sm"},Ee={class:"text-base font-semibold text-gray-800 leading-tight line-clamp-2"},Me={class:"flex-grow"},je={class:"text-gray-600 text-xs mb-3 line-clamp-2"},Be={class:"text-lg font-bold text-green-600 mb-3"},Le={class:"flex gap-2 mt-auto"},Te={key:2,class:"text-center py-12 bg-white rounded-lg shadow-sm border border-gray-200"},Ve={class:"text-gray-500 mb-4"},De={key:0},Se={key:1},ze={__name:"Tienda",setup(Ae){const u=Z(),g=p([]),$=p([]),x=p(!0),h=p(!0),i=p([]),d=p(""),c=p(""),m=p("");G(async()=>{await Promise.all([M(),j()])});const M=async()=>{try{x.value=!0;const s=await V.get("/api/productos");g.value=(s.data.data||s.data||[]).map(e=>{var n;return{id:e.id,nombre:e.nombre,descripcion:e.descripcion,precio:parseFloat(e.precio),stock_actual:e.stock_actual,categoria:((n=e.categoria)==null?void 0:n.nombre)||"Sin categoría",categoria_id:e.categoria_id,imagen:e.imagenes&&e.imagenes.length>0?`/images/productos/${e.imagenes[0].nombre}`:"/images/productos/default.jpg",imagenes:e.imagenes||[]}}).filter(e=>e.stock_actual>0),console.log("Productos cargados:",g.value.length)}catch(s){console.error("Error al cargar productos:",s),u.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los productos",life:3e3})}finally{x.value=!1}},j=async()=>{try{h.value=!0;const s=await V.get("/api/categorias-productos");$.value=(s.data.data||s.data||[]).map(e=>({id:e.id,nombre:e.nombre,cantidad:0})),console.log("Categorías cargadas:",$.value.length)}catch(s){console.error("Error al cargar categorías:",s),u.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las categorías",life:3e3})}finally{h.value=!1}},B=F(()=>$.value.map(s=>({...s,cantidad:g.value.filter(e=>e.categoria===s.nombre).length})).filter(s=>s.cantidad>0)),f=F(()=>{let s=[...g.value];if(m.value){const e=m.value.toLowerCase();s=s.filter(n=>n.nombre.toLowerCase().includes(e)||n.descripcion.toLowerCase().includes(e)||n.categoria.toLowerCase().includes(e))}return i.value.length>0&&(s=s.filter(e=>i.value.includes(e.categoria))),d.value&&!isNaN(d.value)&&(s=s.filter(e=>e.precio>=parseFloat(d.value))),c.value&&!isNaN(c.value)&&(s=s.filter(e=>e.precio<=parseFloat(c.value))),s}),v=F(()=>{if(g.value.length===0)return{min:0,max:0,promedio:0};const s=g.value.map(e=>e.precio);return{min:Math.min(...s),max:Math.max(...s),promedio:s.reduce((e,n)=>e+n,0)/s.length}}),S=s=>{const e=i.value.indexOf(s);e>-1?i.value.splice(e,1):i.value.push(s)},L=()=>{i.value=[],d.value="",c.value="",m.value="",u.add({severity:"info",summary:"Filtros limpiados",detail:"Se han removido todos los filtros",life:2e3})},z=()=>{u.add({severity:"success",summary:"Filtros aplicados",detail:`Mostrando ${f.value.length} productos`,life:2e3})},A=s=>{if(s.stock_actual<=0){u.add({severity:"warn",summary:"Sin stock",detail:`El producto "${s.nombre}" no está disponible`,life:3e3});return}u.add({severity:"success",summary:"¡Agregado al carrito!",detail:`"${s.nombre}" se agregó al carrito`,life:3e3}),console.log("Producto agregado al carrito:",s)},I=s=>{u.add({severity:"info",summary:"Detalles del producto",detail:`${s.nombre} - $${s.precio.toFixed(2)} - ${s.categoria} - Stock: ${s.stock_actual}`,life:5e3})},U=(s,e)=>{s.target.src=`https://via.placeholder.com/300x200/ef4444/ffffff?text=${encodeURIComponent(e.nombre.substring(0,15))}`},R=async()=>{await Promise.all([M(),j()]),u.add({severity:"success",summary:"Datos actualizados",detail:"La información se ha actualizado correctamente",life:2e3})};return(s,e)=>{const n=N("Toast"),T=N("Button"),q=N("Card"),O=H("tooltip");return o(),D(K,null,{default:b(()=>[P(n,{class:"z-[9999]"}),t("div",W,[e[14]||(e[14]=t("div",{class:"mb-4"},[t("h1",{class:"text-2xl font-bold mb-2 text-red-700"},"🛍️ Productos"),t("p",{class:"text-gray-600"},"Encuentra los mejores productos para tu viaje")],-1)),t("div",X,[t("div",Y,[_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a),type:"text",placeholder:"🔍 Buscar productos por nombre, descripción o categoría...",class:"w-full px-4 py-3 pl-12 border border-gray-300 rounded-lg focus:border-red-500 focus:outline-none bg-white shadow-sm"},null,512),[[E,m.value]]),e[3]||(e[3]=t("i",{class:"pi pi-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"},null,-1))])]),t("div",ee,[t("div",te,[t("div",{class:"flex justify-between items-center mb-4"},[e[4]||(e[4]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Filtros",-1)),t("button",{onClick:L,class:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition shadow-sm"}," Limpiar filtros ")]),t("div",se,[e[5]||(e[5]=t("h5",{class:"text-sm font-medium text-gray-700 mb-2"},"Rango de precios",-1)),t("div",ae,[t("div",null,"Mínimo: $"+l(v.value.min.toFixed(2)),1),t("div",null,"Máximo: $"+l(v.value.max.toFixed(2)),1),t("div",null,"Promedio: $"+l(v.value.promedio.toFixed(2)),1)])]),t("div",oe,[e[8]||(e[8]=t("h4",{class:"font-semibold text-gray-700 mb-3"},"Filtrar por precio",-1)),t("div",re,[t("div",le,[e[6]||(e[6]=t("label",{class:"text-sm text-gray-600"},"Min",-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>d.value=a),type:"number",placeholder:`$${v.value.min.toFixed(2)}`,class:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:border-red-500 focus:outline-none bg-gray-50 focus:bg-white [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"0",step:"0.01",max:v.value.max},null,8,ie),[[E,d.value]])]),t("div",ne,[e[7]||(e[7]=t("label",{class:"text-sm text-gray-600"},"Max",-1)),_(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),type:"number",placeholder:`$${v.value.max.toFixed(2)}`,class:"w-full border border-gray-300 rounded px-2 py-1 text-sm focus:border-red-500 focus:outline-none bg-gray-50 focus:bg-white [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"0",step:"0.01",max:v.value.max},null,8,de),[[E,c.value]])]),t("button",{onClick:z,class:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition mt-5 shadow-sm"}," Aplicar ")])]),t("div",null,[t("h4",ce,[e[9]||(e[9]=J(" Categorías ")),h.value?(o(),r("span",ue,"(cargando...)")):w("",!0)]),h.value?(o(),r("div",ge,[(o(),r(k,null,C(3,a=>t("div",{key:a,class:"animate-pulse"},e[10]||(e[10]=[t("div",{class:"h-8 bg-gray-200 rounded"},null,-1)]))),64))])):(o(),r("div",me,[(o(!0),r(k,null,C(B.value,a=>(o(),r("label",{key:a.id,class:"flex items-center cursor-pointer hover:bg-gray-100 p-2 rounded transition"},[t("input",{type:"checkbox",checked:i.value.includes(a.nombre),onChange:y=>S(a.nombre),class:"mr-3 accent-red-600"},null,40,pe),t("span",ve,l(a.nombre),1),t("span",be,l(a.cantidad),1)]))),128)),B.value.length===0?(o(),r("div",xe," No hay categorías disponibles ")):w("",!0)]))])]),t("div",he,[t("div",fe,[t("div",ye," Mostrando "+l(f.value.length)+" de "+l(g.value.length)+" productos ",1),i.value.length>0||d.value||c.value||m.value?(o(),r("div",_e,[t("span",we," Filtros activos: "+l([i.value.length>0?`${i.value.length} categorías`:"",d.value?"precio mín.":"",c.value?"precio máx.":"",m.value?"búsqueda":""].filter(Boolean).join(", ")),1)])):w("",!0)]),x.value?(o(),r("div",ke,[(o(),r(k,null,C(8,a=>t("div",{key:a,class:"animate-pulse"},e[11]||(e[11]=[t("div",{class:"bg-white rounded-lg border border-gray-300 p-4"},[t("div",{class:"h-32 bg-gray-200 rounded mb-4"}),t("div",{class:"h-4 bg-gray-200 rounded mb-2"}),t("div",{class:"h-3 bg-gray-200 rounded mb-2"}),t("div",{class:"h-6 bg-gray-200 rounded mb-4"}),t("div",{class:"h-8 bg-gray-200 rounded"})],-1)]))),64))])):(o(),r("div",Ce,[(o(!0),r(k,null,C(f.value,a=>(o(),D(q,{key:a.id,class:"border border-gray-300 bg-white shadow-md hover:shadow-lg transition-all duration-300 flex flex-col h-full transform hover:-translate-y-1"},{header:b(()=>[t("div",$e,[t("img",{src:a.imagen,alt:a.nombre,class:"object-cover h-full w-full group-hover:scale-110 transition-transform duration-500",onError:y=>U(y,a)},null,40,Fe),t("div",Ne,l(a.categoria),1),t("div",Pe," Stock: "+l(a.stock_actual),1)])]),title:b(()=>[t("span",Ee,l(a.nombre),1)]),content:b(()=>[t("div",Me,[t("div",je,l(a.descripcion),1),t("div",Be," $"+l(a.precio.toFixed(2)),1)])]),footer:b(()=>[t("div",Le,[P(T,{label:"Agregar",onClick:y=>A(a),disabled:a.stock_actual<=0,class:"!bg-red-600 !border-none !px-3 !py-1 !text-white !text-xs font-medium rounded hover:!bg-red-700 transition-all flex-1 shadow-sm disabled:!bg-gray-400",size:"small"},null,8,["onClick","disabled"]),_(P(T,{icon:"pi pi-eye",onClick:y=>I(a),class:"!bg-blue-600 !border-none !text-white hover:!bg-blue-700 transition-all !w-8 !h-8 !p-0 shadow-sm",size:"small"},null,8,["onClick"]),[[O,"Ver detalles",void 0,{top:!0}]])])]),_:2},1024))),128))])),!x.value&&f.value.length===0?(o(),r("div",Te,[e[12]||(e[12]=t("div",{class:"text-gray-400 text-6xl mb-4"},"🔍",-1)),e[13]||(e[13]=t("h3",{class:"text-xl font-semibold text-gray-700 mb-2"},"No se encontraron productos",-1)),t("p",Ve,[g.value.length===0?(o(),r("span",De," No hay productos disponibles en este momento ")):(o(),r("span",Se," Intenta ajustar los filtros para ver más resultados "))]),i.value.length>0||d.value||c.value||m.value?(o(),r("button",{key:0,onClick:L,class:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition shadow-sm"}," Limpiar filtros ")):(o(),r("button",{key:1,onClick:R,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition shadow-sm"}," Recargar productos "))])):w("",!0)])])])]),_:1})}}},Ze=Q(ze,[["__scopeId","data-v-8b55fa4c"]]);export{Ze as default};
