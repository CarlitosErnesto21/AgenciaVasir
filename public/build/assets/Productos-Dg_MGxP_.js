import{N as T,r as u,E as W,w as wa,n as Z,o as _a,k as $,h as oe,d as v,x as k,p as c,e as l,$ as i,a0 as ka,c as g,q as D,a2 as Ca,y as w,t as b,j as _,v as Ie,F as be,l as ye,a7 as Le,A as Ue,D as Da}from"./vendor-gbh1WW5n.js";import{A as Pa}from"./AuthenticatedLayout-CSuYxj7F.js";import{z as Ea,A as he,F as x}from"./ui-BrU4k96Z.js";import{n as xe,c as N,y as Aa,k as re,z as Sa,l as Va,m as Ta,o as Na,a as Me,p as ze}from"./index-B6nVaz6S.js";import Ia from"./Modales-CBT7-lQG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ActualizarStock-DI4T7Or5.js";const La={class:"container mx-auto px-4 py-6"},Ua={class:"bg-white rounded-lg shadow-md"},Ma={class:"flex flex-col sm:flex-row lg:justify-between lg:items-center gap-4 p-4"},za={class:"w-full"},Oa={class:"bg-blue-50 border-l-4 border-blue-400 p-3 mt-3 rounded-r-md"},Fa={class:"text-blue-700 text-sm"},$a={class:"flex items-center gap-2 w-full justify-center lg:w-auto lg:justify-end"},Ba={class:"block sm:hidden"},Ra={class:"hidden sm:block"},ja={key:0,class:"flex flex-col items-center justify-center py-12 space-y-4 bg-white rounded-lg shadow-md"},Ka={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},Ga={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},qa={class:"flex items-center gap-3"},Wa={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Za=["disabled"],Ha=["disabled"],Ja={class:"space-y-3"},Ya={class:"relative"},Qa={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-2 gap-3"},Xa=["value"],et=["value"],at={class:"px-1 mt-3"},tt={class:"text-blue-600 text-xs font-medium flex items-center gap-1"},lt=["title"],st=["title"],ot={class:"text-sm leading-relaxed"},rt={class:"text-sm font-medium leading-relaxed"},nt={class:"flex gap-2 justify-center items-center"},it=["onClick"],dt=["onClick"],ut=["onClick"],ct={class:"flex flex-col items-center justify-center py-12 space-y-4"},mt={class:"text-center"},vt={class:"space-y-4"},pt={class:"w-full flex flex-col"},gt={class:"flex items-center gap-4"},ft={key:0,class:"text-red-500 ml-28"},bt={key:1,class:"text-red-500 ml-28"},yt={key:2,class:"text-orange-500 ml-28"},ht={key:3,class:"text-red-500 ml-28"},xt={class:"w-full flex flex-col"},wt={class:"flex items-start gap-4"},_t={key:0,class:"text-red-500 ml-28"},kt={key:1,class:"text-orange-500 ml-28"},Ct={key:2,class:"text-red-500 ml-28"},Dt={class:"w-full flex flex-col"},Pt={class:"flex items-center gap-4 sm:gap-5"},Et={class:"flex items-center gap-2 flex-1"},At={key:0,class:"text-red-500 ml-28"},St={class:"w-full flex flex-col"},Vt={class:"flex items-center gap-12 sm:gap-11"},Tt={class:"w-full relative"},Nt={key:0,class:"text-red-500 ml-28"},It={class:"flex gap-4"},Lt={class:"flex-1"},Ut={key:0,class:"text-red-500 font-bold"},Mt={key:1,class:"text-gray-400 text-xs"},zt={key:0,class:"text-blue-600 text-xs mt-1 block"},Ot={class:"flex-1"},Ft={key:0,class:"text-red-500 font-bold"},$t={key:1,class:"text-gray-400 text-xs"},Bt={key:0,class:"text-blue-600 text-xs mt-1 block"},Rt={class:"w-full flex flex-col"},jt={class:"flex items-center gap-4"},Kt={class:"flex-1"},Gt={class:"flex items-center gap-3 mb-2"},qt=["disabled"],Wt={class:"flex items-center gap-2"},Zt={key:0,class:"text-red-500 ml-28"},Ht={class:"grid grid-cols-3 ml-2 sm:ml-5 gap-y-2"},Jt=["src"],Yt=["onClick"],Qt={class:"flex justify-center gap-4 w-full mt-6"},Xt=["disabled"],el={key:0},al={key:1},tl=["disabled"],ll={class:"space-y-4"},sl={class:"w-full flex flex-col"},ol={class:"flex items-center gap-4"},rl={key:0,class:"text-gray-500 ml-28 text-xs"},nl={key:1,class:"text-red-500 ml-28"},il={key:2,class:"text-orange-500 ml-28"},dl={key:3,class:"text-red-500 ml-28"},ul={class:"flex justify-center gap-4 w-full mt-6"},cl=["disabled"],ml={key:0},vl={key:1},pl=["disabled"],ee="/api/productos",we="/storage/productos/",Cl={__name:"Productos",setup(gl){T.defaults.withCredentials=!0;const m=Ea(),I=u([]),t=u({id:null,nombre:"",descripcion:"",precio:null,stock_actual:null,stock_minimo:null,categoria_id:null}),y=u([]),H=u([]),ne=u([]),J=u([]),L=u(!1),B=u(!1),ae=u(!1),Y=u(!1),P=u(!1),U=u(!1),S=u(null),Q=u(!1),ie=u(!1),E=u(null),te=u(!1),R=u(!1),de=u(!1),V=u(!1),j=u(!1),K=u(!1),M=u(!1),ue=u(!0),G=u([]),z=u(""),O=u(""),le=u(!1),f=u({nombre:""}),F=u(!1),A=u({global:{value:null,matchMode:he.CONTAINS},categoria:{value:null,matchMode:he.EQUALS},estado:{value:null,matchMode:he.EQUALS}}),Oe=u([{label:"Disponible",value:"DISPONIBLE"},{label:"Stock Bajo",value:"STOCK_BAJO"},{label:"Agotado",value:"AGOTADO"}]),ce=u(10),Fe=u([5,10,20,50]),X=u("Guardar"),me=u(0),_e=u(null),ve=W(()=>{let a=I.value;if(A.value.global.value){const e=A.value.global.value.toLowerCase();a=a.filter(s=>{var r;return s.nombre.toLowerCase().includes(e)||s.descripcion&&s.descripcion.toLowerCase().includes(e)||((r=s.categoria)==null?void 0:r.nombre)&&s.categoria.nombre.toLowerCase().includes(e)})}return A.value.categoria.value&&(a=a.filter(e=>e.categoria_id==A.value.categoria.value)),A.value.estado.value&&(a=a.filter(e=>pe(e).value===A.value.estado.value)),a}),ke=W(()=>y.value.length<5);W(()=>G.value.map(a=>({...a,nombreTruncado:a.nombre.length>20?a.nombre.substring(0,17)+"...":a.nombre})));const $e=W(()=>j.value?"Cargando...":K.value?"Abriendo...":ke.value?"Seleccionar":"Límite alcanzado"),pe=a=>a.stock_actual<=0?{label:"Agotado",value:"AGOTADO",class:"bg-red-100 text-red-800"}:a.stock_actual<=a.stock_minimo?{label:"Stock Bajo",value:"STOCK_BAJO",class:"bg-yellow-100 text-yellow-800"}:{label:"Disponible",value:"DISPONIBLE",class:"bg-green-100 text-green-800"};wa([t,y,J],()=>{S.value&&L.value&&Z(()=>{const a={...t.value,imagenes_actuales:[...y.value]},e=JSON.stringify(a)!==JSON.stringify({...S.value,imagenes_actuales:S.value.imagenes_originales})||J.value.length>0,s=!S.value.id,r=t.value.nombre||t.value.descripcion||t.value.precio||t.value.categoria_id||y.value.length>0;U.value=e||s&&r})},{deep:!0,flush:"post"});function se(){t.value={id:null,nombre:"",descripcion:"",precio:null,stock_actual:null,stock_minimo:null,categoria_id:null},y.value=[],H.value=[],J.value=[],P.value=!1}const Ce=()=>{Z(()=>{setTimeout(()=>{document.querySelectorAll(".p-select").forEach(e=>{const s=e.querySelector(".p-select-label, .p-placeholder");s&&(s.style.overflow="hidden",s.style.textOverflow="ellipsis",s.style.whiteSpace="nowrap",s.style.maxWidth="calc(100% - 2.5rem)",s.style.display="block")})},100)})};_a(()=>{Be(),De(),Ce()});const ge=async()=>{try{const a=await T.get(ee);I.value=(a.data.data||a.data||[]).map(e=>({...e,imagenes:(e.imagenes||[]).map(s=>typeof s=="string"?s:s.nombre)})).sort((e,s)=>{const r=new Date(e.created_at);return new Date(s.created_at)-r})}catch{m.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los productos.",life:4e3})}},Be=async()=>{ue.value=!0;try{const a=await T.get(ee);I.value=(a.data.data||a.data||[]).map(e=>({...e,imagenes:(e.imagenes||[]).map(s=>typeof s=="string"?s:s.nombre)})).sort((e,s)=>{const r=new Date(e.created_at);return new Date(s.created_at)-r})}catch{m.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los productos.",life:4e3})}finally{ue.value=!1}},De=async()=>{try{const a=await T.get("/api/categorias-productos");G.value=a.data.data||a.data||[]}catch{G.value=[],m.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las categorías.",life:4e3})}},Re=()=>{A.value.categoria.value=z.value===""?null:z.value},je=()=>{A.value.estado.value=O.value===""?null:O.value},Pe=async()=>{V.value=!0;try{await new Promise(a=>setTimeout(a,300)),z.value="",O.value="",A.value.global.value=null,A.value.categoria.value=null,A.value.estado.value=null,m.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{V.value=!1}},Ke=()=>{R.value=!0},Ee=async()=>{var a,e;if(!f.value.nombre||f.value.nombre.length<3){m.add({severity:"warn",summary:"Validación",detail:"El nombre de la categoría debe tener al menos 3 caracteres.",life:4e3});return}if(f.value.nombre.length>50){m.add({severity:"warn",summary:"Validación",detail:"El nombre de la categoría no puede exceder 50 caracteres.",life:4e3});return}F.value=!0;try{const s=await T.post("/api/categorias-productos",{nombre:f.value.nombre});m.add({severity:"success",summary:"¡Éxito!",detail:"La categoría ha sido creada correctamente.",life:5e3});const r=s.data,n=r.categoria||r.data||r,d=n==null?void 0:n.id;await De(),Ce(),d&&(await Z(),G.value.find(h=>h.id===d)&&(t.value.categoria_id=d)),Ae()}catch(s){console.error("Error al crear categoría:",s),m.add({severity:"error",summary:"Error",detail:((e=(a=s.response)==null?void 0:a.data)==null?void 0:e.message)||"Error al crear la categoría",life:4e3})}finally{F.value=!1}},Ge=a=>{f.value.nombre=a.target.value.toUpperCase()},Ae=()=>{le.value=!1,f.value.nombre=""},qe=(a,e=10)=>!a||a.length<=e?a:a.substring(0,e)+"...",We=W(()=>G.value.map(a=>({...a,nombreTruncado:qe(a.nombre,20),nombre:a.nombre}))),Se=()=>{se(),X.value="Guardar",P.value=!1,L.value=!0,Z(()=>{S.value={...t.value,imagenes_originales:[...y.value]},U.value=!1})},Ze=a=>{se(),P.value=!1,t.value={...a},y.value=(a.imagenes||[]).map(e=>typeof e=="string"?e:e.nombre),U.value=!1,X.value="Actualizar",L.value=!0,Z(()=>{S.value={...t.value,imagenes_originales:[...y.value]},U.value=!1})},He=async()=>{if(P.value=!0,!t.value.nombre||t.value.nombre.length<3){m.add({severity:"warn",summary:"Campos requeridos",detail:"El nombre debe tener al menos 3 caracteres.",life:4e3});return}if(t.value.nombre.length>200){m.add({severity:"error",summary:"Error de validación",detail:"El nombre no puede exceder 200 caracteres.",life:5e3});return}if(!t.value.descripcion||t.value.descripcion.length<10){m.add({severity:"warn",summary:"Campos requeridos",detail:"La descripción debe tener al menos 10 caracteres.",life:4e3});return}if(t.value.descripcion.length>400){m.add({severity:"error",summary:"Error de validación",detail:"La descripción no puede exceder 400 caracteres.",life:5e3});return}if(Ne()){m.add({severity:"warn",summary:"Nombre duplicado",detail:"Ya existe un producto con este nombre. Por favor elige un nombre diferente.",life:5e3});return}if(!t.value.precio||!t.value.categoria_id||y.value.length===0){m.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos.",life:4e3});return}if(!t.value.id&&(t.value.stock_actual===null||t.value.stock_minimo===null)){m.add({severity:"warn",summary:"Campos requeridos",detail:"Para productos nuevos, el stock actual y mínimo son obligatorios.",life:4e3});return}if(t.value.precio<=0||t.value.precio>9999.99){m.add({severity:"warn",summary:"Verificar datos",detail:"Por favor revisa los valores ingresados y corrige cualquier inconsistencia.",life:4e3});return}if(!t.value.id&&(t.value.stock_actual!==null&&t.value.stock_actual<0||t.value.stock_minimo!==null&&t.value.stock_minimo<1)){m.add({severity:"warn",summary:"Verificar datos",detail:"Por favor revisa los valores de stock y corrige cualquier inconsistencia.",life:4e3});return}const a=2*1024*1024;if(H.value.filter(s=>s.size>a).length>0){m.add({severity:"warn",summary:"Verificar archivos",detail:"Por favor revisa el tamaño de las imágenes seleccionadas.",life:4e3});return}try{M.value=!0;const s=new FormData;s.append("nombre",t.value.nombre||""),s.append("descripcion",t.value.descripcion||""),s.append("precio",t.value.precio||""),s.append("categoria_id",t.value.categoria_id||""),t.value.id||(s.append("stock_actual",t.value.stock_actual||"0"),s.append("stock_minimo",t.value.stock_minimo||"1")),H.value.forEach(n=>s.append("imagenes[]",n)),J.value.forEach(n=>{const d=n.includes("/")?n.split("/").pop():n;s.append("removed_images[]",d)});let r;t.value.id?(s.append("_method","PUT"),r=await T.post(`${ee}/${t.value.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}),m.add({severity:"success",summary:"¡Éxito!",detail:"El producto ha sido actualizado correctamente.",life:5e3})):(r=await T.post(ee,s,{headers:{"Content-Type":"multipart/form-data"}}),m.add({severity:"success",summary:"¡Éxito!",detail:"El producto ha sido creado correctamente.",life:5e3})),await ge(),L.value=!1,U.value=!1,S.value=null,se()}catch(s){if(console.error("Error al guardar producto:",s),s.response&&s.response.status===422){const r=s.response.data.errors;let n="Por favor revisa los siguientes errores:";if(r){const d=[];r.nombre&&r.nombre.forEach(p=>{p.includes("Ya existe un producto")?d.push("Ya existe un producto con este nombre."):p.includes("solo puede contener")?d.push("El nombre solo puede contener letras mayúsculas, acentos y espacios."):d.push(p)}),r.descripcion&&r.descripcion.forEach(p=>{p.includes("solo puede contener")?d.push("La descripción solo puede contener letras mayúsculas, acentos, espacios y signos de puntuación básicos."):d.push(p)}),Object.keys(r).forEach(p=>{p!=="nombre"&&p!=="descripcion"&&r[p].forEach(h=>d.push(h))}),d.length>0&&(n=d.join(" "))}m.add({severity:"error",summary:"Error de validación",detail:n,life:8e3})}else m.add({severity:"error",summary:"Error",detail:"Ocurrió un error inesperado. Por favor intenta nuevamente.",life:6e3})}finally{M.value=!1}},Je=a=>{t.value={...a},B.value=!0},Ye=async()=>{var a,e,s,r,n;de.value=!0;try{const d=await T.delete(`${ee}/${t.value.id}`);await ge(),B.value=!1,m.add({severity:"success",summary:"¡Eliminado!",detail:"El producto ha sido eliminado correctamente.",life:5e3})}catch(d){if(B.value=!1,((a=d.response)==null?void 0:a.status)===422){const p=d.response.data;let h=p.error||p.message||"El producto está protegido contra eliminación.";p.details&&Array.isArray(p.details)&&(h+=`

 Restricciones de seguridad:
• `+p.details.join(`
• `),h+=`

 Para eliminar este producto debe:`,h+=`
• Eliminar primero todas las ventas asociadas`,h+=`
• Limpiar todo el historial de movimientos de inventario`,h+=`
• Luego podrá eliminar el producto de forma segura`),m.add({severity:"error",summary:"Producto Protegido",detail:h,life:15e3})}else if(((e=d.response)==null?void 0:e.status)===404)m.add({severity:"error",summary:"Producto no encontrado",detail:"El producto que intentas eliminar no existe o ya fue eliminado.",life:5e3}),await ge();else if(((s=d.response)==null?void 0:s.status)===500)m.add({severity:"error",summary:"Error del servidor",detail:"Ocurrió un error interno. Por favor, contacta al administrador.",life:6e3});else{const p=((n=(r=d.response)==null?void 0:r.data)==null?void 0:n.error)||d.message||"Error desconocido";m.add({severity:"error",summary:"Error",detail:`No se pudo eliminar el producto: ${p}`,life:6e3})}}finally{de.value=!1}},Qe=()=>{U.value?Y.value=!0:Ve()},Ve=()=>{L.value=!1,Y.value=!1,U.value=!1,S.value=null,se()},Xe=()=>{Y.value=!1},ea=a=>{E.value=a,Q.value=!0},aa=a=>{Q.value=!1,E.value=a,te.value=!0},ta=a=>{Q.value=!1,E.value=a,ae.value=!0},la=async a=>{var r;const e=((r=a.data)==null?void 0:r.producto)||a.producto||a;if(!e||!e.id){console.error("No se pudo obtener el producto actualizado");return}const s=I.value.findIndex(n=>n.id===e.id);s!==-1&&(I.value[s]={...I.value[s],stock_actual:e.stock_actual,stock_minimo:e.stock_minimo,updated_at:e.updated_at}),E.value&&E.value.id===e.id&&(E.value={...E.value,stock_actual:e.stock_actual,stock_minimo:e.stock_minimo,updated_at:e.updated_at}),te.value=!1,m.add({severity:"success",summary:"Stock actualizado",detail:`El stock de "${e.nombre}" se ha actualizado correctamente.`,life:3e3}),await Z()},sa=a=>{if(E.value&&E.value.imagenes&&E.value.imagenes.length>0){ne.value=E.value.imagenes.map(s=>{const r=typeof s=="string"?s:s.nombre;return we+r});const e=Math.max(0,Math.min(a,ne.value.length-1));me.value=e,setTimeout(()=>{ie.value=!0},50)}else m.add({severity:"warn",summary:"Sin imágenes",detail:"No hay imágenes disponibles para mostrar.",life:5e3})},oa=a=>{a.originalEvent.target.closest("button")||(E.value=a.data,ae.value=!0)},Te=u(typeof window<"u"?window.innerWidth:1024),fe=W(()=>Te.value<640?{width:"95vw",maxWidth:"380px"}:Te.value<768?{width:"400px"}:{width:"450px"}),ra=async()=>{K.value=!0;try{await new Promise(a=>setTimeout(a,100)),_e.value.click()}finally{setTimeout(()=>{K.value=!1},200)}},na=async a=>{const e=a.target?a.target.files:a.files,s=2*1024*1024;if(!e||e.length===0)return;if(y.value.length+e.length>5){m.add({severity:"warn",summary:"Límite de imágenes",detail:`Solo puedes subir máximo 5 imágenes. Actualmente tienes ${y.value.length} y estás intentando agregar ${e.length}.`,life:5e3});return}j.value=!0;try{for(const n of e)if(n instanceof File){if(y.value.length>=5){m.add({severity:"warn",summary:"Límite alcanzado",detail:"Has alcanzado el límite máximo de 5 imágenes.",life:4e3});break}if(n.size>s){m.add({severity:"warn",summary:"Archivo demasiado grande",detail:`El archivo "${n.name}" excede el tamaño máximo de 2MB.`,life:5e3});continue}if(!n.type.startsWith("image/")){m.add({severity:"warn",summary:"Formato no válido",detail:`El archivo "${n.name}" no es una imagen válida.`,life:4e3});continue}await new Promise(p=>setTimeout(p,100)),H.value.push(n);const d=new FileReader;d.onload=p=>y.value.push(p.target.result),d.readAsDataURL(n)}e.length>0&&m.add({severity:"success",summary:"Imágenes cargadas",detail:`Se han cargado ${e.length} imagen(es) correctamente.`,life:3e3})}catch{m.add({severity:"error",summary:"Error",detail:"Ocurrió un error al procesar las imágenes.",life:4e3})}finally{j.value=!1,a.target&&(a.target.value="")}},ia=a=>{const e=y.value[a];typeof e=="string"&&e.startsWith("data:image")?(y.value.splice(a,1),H.value.splice(a,1)):(J.value.push(e),y.value.splice(a,1))},da=()=>{t.value.nombre&&(t.value.nombre=t.value.nombre.toUpperCase(),t.value.nombre=t.value.nombre.replace(/[^A-ZÁÉÍÓÚÑÜ\s]/g,""),t.value.nombre.length>200&&(t.value.nombre=t.value.nombre.substring(0,200)))},ua=a=>{const e=a.key;if(!([8,9,27,13,46,35,36,37,38,39,40].includes(a.keyCode)||a.ctrlKey&&[65,67,86,88,90,89].includes(a.keyCode))&&!/^[a-zA-ZáéíóúÁÉÍÓÚñÑüÜ\s]$/.test(e)){a.preventDefault();return}},ca=a=>{a.preventDefault();const e=(a.clipboardData||window.clipboardData).getData("text");if(!e)return;let s=e.toUpperCase().replace(/[^A-ZÁÉÍÓÚÑÜ\s]/g,"");const r=a.target,n=r.value||"",d=r.selectionStart||0,p=r.selectionEnd||0,h=n.substring(0,d),q=n.substring(p);let o=h+s+q;o.length>200&&(o=o.substring(0,200)),t.value.nombre=o,setTimeout(()=>{const C=Math.min(d+s.length,o.length);r.setSelectionRange(C,C)},0)},Ne=()=>{if(!t.value.nombre||t.value.nombre.length<3)return!1;const a=t.value.nombre.trim().toUpperCase();return I.value.some(e=>t.value.id&&e.id===t.value.id?!1:e.nombre.trim().toUpperCase()===a)},ma=a=>{const e=a.key;if(!([8,9,27,13,46,35,36,37,38,39,40].includes(a.keyCode)||a.ctrlKey&&[65,67,86,88,90,89].includes(a.keyCode))&&!/^[a-zA-Z0-9áéíóúÁÉÍÓÚñÑüÜ\s.,;:!?¡¿()\/\-_@#$%&*+=\[\]{}|\\~`"']$/.test(e)){a.preventDefault();return}},va=a=>{a.preventDefault();const e=(a.clipboardData||window.clipboardData).getData("text");if(!e)return;let s=e.toUpperCase().replace(/[^A-ZÁÉÍÓÚÑÜ0-9\s.,;:!?¡¿()\/\-_@#$%&*+=\[\]{}|\\~`"']/g,"");const r=a.target,n=r.value||"",d=r.selectionStart||0,p=r.selectionEnd||0,h=n.substring(0,d),q=n.substring(p);let o=h+s+q;o.length>400&&(o=o.substring(0,400)),t.value.descripcion=o,setTimeout(()=>{const C=Math.min(d+s.length,o.length);r.setSelectionRange(C,C)},0)},pa=()=>{t.value.descripcion&&(t.value.descripcion=t.value.descripcion.toUpperCase(),t.value.descripcion=t.value.descripcion.replace(/[^A-ZÁÉÍÓÚÑÜ0-9\s.,;:!?¡¿()\/\-_@#$%&*+=\[\]{}|\\~`"']/g,""),t.value.descripcion.length>400&&(t.value.descripcion=t.value.descripcion.substring(0,400)))},ga=a=>{const e=a.target.value,s=a.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(a.keyCode)||a.ctrlKey&&[65,67,86,88].includes(a.keyCode))return;if(!/[0-9.]/.test(s)){a.preventDefault();return}if(s==="."&&e.includes(".")){a.preventDefault();return}if(s!=="."){const d=e.split(".");if(d[0].length>=3&&!e.includes(".")){a.preventDefault();return}if(d.length>1&&d[1].length>=2){a.preventDefault();return}}const r=e+s;if(parseFloat(r)>9999.99){a.preventDefault();return}},fa=a=>{a.preventDefault();let s=(a.clipboardData||window.clipboardData).getData("text").replace(/[^\d.]/g,"");if(!s||s===".")return;if((s.match(/\./g)||[]).length>1){const h=s.indexOf(".");s=s.substring(0,h+1)+s.substring(h+1).replace(/\./g,"")}const n=parseFloat(s);if(isNaN(n))return;const p=Math.min(n,9999.99).toFixed(2);t.value.precio=p,a.target.value=p},ba=a=>{const e=a.target.value,s=a.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(a.keyCode)||a.ctrlKey&&[65,67,86,88].includes(a.keyCode))return;if(!/[0-9]/.test(s)){a.preventDefault();return}const r=e+s,n=parseInt(r);if(r.length>4||n>9999){a.preventDefault();return}},ya=a=>{a.preventDefault();const s=(a.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");if(s){let r=parseInt(s);r>9999&&(r=9999),a.target.value=r.toString(),a.target.dispatchEvent(new Event("input",{bubbles:!0}))}},ha=a=>{const e=a.target.value,s=a.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(a.keyCode)||a.ctrlKey&&[65,67,86,88].includes(a.keyCode))return;if(!/[0-9]/.test(s)){a.preventDefault();return}const r=e+s,n=parseInt(r);if(r.length>3||n>100){a.preventDefault();return}},xa=a=>{a.preventDefault();const s=(a.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");if(s){let r=parseInt(s);r>100&&(r=100),r<1&&(r=1),a.target.value=r.toString(),a.target.dispatchEvent(new Event("input",{bubbles:!0}))}};return(a,e)=>{const s=$("Toast"),r=$("InputText"),n=$("Column"),d=$("DataTable"),p=$("Textarea"),h=$("Select"),q=$("Dialog");return v(),oe(Pa,null,{default:k(()=>[c(i(ka),{title:"Productos"}),c(s,{class:"z-[9999]"}),l("div",La,[l("div",Ua,[l("div",Ma,[l("div",za,[e[24]||(e[24]=l("h1",{class:"text-3xl font-bold text-blue-600 mb-2 text-center sm:text-start"},"Catálogo de Productos y Gestión de Stock",-1)),e[25]||(e[25]=l("p",{class:"text-gray-600 text-center sm:text-start"},"Visualiza y administra todos los productos y su inventario en el sistema.",-1)),l("div",Oa,[l("p",Fa,[c(i(x),{icon:i(xe),class:"mr-2 text-yellow-500"},null,8,["icon"]),e[22]||(e[22]=l("strong",null,"Tip:",-1)),e[23]||(e[23]=D(' Para gestionar el stock de un producto, haz clic en el botón "Más" y luego selecciona "Actualizar stock". '))])])]),l("div",$a,[c(i(Ca),{href:a.route("catProductos"),onClick:Ke,class:w([{"opacity-50 cursor-not-allowed":R.value},"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 flex items-center gap-2"])},{default:k(()=>[c(i(x),{icon:R.value?i(N):i(Aa),class:w({"animate-spin":R.value,"h-4":!0})},null,8,["icon","class"]),l("span",Ba,b(R.value?"Cargando...":"Categorías"),1),l("span",Ra,b(R.value?"Cargando...":"Categorías"),1)]),_:1},8,["href","class"]),l("button",{class:"bg-red-500 border flex border-red-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:Se},[c(i(x),{icon:i(re),class:"h-4 w-4 mr-1 text-white"},null,8,["icon"]),e[26]||(e[26]=l("span",null,"Agregar",-1))])])]),ue.value?(v(),g("div",ja,[c(i(x),{icon:i(N),class:"animate-spin h-10 w-10 text-blue-600"},null,8,["icon"]),e[27]||(e[27]=l("span",{class:"text-gray-600 font-medium text-lg"},"Cargando productos...",-1))])):(v(),oe(d,{key:1,value:ve.value,dataKey:"id",paginator:!0,rows:ce.value,rowsPerPageOptions:Fe.value,rowsPerPage:ce.value,"onUpdate:rowsPerPage":e[3]||(e[3]=o=>ce.value=o),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} productos",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:oa,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:k(()=>[l("div",Ka,[l("div",Ga,[l("div",qa,[e[28]||(e[28]=l("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[l("i",{class:"pi pi-filter text-blue-600 text-sm"}),l("span",null,"Filtros")],-1)),l("div",Wa,b(ve.value.length)+" resultado"+b(ve.value.length!==1?"s":""),1),l("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:Pe,disabled:V.value},[V.value?(v(),oe(i(x),{key:0,icon:i(N),class:"animate-spin h-3 w-3"},null,8,["icon"])):_("",!0),l("span",null,b(V.value?"Limp...":"Limpiar"),1)],8,Za)]),l("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:Pe,disabled:V.value},[V.value?(v(),oe(i(x),{key:0,icon:i(N),class:"animate-spin h-3 w-3"},null,8,["icon"])):_("",!0),l("span",null,b(V.value?"Limpiando...":"Limpiar filtros"),1)],8,Ha)]),l("div",Ja,[l("div",Ya,[c(i(x),{icon:i(Na),class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"},null,8,["icon"]),c(r,{modelValue:A.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=o=>A.value.global.value=o),placeholder:"Buscar productos...",class:"w-full h-9 text-sm rounded-md pl-10",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),l("div",Qa,[l("div",null,[Ie(l("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>z.value=o),onChange:Re,class:w(["w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate",z.value===""||z.value===null?"text-gray-400":"text-gray-900"])},[e[29]||(e[29]=l("option",{value:"",disabled:"",select:"",hiddene:"",hiddend:"",hidden:""},"Categoría",-1)),(v(!0),g(be,null,ye(G.value,o=>(v(),g("option",{key:o.id,value:o.id,class:"truncate text-gray-900 text-lg"},b(o.nombre),9,Xa))),128))],34),[[Le,z.value]])]),l("div",null,[Ie(l("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>O.value=o),onChange:je,class:w(["w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate",O.value===""||O.value===null?"text-gray-400":"text-gray-900"])},[e[30]||(e[30]=l("option",{value:"",disabled:"",select:"",hiddene:"",hiddend:"",hidden:""},"Estado",-1)),(v(!0),g(be,null,ye(Oe.value,o=>(v(),g("option",{key:o.value,value:o.value,class:"text-gray-900 truncate text-lg"},b(o.label),9,et))),128))],34),[[Le,O.value]])])]),l("div",at,[l("p",tt,[c(i(x),{icon:i(xe),class:"h-3 w-3 text-yellow-500"},null,8,["icon"]),e[31]||(e[31]=D(" Haz clic en cualquier fila para ver los detalles. "))])])])])]),empty:k(()=>[l("div",ct,[c(i(x),{icon:i(xe),class:"h-12 w-12 text-gray-400"},null,8,["icon"]),l("div",mt,[e[37]||(e[37]=l("h3",{class:"text-lg font-semibold text-gray-700 mb-2"},"NO HAY PRODUCTOS AGREGADOS",-1)),e[38]||(e[38]=l("p",{class:"text-gray-500 mb-4"},'Comienza agregando tu primer producto haciendo clic en el botón "Agregar"',-1)),l("button",{class:"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-md shadow-md transition-all duration-200 flex items-center gap-2 mx-auto",onClick:Se},[c(i(x),{icon:i(re),class:"h-4 w-4"},null,8,["icon"]),e[36]||(e[36]=D(" Agregar Producto "))])])])]),default:k(()=>[c(n,{field:"nombre",header:"Nombre",sortable:"",class:"w-28"},{body:k(o=>[l("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"100px","text-overflow":"ellipsis","white-space":"nowrap"},title:o.data.nombre},b(o.data.nombre),9,lt)]),_:1}),c(n,{field:"descripcion",header:"Descripción",class:"w-28 hidden md:table-cell"},{body:k(o=>[l("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"100px","text-overflow":"ellipsis","white-space":"nowrap"},title:o.data.descripcion},b(o.data.descripcion),9,st)]),_:1}),c(n,{field:"categoria.nombre",header:"Categoría",class:"w-32 hidden md:table-cell"},{body:k(o=>{var C;return[l("div",ot,b(((C=o.data.categoria)==null?void 0:C.nombre)||"Sin categoría"),1)]}),_:1}),c(n,{field:"precio",header:"Precio",class:"w-16"},{body:k(o=>[l("div",rt,b(isNaN(Number(o.data.precio))?"":`$${Number(o.data.precio).toFixed(2)}`),1)]),_:1}),c(n,{field:"estado",header:"Estado",class:"w-28 hidden sm:table-cell"},{body:k(o=>[l("span",{class:w("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+pe(o.data).class)},b(pe(o.data).label),3)]),_:1}),c(n,{exportable:!1,class:"w-52 min-w-36"},{header:k(()=>e[32]||(e[32]=[l("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:k(o=>[l("div",nt,[l("button",{class:"flex bg-green-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:C=>ea(o.data)},[c(i(x),{icon:i(Sa),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[33]||(e[33]=l("span",{class:"hidden md:block text-white"},"Más",-1))],8,it),l("button",{class:"flex bg-blue-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:C=>Ze(o.data)},[c(i(x),{icon:i(Va),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[34]||(e[34]=l("span",{class:"hidden md:block text-white"},"Editar",-1))],8,dt),l("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:C=>Je(o.data)},[c(i(x),{icon:i(Ta),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[35]||(e[35]=l("span",{class:"hidden md:block text-white"},"Eliminar",-1))],8,ut)])]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"])),c(q,{visible:L.value,"onUpdate:visible":e[11]||(e[11]=o=>L.value=o),header:X.value+" Producto",modal:!0,style:Ue(fe.value),closable:!1,draggable:!1},{footer:k(()=>[l("div",Qt,[l("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:He,disabled:M.value},[c(i(x),{icon:M.value?i(N):i(Me),class:w(["h-5 text-white",{"animate-spin":M.value}])},null,8,["icon","class"]),M.value?(v(),g("span",al,b(X.value==="Guardar"?"Guardando...":"Actualizando..."),1)):(v(),g("span",el,b(X.value),1))],8,Xt),l("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Qe,disabled:M.value},[c(i(x),{icon:i(ze),class:"h-5"},null,8,["icon"]),e[50]||(e[50]=D("Cancelar "))],8,tl)])]),default:k(()=>[l("div",vt,[l("div",pt,[l("div",gt,[e[39]||(e[39]=l("label",{for:"nombre",class:"w-24 flex items-center gap-1"},[D(" Nombre: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),c(r,{modelValue:t.value.nombre,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.nombre=o),id:"nombre",name:"nombre",maxlength:200,class:w([{"p-invalid":P.value&&(!t.value.nombre||t.value.nombre.length<3||t.value.nombre.length>200)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"TAZA PARA CAFÉ, ETC.",onInput:da,onKeydown:ua,onPaste:ca},null,8,["modelValue","class"])]),t.value.nombre&&t.value.nombre.length<3?(v(),g("small",ft," El nombre debe tener al menos 3 caracteres. Actual: "+b(t.value.nombre.length)+"/3 ",1)):_("",!0),t.value.nombre&&t.value.nombre.length>=3&&Ne()?(v(),g("small",bt," Ya existe un producto con este nombre. ")):_("",!0),t.value.nombre&&t.value.nombre.length>=180&&t.value.nombre.length<=200?(v(),g("small",yt," Caracteres restantes: "+b(200-t.value.nombre.length),1)):_("",!0),P.value&&!t.value.nombre?(v(),g("small",ht," El nombre es obligatorio. ")):_("",!0)]),l("div",xt,[l("div",wt,[e[40]||(e[40]=l("label",{for:"descripcion",class:"w-24 flex items-center gap-1 mt-2"},[D(" Descripción: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),c(p,{modelValue:t.value.descripcion,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.descripcion=o),id:"descripcion",name:"descripcion",maxlength:400,rows:"3",class:w([{"p-invalid":P.value&&(!t.value.descripcion||t.value.descripcion.length<10||t.value.descripcion.length>400)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),onInput:pa,onKeydown:ma,onPaste:va,placeholder:"TAZA DE CERÁMICA IDEAL PARA CAFÉ CALIENTE - 250ML, ETC."},null,8,["modelValue","class"])]),t.value.descripcion&&t.value.descripcion.length<10?(v(),g("small",_t," La descripción debe tener al menos 10 caracteres. Actual: "+b(t.value.descripcion.length)+"/10 ",1)):_("",!0),t.value.descripcion&&t.value.descripcion.length>=380&&t.value.descripcion.length<=400?(v(),g("small",kt," Caracteres restantes: "+b(400-t.value.descripcion.length),1)):_("",!0),P.value&&!t.value.descripcion?(v(),g("small",Ct," La descripción es obligatoria. ")):_("",!0)]),l("div",Dt,[l("div",Pt,[e[41]||(e[41]=l("label",{for:"categoria_id",class:"w-36 sm:w-32 flex items-center gap-1"},[D(" Categ.: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),l("div",Et,[c(h,{modelValue:t.value.categoria_id,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.categoria_id=o),options:We.value,optionLabel:"nombreTruncado",optionValue:"id",id:"categoria_id",name:"categoria_id",filter:!0,filterPlaceholder:"Buscar categoría...",showClear:!1,class:w(["w-12 sm:w-48 ml-8 rounded-md border-2 border-gray-400 hover:border-gray-500 truncate-select",{"p-invalid":P.value&&!t.value.categoria_id}]),placeholder:"Seleccionar categoría"},null,8,["modelValue","options","class"]),l("button",{type:"button",onClick:e[7]||(e[7]=o=>le.value=!0),class:"bg-green-500 hover:bg-green-600 text-white p-1 rounded-full transition-all duration-200 ease-in-out -ml-1 flex items-center justify-center min-w-[10px]",title:"Agregar nueva categoría"},[c(i(x),{icon:i(re),class:"h-4 w-4"},null,8,["icon"])])])]),P.value&&!t.value.categoria_id?(v(),g("small",At," La categoría es obligatoria. ")):_("",!0)]),l("div",St,[l("div",Vt,[e[43]||(e[43]=l("label",{for:"precio",class:"w-24 flex items-center gap-1"},[D(" Precio: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),l("div",Tt,[e[42]||(e[42]=l("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 pointer-events-none"},"$",-1)),c(r,{modelValue:t.value.precio,"onUpdate:modelValue":e[8]||(e[8]=o=>t.value.precio=o),id:"precio",name:"precio",type:"text",inputmode:"decimal",class:w(["w-full pl-8 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":P.value&&(!t.value.precio||t.value.precio<=0||t.value.precio>9999.99)}]),placeholder:"0.00",onKeydown:ga,onPaste:fa},null,8,["modelValue","class"])])]),P.value&&(t.value.precio==null||t.value.precio<=0||t.value.precio>9999.99)?(v(),g("small",Nt," El precio es obligatorio, debe ser mayor a 0 y menor o igual a 9999.99. ")):_("",!0)]),l("div",It,[l("div",Lt,[l("label",{for:"stock_actual",class:w(["block mb-2",t.value.id!==null?"text-gray-500":""])},[e[44]||(e[44]=D(" Stock actual: ")),t.value.id===null?(v(),g("span",Ut,"*")):(v(),g("span",Mt,"(Deshabilitado)"))],2),c(r,{modelValue:t.value.stock_actual,"onUpdate:modelValue":e[9]||(e[9]=o=>t.value.stock_actual=o),id:"stock_actual",name:"stock_actual",type:"number",inputmode:"numeric",min:"0",max:"9999",disabled:t.value.id!==null,class:w([{"bg-gray-100 cursor-not-allowed":t.value.id!==null,"border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none":t.value.id===null,"border-2 border-gray-300":t.value.id!==null},"w-full rounded-md"]),placeholder:"0",onKeydown:ba,onPaste:ya},null,8,["modelValue","disabled","class"]),t.value.id!==null?(v(),g("small",zt,' Para actualizar el stock usa el botón "Más" → "Actualizar Stock" ')):_("",!0)]),l("div",Ot,[l("label",{for:"stock_minimo",class:w(["block mb-2",t.value.id!==null?"text-gray-500":""])},[e[45]||(e[45]=D(" Stock mínimo: ")),t.value.id===null?(v(),g("span",Ft,"*")):(v(),g("span",$t,"(Deshabilitado)"))],2),c(r,{modelValue:t.value.stock_minimo,"onUpdate:modelValue":e[10]||(e[10]=o=>t.value.stock_minimo=o),id:"stock_minimo",name:"stock_minimo",type:"number",inputmode:"numeric",min:"1",max:"100",disabled:t.value.id!==null,class:w([{"bg-gray-100 cursor-not-allowed":t.value.id!==null,"border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none":t.value.id===null,"border-2 border-gray-300":t.value.id!==null},"w-full rounded-md"]),placeholder:"1",onKeydown:ha,onPaste:xa},null,8,["modelValue","disabled","class"]),t.value.id!==null?(v(),g("small",Bt,' Para actualizar el stock mínimo usa "Actualizar Stock" ')):_("",!0)])]),l("div",Rt,[l("div",jt,[e[48]||(e[48]=l("label",{for:"imagenes",class:"w-24 flex items-center gap-1"},[D("Imágenes:"),l("span",{class:"text-red-500 font-bold"},"*")],-1)),l("div",Kt,[l("div",Gt,[l("input",{type:"file",id:"imagenes",name:"imagenes[]",accept:"image/*",multiple:"",onChange:na,class:"hidden",ref_key:"fileInput",ref:_e},null,544),l("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 outline-none focus:outline-none active:outline-none disabled:opacity-50 disabled:cursor-not-allowed",onClick:ra,disabled:j.value||K.value||!ke.value},[c(i(x),{icon:j.value?i(N):K.value?i(N):i(re),class:w({"animate-spin":j.value||K.value})},null,8,["icon","class"]),D(" "+b($e.value),1)],8,qt),l("div",Wt,[l("span",{class:w(["text-sm font-medium",y.value.length>=5?"text-red-600":"text-gray-600"])},b(y.value.length)+"/5 ",3),e[46]||(e[46]=l("span",{class:"text-xs text-gray-500"},"imágenes",-1))])]),e[47]||(e[47]=l("div",{class:"text-xs text-gray-500 mb-2"}," Máximo 5 imágenes por producto • Formatos: JPG, PNG, GIF • Tamaño máximo: 2MB por imagen ",-1))])]),P.value&&y.value.length===0?(v(),g("small",Zt,"Las imágenes son obligatorias (al menos una).")):_("",!0)]),l("div",Ht,[(v(!0),g(be,null,ye(y.value,(o,C)=>(v(),g("div",{key:C,class:"relative w-24 sm:w-28 h-24 sm:h-28"},[l("img",{src:o.startsWith("data:image")?o:we+o,alt:"Vista previa",class:"w-full h-full object-cover rounded border"},null,8,Jt),l("button",{onClick:fl=>ia(C),class:"absolute top-2 right-2 bg-gray-600/80 hover:bg-gray-700/80 text-white font-bold py-1 px-2 rounded-full shadow",style:{transform:"translate(50%, -50%)"}},e[49]||(e[49]=[l("i",{class:"pi pi-times text-xs"},null,-1)]),8,Yt)]))),128))])])]),_:1},8,["visible","header","style"]),c(q,{visible:le.value,"onUpdate:visible":e[13]||(e[13]=o=>le.value=o),header:"Agregar Nueva Categoría",modal:!0,style:Ue(fe.value),closable:!1,draggable:!1},{footer:k(()=>[l("div",ul,[l("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:Ee,disabled:F.value||!f.value.nombre||f.value.nombre.length<3||f.value.nombre.length>50},[c(i(x),{icon:F.value?i(N):i(Me),class:w(["h-5 text-white",{"animate-spin":F.value}])},null,8,["icon","class"]),F.value?(v(),g("span",vl,"Guardando...")):(v(),g("span",ml,"Guardar"))],8,cl),l("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Ae,disabled:F.value},[c(i(x),{icon:i(ze),class:"h-5"},null,8,["icon"]),e[52]||(e[52]=D("Cancelar "))],8,pl)])]),default:k(()=>[l("div",ll,[l("div",sl,[l("div",ol,[e[51]||(e[51]=l("label",{for:"nombreCategoria",class:"w-24 flex items-center gap-1"},[D(" Nombre: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),c(r,{modelValue:f.value.nombre,"onUpdate:modelValue":e[12]||(e[12]=o=>f.value.nombre=o),modelModifiers:{trim:!0},id:"nombreCategoria",name:"nombreCategoria",maxlength:50,class:w(["flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"border-red-400 focus:border-red-500":f.value.nombre&&f.value.nombre.length>50,"border-orange-400 focus:border-orange-500":f.value.nombre&&f.value.nombre.length>45&&f.value.nombre.length<=50}]),placeholder:"CATEGORÍA (MAX 50 CARACTERES)",style:{"text-transform":"uppercase"},onInput:Ge,onKeyup:Da(Ee,["enter"])},null,8,["modelValue","class"])]),f.value.nombre?(v(),g("small",rl," Caracteres: "+b(f.value.nombre.length)+"/50 ",1)):_("",!0),f.value.nombre&&f.value.nombre.length<3?(v(),g("small",nl," El nombre debe tener al menos 3 caracteres. ")):_("",!0),f.value.nombre&&f.value.nombre.length>45&&f.value.nombre.length<=50?(v(),g("small",il," Te quedan "+b(50-f.value.nombre.length)+" caracteres ",1)):_("",!0),f.value.nombre&&f.value.nombre.length>50?(v(),g("small",dl," Has excedido el límite por "+b(f.value.nombre.length-50)+" caracteres ",1)):_("",!0)])])]),_:1},8,["visible","style"]),c(Ia,{visible:Q.value,"onUpdate:visible":e[14]||(e[14]=o=>Q.value=o),"details-visible":ae.value,"onUpdate:detailsVisible":e[15]||(e[15]=o=>ae.value=o),"carousel-visible":ie.value,"onUpdate:carouselVisible":e[16]||(e[16]=o=>ie.value=o),"delete-visible":B.value,"onUpdate:deleteVisible":e[17]||(e[17]=o=>B.value=o),"unsaved-changes-visible":Y.value,"onUpdate:unsavedChangesVisible":e[18]||(e[18]=o=>Y.value=o),"update-stock-visible":te.value,"onUpdate:updateStockVisible":e[19]||(e[19]=o=>te.value=o),"carousel-index":me.value,"onUpdate:carouselIndex":e[20]||(e[20]=o=>me.value=o),producto:E.value||t.value,"dialog-style":fe.value,"selected-images":ne.value,"image-path":we,"is-deleting":de.value,onUpdateStock:aa,onDeleteProduct:Ye,onCancelDelete:e[21]||(e[21]=()=>B.value=!1),onCloseWithoutSaving:Ve,onContinueEditing:Xe,onViewDetails:ta,onOpenImageModal:sa,onStockUpdated:la},null,8,["visible","details-visible","carousel-visible","delete-visible","unsaved-changes-visible","update-stock-visible","carousel-index","producto","dialog-style","selected-images","is-deleting"])])])]),_:1})}}};export{Cl as default};
