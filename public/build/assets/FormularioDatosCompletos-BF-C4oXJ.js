import{$ as G,r as y,E as h,c as r,d as n,e as a,I as S,j as i,v as I,q as _,a9 as U,a0 as t,t as c,F as w,l as k,p as T,y as z}from"./vendor-Du8cTcRM.js";import{z as A}from"./vue-tel-input-gtn014Sj.js";import{z as F}from"./ui-BT-X-j9i.js";const q={class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},M={class:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md"},Z={class:"w-full flex flex-col"},L={class:"flex items-center gap-4"},H={key:0,class:"ml-28 mt-1"},P={key:0,class:"text-red-500 block"},R={key:1,class:"text-gray-500 ml-28 mt-1"},$={key:2,class:"text-orange-500 ml-28 mt-1"},J={class:"w-full flex flex-col"},K={class:"flex items-start gap-4"},Q={class:"flex-1"},W={key:0,class:"ml-28 mt-1"},X={key:0,class:"text-red-500 block"},Y={key:1,class:"ml-28 mt-1"},j={class:"flex justify-center gap-4 w-full mt-6"},O=["disabled"],ee={key:0},oe={key:1},te=["disabled"],re={__name:"FormularioDatosCompletos",props:{empleado:{type:Object,default:()=>({})},userId:{type:Number,required:!0}},emits:["close"],setup(E,{emit:V}){var x,b;const f=E,C=V,N=F(),e=G({cargo:((x=f.empleado)==null?void 0:x.cargo)||"",telefono:((b=f.empleado)==null?void 0:b.telefono)||"",user_id:f.userId}),l=y({isValid:!1,country:null,formattedNumber:"",mensaje:""}),g=y(!1),p=()=>{e.cargo&&(e.cargo=e.cargo.toUpperCase().replace(/[^A-Z\s]/g,"").substring(0,25))},D=o=>{try{o&&typeof o=="object"&&(l.value.isValid=o.valid===!0,l.value.country={name:o.country,code:o.countryCode},l.value.formattedNumber=o.formatted||"",l.value.international=o.international||"",o.valid===!0&&o.international&&(e.telefono=o.international),e.telefono&&o.valid===!1?l.value.mensaje="✗ Número de teléfono inválido para "+o.country:o.valid===!0?l.value.mensaje="✓ Número válido para "+o.country:l.value.mensaje="")}catch{l.value.mensaje="Error en validación"}},u=h(()=>{const o=[],s=e.cargo||"";return s.length>0&&s.length<2&&o.push("El cargo debe tener al menos 2 caracteres."),s.length>0&&/[^A-Z\s]/.test(s)&&o.push("El cargo solo puede contener letras y espacios (sin tildes ni números)."),s.length>25&&o.push("El cargo no puede exceder 25 caracteres."),o}),m=h(()=>{const o=[],s=e.telefono||"";return s.length>0&&!l.value.isValid&&o.push("El formato del teléfono no es válido."),s.length>30&&o.push("El teléfono no puede exceder 30 caracteres."),o}),v=()=>{C("close")},B=()=>{if(g.value=!0,p(),console.debug("[DEBUG] Enviando datos:",{cargo:e.cargo,telefono:e.telefono,telefonoValidation:l.value}),l.value.isValid&&l.value.international&&(e.telefono=l.value.international),u.value.length>0||m.value.length>0){console.debug("[DEBUG] Errores de validación:",{cargoErrors:u.value,telefonoErrors:m.value});return}e.post(route("empleado.completar-datos"),{preserveScroll:!0,onSuccess:()=>{N.add({severity:"success",summary:"¡Datos guardados!",detail:"Tus datos se han guardado correctamente.",life:4e3}),console.debug("[DEBUG] Guardado exitoso, cerrando modal"),v()},onError:o=>{console.debug("[DEBUG] Errores al guardar:",o)}})};return(o,s)=>(n(),r("div",q,[a("div",M,[s[4]||(s[4]=a("h2",{class:"text-2xl font-bold mb-4 text-blue-600"},"Completa tus datos de Administrador",-1)),a("form",{onSubmit:S(B,["prevent"]),class:"space-y-5"},[a("div",Z,[a("div",L,[s[2]||(s[2]=a("label",{for:"cargo",class:"w-24 flex items-center gap-1"},[_("Cargo "),a("span",{class:"text-red-500 font-bold"},"*")],-1)),I(a("input",{id:"cargo","onUpdate:modelValue":s[0]||(s[0]=d=>t(e).cargo=d),type:"text",class:"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-blue-500 focus:ring-0 focus:shadow-none rounded-md px-2 py-1",maxlength:"25",onInput:p,required:""},null,544),[[U,t(e).cargo]])]),t(e).errors.cargo||g.value&&u.value.length>0?(n(),r("div",H,[t(e).errors.cargo?(n(),r("small",P,c(t(e).errors.cargo),1)):i("",!0),(n(!0),r(w,null,k(u.value,d=>(n(),r("small",{key:d,class:"text-red-500 block"},c(d),1))),128))])):i("",!0),t(e).cargo&&t(e).cargo.length>0&&u.value.length===0?(n(),r("small",R," Caracteres: "+c(t(e).cargo.length)+"/25 ",1)):i("",!0),t(e).cargo&&t(e).cargo.length>=20&&t(e).cargo.length<=25&&u.value.length===0?(n(),r("small",$," Caracteres restantes: "+c(25-t(e).cargo.length),1)):i("",!0)]),a("div",J,[a("div",K,[s[3]||(s[3]=a("label",{for:"telefono",class:"w-24 flex items-center gap-1 mt-2"},[_("Teléfono "),a("span",{class:"text-red-500 font-bold"},"*")],-1)),a("div",Q,[T(t(A),{modelValue:t(e).telefono,"onUpdate:modelValue":s[1]||(s[1]=d=>t(e).telefono=d),id:"telefono",name:"telefono",defaultCountry:"SV",preferredCountries:["SV","GT","HN","CR","NI","PA","BZ"],validCharactersOnly:!0,dropdownOptions:{showDialCodeInSelection:!0,showFlags:!0,showSearchBox:!0,showDialCodeInList:!0},inputOptions:{placeholder:"Número de teléfono"},mode:"international",class:"w-full border border-gray-300 rounded-lg",onValidate:D,disabled:t(e).processing},null,8,["modelValue","disabled"])])]),t(e).errors.telefono||g.value&&m.value.length>0?(n(),r("div",W,[t(e).errors.telefono?(n(),r("small",X,c(t(e).errors.telefono),1)):i("",!0),(n(!0),r(w,null,k(m.value,d=>(n(),r("small",{key:d,class:"text-red-500 block"},c(d),1))),128))])):i("",!0),l.value.mensaje?(n(),r("div",Y,[a("small",{class:z([l.value.isValid?"text-green-600":"text-red-500","block"])},c(l.value.mensaje),3)])):i("",!0)]),a("div",j,[a("button",{type:"submit",disabled:t(e).processing,class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed font-semibold"},[t(e).processing?(n(),r("span",oe,"Guardando...")):(n(),r("span",ee,"Guardar"))],8,O),a("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:v,disabled:t(e).processing}," Cancelar ",8,te)])],32)])]))}};export{re as default};
