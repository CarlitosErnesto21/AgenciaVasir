import{A as la}from"./AuthenticatedLayout-yva5xhgW.js";import{N as L,r as i,E as Z,w as oa,n as ee,o as sa,k as U,c as g,d as v,p as u,$ as c,a0 as ra,x as _,e as l,a1 as ia,y,t as f,h as ye,j as k,A as na,q as P,F as he,l as da}from"./vendor-BiysG-4G.js";import{z as ua,F as de,A as C}from"./ui-CyD9Ijjf.js";import{k as $,m as ca,a as xe,p as ma,b as va,c as pa,e as ga,d as fa}from"./index-DRTZt2OH.js";import ba from"./Modales-D8Hloxi7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ActualizarStock-CfQKrQCd.js";const ya={class:"px-auto md:px-2 mt-6"},ha={class:"flex flex-col sm:flex-row lg:justify-between lg:items-center mb-4 gap-4"},xa={class:"flex items-center gap-2 w-full justify-center lg:w-auto lg:jusfify-end mr-0 sm:mr-4"},wa={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},_a={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},ka={class:"flex items-center gap-3"},Ca={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Pa=["disabled"],Da=["disabled"],Va={class:"space-y-3"},Sa={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-2 gap-3"},Ea=["title"],Aa=["title"],Ta={class:"text-sm leading-relaxed"},Ia={class:"text-sm font-medium leading-relaxed"},Na={class:"flex gap-2 justify-center items-center"},La=["onClick"],Ua=["onClick"],Fa=["onClick"],za={class:"space-y-4"},Ma={class:"w-full flex flex-col"},Oa={class:"flex items-center gap-4"},$a={key:0,class:"text-red-500 ml-28"},Ba={key:1,class:"text-orange-500 ml-28"},Ga={key:2,class:"text-red-500 ml-28"},ja={class:"w-full flex flex-col"},qa={class:"flex items-start gap-4"},Ra={key:0,class:"text-red-500 ml-28"},Ka={key:1,class:"text-orange-500 ml-28"},Wa={key:2,class:"text-red-500 ml-28"},Ja={class:"w-full flex flex-col"},Ha={class:"flex items-center gap-4 sm:gap-5"},Qa={key:0,class:"text-red-500 ml-28"},Xa={class:"w-full flex flex-col"},Ya={class:"flex items-center gap-12 sm:gap-11"},Za={class:"w-full relative"},et={key:0,class:"text-red-500 ml-28"},at={class:"flex gap-4"},tt={class:"flex-1"},lt={key:0,class:"text-red-500 font-bold"},ot={key:1,class:"text-gray-400 text-xs"},st={key:0,class:"text-blue-600 text-xs mt-1 block"},rt={class:"flex-1"},it={key:0,class:"text-red-500 font-bold"},nt={key:1,class:"text-gray-400 text-xs"},dt={key:0,class:"text-blue-600 text-xs mt-1 block"},ut={class:"w-full flex flex-col"},ct={class:"flex items-center gap-4"},mt={class:"flex-1"},vt={class:"flex items-center gap-3 mb-2"},pt=["disabled"],gt={class:"flex items-center gap-2"},ft={key:0,class:"text-red-500 ml-28"},bt={class:"grid grid-cols-3 ml-2 sm:ml-5 gap-y-2"},yt=["src"],ht=["onClick"],xt={class:"flex justify-center gap-4 w-full mt-6"},wt=["disabled"],_t={key:0},kt={key:1},Ct=["disabled"],K="/api/productos",ue="/storage/productos/",Lt={__name:"Productos",setup(Pt){L.defaults.withCredentials=!0;const d=ua(),F=i([]),t=i({id:null,nombre:"",descripcion:"",precio:null,stock_actual:null,stock_minimo:null,categoria_id:null}),p=i([]),B=i([]),ae=i([]),G=i([]),A=i(!1),z=i(!1),W=i(!1),j=i(!1),h=i(!1),T=i(!1),D=i(null),V=i(!1),te=i(!1),x=i(null),J=i(!1),q=i(!1),le=i(!1),S=i(!1),M=i(!1),O=i(!1),I=i(!1),ce=i(!0),H=i([]),Q=i(null),X=i(null),w=i({global:{value:null,matchMode:de.CONTAINS},categoria:{value:null,matchMode:de.EQUALS},estado:{value:null,matchMode:de.EQUALS}}),we=i([{label:"Disponible",value:"DISPONIBLE"},{label:"Stock Bajo",value:"STOCK_BAJO"},{label:"Agotado",value:"AGOTADO"}]),oe=i(10),_e=i([5,10,20,50]),R=i("Guardar"),se=i(0),me=i(null),re=Z(()=>{let a=F.value;if(w.value.global.value){const e=w.value.global.value.toLowerCase();a=a.filter(o=>{var r;return o.nombre.toLowerCase().includes(e)||o.descripcion&&o.descripcion.toLowerCase().includes(e)||((r=o.categoria)==null?void 0:r.nombre)&&o.categoria.nombre.toLowerCase().includes(e)})}return w.value.categoria.value&&(a=a.filter(e=>e.categoria_id==w.value.categoria.value)),w.value.estado.value&&(a=a.filter(e=>ie(e).value===w.value.estado.value)),a}),ve=Z(()=>p.value.length<5),ke=Z(()=>M.value?"Cargando...":O.value?"Abriendo...":ve.value?"Seleccionar":"L√≠mite alcanzado"),ie=a=>a.stock_actual<=0?{label:"Agotado",value:"AGOTADO",class:"bg-red-100 text-red-800"}:a.stock_actual<=a.stock_minimo?{label:"Stock Bajo",value:"STOCK_BAJO",class:"bg-yellow-100 text-yellow-800"}:{label:"Disponible",value:"DISPONIBLE",class:"bg-green-100 text-green-800"};oa([t,p,G],()=>{D.value&&A.value&&ee(()=>{const a={...t.value,imagenes_actuales:[...p.value]},e=JSON.stringify(a)!==JSON.stringify({...D.value,imagenes_actuales:D.value.imagenes_originales})||G.value.length>0,o=!D.value.id,r=t.value.nombre||t.value.descripcion||t.value.precio||t.value.categoria_id||p.value.length>0;T.value=e||o&&r})},{deep:!0,flush:"post"});function Y(){t.value={id:null,nombre:"",descripcion:"",precio:null,stock_actual:null,stock_minimo:null,categoria_id:null},p.value=[],B.value=[],G.value=[],h.value=!1}sa(()=>{Ce(),Pe()});const ne=async()=>{try{const a=await L.get(K);F.value=(a.data.data||a.data||[]).map(e=>({...e,imagenes:(e.imagenes||[]).map(o=>typeof o=="string"?o:o.nombre)})).sort((e,o)=>{const r=new Date(e.created_at);return new Date(o.created_at)-r})}catch{d.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los productos.",life:4e3})}},Ce=async()=>{ce.value=!0,d.add({severity:"info",summary:"Cargando productos...",life:2e3});try{const a=await L.get(K);F.value=(a.data.data||a.data||[]).map(e=>({...e,imagenes:(e.imagenes||[]).map(o=>typeof o=="string"?o:o.nombre)})).sort((e,o)=>{const r=new Date(e.created_at);return new Date(o.created_at)-r}),d.add({severity:"success",summary:"Productos cargados",life:2e3})}catch{d.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los productos.",life:4e3})}finally{ce.value=!1}},Pe=async()=>{try{const a=await L.get("/api/categorias-productos");H.value=a.data.data||a.data||[]}catch{H.value=[],d.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las categor√≠as.",life:4e3})}},De=()=>{w.value.categoria.value=Q.value},Ve=()=>{w.value.estado.value=X.value},pe=async()=>{S.value=!0;try{await new Promise(a=>setTimeout(a,300)),Q.value=null,X.value=null,w.value.global.value=null,w.value.categoria.value=null,w.value.estado.value=null,d.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{S.value=!1}},Se=()=>{q.value=!0},Ee=()=>{Y(),R.value="Guardar",h.value=!1,A.value=!0,ee(()=>{D.value={...t.value,imagenes_originales:[...p.value]},T.value=!1})},Ae=a=>{Y(),h.value=!1,t.value={...a},p.value=(a.imagenes||[]).map(e=>typeof e=="string"?e:e.nombre),T.value=!1,R.value="Actualizar",A.value=!0,ee(()=>{D.value={...t.value,imagenes_originales:[...p.value]},T.value=!1})},Te=async()=>{if(h.value=!0,!t.value.nombre||t.value.nombre.length<3||t.value.nombre.length>100){d.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios est√©n completos y cumplan los requisitos.",life:4e3});return}if(!t.value.descripcion||t.value.descripcion.length<10||t.value.descripcion.length>255){d.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios est√©n completos y cumplan los requisitos.",life:4e3});return}if(!t.value.precio||!t.value.categoria_id||p.value.length===0){d.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios est√©n completos.",life:4e3});return}if(!t.value.id&&(t.value.stock_actual===null||t.value.stock_minimo===null)){d.add({severity:"warn",summary:"Campos requeridos",detail:"Para productos nuevos, el stock actual y m√≠nimo son obligatorios.",life:4e3});return}if(t.value.precio<=0||t.value.precio>9999.99){d.add({severity:"warn",summary:"Verificar datos",detail:"Por favor revisa los valores ingresados y corrige cualquier inconsistencia.",life:4e3});return}if(!t.value.id&&(t.value.stock_actual!==null&&t.value.stock_actual<0||t.value.stock_minimo!==null&&t.value.stock_minimo<1)){d.add({severity:"warn",summary:"Verificar datos",detail:"Por favor revisa los valores de stock y corrige cualquier inconsistencia.",life:4e3});return}const a=2*1024*1024;if(B.value.filter(o=>o.size>a).length>0){d.add({severity:"warn",summary:"Verificar archivos",detail:"Por favor revisa el tama√±o de las im√°genes seleccionadas.",life:4e3});return}try{I.value=!0;const o=new FormData;o.append("nombre",t.value.nombre||""),o.append("descripcion",t.value.descripcion||""),o.append("precio",t.value.precio||""),o.append("categoria_id",t.value.categoria_id||""),t.value.id||(o.append("stock_actual",t.value.stock_actual||"0"),o.append("stock_minimo",t.value.stock_minimo||"1")),B.value.forEach(n=>o.append("imagenes[]",n)),G.value.forEach(n=>{const m=n.includes("/")?n.split("/").pop():n;o.append("removed_images[]",m)});let r;t.value.id?(o.append("_method","PUT"),r=await L.post(`${K}/${t.value.id}`,o,{headers:{"Content-Type":"multipart/form-data"}}),d.add({severity:"success",summary:"¬°√âxito!",detail:"El producto ha sido actualizado correctamente.",life:5e3})):(r=await L.post(K,o,{headers:{"Content-Type":"multipart/form-data"}}),d.add({severity:"success",summary:"¬°√âxito!",detail:"El producto ha sido creado correctamente.",life:5e3})),await ne(),A.value=!1,T.value=!1,D.value=null,Y()}catch{d.add({severity:"warn",summary:"Error de validaci√≥n",detail:"Por favor revisa los campos e intenta nuevamente.",life:6e3})}finally{I.value=!1}},Ie=a=>{t.value={...a},z.value=!0},Ne=async()=>{var a,e,o,r,n;le.value=!0;try{await L.delete(`${K}/${t.value.id}`),await ne(),z.value=!1,d.add({severity:"success",summary:"¬°Eliminado!",detail:"El producto ha sido eliminado correctamente.",life:5e3})}catch(m){if(z.value=!1,((a=m.response)==null?void 0:a.status)===422){const b=m.response.data;let N=b.error||"El producto est√° siendo utilizado en el sistema.";b.details&&Array.isArray(b.details)&&(N+=`

üìã Detalles:
‚Ä¢ `+b.details.join(`
‚Ä¢ `)),d.add({severity:"warn",summary:"‚ùå No se puede eliminar",detail:N,life:1e4})}else if(((e=m.response)==null?void 0:e.status)===404)d.add({severity:"error",summary:"Producto no encontrado",detail:"El producto que intentas eliminar no existe o ya fue eliminado.",life:5e3}),await ne();else if(((o=m.response)==null?void 0:o.status)===500)d.add({severity:"error",summary:"Error del servidor",detail:"Ocurri√≥ un error interno. Por favor, contacta al administrador.",life:6e3});else{const b=((n=(r=m.response)==null?void 0:r.data)==null?void 0:n.error)||m.message||"Error desconocido";d.add({severity:"error",summary:"Error",detail:`No se pudo eliminar el producto: ${b}`,life:6e3})}}finally{le.value=!1}},Le=()=>{T.value?j.value=!0:ge()},ge=()=>{A.value=!1,j.value=!1,T.value=!1,D.value=null,Y()},Ue=()=>{j.value=!1},Fe=a=>{x.value=a,V.value=!0},ze=a=>{d.add({severity:"info",summary:"Duplicar Producto",detail:`Funcionalidad de duplicar producto "${a.nombre}" en desarrollo.`,life:5e3}),V.value=!1},Me=a=>{V.value=!1,x.value=a,J.value=!0},Oe=a=>{d.add({severity:"info",summary:"Generar Reporte",detail:`Funcionalidad de generar reporte del producto "${a.nombre}" en desarrollo.`,life:5e3}),V.value=!1},$e=a=>{d.add({severity:"info",summary:"Archivar Producto",detail:`Funcionalidad de archivar producto "${a.nombre}" en desarrollo.`,life:5e3}),V.value=!1},Be=a=>{V.value=!1,x.value=a,W.value=!0},Ge=async a=>{var r;const e=((r=a.data)==null?void 0:r.producto)||a.producto||a;if(!e||!e.id){console.error("No se pudo obtener el producto actualizado");return}const o=F.value.findIndex(n=>n.id===e.id);o!==-1&&(F.value[o]={...F.value[o],stock_actual:e.stock_actual,stock_minimo:e.stock_minimo,updated_at:e.updated_at}),x.value&&x.value.id===e.id&&(x.value={...x.value,stock_actual:e.stock_actual,stock_minimo:e.stock_minimo,updated_at:e.updated_at}),J.value=!1,d.add({severity:"success",summary:"Stock actualizado",detail:`El stock de "${e.nombre}" se ha actualizado correctamente.`,life:3e3}),await ee()},je=a=>{if(x.value&&x.value.imagenes&&x.value.imagenes.length>0){ae.value=x.value.imagenes.map(o=>{const r=typeof o=="string"?o:o.nombre;return ue+r});const e=Math.max(0,Math.min(a,ae.value.length-1));se.value=e,setTimeout(()=>{te.value=!0},50)}else d.add({severity:"warn",summary:"Sin im√°genes",detail:"No hay im√°genes disponibles para mostrar.",life:5e3})},qe=a=>{a.originalEvent.target.closest("button")||(x.value=a.data,W.value=!0)},fe=i(typeof window<"u"?window.innerWidth:1024),be=Z(()=>fe.value<640?{width:"95vw",maxWidth:"380px"}:fe.value<768?{width:"400px"}:{width:"450px"}),Re=async()=>{O.value=!0;try{await new Promise(a=>setTimeout(a,100)),me.value.click()}finally{setTimeout(()=>{O.value=!1},200)}},Ke=async a=>{const e=a.target?a.target.files:a.files,o=2*1024*1024;if(!e||e.length===0)return;if(p.value.length+e.length>5){d.add({severity:"warn",summary:"L√≠mite de im√°genes",detail:`Solo puedes subir m√°ximo 5 im√°genes. Actualmente tienes ${p.value.length} y est√°s intentando agregar ${e.length}.`,life:5e3});return}M.value=!0;try{for(const n of e)if(n instanceof File){if(p.value.length>=5){d.add({severity:"warn",summary:"L√≠mite alcanzado",detail:"Has alcanzado el l√≠mite m√°ximo de 5 im√°genes.",life:4e3});break}if(n.size>o){d.add({severity:"warn",summary:"Archivo demasiado grande",detail:`El archivo "${n.name}" excede el tama√±o m√°ximo de 2MB.`,life:5e3});continue}if(!n.type.startsWith("image/")){d.add({severity:"warn",summary:"Formato no v√°lido",detail:`El archivo "${n.name}" no es una imagen v√°lida.`,life:4e3});continue}await new Promise(b=>setTimeout(b,100)),B.value.push(n);const m=new FileReader;m.onload=b=>p.value.push(b.target.result),m.readAsDataURL(n)}e.length>0&&d.add({severity:"success",summary:"Im√°genes cargadas",detail:`Se han cargado ${e.length} imagen(es) correctamente.`,life:3e3})}catch{d.add({severity:"error",summary:"Error",detail:"Ocurri√≥ un error al procesar las im√°genes.",life:4e3})}finally{M.value=!1,a.target&&(a.target.value="")}},We=a=>{const e=p.value[a];typeof e=="string"&&e.startsWith("data:image")?(p.value.splice(a,1),B.value.splice(a,1)):(G.value.push(e),p.value.splice(a,1))},Je=()=>{t.value.nombre&&t.value.nombre.length>100&&(t.value.nombre=t.value.nombre.substring(0,100))},He=()=>{t.value.descripcion&&t.value.descripcion.length>255&&(t.value.descripcion=t.value.descripcion.substring(0,255))},Qe=a=>{const e=a.target.value,o=a.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(a.keyCode)||a.ctrlKey&&[65,67,86,88].includes(a.keyCode))return;if(!/[0-9.]/.test(o)){a.preventDefault();return}if(o==="."&&e.includes(".")){a.preventDefault();return}if(o!=="."){const m=e.split(".");if(m[0].length>=3&&!e.includes(".")){a.preventDefault();return}if(m.length>1&&m[1].length>=2){a.preventDefault();return}}const r=e+o;if(parseFloat(r)>9999.99){a.preventDefault();return}},Xe=a=>{a.preventDefault();let o=(a.clipboardData||window.clipboardData).getData("text").replace(/[^\d.]/g,"");if(!o||o===".")return;if((o.match(/\./g)||[]).length>1){const N=o.indexOf(".");o=o.substring(0,N+1)+o.substring(N+1).replace(/\./g,"")}const n=parseFloat(o);if(isNaN(n))return;const b=Math.min(n,9999.99).toFixed(2);t.value.precio=b,a.target.value=b},Ye=a=>{const e=a.target.value,o=a.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(a.keyCode)||a.ctrlKey&&[65,67,86,88].includes(a.keyCode))return;if(!/[0-9]/.test(o)){a.preventDefault();return}const r=e+o,n=parseInt(r);if(r.length>4||n>9999){a.preventDefault();return}},Ze=a=>{a.preventDefault();const o=(a.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");if(o){let r=parseInt(o);r>9999&&(r=9999),a.target.value=r.toString(),a.target.dispatchEvent(new Event("input",{bubbles:!0}))}},ea=a=>{const e=a.target.value,o=a.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(a.keyCode)||a.ctrlKey&&[65,67,86,88].includes(a.keyCode))return;if(!/[0-9]/.test(o)){a.preventDefault();return}const r=e+o,n=parseInt(r);if(r.length>3||n>100){a.preventDefault();return}},aa=a=>{a.preventDefault();const o=(a.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");if(o){let r=parseInt(o);r>100&&(r=100),r<1&&(r=1),a.target.value=r.toString(),a.target.dispatchEvent(new Event("input",{bubbles:!0}))}};return(a,e)=>{const o=U("Toast"),r=U("InputText"),n=U("Select"),m=U("Column"),b=U("DataTable"),N=U("Textarea"),ta=U("Dialog");return v(),g(he,null,[u(c(ra),{title:"Productos"}),u(la,null,{default:_(()=>[u(o,{class:"z-[9999]"}),l("div",ya,[l("div",ha,[e[20]||(e[20]=l("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold text-center sm:text-start ml-0 sm:ml-4"},"Cat√°logo de Productos",-1)),l("div",xa,[u(c(ia),{href:a.route("catProductos"),onClick:Se,class:y([{"opacity-50 cursor-not-allowed":q.value},"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 flex items-center gap-2"])},{default:_(()=>[u(c(C),{icon:q.value?c($):c(ca),class:y({"animate-spin":q.value,"h-4":!0})},null,8,["icon","class"]),l("span",null,f(q.value?"Cargando...":"Gestionar categor√≠as"),1)]),_:1},8,["href","class"]),l("button",{class:"bg-red-500 border border-red-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:Ee},[u(c(C),{icon:c(xe),class:"h-4 w-4 mr-1 text-white"},null,8,["icon"]),e[19]||(e[19]=l("span",null,"¬†Agregar producto",-1))])])]),u(b,{value:re.value,dataKey:"id",paginator:!0,rows:oe.value,rowsPerPageOptions:_e.value,rowsPerPage:oe.value,"onUpdate:rowsPerPage":e[3]||(e[3]=s=>oe.value=s),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} productos",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:qe,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:_(()=>[l("div",wa,[l("div",_a,[l("div",ka,[e[21]||(e[21]=l("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[l("i",{class:"pi pi-filter text-blue-600 text-sm"}),l("span",null,"Filtros")],-1)),l("div",Ca,f(re.value.length)+" resultado"+f(re.value.length!==1?"s":""),1),l("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:pe,disabled:S.value},[S.value?(v(),ye(c(C),{key:0,icon:c($),class:"animate-spin h-3 w-3"},null,8,["icon"])):k("",!0),l("span",null,f(S.value?"Limpiando...":"Limpiar filtros"),1)],8,Pa)]),l("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:pe,disabled:S.value},[S.value?(v(),ye(c(C),{key:0,icon:c($),class:"animate-spin h-3 w-3"},null,8,["icon"])):k("",!0),l("span",null,f(S.value?"Limpiando...":"Limpiar filtros"),1)],8,Da)]),l("div",Va,[l("div",null,[u(r,{modelValue:w.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=s=>w.value.global.value=s),placeholder:"üîç Buscar productos...",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),l("div",Sa,[l("div",null,[u(n,{modelValue:Q.value,"onUpdate:modelValue":e[1]||(e[1]=s=>Q.value=s),options:H.value,optionLabel:"nombre",optionValue:"id",placeholder:"Categor√≠a",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},onChange:De,clearable:!0},null,8,["modelValue","options"])]),l("div",null,[u(n,{modelValue:X.value,"onUpdate:modelValue":e[2]||(e[2]=s=>X.value=s),options:we.value,optionLabel:"label",optionValue:"value",placeholder:"Estado",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},onChange:Ve,clearable:!0},null,8,["modelValue","options"])])])])])]),default:_(()=>[u(m,{field:"nombre",header:"Nombre",sortable:"",class:"w-28"},{body:_(s=>[l("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"100px","text-overflow":"ellipsis","white-space":"nowrap"},title:s.data.nombre},f(s.data.nombre),9,Ea)]),_:1}),u(m,{field:"descripcion",header:"Descripci√≥n",class:"w-28 hidden md:table-cell"},{body:_(s=>[l("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"100px","text-overflow":"ellipsis","white-space":"nowrap"},title:s.data.descripcion},f(s.data.descripcion),9,Aa)]),_:1}),u(m,{field:"categoria.nombre",header:"Categor√≠a",class:"w-32 hidden md:table-cell"},{body:_(s=>{var E;return[l("div",Ta,f(((E=s.data.categoria)==null?void 0:E.nombre)||"Sin categor√≠a"),1)]}),_:1}),u(m,{field:"precio",header:"Precio",class:"w-16"},{body:_(s=>[l("div",Ia,f(isNaN(Number(s.data.precio))?"":`$${Number(s.data.precio).toFixed(2)}`),1)]),_:1}),u(m,{field:"estado",header:"Estado",class:"w-28 hidden sm:table-cell"},{body:_(s=>[l("span",{class:y("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+ie(s.data).class)},f(ie(s.data).label),3)]),_:1}),u(m,{exportable:!1,class:"w-52 min-w-36"},{header:_(()=>e[22]||(e[22]=[l("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:_(s=>[l("div",Na,[l("button",{class:"flex bg-green-500 border p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:E=>Fe(s.data)},[u(c(C),{icon:c(ma),class:"h-4 w-7 text-white"},null,8,["icon"]),e[23]||(e[23]=l("span",{class:"hidden md:block text-white"},"M√°s",-1))],8,La),l("button",{class:"flex bg-blue-500 border p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:E=>Ae(s.data)},[u(c(C),{icon:c(va),class:"h-4 w-7 text-white"},null,8,["icon"]),e[24]||(e[24]=l("span",{class:"hidden md:block text-white"},"Editar",-1))],8,Ua),l("button",{class:"flex bg-red-500 border p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:E=>Ie(s.data)},[u(c(C),{icon:c(pa),class:"h-4 w-7 text-white"},null,8,["icon"]),e[25]||(e[25]=l("span",{class:"hidden md:block text-white"},"Eliminar",-1))],8,Fa)])]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"]),u(ta,{visible:A.value,"onUpdate:visible":e[10]||(e[10]=s=>A.value=s),header:R.value+" Producto",modal:!0,style:na(be.value),closable:!1,draggable:!1},{footer:_(()=>[l("div",xt,[l("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:Te,disabled:I.value},[u(c(C),{icon:I.value?c($):c(ga),class:y(["h-5 text-white",{"animate-spin":I.value}])},null,8,["icon","class"]),I.value?(v(),g("span",kt,f(R.value==="Guardar"?"Guardando...":"Actualizando..."),1)):(v(),g("span",_t,f(R.value),1))],8,wt),l("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Le,disabled:I.value},[u(c(C),{icon:c(fa),class:"h-5"},null,8,["icon"]),e[37]||(e[37]=P("Cancelar "))],8,Ct)])]),default:_(()=>[l("div",za,[l("div",Ma,[l("div",Oa,[e[26]||(e[26]=l("label",{for:"nombre",class:"w-24 flex items-center gap-1"},[P(" Nombre: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),u(r,{modelValue:t.value.nombre,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.nombre=s),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:100,class:y([{"p-invalid":h.value&&(!t.value.nombre||t.value.nombre.length<3||t.value.nombre.length>100)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"Taza para caf√©, etc.",onInput:Je},null,8,["modelValue","class"])]),t.value.nombre&&t.value.nombre.length<3?(v(),g("small",$a," El nombre debe tener al menos 3 caracteres. Actual: "+f(t.value.nombre.length)+"/3 ",1)):k("",!0),t.value.nombre&&t.value.nombre.length>=90&&t.value.nombre.length<=100?(v(),g("small",Ba," Caracteres restantes: "+f(100-t.value.nombre.length),1)):k("",!0),h.value&&!t.value.nombre?(v(),g("small",Ga," El nombre es obligatorio. ")):k("",!0)]),l("div",ja,[l("div",qa,[e[27]||(e[27]=l("label",{for:"descripcion",class:"w-24 flex items-center gap-1 mt-2"},[P(" Descripci√≥n: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),u(N,{modelValue:t.value.descripcion,"onUpdate:modelValue":e[5]||(e[5]=s=>t.value.descripcion=s),modelModifiers:{trim:!0},id:"descripcion",name:"descripcion",maxlength:255,rows:"3",class:y([{"p-invalid":h.value&&(!t.value.descripcion||t.value.descripcion.length<10||t.value.descripcion.length>255)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),onInput:He,placeholder:"Taza de cer√°mica ideal para caf√© calientes, etc."},null,8,["modelValue","class"])]),t.value.descripcion&&t.value.descripcion.length<10?(v(),g("small",Ra," La descripci√≥n debe tener al menos 10 caracteres. Actual: "+f(t.value.descripcion.length)+"/10 ",1)):k("",!0),t.value.descripcion&&t.value.descripcion.length>=230&&t.value.descripcion.length<=255?(v(),g("small",Ka," Caracteres restantes: "+f(255-t.value.descripcion.length),1)):k("",!0),h.value&&!t.value.descripcion?(v(),g("small",Wa," La descripci√≥n es obligatoria. ")):k("",!0)]),l("div",Ja,[l("div",Ha,[e[28]||(e[28]=l("label",{for:"categoria_id",class:"w-36 sm:w-32 flex items-center gap-1"},[P(" Categor√≠a: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),u(n,{modelValue:t.value.categoria_id,"onUpdate:modelValue":e[6]||(e[6]=s=>t.value.categoria_id=s),options:H.value,optionLabel:"nombre",optionValue:"id",id:"categoria_id",name:"categoria_id",class:y(["w-full rounded-md border-2 border-gray-400 hover:border-gray-500",{"p-invalid":h.value&&!t.value.categoria_id}]),placeholder:"Seleccionar"},null,8,["modelValue","options","class"])]),h.value&&!t.value.categoria_id?(v(),g("small",Qa," La categor√≠a es obligatoria. ")):k("",!0)]),l("div",Xa,[l("div",Ya,[e[30]||(e[30]=l("label",{for:"precio",class:"w-24 flex items-center gap-1"},[P(" Precio: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),l("div",Za,[e[29]||(e[29]=l("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 pointer-events-none"},"$",-1)),u(r,{modelValue:t.value.precio,"onUpdate:modelValue":e[7]||(e[7]=s=>t.value.precio=s),id:"precio",name:"precio",type:"text",inputmode:"decimal",class:y(["w-full pl-8 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":h.value&&(!t.value.precio||t.value.precio<=0||t.value.precio>9999.99)}]),placeholder:"0.00",onKeydown:Qe,onPaste:Xe},null,8,["modelValue","class"])])]),h.value&&(t.value.precio==null||t.value.precio<=0||t.value.precio>9999.99)?(v(),g("small",et," El precio es obligatorio, debe ser mayor a 0 y menor o igual a 9999.99. ")):k("",!0)]),l("div",at,[l("div",tt,[l("label",{for:"stock_actual",class:y(["block mb-2",t.value.id!==null?"text-gray-500":""])},[e[31]||(e[31]=P(" Stock actual: ")),t.value.id===null?(v(),g("span",lt,"*")):(v(),g("span",ot,"(Deshabilitado)"))],2),u(r,{modelValue:t.value.stock_actual,"onUpdate:modelValue":e[8]||(e[8]=s=>t.value.stock_actual=s),id:"stock_actual",name:"stock_actual",type:"number",inputmode:"numeric",min:"0",max:"9999",disabled:t.value.id!==null,class:y([{"bg-gray-100 cursor-not-allowed":t.value.id!==null,"border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none":t.value.id===null,"border-2 border-gray-300":t.value.id!==null},"w-full rounded-md"]),placeholder:"0",onKeydown:Ye,onPaste:Ze},null,8,["modelValue","disabled","class"]),t.value.id!==null?(v(),g("small",st,' Para actualizar el stock usa el bot√≥n "M√°s" ‚Üí "Actualizar Stock" ')):k("",!0)]),l("div",rt,[l("label",{for:"stock_minimo",class:y(["block mb-2",t.value.id!==null?"text-gray-500":""])},[e[32]||(e[32]=P(" Stock m√≠nimo: ")),t.value.id===null?(v(),g("span",it,"*")):(v(),g("span",nt,"(Deshabilitado)"))],2),u(r,{modelValue:t.value.stock_minimo,"onUpdate:modelValue":e[9]||(e[9]=s=>t.value.stock_minimo=s),id:"stock_minimo",name:"stock_minimo",type:"number",inputmode:"numeric",min:"1",max:"100",disabled:t.value.id!==null,class:y([{"bg-gray-100 cursor-not-allowed":t.value.id!==null,"border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none":t.value.id===null,"border-2 border-gray-300":t.value.id!==null},"w-full rounded-md"]),placeholder:"1",onKeydown:ea,onPaste:aa},null,8,["modelValue","disabled","class"]),t.value.id!==null?(v(),g("small",dt,' Para actualizar el stock m√≠nimo usa "Actualizar Stock" ')):k("",!0)])]),l("div",ut,[l("div",ct,[e[35]||(e[35]=l("label",{for:"imagenes",class:"w-24 flex items-center gap-1"},[P("Im√°genes:"),l("span",{class:"text-red-500 font-bold"},"*")],-1)),l("div",mt,[l("div",vt,[l("input",{type:"file",id:"imagenes",name:"imagenes[]",accept:"image/*",multiple:"",onChange:Ke,class:"hidden",ref_key:"fileInput",ref:me},null,544),l("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 outline-none focus:outline-none active:outline-none disabled:opacity-50 disabled:cursor-not-allowed",onClick:Re,disabled:M.value||O.value||!ve.value},[u(c(C),{icon:M.value?c($):O.value?c($):c(xe),class:y({"animate-spin":M.value||O.value})},null,8,["icon","class"]),P(" "+f(ke.value),1)],8,pt),l("div",gt,[l("span",{class:y(["text-sm font-medium",p.value.length>=5?"text-red-600":"text-gray-600"])},f(p.value.length)+"/5 ",3),e[33]||(e[33]=l("span",{class:"text-xs text-gray-500"},"im√°genes",-1))])]),e[34]||(e[34]=l("div",{class:"text-xs text-gray-500 mb-2"}," M√°ximo 5 im√°genes por producto ‚Ä¢ Formatos: JPG, PNG, GIF ‚Ä¢ Tama√±o m√°ximo: 2MB por imagen ",-1))])]),h.value&&p.value.length===0?(v(),g("small",ft,"Las im√°genes son obligatorias (al menos una).")):k("",!0)]),l("div",bt,[(v(!0),g(he,null,da(p.value,(s,E)=>(v(),g("div",{key:E,class:"relative w-24 sm:w-28 h-24 sm:h-28"},[l("img",{src:s.startsWith("data:image")?s:ue+s,alt:"Vista previa",class:"w-full h-full object-cover rounded border"},null,8,yt),l("button",{onClick:Dt=>We(E),class:"absolute top-2 right-2 bg-gray-600/80 hover:bg-gray-700/80 text-white font-bold py-1 px-2 rounded-full shadow",style:{transform:"translate(50%, -50%)"}},e[36]||(e[36]=[l("i",{class:"pi pi-times text-xs"},null,-1)]),8,ht)]))),128))])])]),_:1},8,["visible","header","style"]),u(ba,{visible:V.value,"onUpdate:visible":e[11]||(e[11]=s=>V.value=s),"details-visible":W.value,"onUpdate:detailsVisible":e[12]||(e[12]=s=>W.value=s),"carousel-visible":te.value,"onUpdate:carouselVisible":e[13]||(e[13]=s=>te.value=s),"delete-visible":z.value,"onUpdate:deleteVisible":e[14]||(e[14]=s=>z.value=s),"unsaved-changes-visible":j.value,"onUpdate:unsavedChangesVisible":e[15]||(e[15]=s=>j.value=s),"update-stock-visible":J.value,"onUpdate:updateStockVisible":e[16]||(e[16]=s=>J.value=s),"carousel-index":se.value,"onUpdate:carouselIndex":e[17]||(e[17]=s=>se.value=s),producto:x.value||t.value,"dialog-style":be.value,"selected-images":ae.value,"image-path":ue,"is-deleting":le.value,onDuplicate:ze,onUpdateStock:Me,onGenerateReport:Oe,onArchive:$e,onDeleteProduct:Ne,onCancelDelete:e[18]||(e[18]=()=>z.value=!1),onCloseWithoutSaving:ge,onContinueEditing:Ue,onViewDetails:Be,onOpenImageModal:je,onStockUpdated:Ge},null,8,["visible","details-visible","carousel-visible","delete-visible","unsaved-changes-visible","update-stock-visible","carousel-index","producto","dialog-style","selected-images","is-deleting"])])]),_:1})],64)}}};export{Lt as default};
