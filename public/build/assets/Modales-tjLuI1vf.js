import{F as i,g as E,m as le}from"./ui-DrLUz167.js";import{p as G,e as D,k as H,l as oe,s as N,f as ne,B as re,z as ie,c as X}from"./index-t8PHqkOa.js";import{f as de}from"./index-DtyEsSN9.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as V,r as me,w as S,a6 as ue,c as m,d as r,p as c,x as p,e,q as d,t as o,j as R,$ as a,h,A as Z,F as I,y as ve}from"./vendor-CqKcGHPa.js";const be={class:"space-y-4"},fe={class:"text-center mb-4"},xe={class:"text-lg font-semibold text-gray-800"},ge={class:"text-blue-600"},ye={class:"text-sm text-gray-600 mt-1"},pe={class:"grid grid-cols-1 gap-3"},he=["disabled"],we={class:"text-left flex-1"},Re={class:"font-medium"},ke={class:"text-xs opacity-90"},ze=["disabled"],Ae={class:"text-left flex-1"},Ce={class:"font-medium"},Ee={class:"text-xs opacity-90"},De={class:"flex justify-center gap-4 w-full mt-6"},Ne={key:0,class:"space-y-4 sm:space-y-6"},Ve={class:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4"},Se={class:"font-semibold text-blue-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},Ie={class:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 text-xs sm:text-sm"},Pe={class:"break-words"},Be={class:"ml-2"},Fe={class:"ml-2"},Te={class:"break-words"},je={class:"ml-2"},Me={key:0,class:"flex flex-col"},$e=["href"],Le={class:"ml-2"},Oe={key:0,class:"flex flex-col"},Ue=["href"],We={class:"bg-gray-50 border border-gray-200 rounded-lg p-3 sm:p-4"},qe={class:"font-semibold text-gray-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},Ge={class:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 text-xs sm:text-sm"},He={class:"break-words"},Xe={class:"ml-2"},Ze={class:"ml-2"},Je={class:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4"},Ke={class:"font-semibold text-green-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},Qe={class:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3 text-xs sm:text-sm"},Ye={class:"ml-2"},_e={class:"ml-2"},es={class:"col-span-2 sm:col-span-1"},ss={class:"ml-2 font-bold text-green-600"},ts={class:"flex justify-center gap-4 w-full mt-6"},as={class:"space-y-3 sm:space-y-4"},ls={class:"bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4 mb-4"},os={class:"flex items-start gap-2 sm:gap-3"},ns={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4"},rs={class:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3"},is={class:"text-xs sm:text-sm space-y-1"},ds={class:"break-words"},cs={class:"break-words"},ms={class:"text-gray-500 text-xs mt-1"},us={class:"flex justify-center gap-4 w-full mt-6"},vs=["disabled"],bs={key:2},fs={key:3},xs=["disabled"],gs={__name:"Modales",props:{visible:{type:Boolean,default:!1},detallesVisible:{type:Boolean,default:!1},rechazarVisible:{type:Boolean,default:!1},reserva:{type:Object,default:()=>({})},tour:{type:Object,default:()=>({})},dialogStyle:{type:Object,default:()=>({})},procesando:{type:Boolean,default:!1},confirmandoReserva:{type:Boolean,default:!1},rechazandoReserva:{type:Boolean,default:!1},estadosReservas:{type:Array,default:()=>[]},estadosTours:{type:Array,default:()=>[]}},emits:["update:visible","update:detallesVisible","update:rechazarVisible","confirmar","rechazar","verDetalles"],setup(t,{emit:J}){const y=t,w=J,u=V({get:()=>y.visible,set:l=>w("update:visible",l)}),f=V({get:()=>y.detallesVisible,set:l=>w("update:detallesVisible",l)}),x=V({get:()=>y.rechazarVisible,set:l=>w("update:rechazarVisible",l)}),g=me(""),A=l=>{if(!l||!l.estado)return[];switch(l.estado){case"PENDIENTE":return["confirmar","rechazar","detalles"];case"CONFIRMADA":return["rechazar","detalles"];case"REPROGRAMADA":return["rechazar","detalles"];case"CANCELADA":return["detalles"];case"FINALIZADA":return["detalles"];default:return["detalles"]}},K=l=>{const s=y.estadosReservas.find(n=>n.value===l);return(s==null?void 0:s.color)||"bg-gray-100 text-gray-800"},P=l=>{if(!l)return"N/A";const s=new Date(l);return s.getHours()===0&&s.getMinutes()===0?s.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):s.toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},Q=()=>{w("confirmar",y.reserva)},Y=()=>{g.value="",u.value=!1,x.value=!0},_=()=>{w("rechazar",{reserva:y.reserva,motivo:g.value})},ee=()=>{u.value=!1,f.value=!0},se=()=>{g.value=""},C=()=>{document.body.style.overflow="hidden",document.body.style.paddingRight="15px"},k=()=>{document.body.style.overflow="",document.body.style.paddingRight=""},te=()=>{x.value=!1,se()};return S(u,l=>{l?C():!f.value&&!x.value&&k()}),S(f,l=>{l?C():!u.value&&!x.value&&k()}),S(x,l=>{l?C():!u.value&&!f.value&&k()}),ue(()=>{k()}),(l,s)=>(r(),m(I,null,[c(a(E),{visible:u.value,"onUpdate:visible":s[1]||(s[1]=n=>u.value=n),header:"Más Acciones",modal:!0,style:Z(t.dialogStyle),closable:!1,draggable:!1},{footer:p(()=>[e("div",De,[e("button",{type:"button",onClick:s[0]||(s[0]=n=>u.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[c(a(i),{icon:a(N),class:"h-5"},null,8,["icon"]),s[9]||(s[9]=d(" Cerrar "))])])]),default:p(()=>{var n,v,b;return[e("div",be,[e("div",fe,[e("h4",xe,[s[6]||(s[6]=d(" Reserva: ")),e("span",ge,o(t.reserva.entidad_nombre||"Reserva"),1)]),e("p",ye," Cliente: "+o(((v=(n=t.reserva.cliente)==null?void 0:n.user)==null?void 0:v.name)||((b=t.reserva.cliente)==null?void 0:b.nombres)||"N/A"),1),s[7]||(s[7]=e("p",{class:"text-xs text-gray-500 mt-1"},"Selecciona una acción a realizar",-1))]),e("div",pe,[A(t.reserva).includes("detalles")?(r(),m("button",{key:0,class:"w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-md transition-all duration-200 ease-in-out flex items-center gap-3 justify-start",onClick:ee},[c(a(i),{icon:a(G),class:"h-5 w-5"},null,8,["icon"]),s[8]||(s[8]=e("div",{class:"text-left flex-1"},[e("div",{class:"font-medium"},"Ver Detalles"),e("div",{class:"text-xs opacity-90"},"Información completa de la reserva")],-1))])):R("",!0),A(t.reserva).includes("confirmar")?(r(),m("button",{key:1,class:"w-full bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-md transition-all duration-200 ease-in-out flex items-center gap-3 justify-start disabled:opacity-50 disabled:cursor-not-allowed",onClick:Q,disabled:t.confirmandoReserva},[t.confirmandoReserva?(r(),h(a(i),{key:0,icon:a(D),class:"h-5 w-5 animate-spin"},null,8,["icon"])):(r(),h(a(i),{key:1,icon:a(H),class:"h-5 w-5"},null,8,["icon"])),e("div",we,[e("div",Re,o(t.confirmandoReserva?"Confirmando...":"Confirmar Reserva"),1),e("div",ke,o(t.confirmandoReserva?"Procesando la confirmación":"Aprobar la reserva del cliente"),1)])],8,he)):R("",!0),A(t.reserva).includes("rechazar")?(r(),m("button",{key:2,class:"w-full bg-red-500 hover:bg-red-600 text-white px-4 py-3 rounded-md transition-all duration-200 ease-in-out flex items-center gap-3 justify-start disabled:opacity-50 disabled:cursor-not-allowed",onClick:Y,disabled:t.rechazandoReserva},[t.rechazandoReserva?(r(),h(a(i),{key:0,icon:a(D),class:"h-5 w-5 animate-spin"},null,8,["icon"])):(r(),h(a(i),{key:1,icon:a(oe),class:"h-5 w-5"},null,8,["icon"])),e("div",Ae,[e("div",Ce,o(t.rechazandoReserva?"Rechazando...":"Rechazar Reserva"),1),e("div",Ee,o(t.rechazandoReserva?"Procesando el rechazo":"Rechazar con motivo especificado"),1)])],8,ze)):R("",!0)])])]}),_:1},8,["visible","style"]),c(a(E),{visible:f.value,"onUpdate:visible":s[3]||(s[3]=n=>f.value=n),modal:"",header:"Detalles de la Reserva",style:{width:"95vw",maxWidth:"800px"},closable:!1,draggable:!1},{footer:p(()=>[e("div",ts,[e("button",{type:"button",onClick:s[2]||(s[2]=n=>f.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[c(a(i),{icon:a(N),class:"h-5"},null,8,["icon"]),s[25]||(s[25]=d("Cerrar "))])])]),default:p(()=>{var n,v,b,z,B,F,T,j,M,$,L,O,U,W,q;return[t.reserva?(r(),m("div",Ne,[e("div",Ve,[e("h4",Se,[c(a(i),{icon:a(G),class:"text-blue-600 text-sm sm:text-base"},null,8,["icon"]),s[10]||(s[10]=d(" Información del Cliente "))]),e("div",Ie,[e("div",Pe,[s[11]||(s[11]=e("span",{class:"font-medium text-gray-700"},"Nombre:",-1)),e("span",Be,o(((v=(n=t.reserva.cliente)==null?void 0:n.user)==null?void 0:v.name)||((b=t.reserva.cliente)==null?void 0:b.nombres)||"Problema al obtener nombre o no existe"),1)]),e("div",null,[s[12]||(s[12]=e("span",{class:"font-medium text-gray-700"},"Documento:",-1)),e("span",Fe,o(((z=t.reserva.cliente)==null?void 0:z.numero_identificacion)||"Problema al obtener documento o no existe"),1)]),e("div",Te,[s[14]||(s[14]=e("span",{class:"font-medium text-gray-700"},"Email:",-1)),e("span",je,[(F=(B=t.reserva.cliente)==null?void 0:B.user)!=null&&F.email||(T=t.reserva.cliente)!=null&&T.correo?(r(),m("div",Me,[e("a",{href:`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(((M=(j=t.reserva.cliente)==null?void 0:j.user)==null?void 0:M.email)||(($=t.reserva.cliente)==null?void 0:$.correo))}`,target:"_blank",rel:"noopener noreferrer",class:"text-blue-600 hover:underline flex items-center gap-1"},[c(a(i),{icon:a(ne),class:"h-4 w-4 mr-1"},null,8,["icon"]),d(" "+o(((O=(L=t.reserva.cliente)==null?void 0:L.user)==null?void 0:O.email)||((U=t.reserva.cliente)==null?void 0:U.correo)),1)],8,$e),s[13]||(s[13]=e("span",{class:"text-xs text-blue-700 mt-1"},"Toca para escribir por Gmail",-1))])):(r(),m(I,{key:1},[d(" Problema al obtener email o no existe ")],64))])]),e("div",null,[s[16]||(s[16]=e("span",{class:"font-medium text-gray-700"},"Teléfono:",-1)),e("span",Le,[(W=t.reserva.cliente)!=null&&W.telefono?(r(),m("div",Oe,[e("a",{href:`https://wa.me/${t.reserva.cliente.telefono.replace(/[^\d]/g,"")}`,target:"_blank",rel:"noopener noreferrer",class:"text-green-600 hover:underline flex items-center gap-1"},[c(a(i),{icon:a(de),class:"h-4 w-4 mr-1"},null,8,["icon"]),d(" "+o(t.reserva.cliente.telefono),1)],8,Ue),s[15]||(s[15]=e("span",{class:"text-xs text-green-700 mt-1"},"Toca para contactar por WhatsApp",-1))])):(r(),m(I,{key:1},[d(" Problema al obtener teléfono o no existe ")],64))])])])]),e("div",We,[e("h4",qe,[c(a(i),{icon:a(re),class:"text-gray-600 text-sm sm:text-base"},null,8,["icon"]),s[17]||(s[17]=d(" Información del Servicio "))]),e("div",Ge,[e("div",He,[s[18]||(s[18]=e("span",{class:"font-medium text-gray-700"},"Servicio:",-1)),e("span",Xe,o(t.reserva.entidad_nombre||"Problema al obtener servicio o no existe"),1)]),e("div",null,[s[19]||(s[19]=e("span",{class:"font-medium text-gray-700"},"Reservado:",-1)),e("span",Ze,o(P(t.reserva.fecha_reserva)||"Problema al obtener fecha o no existe"),1)]),e("div",null,[s[20]||(s[20]=e("span",{class:"font-medium text-gray-700"},"Estado:",-1)),e("span",{class:ve([K(t.reserva.estado),"ml-2 px-2 py-1 rounded-full text-xs font-medium"])},o(((q=t.estadosReservas.find(ae=>ae.value===t.reserva.estado))==null?void 0:q.label)||t.reserva.estado||"Problema al obtener estado o no existe"),3)])])]),e("div",Je,[e("h4",Ke,[c(a(i),{icon:a(ie),class:"text-green-600 text-sm sm:text-base"},null,8,["icon"]),s[21]||(s[21]=d(" Detalles de la Reserva "))]),e("div",Qe,[e("div",null,[s[22]||(s[22]=e("span",{class:"font-medium text-gray-700"},"Adultos:",-1)),e("span",Ye,o(t.reserva.mayores_edad||0),1)]),e("div",null,[s[23]||(s[23]=e("span",{class:"font-medium text-gray-700"},"Niños:",-1)),e("span",_e,o(t.reserva.menores_edad||0),1)]),e("div",es,[s[24]||(s[24]=e("span",{class:"font-medium text-gray-700"},"Total:",-1)),e("span",ss,"$"+o(Number(t.reserva.total||0).toFixed(2)),1)])])])])):R("",!0)]}),_:1},8,["visible"]),c(a(E),{visible:x.value,"onUpdate:visible":s[5]||(s[5]=n=>x.value=n),modal:"",header:"Rechazar Reserva",style:Z(t.dialogStyle),closable:!1,draggable:!1},{footer:p(()=>[e("div",us,[e("button",{onClick:_,disabled:!g.value.trim()||t.procesando,class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[t.procesando?(r(),h(a(i),{key:0,icon:a(D),class:"animate-spin h-5 text-white"},null,8,["icon"])):(r(),h(a(i),{key:1,icon:a(H),class:"h-5"},null,8,["icon"])),t.procesando?(r(),m("span",fs,"Eliminando...")):(r(),m("span",bs,"Eliminar Reserva Definitivamente"))],8,vs),e("button",{type:"button",onClick:te,disabled:t.procesando,class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[c(a(i),{icon:a(N),class:"h-5"},null,8,["icon"]),s[33]||(s[33]=d("Cancelar "))],8,xs)])]),default:p(()=>{var n,v,b;return[e("div",as,[e("div",ls,[e("div",os,[c(a(i),{icon:a(X),class:"text-orange-600 text-base sm:text-lg mt-1 flex-shrink-0"},null,8,["icon"]),s[26]||(s[26]=e("div",null,[e("h4",{class:"font-semibold text-orange-800 text-sm sm:text-base mb-2"},"¡ADVERTENCIA - Acción Permanente!"),e("div",{class:"text-xs sm:text-sm text-orange-700 space-y-1"},[e("p",null,[e("strong",null,"• Esta acción NO se puede deshacer")]),e("p",null,"• La reserva será ELIMINADA completamente de la base de datos"),e("p",null,"• Se liberarán automáticamente los cupos del tour"),e("p",null,"• Se enviará una notificación por email al cliente"),e("p",null,"• No será posible recuperar esta información posteriormente")])],-1))])]),t.reserva?(r(),m("div",ns,[e("div",rs,[c(a(i),{icon:a(X),class:"text-red-600 text-base sm:text-lg"},null,8,["icon"]),s[27]||(s[27]=e("h4",{class:"font-medium text-red-800 text-sm sm:text-base"},"Confirmar Rechazo",-1))]),e("div",is,[e("p",ds,[s[28]||(s[28]=e("strong",null,"Cliente:",-1)),d(" "+o(((v=(n=t.reserva.cliente)==null?void 0:n.user)==null?void 0:v.name)||((b=t.reserva.cliente)==null?void 0:b.nombres)||"N/A"),1)]),e("p",cs,[s[29]||(s[29]=e("strong",null,"Servicio:",-1)),d(" "+o(t.reserva.entidad_nombre),1)]),e("p",null,[s[30]||(s[30]=e("strong",null,"Fecha:",-1)),d(" "+o(P(t.reserva.fecha_reserva)),1)]),e("p",null,[s[31]||(s[31]=e("strong",null,"Total:",-1)),d(" $"+o(Number(t.reserva.total||0).toFixed(2)),1)])])])):R("",!0),e("div",null,[s[32]||(s[32]=e("label",{class:"block text-xs sm:text-sm font-medium text-gray-700 mb-2"},[d(" Motivo del rechazo "),e("span",{class:"text-red-500"},"*")],-1)),c(a(le),{modelValue:g.value,"onUpdate:modelValue":s[4]||(s[4]=z=>g.value=z),placeholder:"Especifica el motivo por el cual se rechaza esta reserva...",rows:"4",class:"w-full text-xs sm:text-sm",maxlength:"500",pt:{root:"w-full",textarea:"text-xs sm:text-sm p-2 sm:p-3"}},null,8,["modelValue"]),e("small",ms,o(g.value.length)+"/500 caracteres ",1)])])]}),_:1},8,["visible","style"])],64))}},ks=ce(gs,[["__scopeId","data-v-3da992e7"]]);export{ks as default};
