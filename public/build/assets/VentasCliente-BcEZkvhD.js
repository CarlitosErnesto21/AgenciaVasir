import{A as q}from"./AuthenticatedLayout-B1--8ivd.js";import{r as u,E as v,o as z,h as _,d as h,x as i,p as a,e,$ as s,a0 as H,t as o,a1 as W,j as C,c as G,q as P,y as K}from"./vendor-CLNWHdEK.js";import{A as X,F as J,a as Q,D as d,e as Y,f as V,h as Z,o as ee,g as te}from"./ui-DPmvhuIJ.js";import{H as se,a8 as le,a as ae,ad as oe,v as ne,ac as de,t as ie,f as S,g as re}from"./index-Bt2ku3xk.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={class:"container mx-auto px-4 py-6"},ue={class:"mb-6 bg-white rounded-lg shadow-md p-6"},me={class:"flex items-center justify-between"},pe={class:"flex items-center gap-4"},ge={class:"flex items-center gap-2"},xe={class:"text-lg font-semibold text-gray-800"},be={class:"flex items-center gap-2"},fe={class:"text-sm text-gray-600"},ve={class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-4 gap-4 mb-6"},he={class:"bg-white rounded-lg shadow-md p-3"},we={class:"flex flex-col items-center text-center"},ye={class:"p-1.5 rounded-full bg-blue-100 mb-2"},_e={class:"text-lg font-bold text-gray-900"},Ce={class:"bg-white rounded-lg shadow-md p-3"},Pe={class:"flex flex-col items-center text-center"},Ve={class:"p-1.5 rounded-full bg-green-100 mb-2"},ke={class:"text-lg font-bold text-gray-900"},Le={class:"bg-white rounded-lg shadow-md p-3"},Fe={class:"flex flex-col items-center text-center"},De={class:"p-1.5 rounded-full bg-yellow-100 mb-2"},Te={class:"text-lg font-bold text-gray-900"},$e={class:"bg-white rounded-lg shadow-md p-3"},Ne={class:"flex flex-col items-center text-center"},Se={class:"p-1.5 rounded-full bg-green-100 mb-2"},Ae={class:"text-lg font-bold text-gray-900"},Re={class:"bg-white rounded-lg shadow-md"},je={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},Ee={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},Ie={class:"flex items-center gap-3"},Me={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Oe=["disabled"],Be=["disabled"],Ue={class:"space-y-3"},qe={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},ze={class:"font-medium text-blue-600"},He={class:"text-sm"},We={class:"text-sm font-semibold text-green-600"},Ge={key:0,class:"space-y-4"},Ke={class:"grid grid-cols-1 gap-4"},Xe={class:"bg-gray-50 p-4 rounded-lg"},Je={class:"space-y-2"},Qe={class:"text-lg font-semibold text-green-600"},Ye={class:"flex justify-center w-full"},at={__name:"VentasCliente",props:{cliente:{type:Object,required:!0},ventas:{type:Array,default:()=>[]}},setup(m){const p=m,k=X(),w=u(10),A=u([5,10,20,50]),g=u(""),r=u(null),x=u(!1),c=u(!1),R=u([{label:"Todos los estados",value:""},{label:"Pendientes",value:"pendiente"},{label:"Completadas",value:"completada"},{label:"Canceladas",value:"cancelada"}]),b=u({global:{value:null,matchMode:J.CONTAINS}}),y=v(()=>{let l=p.ventas;if(g.value&&(l=l.filter(t=>t.estado===g.value)),b.value.global.value){const t=b.value.global.value.toLowerCase();l=l.filter(f=>f.id.toString().includes(t))}return l}),j=v(()=>p.ventas.reduce((l,t)=>l+parseFloat(t.total),0)),E=v(()=>p.ventas.filter(l=>l.estado==="pendiente").length),I=v(()=>p.ventas.filter(l=>l.estado==="completada").length),L=l=>new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"}),M=l=>{switch(l){case"completada":return"bg-green-100 text-green-800";case"pendiente":return"bg-yellow-100 text-yellow-800";case"cancelada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},O=l=>{switch(l){case"completada":return"Completada";case"pendiente":return"Pendiente";case"cancelada":return"Cancelada";default:return l}},B=l=>{r.value=l.data,x.value=!0},U=()=>{x.value=!1,r.value=null},F=async()=>{c.value=!0,await new Promise(l=>setTimeout(l,300)),g.value="",c.value=!1,k.add({severity:"success",summary:"Filtros limpiados",detail:"Los filtros han sido limpiados exitosamente",life:3e3})};return z(()=>{k.add({severity:"success",summary:"Ventas cargadas",detail:`Se encontraron ${p.ventas.length} ventas para este cliente.`,life:3e3})}),(l,t)=>(h(),_(q,null,{default:i(()=>{var f,D,T,$,N;return[a(s(H),{title:`Ventas de ${((D=(f=m.cliente)==null?void 0:f.user)==null?void 0:D.name)||"Cliente"}`},null,8,["title"]),a(s(Q),{class:"z-[9999]"}),e("div",ce,[e("div",ue,[e("div",me,[e("div",null,[t[4]||(t[4]=e("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Ventas del Cliente",-1)),e("div",pe,[e("div",ge,[a(s(d),{icon:s(se),class:"text-blue-500"},null,8,["icon"]),e("span",xe,o((($=(T=m.cliente)==null?void 0:T.user)==null?void 0:$.name)||"Cliente no encontrado"),1)]),e("div",be,[a(s(d),{icon:s(le),class:"text-gray-500"},null,8,["icon"]),e("span",fe,o(((N=m.cliente)==null?void 0:N.numero_identificacion)||"N/A"),1)])])]),a(s(W),{href:l.route("clientes"),class:"bg-blue-500 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 text-sm"},{default:i(()=>[a(s(d),{icon:s(ae),class:"h-4 w-4"},null,8,["icon"]),t[5]||(t[5]=e("span",{class:"hidden sm:inline"},"Volver a Clientes",-1)),t[6]||(t[6]=e("span",{class:"sm:hidden"},"Volver",-1))]),_:1,__:[5,6]},8,["href"])])]),e("div",ve,[e("div",he,[e("div",we,[e("div",ye,[a(s(d),{icon:s(oe),class:"h-4 w-4 text-blue-600"},null,8,["icon"])]),t[7]||(t[7]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Total",-1)),e("p",_e,o(m.ventas.length),1)])]),e("div",Ce,[e("div",Pe,[e("div",Ve,[a(s(d),{icon:s(ne),class:"h-4 w-4 text-green-600"},null,8,["icon"])]),t[8]||(t[8]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Monto",-1)),e("p",ke,"$"+o(j.value.toFixed(0)),1)])]),e("div",Le,[e("div",Fe,[e("div",De,[a(s(d),{icon:s(de),class:"h-4 w-4 text-yellow-600"},null,8,["icon"])]),t[9]||(t[9]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Pendientes",-1)),e("p",Te,o(E.value),1)])]),e("div",$e,[e("div",Ne,[e("div",Se,[a(s(d),{icon:s(ie),class:"h-4 w-4 text-green-600"},null,8,["icon"])]),t[10]||(t[10]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Completadas",-1)),e("p",Ae,o(I.value),1)])])]),e("div",Re,[t[12]||(t[12]=e("h3",{class:"text-2xl text-blue-600 font-bold mb-4"},"Historial de Ventas",-1)),a(s(Y),{value:y.value,dataKey:"id",paginator:!0,rows:w.value,rowsPerPageOptions:A.value,rowsPerPage:w.value,"onUpdate:rowsPerPage":t[2]||(t[2]=n=>w.value=n),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} ventas",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:B,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-16 text-sm hover:bg-blue-50 transition-colors duration-200 cursor-pointer"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:i(()=>[e("div",je,[e("div",Ee,[e("div",Ie,[t[11]||(t[11]=e("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[e("i",{class:"pi pi-filter text-blue-600 text-sm"}),e("span",null,"Filtros")],-1)),e("div",Me,o(y.value.length)+" resultado"+o(y.value.length!==1?"s":""),1),e("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:F,disabled:c.value},[c.value?(h(),_(s(d),{key:0,icon:s(S),class:"animate-spin h-3 w-3"},null,8,["icon"])):C("",!0),e("span",null,o(c.value?"Limpiando...":"Limpiar filtros"),1)],8,Oe)]),e("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:F,disabled:c.value},[c.value?(h(),_(s(d),{key:0,icon:s(S),class:"animate-spin h-3 w-3"},null,8,["icon"])):C("",!0),e("span",null,o(c.value?"Limpiando...":"Limpiar filtros"),1)],8,Be)]),e("div",Ue,[e("div",qe,[a(s(Z),{modelValue:b.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=n=>b.value.global.value=n),placeholder:"üîç Buscar ventas...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"]),a(s(ee),{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=n=>g.value=n),options:R.value,optionLabel:"label",optionValue:"value",placeholder:"Filtrar por estado",class:"w-full text-sm border border-blue-300",pt:{root:{class:"h-9"},input:{class:"text-sm"},dropdown:{class:"text-sm"}}},null,8,["modelValue","options"])])])])]),default:i(()=>[a(s(V),{field:"id",header:"ID",sortable:"",class:"w-16"},{body:i(n=>[e("span",ze,"#"+o(n.data.id),1)]),_:1}),a(s(V),{field:"fecha",header:"Fecha",sortable:"",class:"w-28"},{body:i(n=>[e("span",He,o(L(n.data.fecha)),1)]),_:1}),a(s(V),{field:"total",header:"Total",sortable:"",class:"w-24"},{body:i(n=>[e("span",We," $"+o(Number(n.data.total).toFixed(2)),1)]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"])])]),a(s(te),{visible:x.value,"onUpdate:visible":t[3]||(t[3]=n=>x.value=n),header:"Detalles de la Venta",modal:!0,style:{width:"90vw",maxWidth:"600px"},closable:!0,draggable:!1},{footer:i(()=>[e("div",Ye,[e("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:U},[a(s(d),{icon:s(re),class:"h-5"},null,8,["icon"]),t[18]||(t[18]=P(" Cerrar "))])])]),default:i(()=>[r.value?(h(),G("div",Ge,[e("div",Ke,[e("div",Xe,[t[17]||(t[17]=e("h4",{class:"font-semibold text-gray-800 mb-3"},"Informaci√≥n General",-1)),e("div",Je,[e("p",null,[t[13]||(t[13]=e("strong",null,"ID de Venta:",-1)),P(" #"+o(r.value.id),1)]),e("p",null,[t[14]||(t[14]=e("strong",null,"Fecha:",-1)),P(" "+o(L(r.value.fecha)),1)]),e("p",null,[t[15]||(t[15]=e("strong",null,"Estado:",-1)),e("span",{class:K([M(r.value.estado),"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-2"])},o(O(r.value.estado)),3)]),e("p",null,[t[16]||(t[16]=e("strong",null,"Total:",-1)),e("span",Qe,"$"+o(Number(r.value.total).toFixed(2)),1)])])])])])):C("",!0)]),_:1},8,["visible"])]}),_:1}))}};export{at as default};
