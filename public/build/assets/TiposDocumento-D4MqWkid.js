import{A as be}from"./AuthenticatedLayout-F65G6cJn.js";import{b as fe,r,E as Z,w as ge,n as $,o as xe,h as R,d as p,x as c,p as n,e as s,$ as a,a0 as ye,t as v,j as A,A as q,c as C,q as L,y as M,N as j}from"./vendor-CLNWHdEK.js";import{A as he,a as we,D as u,e as Ce,f as J,h as H,g as F}from"./ui-DPmvhuIJ.js";import{b as ke,c as K,d as _e,f as N,e as X,g as Q,h as Y,i as Te}from"./index-Bl_KdgJY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Pe={class:"container mx-auto px-4 py-6"},Ee={class:"bg-white rounded-lg shadow-md"},De={class:"flex flex-col sm:flex-row lg:justify-between lg:items-center mb-4 gap-4 p-6"},Ae={class:"flex items-center gap-2 w-full justify-center lg:w-auto lg:justify-end"},Le={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},je={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},Ne={class:"flex items-center gap-3"},Se={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},ze=["disabled"],Oe=["disabled"],Ue={class:"space-y-3"},Ve=["title"],$e={class:"flex gap-2 justify-center items-center"},Re=["onClick"],qe=["onClick"],Me={class:"space-y-4"},Fe={class:"w-full flex flex-col"},Ie={class:"flex items-center gap-4"},Be={key:0,class:"text-red-500 ml-28"},Ge={key:1,class:"text-orange-500 ml-28"},We={key:2,class:"text-red-500 ml-28"},Ze={class:"flex justify-center gap-4 w-full mt-6"},Je=["disabled"],He={key:0},Ke={key:1},Xe=["disabled"],Qe={class:"flex items-center gap-3"},Ye={class:"flex flex-col"},es={class:"flex justify-center gap-4 w-full"},ss=["disabled"],ts={key:0},as={key:1},ls=["disabled"],os={class:"flex items-center gap-3"},ns={class:"flex justify-center gap-3 w-full"},ms={__name:"TiposDocumento",props:{tipoDocumentos:{type:Array,default:()=>[]}},setup(ee){const se=ee,d=he(),o=fe({id:null,nombre:""}),k=r(null),b=r(se.tipoDocumentos||[]),m=r(!1),w=r(!1),x=r(!1),S=r(!0),y=r(!1),T=r(!1),P=r(!1),f=r(!1),E=r(!1),_=r(null),h=r(!1),g=r(null),z=r(10),te=r([5,10,20,50]),D=r({global:{value:null,matchMode:"contains"}}),O=Z(()=>({width:"95vw",maxWidth:"500px",maxHeight:"95vh"})),U=Z(()=>{let l=b.value;if(D.value.global.value){const e=D.value.global.value.toLowerCase();l=l.filter(t=>t.nombre.toLowerCase().includes(e))}return l});ge([o],()=>{g.value&&(f.value||E.value)&&$(()=>{const l={...o},e=JSON.stringify(l)!==JSON.stringify(g.value),t=!g.value.id,i=o.nombre;h.value=e||t&&i})},{deep:!0,flush:"post"});const ae=()=>{Object.assign(o,{id:null,nombre:""}),y.value=!1,f.value=!0,$(()=>{g.value={...o},h.value=!1})},le=l=>{k.value=l.data},oe=l=>{_.value=l,Object.assign(o,{id:l.id,nombre:l.nombre}),y.value=!1,E.value=!0,$(()=>{g.value={...o},h.value=!1})},ne=l=>{k.value=l,T.value=!0},re=async()=>{var l,e;w.value=!0;try{if((await j.delete(`/api/tipo-documentos/${k.value.id}`)).data.success){const i=b.value.findIndex(V=>V.id===k.value.id);i!==-1&&b.value.splice(i,1),d.add({severity:"success",summary:"Tipo eliminado",detail:"El tipo de documento ha sido eliminado correctamente",life:3e3}),T.value=!1,k.value=null}}catch(t){console.error("Error al eliminar tipo:",t),d.add({severity:"error",summary:"Error",detail:((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"Error al eliminar el tipo de documento",life:3e3})}finally{w.value=!1}},I=async()=>{x.value=!0;try{await new Promise(l=>setTimeout(l,300)),D.value.global.value=null,d.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{x.value=!1}},ie=async()=>{var l,e;if(y.value=!0,!o.nombre||o.nombre.length<3||o.nombre.length>20){d.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que el nombre estÃ© completo y cumpla los requisitos.",life:4e3});return}m.value=!0;try{const t=await j.post("/api/tipo-documentos",{nombre:o.nombre.trim()});t.data.success&&(b.value.push(t.data.tipo_documento),h.value=!1,g.value=null,B(),d.add({severity:"success",summary:"Ã‰xito",detail:"Tipo de documento creado exitosamente",life:3e3}))}catch(t){console.error("Error al crear tipo:",t),d.add({severity:"error",summary:"Error",detail:((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"Error al crear el tipo de documento",life:3e3})}finally{m.value=!1}},de=async()=>{var l,e;if(y.value=!0,!o.nombre||o.nombre.length<3||o.nombre.length>20||!_.value){d.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que el nombre estÃ© completo y cumpla los requisitos.",life:4e3});return}m.value=!0;try{const t=await j.put(`/api/tipo-documentos/${_.value.id}`,{nombre:o.nombre.trim()});if(t.data.success){const i=b.value.findIndex(V=>V.id===_.value.id);i!==-1&&(b.value[i]=t.data.tipo_documento),h.value=!1,g.value=null,B(),d.add({severity:"success",summary:"Ã‰xito",detail:"Tipo de documento actualizado exitosamente",life:3e3})}}catch(t){console.error("Error al actualizar tipo:",t),d.add({severity:"error",summary:"Error",detail:((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"Error al actualizar el tipo de documento",life:3e3})}finally{m.value=!1}},B=()=>{f.value=!1,E.value=!1,_.value=null,m.value=!1,y.value=!1,h.value=!1,g.value=null,Object.assign(o,{id:null,nombre:""})},G=()=>{h.value?P.value=!0:W()},W=()=>{f.value=!1,E.value=!1,P.value=!1,h.value=!1,g.value=null,_.value=null,Object.assign(o,{id:null,nombre:""}),y.value=!1},ue=()=>{P.value=!1},ce=()=>{o.nombre&&o.nombre.length>20&&(o.nombre=o.nombre.substring(0,20))},me=l=>{const e=l.target.value,t=e.match(/[^a-zA-ZÃ¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘\s]/g);t&&t.length>0&&d.add({severity:"warn",summary:"Caracteres no permitidos",detail:"Solo se permiten letras, espacios y acentos. Se han removido los caracteres no vÃ¡lidos.",life:3e3});const i=e.replace(/[^a-zA-ZÃ¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘\s]/g,"").toUpperCase();l.target.value=i,o.nombre=i,ce()},pe=l=>{l.preventDefault();const e=(l.clipboardData||window.clipboardData).getData("text"),t=e.replace(/[^a-zA-ZÃ¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘\s]/g,"").replace(/\s+/g," ").trim().toUpperCase();t!==e.toUpperCase()&&d.add({severity:"info",summary:"Texto limpiado",detail:"Se han removido nÃºmeros y caracteres especiales del texto pegado y convertido a mayÃºsculas.",life:3e3});const i=t.length>20?t.substring(0,20):t;o.nombre=i,l.target.value=i},ve=async()=>{S.value=!0,d.add({severity:"info",summary:"Cargando tipos de documento...",life:2e3});try{const l=await j.get("/api/tipo-documentos");l.data.success&&(b.value=l.data.tipos),d.add({severity:"success",summary:"Tipos de documento cargados",life:2e3})}catch(l){console.error("Error loading tipos:",l),d.add({severity:"error",summary:"Error",detail:"Error al cargar los tipos de documento",life:4e3})}finally{S.value=!1}};return xe(()=>{console.log("Tipos de documento cargados:",b.value),b.value.length===0?ve():S.value=!1}),(l,e)=>(p(),R(be,null,{default:c(()=>[n(a(ye),{title:"Tipos de Documento"}),n(a(we),{class:"z-[9999]"}),s("div",Pe,[e[23]||(e[23]=s("div",{class:"mb-6"},[s("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"GestiÃ³n de Tipos de Documento"),s("p",{class:"text-gray-600"},"AdministraciÃ³n completa de tipos de documentos del sistema")],-1)),s("div",Ee,[s("div",De,[e[9]||(e[9]=s("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold text-center sm:text-start"},"Lista de Tipos de Documento",-1)),s("div",Ae,[s("button",{class:"bg-red-500 border border-red-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:ae},[n(a(u),{icon:a(ke),class:"h-4 w-4 mr-1 text-white"},null,8,["icon"]),e[8]||(e[8]=s("span",null,"Â Agregar tipo",-1))])])]),n(a(Ce),{value:U.value,dataKey:"id",paginator:!0,rows:z.value,rowsPerPageOptions:te.value,rowsPerPage:z.value,"onUpdate:rowsPerPage":e[1]||(e[1]=t=>z.value=t),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} tipos de documento",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:le,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:c(()=>[s("div",Le,[s("div",je,[s("div",Ne,[e[10]||(e[10]=s("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[s("i",{class:"pi pi-filter text-blue-600 text-sm"}),s("span",null,"Filtros")],-1)),s("div",Se,v(U.value.length)+" resultado"+v(U.value.length!==1?"s":""),1),s("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:I,disabled:x.value},[x.value?(p(),R(a(u),{key:0,icon:a(N),class:"animate-spin h-3 w-3"},null,8,["icon"])):A("",!0),s("span",null,v(x.value?"Limpiando...":"Limpiar filtros"),1)],8,ze)]),s("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:I,disabled:x.value},[x.value?(p(),R(a(u),{key:0,icon:a(N),class:"animate-spin h-3 w-3"},null,8,["icon"])):A("",!0),s("span",null,v(x.value?"Limpiando...":"Limpiar filtros"),1)],8,Oe)]),s("div",Ue,[s("div",null,[n(a(H),{modelValue:D.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=t=>D.value.global.value=t),placeholder:"ðŸ” Buscar tipos de documento...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])])])])]),default:c(()=>[n(a(J),{field:"nombre",header:"Nombre",sortable:"",class:"w-64"},{body:c(t=>[s("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"150px","text-overflow":"ellipsis","white-space":"nowrap"},title:t.data.nombre},v(t.data.nombre),9,Ve)]),_:1}),n(a(J),{exportable:!1,class:"w-52 min-w-36"},{header:c(()=>e[11]||(e[11]=[s("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:c(t=>[s("div",$e,[s("button",{class:"flex bg-blue-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:i=>oe(t.data)},[n(a(u),{icon:a(K),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[12]||(e[12]=s("span",{class:"hidden md:block text-white"},"Editar",-1))],8,Re),s("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:i=>ne(t.data)},[n(a(u),{icon:a(_e),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[13]||(e[13]=s("span",{class:"hidden md:block text-white"},"Eliminar",-1))],8,qe)])]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"])]),n(a(F),{visible:f.value||E.value,"onUpdate:visible":e[4]||(e[4]=t=>!t&&G()),header:(f.value?"Guardar":"Actualizar")+" Tipo de Documento",modal:!0,style:q(O.value),closable:!1,draggable:!1},{footer:c(()=>[s("div",Ze,[s("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:e[3]||(e[3]=t=>f.value?ie():de()),disabled:m.value},[n(a(u),{icon:m.value?a(N):a(X),class:M(["h-5 text-white",{"animate-spin":m.value}])},null,8,["icon","class"]),m.value?(p(),C("span",Ke,v(f.value?"Guardando...":"Actualizando..."),1)):(p(),C("span",He,v(f.value?"Guardar":"Actualizar"),1))],8,Je),s("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:G,disabled:m.value},[n(a(u),{icon:a(Q),class:"h-5"},null,8,["icon"]),e[15]||(e[15]=L("Cancelar "))],8,Xe)])]),default:c(()=>[s("div",Me,[s("div",Fe,[s("div",Ie,[e[14]||(e[14]=s("label",{for:"nombre",class:"w-24 flex items-center gap-1"},[L(" Nombre: "),s("span",{class:"text-red-500 font-bold"},"*")],-1)),n(a(H),{modelValue:o.nombre,"onUpdate:modelValue":e[2]||(e[2]=t=>o.nombre=t),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:20,class:M([{"p-invalid":y.value&&(!o.nombre||o.nombre.length<3||o.nombre.length>20)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md uppercase"]),placeholder:"DUI, PASAPORTE, ETC.",onInput:me,onPaste:pe},null,8,["modelValue","class"])]),o.nombre&&o.nombre.length<3?(p(),C("small",Be," El nombre debe tener al menos 3 caracteres. Actual: "+v(o.nombre.length)+"/3 ",1)):A("",!0),o.nombre&&o.nombre.length>=18&&o.nombre.length<=20?(p(),C("small",Ge," Caracteres restantes: "+v(20-o.nombre.length),1)):A("",!0),y.value&&!o.nombre?(p(),C("small",We," El nombre es obligatorio. ")):A("",!0)])])]),_:1},8,["visible","header","style"]),n(a(F),{visible:T.value,"onUpdate:visible":e[6]||(e[6]=t=>T.value=t),header:"Eliminar tipo de documento",modal:!0,style:q(O.value),closable:!1,draggable:!1},{footer:c(()=>[s("div",es,[s("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:re,disabled:w.value},[n(a(u),{icon:w.value?a(N):a(X),class:M(["h-5",{"animate-spin":w.value}])},null,8,["icon","class"]),w.value?(p(),C("span",as,"Eliminando...")):(p(),C("span",ts,"Eliminar"))],8,ss),s("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:e[5]||(e[5]=t=>T.value=!1),disabled:w.value},[n(a(u),{icon:a(Q),class:"h-5"},null,8,["icon"]),e[19]||(e[19]=s("span",null,"Cancelar",-1))],8,ls)])]),default:c(()=>{var t;return[s("div",Qe,[n(a(u),{icon:a(Y),class:"h-8 w-8 text-red-500"},null,8,["icon"]),s("div",Ye,[s("span",null,[e[16]||(e[16]=L("Â¿EstÃ¡s seguro de eliminar el tipo de documento: ")),s("b",null,v((t=k.value)==null?void 0:t.nombre),1),e[17]||(e[17]=L("?"))]),e[18]||(e[18]=s("span",{class:"text-red-600 text-sm font-medium mt-1"},"Esta acciÃ³n es irreversible.",-1))])])]}),_:1},8,["visible","style"]),n(a(F),{visible:P.value,"onUpdate:visible":e[7]||(e[7]=t=>P.value=t),header:"Cambios sin guardar",modal:!0,style:q(O.value),closable:!1,draggable:!1},{footer:c(()=>[s("div",ns,[s("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:W},[n(a(u),{icon:a(Te),class:"h-4"},null,8,["icon"]),e[21]||(e[21]=s("span",null,"Salir sin guardar",-1))]),s("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:ue},[n(a(u),{icon:a(K),class:"h-4"},null,8,["icon"]),e[22]||(e[22]=s("span",null,"Continuar",-1))])])]),default:c(()=>[s("div",os,[n(a(u),{icon:a(Y),class:"h-8 w-8 text-red-500"},null,8,["icon"]),e[20]||(e[20]=s("div",{class:"flex flex-col"},[s("span",null,"Â¡Tienes informaciÃ³n sin guardar!"),s("span",{class:"text-red-600 text-sm font-medium mt-1"},"Â¿Deseas salir sin guardar?")],-1))])]),_:1},8,["visible","style"])])]),_:1}))}};export{ms as default};
