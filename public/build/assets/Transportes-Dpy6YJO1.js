import{A as re}from"./AuthenticatedLayout-DmK10Wi9.js";import{r as u,E as oe,w as ne,n as B,o as de,N as I,k as E,c as p,d as v,p as r,$ as o,a0 as ie,x as n,e as l,a1 as ue,t as c,y as T,q as g,j as b,F as ce}from"./vendor-BOi6Gr0G.js";import{z as me,F as M,A as f,n as pe}from"./ui-BibPgP1I.js";import{f as ve,o as fe,b as R,c as ge,d as $,e as q,g as z,h as be}from"./index-B7S65CUL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const xe={class:"py-4 sm:py-6 px-4 sm:px-7 mt-6 sm:mt-10 mx-auto bg-red-50 shadow-lg rounded-lg h-screen-full"},ye={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2 sm:gap-0"},he={class:"flex items-center gap-3"},we={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},_e={class:"flex items-center justify-between mb-3"},Ce={class:"flex items-center gap-3"},ke={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Pe={class:"space-y-3"},Ee={class:"text-sm font-mono leading-relaxed"},Te={class:"text-sm font-medium leading-relaxed"},Le={class:"text-sm leading-relaxed text-center"},Ne={class:"text-sm leading-relaxed"},De={class:"flex gap-2 h-full justify-center items-center"},Ie=["onClick"],Ve=["onClick"],Oe={class:"space-y-4"},Ae={class:"w-full flex flex-col"},Se={class:"flex items-center gap-4"},Be={key:0,class:"text-red-500 ml-28"},Me={key:1,class:"text-orange-500 ml-28"},je={key:2,class:"text-red-500 ml-28"},Ue={class:"w-full flex flex-col"},Fe={class:"flex items-center gap-4"},Re={key:0,class:"text-red-500 ml-28"},$e={key:1,class:"text-orange-500 ml-28"},qe={key:2,class:"text-red-500 ml-28"},ze={class:"w-full flex flex-col"},Ke={class:"flex items-center gap-4"},Ge={key:0,class:"text-red-500 ml-28"},Je={key:1,class:"text-orange-500 ml-28"},We={class:"w-full flex flex-col"},Qe={class:"flex items-center gap-4"},Xe={key:0,class:"text-red-500 ml-28"},He={key:1,class:"text-orange-500 ml-28"},Ye={key:2,class:"text-red-500 ml-28"},Ze={class:"w-full flex flex-col"},ea={class:"flex items-center gap-4"},aa={class:"flex justify-center gap-4 w-full"},la={class:"flex items-center gap-3"},ta={class:"flex flex-col"},sa={class:"flex justify-center gap-4 w-full"},ra={class:"flex items-center gap-3"},oa={class:"flex justify-center gap-3 w-full"},pa={__name:"Transportes",setup(na){const m=me(),j=u([]),e=u({id:null,numero_placa:"",nombre:"",capacidad:null,marca:"",estado:"DISPONIBLE"}),U=u(null),w=u(!1),k=u(!1),P=u(!1),x=u(!1),C=u(!1),_=u(null),h=u({global:{value:null,matchMode:M.CONTAINS},nombre:{value:null,matchMode:M.CONTAINS},capacidad:{value:null,matchMode:M.EQUALS}}),V=u(10),K=u([5,10,20,50]),L=u("Guardar"),G=u([{label:"DISPONIBLE",value:"DISPONIBLE"},{label:"NO DISPONIBLE",value:"NO_DISPONIBLE"}]),O=oe(()=>{let t=j.value;if(h.value.global.value){const a=h.value.global.value.toLowerCase();t=t.filter(d=>d.nombre.toLowerCase().includes(a)||d.capacidad&&d.capacidad.toString().includes(a))}return h.value.nombre.value&&(t=t.filter(a=>a.nombre.toLowerCase().includes(h.value.nombre.value.toLowerCase()))),h.value.capacidad.value&&(t=t.filter(a=>a.capacidad==h.value.capacidad.value)),t});ne([e],()=>{_.value&&w.value&&B(()=>{const t={...e.value},a=JSON.stringify(t)!==JSON.stringify(_.value),d=!_.value.id,i=e.value.nombre||e.value.capacidad;C.value=a||d&&i})},{deep:!0});function N(){e.value={id:null,numero_placa:"",nombre:"",capacidad:null,marca:"",estado:"DISPONIBLE"},x.value=!1}de(()=>{A()});const A=async()=>{try{const t=await I.get("/api/transportes");j.value=t.data.sort((a,d)=>d.id-a.id)}catch{m.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los transportes.",life:4e3})}},J=()=>{N(),L.value="Guardar",w.value=!0,B(()=>{_.value={...e.value},C.value=!1})},W=t=>{N(),e.value={...t},L.value="Actualizar",w.value=!0,B(()=>{_.value={...e.value},C.value=!1})},Q=/^(P|M|C|A|R|D|V|G|AB|MB|CD|CC|CR|MI|FA|PE|OF|OI)[ -]?[0-9A-F]{6}$/i,X=async()=>{if(x.value=!0,!e.value.numero_placa||e.value.numero_placa.length<5||e.value.numero_placa.length>10){m.add({severity:"warn",summary:"Campos requeridos",detail:"La placa debe tener entre 5 y 10 caracteres.",life:4e3});return}if(!Q.test(e.value.numero_placa)){m.add({severity:"warn",summary:"Formato inv√°lido",detail:"La placa debe iniciar con un prefijo v√°lido y tener 6 caracteres alfanum√©ricos. Ejemplo: P 123456, AB-12A3F",life:5e3});return}if(!e.value.nombre||e.value.nombre.length<3||e.value.nombre.length>50){m.add({severity:"warn",summary:"Campos requeridos",detail:"El nombre debe tener entre 3 y 50 caracteres.",life:4e3});return}if(!e.value.capacidad||e.value.capacidad<1){m.add({severity:"warn",summary:"Campos requeridos",detail:"La capacidad debe ser al menos 1.",life:4e3});return}if(!e.value.marca||e.value.marca.length<2||e.value.marca.length>30){m.add({severity:"warn",summary:"Campos requeridos",detail:"La marca debe tener entre 2 y 30 caracteres.",life:4e3});return}try{let t;e.value.id?(t=await I.put(`/api/transportes/${e.value.id}`,{numero_placa:e.value.numero_placa,nombre:e.value.nombre,capacidad:e.value.capacidad,marca:e.value.marca,estado:e.value.estado}),m.add({severity:"success",summary:"¬°√âxito!",detail:"Transporte actualizado correctamente.",life:4e3})):(t=await I.post("/api/transportes",{numero_placa:e.value.numero_placa,nombre:e.value.nombre,capacidad:e.value.capacidad,marca:e.value.marca,estado:e.value.estado}),m.add({severity:"success",summary:"¬°√âxito!",detail:"Transporte creado correctamente.",life:4e3})),await A(),w.value=!1,C.value=!1,_.value=null,N()}catch(t){t.response&&t.response.data&&t.response.data.errors&&t.response.data.errors.numero_placa?m.add({severity:"error",summary:"Error",detail:t.response.data.errors.numero_placa[0],life:4e3}):m.add({severity:"error",summary:"Error",detail:"No se pudo guardar el transporte.",life:4e3})}},H=t=>{e.value={...t},k.value=!0},Y=async()=>{try{await I.delete(`/api/transportes/${e.value.id}`),await A(),k.value=!1,m.add({severity:"success",summary:"¬°Eliminado!",detail:"Transporte eliminado correctamente.",life:4e3})}catch{m.add({severity:"error",summary:"Error",detail:"No se pudo eliminar el transporte.",life:4e3})}},Z=()=>{C.value?P.value=!0:F()},F=()=>{w.value=!1,P.value=!1,C.value=!1,_.value=null,N()},ee=()=>{P.value=!1},D=u(!1),ae=t=>{const a=t.target.value,d=t.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(t.keyCode)||t.ctrlKey&&[65,67,86,88].includes(t.keyCode))return;if(!/[0-9]/.test(d)){t.preventDefault();return}const i=a+d,y=parseInt(i);if(i.length>3||y>500){t.preventDefault(),(y>500||i.length>3)&&(D.value=!0);return}D.value=!1},le=t=>{t.preventDefault();const d=(t.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");if(d){let i=parseInt(d);i>500&&(i=500,D.value=!0),e.value.capacidad=i.toString()}};return(t,a)=>{const d=E("Toast"),i=E("InputText"),y=E("Column"),te=E("DataTable"),S=E("Dialog");return v(),p(ce,null,[r(o(ie),{title:"Cat√°logo de Transportes"}),r(re,null,{default:n(()=>[r(d,{class:"z-[9999]"}),l("div",xe,[l("div",ye,[l("div",he,[r(o(ue),{href:t.route("tours"),class:"flex items-center text-blue-600 hover:text-blue-700 transition-colors duration-200 px-4 rounded-lg",title:"Regresar a Tours"},{default:n(()=>[r(o(f),{icon:o(ve),class:"h-8"},null,8,["icon"])]),_:1},8,["href"]),a[12]||(a[12]=l("h3",{class:"text-lg sm:text-2xl text-blue-600 font-bold"},"Cat√°logo de Transportes",-1))]),l("button",{class:"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:J},[r(o(f),{icon:o(fe),class:"h-4 w-4 text-white"},null,8,["icon"]),a[13]||(a[13]=l("span",null,"¬†Agregar transporte",-1))])]),r(te,{value:O.value,selection:U.value,"onUpdate:selection":a[1]||(a[1]=s=>U.value=s),dataKey:"id",paginator:!0,rows:V.value,rowsPerPageOptions:K.value,rowsPerPage:V.value,"onUpdate:rowsPerPage":a[2]||(a[2]=s=>V.value=s),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} transportes",class:"overflow-x-auto max-w-full",style:{display:"block","max-width":"84vw"},responsiveLayout:"scroll",pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:n(()=>[l("div",we,[l("div",_e,[l("div",Ce,[a[14]||(a[14]=l("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[l("i",{class:"pi pi-filter text-blue-600 text-sm"}),l("span",null,"Filtros")],-1)),l("div",ke,c(O.value.length)+" resultado"+c(O.value.length!==1?"s":""),1)])]),l("div",Pe,[l("div",null,[r(i,{modelValue:h.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=s=>h.value.global.value=s),placeholder:"üîç Buscar transportes...",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])])])])]),default:n(()=>[r(y,{field:"numero_placa",header:"Placa",sortable:"",class:"w-32 min-w-24"},{body:n(s=>[l("div",Ee,c(s.data.numero_placa),1)]),_:1}),r(y,{field:"nombre",header:"Nombre",sortable:"",class:"w-40 min-w-34"},{body:n(s=>[l("div",Te,c(s.data.nombre),1)]),_:1}),r(y,{field:"capacidad",header:"Capacidad",class:"w-32 min-w-20"},{body:n(s=>[l("div",Le,c(s.data.capacidad),1)]),_:1}),r(y,{field:"marca",header:"Marca",sortable:"",class:"w-32 min-w-24"},{body:n(s=>[l("div",Ne,c(s.data.marca),1)]),_:1}),r(y,{field:"estado",header:"Estado",sortable:"",class:"w-32 min-w-24"},{body:n(s=>[l("span",{class:T(s.data.estado==="DISPONIBLE"?"bg-green-100 text-green-800 px-2 py-1 rounded-full":"bg-red-100 text-red-800 px-2 py-1 rounded-full")},c(s.data.estado==="NO_DISPONIBLE"?"NO DISPONIBLE":s.data.estado),3)]),_:1}),r(y,{exportable:!1,class:"w-40 min-w-52"},{header:n(()=>a[15]||(a[15]=[l("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:n(s=>[l("div",De,[l("button",{class:"bg-orange-200/30 border p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:se=>W(s.data)},[r(o(f),{icon:o(R),class:"h-4 w-4 text-orange-600"},null,8,["icon"]),a[16]||(a[16]=g(" ¬†Editar "))],8,Ie),l("button",{class:"bg-red-200/30 border p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:se=>H(s.data)},[r(o(f),{icon:o(ge),class:"h-4 w-4 text-red-600"},null,8,["icon"]),a[17]||(a[17]=g(" ¬†Eliminar "))],8,Ve)])]),_:1})]),_:1},8,["value","selection","rows","rowsPerPageOptions","rowsPerPage"]),r(S,{visible:w.value,"onUpdate:visible":a[8]||(a[8]=s=>w.value=s),header:L.value+" Transporte",modal:!0,style:{width:"400px"},closable:!1,draggable:!1},{footer:n(()=>[l("div",aa,[l("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Z},[r(o(f),{icon:o($),class:"h-5 text-green-600"},null,8,["icon"]),a[23]||(a[23]=g("Cancelar "))]),l("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:X},[r(o(f),{icon:o(q),class:"h-5 text-white"},null,8,["icon"]),g(c(L.value),1)])])]),default:n(()=>[l("div",Oe,[l("div",Ae,[l("div",Se,[a[18]||(a[18]=l("label",{for:"numero_placa",class:"w-24 flex items-center gap-1"},[g(" Placa: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),r(i,{modelValue:e.value.numero_placa,"onUpdate:modelValue":a[3]||(a[3]=s=>e.value.numero_placa=s),modelModifiers:{trim:!0},id:"numero_placa",name:"numero_placa",maxlength:10,class:T([{"p-invalid":x.value&&(!e.value.numero_placa||e.value.numero_placa.length<5||e.value.numero_placa.length>10)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"Ej. ABC123, 12A345"},null,8,["modelValue","class"])]),e.value.numero_placa&&e.value.numero_placa.length<5?(v(),p("small",Be," La placa debe tener al menos 5 caracteres. Actual: "+c(e.value.numero_placa.length)+"/5 ",1)):b("",!0),e.value.numero_placa&&e.value.numero_placa.length>10?(v(),p("small",Me," Caracteres restantes: "+c(10-e.value.numero_placa.length),1)):b("",!0),x.value&&!e.value.numero_placa?(v(),p("small",je," La placa es obligatoria. ")):b("",!0)]),l("div",Ue,[l("div",Fe,[a[19]||(a[19]=l("label",{for:"nombre",class:"w-24 flex items-center gap-1"},[g(" Nombre: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),r(i,{modelValue:e.value.nombre,"onUpdate:modelValue":a[4]||(a[4]=s=>e.value.nombre=s),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:50,class:T([{"p-invalid":x.value&&(!e.value.nombre||e.value.nombre.length<3||e.value.nombre.length>50)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"Ej. Autob√∫s, Carro, etc."},null,8,["modelValue","class"])]),e.value.nombre&&e.value.nombre.length<3?(v(),p("small",Re," El nombre debe tener al menos 3 caracteres. Actual: "+c(e.value.nombre.length)+"/3 ",1)):b("",!0),e.value.nombre&&e.value.nombre.length>45?(v(),p("small",$e," Caracteres restantes: "+c(50-e.value.nombre.length),1)):b("",!0),x.value&&!e.value.nombre?(v(),p("small",qe," El nombre es obligatorio. ")):b("",!0)]),l("div",ze,[l("div",Ke,[a[20]||(a[20]=l("label",{for:"capacidad",class:"w-24 flex items-center gap-1"},[g(" Capacidad: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),r(i,{modelValue:e.value.capacidad,"onUpdate:modelValue":a[5]||(a[5]=s=>e.value.capacidad=s),id:"capacidad",name:"capacidad",type:"number",inputmode:"numeric",min:"1",max:"500",class:T(["flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":x.value&&(!e.value.capacidad||e.value.capacidad<1)}]),placeholder:"Cantidad (1-500)",onKeydown:ae,onPaste:le},null,8,["modelValue","class"])]),x.value&&(!e.value.capacidad||e.value.capacidad<1)?(v(),p("small",Ge," La capacidad es obligatoria y debe ser mayor o igual a 1. ")):b("",!0),D.value?(v(),p("small",Je," Capacidad ajustada al l√≠mite m√°ximo permitido (500). ")):b("",!0)]),l("div",We,[l("div",Qe,[a[21]||(a[21]=l("label",{for:"marca",class:"w-24 flex items-center gap-1"},[g(" Marca: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),r(i,{modelValue:e.value.marca,"onUpdate:modelValue":a[6]||(a[6]=s=>e.value.marca=s),modelModifiers:{trim:!0},id:"marca",name:"marca",maxlength:30,class:T([{"p-invalid":x.value&&(!e.value.marca||e.value.marca.length<2||e.value.marca.length>30)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"Ej. Toyota, Mercedes"},null,8,["modelValue","class"])]),e.value.marca&&e.value.marca.length<2?(v(),p("small",Xe," La marca debe tener al menos 2 caracteres. Actual: "+c(e.value.marca.length)+"/2 ",1)):b("",!0),e.value.marca&&e.value.marca.length>30?(v(),p("small",He," Caracteres restantes: "+c(30-e.value.marca.length),1)):b("",!0),x.value&&!e.value.marca?(v(),p("small",Ye," La marca es obligatoria. ")):b("",!0)]),l("div",Ze,[l("div",ea,[a[22]||(a[22]=l("label",{for:"estado",class:"w-24 flex items-center gap-1"},[g(" Estado: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),r(o(pe),{modelValue:e.value.estado,"onUpdate:modelValue":a[7]||(a[7]=s=>e.value.estado=s),options:G.value,optionLabel:"label",optionValue:"value",id:"estado",class:"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"},null,8,["modelValue","options"])])])])]),_:1},8,["visible","header"]),r(S,{visible:k.value,"onUpdate:visible":a[10]||(a[10]=s=>k.value=s),header:"Eliminar transporte",modal:!0,style:{width:"350px"},closable:!1,draggable:!1},{footer:n(()=>[l("div",sa,[l("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:a[9]||(a[9]=s=>k.value=!1)},[r(o(f),{icon:o($),class:"h-5"},null,8,["icon"]),a[27]||(a[27]=l("span",null,"No",-1))]),l("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Y},[r(o(f),{icon:o(q),class:"h-5"},null,8,["icon"]),a[28]||(a[28]=l("span",null,"S√≠",-1))])])]),default:n(()=>[l("div",la,[r(o(f),{icon:o(z),class:"h-8 w-8 text-red-500"},null,8,["icon"]),l("div",ta,[l("span",null,[a[24]||(a[24]=g("¬øEst√°s seguro de eliminar el transporte: ")),l("b",null,c(e.value.nombre),1),a[25]||(a[25]=g("?"))]),a[26]||(a[26]=l("span",{class:"text-red-600 text-sm font-medium mt-1"},"Esta acci√≥n es irreversible.",-1))])])]),_:1},8,["visible"]),r(S,{visible:P.value,"onUpdate:visible":a[11]||(a[11]=s=>P.value=s),header:"Cambios sin guardar",modal:!0,style:{width:"400px"},closable:!1,draggable:!1},{footer:n(()=>[l("div",oa,[l("button",{type:"button",class:"bg-white hover:bg-green-100 text-green-600 border border-green-600 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:ee},[r(o(f),{icon:o(R),class:"h-4"},null,8,["icon"]),a[30]||(a[30]=l("span",null,"Continuar",-1))]),l("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:F},[r(o(f),{icon:o(be),class:"h-4"},null,8,["icon"]),a[31]||(a[31]=l("span",null,"Salir sin guardar",-1))])])]),default:n(()=>[l("div",ra,[r(o(f),{icon:o(z),class:"h-8 w-8 text-orange-500"},null,8,["icon"]),a[29]||(a[29]=l("span",null,"Tienes informaci√≥n sin guardar. ¬øDeseas salir sin guardar?",-1))])]),_:1},8,["visible"])])]),_:1})],64)}}};export{pa as default};
