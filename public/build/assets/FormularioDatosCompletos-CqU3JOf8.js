import{r as x,o as G,a6 as P,E as b,_ as U,c as r,d as n,e as t,q as f,p as k,$ as l,I as M,j as d,v as T,a9 as F,t as u,F as C,l as V,y as W,A as L}from"./vendor-CqKcGHPa.js";import{z as q}from"./vue-tel-input-J95PmLrS.js";import{z as R,F as Z}from"./ui-DrLUz167.js";import{d as H}from"./index-BXYozc4i.js";const $={class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4"},J={class:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-lg"},K={class:"flex"},Q={class:"ml-3"},X={class:"text-xs text-blue-600 mt-2"},Y={class:"w-full flex flex-col"},j={class:"flex items-center gap-4"},O={key:0,class:"ml-28 mt-1"},ee={key:0,class:"text-red-500 block"},oe={key:1,class:"text-gray-500 ml-28 mt-1"},te={key:2,class:"text-orange-500 ml-28 mt-1"},se={class:"w-full flex flex-col"},le={class:"flex items-start gap-4"},ae={class:"flex-1"},re={key:0,class:"ml-28 mt-1"},ne={key:0,class:"text-red-500 block"},ie={key:1,class:"ml-28 mt-1"},de={class:"flex justify-center gap-4 w-full mt-6"},ue=["disabled"],ce={key:0},me={key:1},fe=["disabled"],be={__name:"FormularioDatosCompletos",props:{empleado:{type:Object,default:()=>({})},userId:{type:Number,required:!0}},emits:["close"],setup(z,{emit:I}){var _,E;const g=z,N=I,B=R(),v=x(window.innerWidth),h=()=>{v.value=window.innerWidth};G(()=>{window.addEventListener("resize",h)}),P(()=>{window.removeEventListener("resize",h)});const D=b(()=>v.value<640?{width:"95vw",maxWidth:"380px"}:v.value<768?{width:"400px"}:{width:"450px"}),e=U({cargo:((_=g.empleado)==null?void 0:_.cargo)||"PROPIETARIA",telefono:((E=g.empleado)==null?void 0:E.telefono)||"",user_id:g.userId}),a=x({isValid:!1,country:null,formattedNumber:"",mensaje:""}),p=x(!1),y=()=>{e.cargo&&(e.cargo=e.cargo.toUpperCase().replace(/[^A-Z\s]/g,"").substring(0,25))},S=s=>{try{s&&typeof s=="object"&&(a.value.isValid=s.valid===!0,a.value.country={name:s.country,code:s.countryCode},a.value.formattedNumber=s.formatted||"",a.value.international=s.international||"",s.valid===!0&&s.international&&(e.telefono=s.international),e.telefono&&s.valid===!1?a.value.mensaje="✗ Número de teléfono inválido para "+s.country:s.valid===!0?a.value.mensaje="✓ Número válido para "+s.country:a.value.mensaje="")}catch{a.value.mensaje="Error en validación"}},c=b(()=>{const s=[],o=e.cargo||"";return o.length>0&&o.length<2&&s.push("El cargo debe tener al menos 2 caracteres."),o.length>0&&/[^A-Z\s]/.test(o)&&s.push("El cargo solo puede contener letras y espacios (sin tildes ni números)."),o.length>25&&s.push("El cargo no puede exceder 25 caracteres."),s}),m=b(()=>{const s=[],o=e.telefono||"";return o.length>0&&!a.value.isValid&&s.push("El formato del teléfono no es válido."),o.length>30&&s.push("El teléfono no puede exceder 30 caracteres."),s}),w=()=>{N("close")},A=()=>{if(p.value=!0,y(),console.debug("[DEBUG] Enviando datos:",{cargo:e.cargo,telefono:e.telefono,telefonoValidation:a.value}),a.value.isValid&&a.value.international&&(e.telefono=a.value.international),c.value.length>0||m.value.length>0){console.debug("[DEBUG] Errores de validación:",{cargoErrors:c.value,telefonoErrors:m.value});return}e.post(route("empleado.completar-datos"),{preserveScroll:!0,onSuccess:()=>{B.add({severity:"success",summary:"¡Datos guardados!",detail:"Tus datos se han guardado correctamente.",life:4e3}),console.debug("[DEBUG] Guardado exitoso, cerrando modal"),w()},onError:s=>{console.debug("[DEBUG] Errores al guardar:",s)}})};return(s,o)=>(n(),r("div",$,[t("div",{class:"bg-white rounded-lg shadow-lg p-6",style:L(D.value)},[o[8]||(o[8]=t("h2",{class:"text-2xl font-bold mb-4 text-blue-600"},"Completa tus datos de Administrador",-1)),t("div",J,[t("div",K,[o[5]||(o[5]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-blue-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})])],-1)),t("div",Q,[o[4]||(o[4]=t("p",{class:"text-sm text-blue-700"},[t("strong",null,"Información importante:"),f(" Estos datos se solicitarán solo una vez. Puedes modificar el cargo sugerido si es necesario. ")],-1)),t("p",X,[k(l(Z),{icon:l(H),class:"mr-1 text-yellow-400"},null,8,["icon"]),o[2]||(o[2]=f(" Posteriormente podrás modificar toda la información en: ")),o[3]||(o[3]=t("span",{class:"font-medium"},"Mi Perfil → Editar Perfil → Información Personal",-1))])])])]),t("form",{onSubmit:M(A,["prevent"]),class:"space-y-5"},[t("div",Y,[t("div",j,[o[6]||(o[6]=t("label",{for:"cargo",class:"w-24 flex items-center gap-1"},[f("Cargo "),t("span",{class:"text-red-500 font-bold"},"*")],-1)),T(t("input",{id:"cargo","onUpdate:modelValue":o[0]||(o[0]=i=>l(e).cargo=i),type:"text",class:"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-blue-500 focus:ring-0 focus:shadow-none rounded-md px-2 py-1",maxlength:"25",onInput:y,required:""},null,544),[[F,l(e).cargo]])]),l(e).errors.cargo||p.value&&c.value.length>0?(n(),r("div",O,[l(e).errors.cargo?(n(),r("small",ee,u(l(e).errors.cargo),1)):d("",!0),(n(!0),r(C,null,V(c.value,i=>(n(),r("small",{key:i,class:"text-red-500 block"},u(i),1))),128))])):d("",!0),l(e).cargo&&l(e).cargo.length>0&&c.value.length===0?(n(),r("small",oe," Caracteres: "+u(l(e).cargo.length)+"/25 ",1)):d("",!0),l(e).cargo&&l(e).cargo.length>=20&&l(e).cargo.length<=25&&c.value.length===0?(n(),r("small",te," Caracteres restantes: "+u(25-l(e).cargo.length),1)):d("",!0)]),t("div",se,[t("div",le,[o[7]||(o[7]=t("label",{for:"telefono",class:"w-24 flex items-center gap-1 mt-2"},[f("Teléfono "),t("span",{class:"text-red-500 font-bold"},"*")],-1)),t("div",ae,[k(l(q),{modelValue:l(e).telefono,"onUpdate:modelValue":o[1]||(o[1]=i=>l(e).telefono=i),id:"telefono",name:"telefono",defaultCountry:"SV",preferredCountries:["SV","GT","HN","CR","NI","PA","BZ"],validCharactersOnly:!0,dropdownOptions:{showDialCodeInSelection:!0,showFlags:!0,showSearchBox:!0,showDialCodeInList:!0},inputOptions:{placeholder:"Número de teléfono"},mode:"international",class:"w-full border border-gray-300 rounded-lg",onValidate:S,disabled:l(e).processing},null,8,["modelValue","disabled"])])]),l(e).errors.telefono||p.value&&m.value.length>0?(n(),r("div",re,[l(e).errors.telefono?(n(),r("small",ne,u(l(e).errors.telefono),1)):d("",!0),(n(!0),r(C,null,V(m.value,i=>(n(),r("small",{key:i,class:"text-red-500 block"},u(i),1))),128))])):d("",!0),a.value.mensaje?(n(),r("div",ie,[t("small",{class:W([a.value.isValid?"text-green-600":"text-red-500","block"])},u(a.value.mensaje),3)])):d("",!0)]),t("div",de,[t("button",{type:"submit",disabled:l(e).processing,class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed font-semibold"},[l(e).processing?(n(),r("span",me,"Guardando...")):(n(),r("span",ce,"Guardar"))],8,ue),t("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:w,disabled:l(e).processing}," Cancelar ",8,fe)])],32)],4)]))}};export{be as default};
