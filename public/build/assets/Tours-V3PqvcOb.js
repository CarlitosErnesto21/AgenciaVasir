import{a3 as nt,r as c,E as R,w as ze,n as Ne,o as rt,a6 as it,N as M,k as ne,h as Ve,d as u,x as A,p as v,e as a,$ as d,a0 as dt,c as m,q as D,a2 as ut,y as S,t as p,j as y,v as re,F as H,l as W,a7 as Be,A as ie,D as fa,a9 as je,a5 as ga}from"./vendor-gbh1WW5n.js";import{A as ct}from"./AuthenticatedLayout-CSuYxj7F.js";import{z as mt,A as _e,F as w,q as de}from"./ui-BrU4k96Z.js";import{R as vt,c as K,S as pt,k as we,z as ft,l as gt,m as bt,T as ht,o as ba,n as xt,f as yt,p as Ce,a as _t}from"./index-B6nVaz6S.js";import wt from"./Modales-DCoHBNNe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ct={class:"container mx-auto px-4 py-6"},Dt={class:"bg-white rounded-lg shadow-md"},kt={class:"flex flex-col sm:flex-row lg:justify-between lg:items-center gap-4 p-4"},Et={class:"flex items-center gap-2 w-full justify-center lg:w-auto lg:justify-end"},St={class:"block sm:hidden"},At={class:"hidden sm:block"},It={key:0,class:"flex flex-col items-center justify-center py-12 space-y-4 bg-white rounded-lg shadow-md"},Tt={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},Pt={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},Ft={class:"flex items-center gap-3"},Nt={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Vt=["disabled"],Lt=["disabled"],Rt={class:"space-y-3"},Mt={class:"relative"},Ot={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-5 gap-3"},$t=["value"],Ut=["value"],qt={class:"col-span-2 sm:col-span-1"},zt=["value"],Bt={class:"col-span-2 sm:col-span-1 md:col-span-1 lg:col-span-1 hidden sm:block"},jt={class:"col-span-2 sm:col-span-1 md:col-span-1 lg:col-span-1 hidden sm:block"},Gt={class:"flex w-80 sm:hidden"},Ht={class:"col-span-2 sm:col-span-4 md:col-span-4 lg:col-span-4 px-1 mt-3"},Wt={class:"text-blue-600 text-xs font-medium flex items-center gap-1"},Kt=["title"],Zt=["title"],Qt={class:"text-sm leading-relaxed"},Yt={class:"text-sm font-medium leading-relaxed"},Jt={class:"flex gap-2 justify-center items-center"},Xt=["onClick"],es=["onClick"],as=["onClick"],ts={class:"flex flex-col items-center justify-center py-12 space-y-4"},ss={class:"text-center"},ls={key:0,class:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4"},os={class:"flex"},ns={class:"flex-shrink-0"},rs={class:"space-y-4"},is={class:"w-full flex flex-col"},ds={class:"flex items-center gap-4"},us={key:0,class:"text-red-500 ml-28"},cs={key:1,class:"text-orange-500 ml-28"},ms={key:2,class:"text-red-500 ml-28"},vs={class:"w-full flex flex-col"},ps={class:"flex items-start gap-4"},fs={class:"flex w-full flex-col"},gs={class:"flex gap-2 mb-3"},bs=["disabled"],hs=["disabled"],xs={class:"text-gray-500 ml-2 text-xs block text-right select-none"},ys={class:"space-y-2 max-h-40 overflow-y-auto"},_s={class:"flex-1"},ws=["onClick","disabled"],Cs={key:0,class:"text-gray-500 text-sm mt-2"},Ds={class:"w-full flex flex-col"},ks={class:"flex items-start gap-4"},Es={class:"flex w-full flex-col"},Ss={class:"flex gap-2 mb-3"},As=["disabled"],Is=["disabled"],Ts={class:"text-gray-500 ml-2 text-xs block text-right select-none"},Ps={key:0,class:"space-y-2 max-h-40 overflow-y-auto"},Fs={class:"flex-1"},Ns=["onClick","disabled"],Vs={key:1,class:"text-gray-500 text-sm mt-2"},Ls={class:"w-full"},Rs={class:"flex items-start gap-4"},Ms={key:0,class:"text-red-500 ml-28"},Os={key:1,class:"text-orange-500 ml-28"},$s={key:2,class:"text-red-500 ml-28"},Us={key:3,class:"text-red-500 ml-28"},qs={class:"w-full flex flex-col"},zs={class:"flex items-center gap-3.5"},Bs={key:0,class:"text-red-500 ml-28"},js={class:"grid grid-cols-2 gap-4"},Gs={class:"w-full"},Hs={for:"cupo_min",class:"flex items-center gap-1 mb-2"},Ws={key:0,class:"text-gray-500 text-xs"},Ks={key:0,class:"text-red-500 block text-xs mt-1"},Zs={key:1,class:"text-red-500 block text-xs mt-1"},Qs={class:"w-full"},Ys={for:"cupo_max",class:"flex items-center gap-1 mb-2"},Js={key:0,class:"text-gray-500 text-xs"},Xs={key:0,class:"text-red-500 block text-xs mt-1"},el={key:1,class:"text-red-500 block text-xs mt-1"},al={class:"flex gap-4"},tl={class:"flex-1"},sl={key:0,class:"text-red-500 block text-xs mt-1"},ll={class:"flex-1"},ol={key:0,class:"text-red-500 block text-xs mt-1"},nl={class:"w-full flex flex-col"},rl={class:"flex items-center gap-10 sm:gap-9"},il={class:"w-full relative"},dl={key:0,class:"text-red-500 ml-28"},ul={class:"w-full flex flex-col"},cl={class:"flex items-center gap-5"},ml={key:0,class:"text-red-500 ml-28"},vl={class:"w-full flex flex-col"},pl={class:"flex items-center gap-4"},fl={class:"flex-1"},gl={class:"flex items-center gap-3 mb-2"},bl=["disabled"],hl={class:"flex items-center gap-2"},xl={key:0,class:"text-red-500 ml-28"},yl={class:"grid grid-cols-3 ml-2 sm:ml-5 gap-y-2"},_l=["src"],wl=["onClick"],Cl={class:"flex justify-center gap-4 w-full mt-6"},Dl=["disabled"],kl={key:0},El={key:1},Sl=["disabled"],Al={class:"pt-2 mb-6"},Il={class:"relative"},Tl={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},Pl=["disabled"],Fl={class:"absolute inset-y-0 right-0 flex items-center pr-3"},Nl={key:1,class:"animate-spin"},Vl={key:0,class:"text-center py-8"},Ll={key:1,class:"text-center py-8"},Rl={key:2,class:"text-center py-8"},Ml={class:"text-gray-600"},Ol={key:3,class:"space-y-3"},$l={class:"bg-orange-50 border border-orange-200 rounded-lg p-2 mb-3"},Ul={class:"flex items-center gap-2"},ql={class:"font-semibold text-orange-800 text-sm"},zl={class:"max-h-80 overflow-y-auto space-y-2"},Bl=["onClick"],jl={class:"flex justify-between items-start mb-2"},Gl={class:"font-semibold text-sm text-blue-600 leading-tight hover:text-blue-800 transition-colors"},Hl={class:"flex items-center gap-2 ml-2 flex-shrink-0"},Wl={class:"px-2 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full"},Kl={class:"space-y-1 text-xs text-gray-600 mb-2"},Zl={class:"flex items-center gap-2"},Ql={key:0,class:"px-2 py-0.5 bg-green-100 text-green-800 text-xs font-medium rounded-full"},Yl={key:1,class:"px-2 py-0.5 bg-red-100 text-red-800 text-xs font-medium rounded-full"},Jl={class:"bg-gray-50 rounded p-2"},Xl={class:"space-y-1"},eo={class:"flex justify-between items-start"},ao={class:"font-medium"},to={class:"text-gray-500 ml-2"},so={class:"text-gray-400 text-xs"},lo={class:"flex justify-center gap-4 w-full mt-6"},De="/api/tours",Ge="/storage/tours/",vo={__name:"Tours",setup(oo){const f=mt();nt();const F=c([]),P=c([]),O=c(""),$=c(""),ke=c([]),s=c({id:null,nombre:"",categoria:null,incluye:"",no_incluye:"",cupo_min:null,cupo_max:null,punto_salida:"",fecha_salida:null,fecha_regreso:null,estado:"DISPONIBLE",precio:null,transporte_id:null,imagenes:[]}),k=c([]),ue=c([]),ce=c([]),He=c(null),U=c(!1),me=c(!1),q=c(!1),ve=c(!1),C=c(!1),Z=c(!1),z=c(null),Q=c(!1),Le=c(!1),Y=c(!1),B=c(!1),j=c(!1),ae=c(!1),pe=c(!0),fe=c(!1),ge=c([]),J=c(!1),N=c(""),E=c({global:{value:null,matchMode:_e.CONTAINS},categoria:{value:null,matchMode:_e.EQUALS},"transporte.nombre":{value:null,matchMode:_e.EQUALS},estado:{value:null,matchMode:_e.EQUALS},fecha_salida:{value:null,matchMode:_e.DATE_IS}}),te=c(""),X=c(""),se=c(""),I=c(null),T=c(null),Re=c(10),ha=c([5,10,20,50]),be=c("Guardar"),x=c(null),h=c(!1),V=c([]),We=c([{label:"Nacional",value:"NACIONAL"},{label:"Internacional",value:"INTERNACIONAL"}]),Ke=c([{label:"Disponible",value:"DISPONIBLE"},{label:"Completo",value:"COMPLETO"},{label:"En Curso",value:"EN_CURSO"},{label:"Finalizado",value:"FINALIZADO"},{label:"Reprogramada",value:"REPROGRAMADA"}]),Ee=c(!1),Me=c(!1),G=c(null),Oe=c([]),$e=c(0),Ze=c(null),Ue=R(()=>{let t=ke.value;if(E.value.global.value){const e=E.value.global.value.toLowerCase();t=t.filter(n=>n.nombre.toLowerCase().includes(e)||n.incluye&&n.incluye.toLowerCase().includes(e)||n.no_incluye&&n.no_incluye.toLowerCase().includes(e)||n.punto_salida.toLowerCase().includes(e))}return E.value.categoria.value&&(t=t.filter(e=>e.categoria===E.value.categoria.value)),E.value["transporte.nombre"].value&&(t=t.filter(e=>e["transporte.nombre"]===E.value["transporte.nombre"].value)),E.value.estado.value&&(t=t.filter(e=>e.estado===E.value.estado.value)),(I.value||T.value)&&(t=t.filter(e=>{if(!e.fecha_salida)return!1;const n=new Date(e.fecha_salida);let o=!0;if(I.value){const r=new Date(I.value);o=o&&n>=r}if(T.value){const r=new Date(T.value);r.setHours(23,59,59,999),o=o&&n<=r}return o})),t}),Qe=R(()=>k.value.length<5),xa=R(()=>Y.value?"Cargando...":B.value?"Abriendo...":Qe.value?"Seleccionar":"Límite alcanzado"),le=R(()=>{if(!s.value.cupo_min)return"";const t=parseInt(s.value.cupo_min)||0,e=parseInt(s.value.cupo_max)||0;if(t<=0)return"El cupo mínimo debe ser al menos 1.";const n=V.value.find(r=>r.id===s.value.transporte_id),o=n?n.capacidad:null;return o&&t>o?`El cupo mínimo no puede ser mayor que la capacidad del transporte (${o}).`:s.value.cupo_max&&e>0&&t>=e?"El cupo mínimo debe ser menor que el cupo máximo.":""}),oe=R(()=>{if(!s.value.cupo_max)return"";const t=parseInt(s.value.cupo_min)||0,e=parseInt(s.value.cupo_max)||0;if(e<=0)return"El cupo máximo debe ser al menos 1.";const n=V.value.find(r=>r.id===s.value.transporte_id),o=n?n.capacidad:null;return o&&e>o?`El cupo máximo no puede ser mayor que la capacidad del transporte (${o}).`:s.value.cupo_min&&t>0&&e<=t?"El cupo máximo debe ser mayor que el cupo mínimo.":""}),ee=R(()=>{const t=V.value.find(e=>e.id===s.value.transporte_id);return t?t.capacidad:30}),qe=R(()=>{if(!N.value||N.value.trim()==="")return ge.value;const t=N.value.toLowerCase().trim();return ge.value.map(e=>{const n=e.reservas_pendientes.filter(o=>o.cliente_nombre.toLowerCase().includes(t));return n.length>0?{...e,reservas_pendientes:n}:null}).filter(e=>e!==null)});ze([s,x,F,P,k,ce],()=>{z.value&&U.value&&Ne(()=>{const t={...s.value,fecha_regreso:x.value,incluye_lista:[...F.value],no_incluye_lista:[...P.value],imagenes_actuales:[...k.value]},e=JSON.stringify(t)!==JSON.stringify({...z.value,imagenes_actuales:z.value.imagenes_originales})||ce.value.length>0,n=!z.value.id,o=s.value.nombre||s.value.punto_salida||s.value.fecha_salida||x.value||s.value.precio||s.value.categoria||s.value.transporte_id||F.value.length>0||P.value.length>0||k.value.length>0;Z.value=e||n&&o})},{deep:!0,flush:"post"}),ze(()=>s.value.transporte_id,(t,e)=>{if(t&&t!==e&&U.value){const n=V.value.find(o=>o.id===t);if(n){const o=n.capacidad;s.value.cupo_min&&s.value.cupo_min>o&&(s.value.cupo_min=o),s.value.cupo_max&&s.value.cupo_max>o&&(s.value.cupo_max=o)}}});function Se(){s.value={id:null,nombre:"",categoria:null,incluye:"",no_incluye:"",cupo_min:null,cupo_max:null,punto_salida:"",fecha_salida:null,fecha_regreso:null,estado:"DISPONIBLE",precio:null,transporte_id:null,imagenes:[]},k.value=[],ue.value=[],ce.value=[],x.value=null,C.value=!1,F.value=[],P.value=[],O.value="",$.value=""}const Ye=()=>{O.value.trim()&&(F.value.push(O.value.trim()),O.value="")},ya=t=>{F.value.splice(t,1)},Je=()=>{$.value.trim()&&(P.value.push($.value.trim()),$.value="")},_a=t=>{P.value.splice(t,1)},Xe=t=>t?t.split("|").filter(e=>e.trim()).map(e=>e.trim()):[],ea=t=>t.join("|"),he=()=>{Ne(()=>{setTimeout(()=>{document.querySelectorAll(".p-select").forEach(e=>{const n=e.querySelector(".p-select-label, .p-placeholder");n&&(n.style.overflow="hidden",n.style.textOverflow="ellipsis",n.style.whiteSpace="nowrap",n.style.maxWidth="calc(100% - 2.5rem)",n.style.display="block")})},100)})};rt(()=>{Ca(),Da(),he(),typeof window<"u"&&window.addEventListener("resize",aa),wa()});const wa=()=>{const e=new URLSearchParams(window.location.search).get("editTour");e&&setTimeout(()=>{const n=ke.value.find(o=>o.id==e);if(n){oa(n);const o=window.location.pathname;window.history.replaceState({},"",o)}},1e3)},aa=()=>{xe.value=window.innerWidth};it(()=>{typeof window<"u"&&window.removeEventListener("resize",aa)});const ta=async()=>{pe.value=!0;try{const t=await M.get(De);ke.value=t.data.map(e=>{var n,o,r;return{...e,imagenes:(e.imagenes||[]).map(i=>typeof i=="string"?i:i.nombre),transporte_nombre:((n=e.transporte)==null?void 0:n.nombre)||"",transporte_capacidad:((o=e.transporte)==null?void 0:o.capacidad)||"","transporte.nombre":(r=e.transporte)==null?void 0:r.nombre}}).sort((e,n)=>{const o={EN_CURSO:1,COMPLETO:2,REPROGRAMADA:3,DISPONIBLE:4,FINALIZADO:5,CANCELADA:6},r=o[e.estado]||99,i=o[n.estado]||99;if(r!==i)return r-i;const b=new Date(e.fecha_salida),_=new Date(n.fecha_salida);return b-_})}catch{f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los tours.",life:4e3})}finally{pe.value=!1}},Ca=async()=>{pe.value=!0;try{const t=await M.get(De);ke.value=t.data.map(e=>{var n,o,r;return{...e,imagenes:(e.imagenes||[]).map(i=>typeof i=="string"?i:i.nombre),transporte_nombre:((n=e.transporte)==null?void 0:n.nombre)||"",transporte_capacidad:((o=e.transporte)==null?void 0:o.capacidad)||"","transporte.nombre":(r=e.transporte)==null?void 0:r.nombre}}).sort((e,n)=>{const o={EN_CURSO:1,COMPLETO:2,REPROGRAMADA:3,DISPONIBLE:4,FINALIZADO:5,CANCELADA:6},r=o[e.estado]||99,i=o[n.estado]||99;if(r!==i)return r-i;const b=new Date(e.fecha_salida),_=new Date(n.fecha_salida);return b-_})}catch{f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los tours.",life:4e3})}finally{pe.value=!1}},Da=async()=>{try{const t=await M.get("/api/transportes");V.value=t.data||[]}catch{V.value=[],f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los transportes.",life:4e3})}},ka=async()=>{J.value=!0;try{const t=await M.get("/api/tours-reservas-pendientes"),e={COMPLETO:1,REPROGRAMADA:2,DISPONIBLE:3};ge.value=t.data.sort((n,o)=>{const r=e[n.estado]||99,i=e[o.estado]||99;if(r!==i)return r-i;const b=new Date(n.fecha_salida_formatted),_=new Date(o.fecha_salida_formatted);return b-_})}catch(t){console.error("Error al cargar tours con reservas pendientes:",t),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los tours con reservas pendientes.",life:4e3})}finally{J.value=!1}},Ea=async()=>{fe.value=!0,await ka()},Sa=t=>{fe.value=!1,ga.visit(`/catalogos/reservas?tour=${t}`)},Aa=()=>{E.value.categoria.value=te.value===""?null:te.value,he()},Ia=()=>{if(X.value&&X.value!==""){const t=V.value.find(e=>e.id===X.value);E.value["transporte.nombre"].value=t?t.nombre:null}else E.value["transporte.nombre"].value=null;he()},Ta=()=>{E.value.estado.value=se.value===""?null:se.value,he()},Ae=()=>{if(I.value&&T.value){const t=new Date(I.value),e=new Date(T.value);t>e&&(T.value=null,f.add({severity:"warn",summary:"Fecha ajustada",detail:"La fecha 'hasta' se limpió porque era anterior a la fecha 'desde'.",life:5e3}))}},Ie=()=>{if(I.value&&T.value){const t=new Date(I.value);new Date(T.value)<t&&(I.value=null,f.add({severity:"warn",summary:"Fecha ajustada",detail:"La fecha 'desde' se limpió porque era posterior a la fecha 'hasta'.",life:5e3}))}};ze([te,X,se],()=>{he()},{deep:!0});const sa=async()=>{j.value=!0;try{await new Promise(t=>setTimeout(t,300)),te.value="",X.value="",se.value="",I.value=null,T.value=null,E.value.global.value=null,E.value.categoria.value=null,E.value["transporte.nombre"].value=null,E.value.estado.value=null,E.value.fecha_salida.value=null,f.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{j.value=!1}},Pa=()=>{ae.value=!0},la=()=>{Se(),be.value="Guardar",C.value=!1,h.value=!1,U.value=!0,Ne(()=>{z.value={...s.value,fecha_regreso:x.value,incluye_lista:[...F.value],no_incluye_lista:[...P.value],imagenes_originales:[...k.value]},Z.value=!1})},oa=async t=>{var e;if(t.estado==="COMPLETO"){f.add({severity:"warn",summary:"No se puede editar",detail:`No puedes editar el tour "${t.nombre}" porque ya está completo.`,life:5e3});return}try{const o=(await M.get(`/api/tours/${t.id}/reservas`)).data.reservas||[];if(o.length===0)h.value=!1;else{const r=["CANCELADA","PENDIENTE","REPROGRAMADA","CONFIRMADA"],i=["EN_CURSO","FINALIZADA"],b=o.some(l=>i.includes(l.estado)),_=o.some(l=>r.includes(l.estado));if(b){f.add({severity:"warn",summary:"No se puede editar",detail:`No puedes editar el tour "${t.nombre}" porque tiene reservas en curso o finalizadas.`,life:5e3});return}else _&&(h.value=!0,f.add({severity:"info",summary:"Edición limitada",detail:"El tour tiene reservas especiales. Solo puedes modificar los cupos.",life:5e3}))}Se(),C.value=!1,s.value={...t,transporte_id:((e=t.transporte)==null?void 0:e.id)||t.transporte_id||null},t.fecha_salida&&(typeof t.fecha_salida=="string"?s.value.fecha_salida=new Date(t.fecha_salida):s.value.fecha_salida=t.fecha_salida),t.fecha_regreso&&(typeof t.fecha_regreso=="string"?x.value=new Date(t.fecha_regreso):x.value=t.fecha_regreso),k.value=(t.imagenes||[]).map(r=>typeof r=="string"?r:r.nombre),F.value=Xe(t.incluye),P.value=Xe(t.no_incluye),Z.value=!1,be.value="Actualizar",U.value=!0,Ne(()=>{z.value={...s.value,fecha_regreso:x.value,incluye_lista:[...F.value],no_incluye_lista:[...P.value],imagenes_originales:[...k.value]},Z.value=!1})}catch(n){console.error("Error verificando reservas:",n),h.value=!1,f.add({severity:"error",summary:"Error",detail:"Error al verificar las reservas del tour",life:3e3})}},Fa=async()=>{if(!s.value.fecha_salida||!x.value)return!0;try{const t=r=>{if(!r)return null;let i;return r instanceof Date?i=r:typeof r=="string"&&(r.includes("T")&&r.includes("Z")?i=new Date(r):i=new Date(r)),i.getFullYear()+"-"+String(i.getMonth()+1).padStart(2,"0")+"-"+String(i.getDate()).padStart(2,"0")+" "+String(i.getHours()).padStart(2,"0")+":"+String(i.getMinutes()).padStart(2,"0")+":"+String(i.getSeconds()).padStart(2,"0")},e=t(s.value.fecha_salida),n=t(x.value),o=await M.post("/api/tours/validar-fechas",{fecha_salida:e,fecha_regreso:n,tour_id:s.value.id});if(!o.data.success&&o.data.tiene_conflictos){const r=o.data.conflictos;let i=`${o.data.message}`;return r&&r.length>0?(i+=`:

`,i+=`Tours activos programados para esta fecha:
`,r.forEach((b,_)=>{i+=`${_+1}. ${b.nombre}
`,i+=`   Fechas: ${b.fecha_salida} al ${b.fecha_regreso}

`}),i+=`Nota: Solo se permiten 3 tours activos por fecha de salida (no se cuentan tours cancelados o finalizados).
`,i+="Por favor selecciona una fecha de salida diferente."):i+=`.

Por favor verifica la información del tour.`,f.add({severity:"warn",summary:"Límite diario alcanzado",detail:i,life:1e4}),!1}return!0}catch(t){return console.error("Error al validar fechas:",t),f.add({severity:"error",summary:"Error de validación",detail:"No se pudieron validar las fechas. Inténtalo nuevamente.",life:4e3}),!1}},Na=async()=>{if(C.value=!0,!x.value){f.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos.",life:4e3});return}if(!s.value.nombre||s.value.nombre.length<10||s.value.nombre.length>200){f.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos y cumplan los requisitos.",life:4e3});return}if(!s.value.punto_salida||s.value.punto_salida.length<5||s.value.punto_salida.length>200){f.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos y cumplan los requisitos.",life:4e3});return}if(le.value){f.add({severity:"warn",summary:"Error en cupo mínimo",detail:le.value,life:4e3});return}if(oe.value){f.add({severity:"warn",summary:"Error en cupo máximo",detail:oe.value,life:4e3});return}if(s.value.cupo_min&&s.value.cupo_max&&s.value.cupo_min>=s.value.cupo_max){f.add({severity:"warn",summary:"Verificar datos",detail:"Por favor revisa los valores ingresados y corrige cualquier inconsistencia.",life:4e3});return}if(!Pe()){f.add({severity:"warn",summary:"Verificar fechas",detail:"Por favor revisa las fechas ingresadas y asegúrate de que sean correctas.",life:4e3});return}if(!Fe()){f.add({severity:"warn",summary:"Verificar fechas",detail:"Por favor revisa las fechas ingresadas y asegúrate de que sean correctas.",life:4e3});return}if(!await Fa())return;if(!s.value.fecha_salida||!s.value.precio||!s.value.categoria||!s.value.transporte_id||!s.value.cupo_min||!s.value.cupo_max||k.value.length===0){f.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos.",life:4e3});return}if(k.value.length>5){f.add({severity:"warn",summary:"Demasiadas imágenes",detail:"No puedes subir más de 5 imágenes por tour.",life:4e3});return}const e=2*1024*1024;if(ue.value.filter(o=>o.size>e).length>0){f.add({severity:"warn",summary:"Verificar archivos",detail:"Por favor revisa el tamaño de las imágenes seleccionadas.",life:4e3});return}Q.value=!0;try{const o=new FormData;if(o.append("nombre",s.value.nombre||""),F.value.length>0?o.append("incluye",ea(F.value)):o.append("incluye",""),o.append("punto_salida",s.value.punto_salida||""),s.value.fecha_salida instanceof Date){const i=s.value.fecha_salida,b=i.getFullYear(),_=String(i.getMonth()+1).padStart(2,"0"),l=String(i.getDate()).padStart(2,"0"),g=String(i.getHours()).padStart(2,"0"),L=String(i.getMinutes()).padStart(2,"0"),ye=String(i.getSeconds()).padStart(2,"0");o.append("fecha_salida",`${b}-${_}-${l} ${g}:${L}:${ye}`)}else s.value.fecha_salida&&o.append("fecha_salida",s.value.fecha_salida);if(x.value instanceof Date){const i=x.value,b=i.getFullYear(),_=String(i.getMonth()+1).padStart(2,"0"),l=String(i.getDate()).padStart(2,"0"),g=String(i.getHours()).padStart(2,"0"),L=String(i.getMinutes()).padStart(2,"0"),ye=String(i.getSeconds()).padStart(2,"0");o.append("fecha_regreso",`${b}-${_}-${l} ${g}:${L}:${ye}`)}else x.value&&o.append("fecha_regreso",x.value);o.append("precio",s.value.precio||""),o.append("categoria",s.value.categoria||""),o.append("transporte_id",s.value.transporte_id||""),P.value.length>0?o.append("no_incluye",ea(P.value)):o.append("no_incluye",""),s.value.cupo_min&&o.append("cupo_min",s.value.cupo_min),s.value.cupo_max&&o.append("cupo_max",s.value.cupo_max),ue.value.forEach(i=>o.append("imagenes[]",i)),ce.value.forEach(i=>{const b=i.includes("/")?i.split("/").pop():i;o.append("removed_images[]",b)});let r;s.value.id?(o.append("_method","PUT"),r=await M.post(`${De}/${s.value.id}`,o,{headers:{"Content-Type":"multipart/form-data"}}),f.add({severity:"success",summary:"¡Éxito!",detail:"El tour ha sido actualizado correctamente.",life:5e3})):(r=await M.post(De,o,{headers:{"Content-Type":"multipart/form-data"}}),f.add({severity:"success",summary:"¡Éxito!",detail:"El tour ha sido creado correctamente.",life:5e3})),await ta(),U.value=!1,Z.value=!1,z.value=null,Se()}catch(o){let r="Por favor revisa los campos e intenta nuevamente.";if(o.response&&o.response.status===422){if(o.response.data&&o.response.data.message)r=o.response.data.message;else if(o.response.data&&o.response.data.errors){const i=o.response.data.errors,b=Object.values(i)[0];b&&b.length>0&&(r=b[0])}}f.add({severity:"warn",summary:"Error de validación",detail:r,life:8e3})}finally{Q.value=!1}},Te=c(null),Va=async t=>{s.value={...t};try{const e=await M.get(`/api/tours/${t.id}/informacion-eliminacion`);e.data.success?Te.value=e.data:Te.value=null}catch(e){console.error("Error obteniendo información de eliminación:",e),Te.value=null}me.value=!0},La=async()=>{Le.value=!0;try{await M.delete(`${De}/${s.value.id}`),await ta(),me.value=!1,f.add({severity:"success",summary:"¡Eliminado!",detail:"El tour ha sido eliminado correctamente.",life:5e3})}catch{f.add({severity:"error",summary:"Error",detail:"No se pudo eliminar el tour. Inténtalo de nuevo.",life:5e3})}finally{Le.value=!1}},Ra=()=>{Z.value?ve.value=!0:na()},na=()=>{U.value=!1,ve.value=!1,Z.value=!1,z.value=null,Se()},Ma=()=>{ve.value=!1},Oa=async()=>{B.value=!0,await new Promise(t=>setTimeout(t,300)),Ze.value.click(),setTimeout(()=>{Y.value||(B.value=!1)},1e3)},$a=async t=>{const e=t.target?t.target.files:t.files,n=2*1024*1024,o=5;if(B.value=!1,!e||e.length===0)return;const r=k.value.length,i=e.length;if(r+i>o){const _=o-r;f.add({severity:"warn",summary:"Límite de imágenes excedido",detail:`Solo puedes subir un máximo de ${o} imágenes por tour. Actualmente tienes ${r} imagen${r!==1?"es":""}, puedes agregar máximo ${_} más.`,life:6e3});return}Y.value=!0;try{const _=[];let l=0;for(const g of e)if(g instanceof File){if(g.size>n){f.add({severity:"warn",summary:"Archivo muy grande",detail:`El archivo "${g.name}" excede el tamaño máximo de 2MB.`,life:5e3});continue}if(!g.type.startsWith("image/")){f.add({severity:"warn",summary:"Formato no válido",detail:`El archivo "${g.name}" no es una imagen válida.`,life:4e3});continue}ue.value.push(g),l++;const L=new Promise(ye=>{const pa=new FileReader;pa.onload=ot=>{k.value.push(ot.target.result),ye()},pa.readAsDataURL(g)});_.push(L)}await Promise.all(_),l>0&&f.add({severity:"success",summary:"Imágenes cargadas",detail:`${l} imagen${l>1?"es":""} cargada${l>1?"s":""} correctamente. Total: ${k.value.length}/${o}`,life:4e3})}catch{f.add({severity:"error",summary:"Error al cargar imágenes",detail:"Hubo un problema al procesar las imágenes. Inténtalo de nuevo.",life:4e3})}finally{Y.value=!1,B.value=!1,t.target&&(t.target.value="")}},Ua=t=>{const e=k.value[t];typeof e=="string"&&e.startsWith("data:image")?(k.value.splice(t,1),ue.value.splice(t,1)):(ce.value.push(e),k.value.splice(t,1))},qa=t=>{if(G.value&&G.value.imagenes&&G.value.imagenes.length>0){Oe.value=G.value.imagenes.map(n=>{const o=typeof n=="string"?n:n.nombre;return Ge+o});const e=Math.max(0,Math.min(t,Oe.value.length-1));$e.value=e,setTimeout(()=>{Me.value=!0},50)}else f.add({severity:"warn",summary:"Sin imágenes",detail:"No hay imágenes disponibles para mostrar.",life:5e3})},ra=()=>{s.value.nombre&&(s.value.nombre=s.value.nombre.toUpperCase(),s.value.nombre=s.value.nombre.replace(/[^A-ZÁÉÍÓÚÑ0-9\s]/g,""),s.value.nombre=s.value.nombre.replace(/\s+/g," "),s.value.nombre.length>200&&(s.value.nombre=s.value.nombre.substring(0,200)),s.value.nombre=s.value.nombre.trim())},za=t=>{/[a-zA-ZáéíóúñÁÉÍÓÚÑ0-9\s]/.test(t.key)||t.preventDefault()},Ba=t=>{t.preventDefault();const e=(t.clipboardData||window.clipboardData).getData("text");if(e){let n=e.toUpperCase();n=n.replace(/[^A-ZÁÉÍÓÚÑ0-9\s]/g,""),n=n.replace(/\s+/g," "),n=n.trim(),n.length>200&&(n=n.substring(0,200)),s.value.nombre=n,ra()}},ja=t=>{t.preventDefault();const e=(t.clipboardData||window.clipboardData).getData("text");if(e){let n=e.toUpperCase();n=n.replace(/\s+/g," "),n=n.trim(),n.length>200&&(n=n.substring(0,200)),s.value.punto_salida=n,ia()}},ia=()=>{s.value.punto_salida&&(s.value.punto_salida=s.value.punto_salida.toUpperCase(),s.value.punto_salida=s.value.punto_salida.replace(/\s+/g," "),s.value.punto_salida.length>200&&(s.value.punto_salida=s.value.punto_salida.substring(0,200)),s.value.punto_salida=s.value.punto_salida.trim())},da=()=>{const t=V.value.find(r=>r.id===s.value.transporte_id),e=t?t.capacidad:null,n=parseInt(s.value.cupo_min)||0,o=parseInt(s.value.cupo_max)||0;return s.value.cupo_min&&n<1||s.value.cupo_max&&o<1||e&&(s.value.cupo_min&&n>e||s.value.cupo_max&&o>e)?!1:s.value.cupo_min&&!s.value.cupo_max||s.value.cupo_max&&!s.value.cupo_min?!0:!(s.value.cupo_min&&s.value.cupo_max&&n>=o)},Pe=()=>{if(!s.value.fecha_salida)return!0;const t=new Date,e=new Date(s.value.fecha_salida),n=new Date(t.getTime()+60*60*1e3);return!(e<n||x.value&&(new Date(x.value)-e)/(1e3*60*60)<1)},Fe=()=>{if(!x.value)return!0;const t=new Date(x.value);if(s.value.fecha_salida){const e=new Date(s.value.fecha_salida);if((t-e)/(1e3*60*60)<1)return!1}return!0},ua=()=>{const t=new Date;return t.setHours(t.getHours()+1),t},Ga=()=>{if(!s.value.fecha_salida)return ua();const t=new Date(s.value.fecha_salida);return t.setHours(t.getHours()+1),t},Ha=()=>{if(!x.value)return null;const t=new Date(x.value);return t.setHours(t.getHours()-1),t},xe=c(typeof window<"u"?window.innerWidth:1024),ca=R(()=>xe.value<640?{width:"95vw",maxWidth:"380px"}:xe.value<768?{width:"400px"}:{width:"450px"}),Wa=R(()=>xe.value<640?{width:"95vw",maxWidth:"400px"}:xe.value<768?{width:"500px"}:{width:"600px"}),Ka=t=>{G.value=t,q.value=!0},Za=t=>{f.add({severity:"info",summary:"Duplicar Tour",detail:`Funcionalidad de duplicar tour "${t.nombre}" en desarrollo.`,life:5e3}),q.value=!1},Qa=t=>{q.value=!1},Ya=t=>{f.add({severity:"info",summary:"Generar Reporte",detail:`Funcionalidad de generar reporte del tour "${t.nombre}" en desarrollo.`,life:5e3}),q.value=!1},Ja=t=>{f.add({severity:"info",summary:"Archivar Tour",detail:`Funcionalidad de archivar tour "${t.nombre}" en desarrollo.`,life:5e3}),q.value=!1},Xa=t=>{ga.visit(`/catalogos/reservas?tour=${t.id}`)},et=t=>{q.value=!1,G.value=t,Ee.value=!0},at=t=>{t.originalEvent.target.closest("button")||(G.value=t.data,Ee.value=!0)},ma=t=>{const e=t.target.value,n=t.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(t.keyCode)||t.ctrlKey&&[65,67,86,88].includes(t.keyCode))return;if(!/[0-9]/.test(n)){t.preventDefault();return}const o=e+n,r=parseInt(o),i=ee.value;if(o==="0"||e===""&&n==="0"){t.preventDefault();return}if(o.length>3||r>i||r<1){t.preventDefault();return}},va=t=>{t.preventDefault();const n=(t.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");if(n){let o=parseInt(n);const r=ee.value;o<1?o=1:o>r&&(o=r),t.target.id.includes("cupo_min")?s.value.cupo_min=o:t.target.id.includes("cupo_max")&&(s.value.cupo_max=o)}},tt=R(()=>s.cupo_max?Math.max(1,s.cupo_max-1):1),st=t=>{const e=t.target.value,n=t.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(t.keyCode)||t.ctrlKey&&[65,67,86,88].includes(t.keyCode))return;if(!/[0-9.]/.test(n)){t.preventDefault();return}if(n==="."&&e.includes(".")){t.preventDefault();return}if(n!=="."){const i=e.split(".");if(i[0].length>=4&&!e.includes(".")){t.preventDefault();return}if(i.length>1&&i[1].length>=2){t.preventDefault();return}}const o=e+n;if(parseFloat(o)>9999.99){t.preventDefault();return}},lt=t=>{t.preventDefault();let n=(t.clipboardData||window.clipboardData).getData("text").replace(/[^\d.]/g,"");if(!n||n===".")return;if((n.match(/\./g)||[]).length>1){const _=n.indexOf(".");n=n.substring(0,_+1)+n.substring(_+1).replace(/\./g,"")}const r=parseFloat(n);if(isNaN(r))return;const b=Math.min(r,9999.99).toFixed(2);s.precio=b,t.target.value=b};return(t,e)=>{const n=ne("Toast"),o=ne("InputText"),r=ne("Column"),i=ne("DataTable"),b=ne("Select"),_=ne("Dialog");return u(),Ve(ct,null,{default:A(()=>[v(d(dt),{title:"Tours"}),v(n,{class:"z-[9999]"}),a("div",Ct,[a("div",Dt,[a("div",kt,[e[36]||(e[36]=a("div",{class:"text-center sm:text-left"},[a("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Catálogo de Tours y Control de Reservaciones"),a("p",{class:"text-gray-600"},"Gestión completa de paquetes turísticos"),a("div",{class:"bg-blue-50 border-l-4 border-blue-400 p-3 mt-3 rounded-r-md space-y-2"},[a("div",{class:"flex items-start gap-2 text-xs text-blue-700"},[a("i",{class:"fas fa-info-circle mt-0.5 text-blue-500 flex-shrink-0"}),a("div",null,[a("span",{class:"font-semibold"},"Ordenamiento:"),D(" Tours por estado (En Curso → Completo → Reprogramada → Disponible → Finalizado) y fecha próxima. ")])]),a("div",{class:"flex items-start gap-2 text-xs text-green-700"},[a("i",{class:"fas fa-calendar-check mt-0.5 text-green-500 flex-shrink-0"}),a("div",null,[a("span",{class:"font-semibold"},"Reservas:"),D(' Usa botón "Más" (⋮) → "Ver reservas" para gestionar reservas individuales. ')])]),a("div",{class:"flex items-start gap-2 text-xs text-orange-700"},[a("i",{class:"fas fa-clock mt-0.5 text-orange-500 flex-shrink-0"}),a("div",null,[a("span",{class:"font-semibold"},"Pendientes:"),D(' Botón "Pendientes" muestra tours con reservas por confirmar. ')])])])],-1)),a("div",Et,[a("button",{onClick:Ea,class:"bg-orange-500 border border-orange-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 flex items-center gap-2"},[v(d(w),{icon:d(vt),class:"h-4 w-4"},null,8,["icon"]),e[33]||(e[33]=a("span",{class:"hidden sm:block"},"Pendientes",-1)),e[34]||(e[34]=a("span",{class:"block sm:hidden"},"Pendientes",-1))]),v(d(ut),{href:t.route("transportes"),onClick:Pa,class:S([{"opacity-50 cursor-not-allowed":ae.value},"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 flex items-center gap-2"])},{default:A(()=>[v(d(w),{icon:ae.value?d(K):d(pt),class:S({"animate-spin":ae.value,"h-4":!0})},null,8,["icon","class"]),a("span",St,p(ae.value?"Cargando...":"Transportes"),1),a("span",At,p(ae.value?"Cargando...":"Transportes"),1)]),_:1},8,["href","class"]),a("button",{class:"bg-red-500 flex border border-red-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:la},[v(d(w),{icon:d(we),class:"h-4 w-4 mr-1 text-white"},null,8,["icon"]),e[35]||(e[35]=a("span",null,"Agregar",-1))])])]),pe.value?(u(),m("div",It,[v(d(w),{icon:d(K),class:"animate-spin h-10 w-10 text-blue-600"},null,8,["icon"]),e[37]||(e[37]=a("span",{class:"text-gray-600 font-medium text-lg"},"Cargando tours...",-1))])):(u(),Ve(i,{key:1,value:Ue.value,selection:He.value,"onUpdate:selection":e[8]||(e[8]=l=>He.value=l),dataKey:"id",paginator:!0,rows:Re.value,rowsPerPageOptions:ha.value,rowsPerPage:Re.value,"onUpdate:rowsPerPage":e[9]||(e[9]=l=>Re.value=l),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} tours",class:"overflow-x-auto max-w-full px-auto",onRowClick:at,responsiveLayout:"scroll",pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:A(()=>[a("div",Tt,[a("div",Pt,[a("div",Ft,[e[38]||(e[38]=a("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[a("i",{class:"pi pi-filter text-blue-600 text-sm"}),a("span",null,"Filtros")],-1)),a("div",Nt,p(Ue.value.length)+" resultado"+p(Ue.value.length!==1?"s":""),1),a("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:sa,disabled:j.value},[j.value?(u(),Ve(d(w),{key:0,icon:d(K),class:"animate-spin h-3 w-3"},null,8,["icon"])):y("",!0),a("span",null,p(j.value?"Limp...":"Limpiar"),1)],8,Vt)]),a("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:sa,disabled:j.value},[j.value?(u(),Ve(d(w),{key:0,icon:d(K),class:"animate-spin h-3 w-3"},null,8,["icon"])):y("",!0),a("span",null,p(j.value?"Limpiando...":"Limpiar filtros"),1)],8,Lt)]),a("div",Rt,[a("div",Mt,[v(d(w),{icon:d(ba),class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"},null,8,["icon"]),v(o,{modelValue:E.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=l=>E.value.global.value=l),placeholder:"Buscar tours...",class:"w-full h-9 text-sm rounded-md pl-10",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),a("div",Ot,[a("div",null,[re(a("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>te.value=l),onChange:Aa,class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[39]||(e[39]=a("option",{value:"",disabled:"",selected:"",hidden:""},"Categoría",-1)),(u(!0),m(H,null,W(We.value,l=>(u(),m("option",{key:l.value,value:l.value,class:"truncate text-gray-900 text-lg"},p(l.label),9,$t))),128))],544),[[Be,te.value]])]),a("div",null,[re(a("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>X.value=l),onChange:Ia,class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[40]||(e[40]=a("option",{value:"",disabled:"",selected:"",hidden:""},"Transporte",-1)),(u(!0),m(H,null,W(V.value,l=>(u(),m("option",{key:l.id,value:l.id,class:"truncate text-gray-900 text-lg"},p(l.nombre),9,Ut))),128))],544),[[Be,X.value]])]),a("div",qt,[re(a("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>se.value=l),onChange:Ta,class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[41]||(e[41]=a("option",{value:"",disabled:"",selected:"",hidden:""},"Estado",-1)),(u(!0),m(H,null,W(Ke.value,l=>(u(),m("option",{key:l.value,value:l.value,class:"truncate text-gray-900 text-lg"},p(l.label),9,zt))),128))],544),[[Be,se.value]])]),a("div",Bt,[v(d(de),{modelValue:I.value,"onUpdate:modelValue":e[4]||(e[4]=l=>I.value=l),placeholder:"Fecha desde",class:"w-full h-9 text-sm rounded-md border border-blue-300",onDateSelect:Ae,onClear:Ae,showIcon:!0,dateFormat:"dd/mm/yy",maxDate:T.value},null,8,["modelValue","maxDate"])]),a("div",jt,[v(d(de),{modelValue:T.value,"onUpdate:modelValue":e[5]||(e[5]=l=>T.value=l),placeholder:"Fecha hasta",class:"w-full h-9 text-sm rounded-md border border-blue-300",onDateSelect:Ie,onClear:Ie,showIcon:!0,dateFormat:"dd/mm/yy",minDate:I.value},null,8,["modelValue","minDate"])]),a("div",Gt,[v(d(de),{modelValue:I.value,"onUpdate:modelValue":e[6]||(e[6]=l=>I.value=l),placeholder:"Fecha desde",class:"h-9 text-sm rounded-md",onDateSelect:Ae,onClear:Ae,showIcon:!0,dateFormat:"dd/mm/yy",maxDate:T.value},null,8,["modelValue","maxDate"]),v(d(de),{modelValue:T.value,"onUpdate:modelValue":e[7]||(e[7]=l=>T.value=l),placeholder:"Fecha hasta",class:"h-9 text-sm rounded-md",onDateSelect:Ie,onClear:Ie,showIcon:!0,dateFormat:"dd/mm/yy",minDate:I.value},null,8,["modelValue","minDate"])]),a("div",Ht,[a("p",Wt,[v(d(w),{icon:d(xt),class:"h-3 w-3 text-yellow-500"},null,8,["icon"]),e[42]||(e[42]=D(" Haz clic en cualquier fila para ver los detalles. "))])])])])])]),empty:A(()=>[a("div",ts,[v(d(w),{icon:d(ht),class:"h-12 w-12 text-gray-400"},null,8,["icon"]),a("div",ss,[e[48]||(e[48]=a("h3",{class:"text-lg font-semibold text-gray-700 mb-2"},"NO HAY TOURS AGREGADOS",-1)),e[49]||(e[49]=a("p",{class:"text-gray-500 mb-4"},'Comienza agregando tu primer tour haciendo clic en el botón "Agregar"',-1)),a("button",{class:"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-md shadow-md transition-all duration-200 flex items-center gap-2 mx-auto",onClick:la},[v(d(w),{icon:d(we),class:"h-4 w-4"},null,8,["icon"]),e[47]||(e[47]=D(" Agregar Tour "))])])])]),default:A(()=>[v(r,{field:"nombre",header:"Nombre",sortable:"",class:"w-36 min-w-24"},{body:A(l=>[a("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"85px","text-overflow":"ellipsis","white-space":"nowrap"},title:l.data.nombre},p(l.data.nombre),9,Kt)]),_:1}),v(r,{field:"punto_salida",header:"Punto salida",class:"w-32 min-w-32 hidden md:table-cell"},{body:A(l=>[a("div",{class:"text-sm leading-relaxed overflow-hidden",style:{"max-width":"128px","text-overflow":"ellipsis","white-space":"nowrap"},title:l.data.punto_salida},p(l.data.punto_salida),9,Zt)]),_:1}),v(r,{field:"fecha_salida",header:"Fecha salida",class:"w-36 min-w-36 hidden md:table-cell"},{body:A(l=>[a("div",Qt,p(l.data.fecha_salida?new Date(l.data.fecha_salida).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):""),1)]),_:1}),v(r,{field:"precio",header:"Precio",class:"w-24 min-w-18"},{body:A(l=>[a("div",Yt,p(isNaN(Number(l.data.precio))?"":`$${Number(l.data.precio).toFixed(2)}`),1)]),_:1}),v(r,{field:"estado",header:"Estado",class:"w-32 min-w-24 hidden lg:table-cell"},{body:A(l=>{var g;return[a("span",{class:S([{"bg-green-100 text-green-800":l.data.estado==="DISPONIBLE","bg-red-100 text-red-800":l.data.estado==="COMPLETO"||l.data.estado==="CANCELADA","bg-blue-100 text-blue-800":l.data.estado==="EN_CURSO","bg-gray-100 text-gray-800":l.data.estado==="FINALIZADO","bg-purple-100 text-purple-800":l.data.estado==="REPROGRAMADA"},"px-2 py-1 rounded-full text-xs font-medium"])},p(((g=Ke.value.find(L=>L.value===l.data.estado))==null?void 0:g.label)||l.data.estado),3)]}),_:1}),v(r,{exportable:!1,class:"w-52 min-w-36"},{header:A(()=>e[43]||(e[43]=[a("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:A(l=>[a("div",Jt,[a("button",{class:"flex bg-green-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:g=>Ka(l.data),title:"Más acciones"},[v(d(w),{icon:d(ft),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[44]||(e[44]=a("span",{class:"hidden md:block text-white"},"Más",-1))],8,Xt),a("button",{class:"flex bg-blue-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:g=>oa(l.data)},[v(d(w),{icon:d(gt),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[45]||(e[45]=a("span",{class:"hidden md:block text-white"},"Editar",-1))],8,es),a("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:g=>Va(l.data)},[v(d(w),{icon:d(bt),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[46]||(e[46]=a("span",{class:"hidden md:block text-white"},"Eliminar",-1))],8,as)])]),_:1})]),_:1},8,["value","selection","rows","rowsPerPageOptions","rowsPerPage"])),v(_,{visible:U.value,"onUpdate:visible":e[21]||(e[21]=l=>U.value=l),header:be.value+" Tour",modal:!0,style:ie(ca.value),closable:!1,draggable:!1},{footer:A(()=>[a("div",Cl,[a("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:Na,disabled:Q.value||!!le.value||!!oe.value},[v(d(w),{icon:Q.value?d(K):d(_t),class:S(["h-5 text-white",{"animate-spin":Q.value}])},null,8,["icon","class"]),Q.value?(u(),m("span",El,p(be.value==="Guardar"?"Guardando...":"Actualizando..."),1)):(u(),m("span",kl,p(be.value),1))],8,Dl),a("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Ra,disabled:Q.value},[v(d(w),{icon:d(Ce),class:"h-5"},null,8,["icon"]),e[69]||(e[69]=D("Cancelar "))],8,Sl)])]),default:A(()=>[h.value?(u(),m("div",ls,[a("div",os,[a("div",ns,[v(d(w),{icon:d(yt),class:"h-5 w-5 text-yellow-400"},null,8,["icon"])]),e[50]||(e[50]=a("div",{class:"ml-3"},[a("p",{class:"text-sm text-yellow-700"},[a("strong",null,"Edición restringida:"),D(" Este tour tiene reservas en estados especiales (Cancelada, Pendiente o Reprogramada). Solo puedes modificar el cupo mínimo y máximo. Los demás campos están deshabilitados para mantener la integridad de los datos. ")])],-1))])])):y("",!0),a("div",rs,[a("div",is,[a("div",ds,[e[51]||(e[51]=a("label",{for:"nombre",class:"flex items-center gap-1"},[D("Tour: "),a("span",{class:"text-red-500 font-bold"},"*")],-1)),v(o,{modelValue:s.value.nombre,"onUpdate:modelValue":e[10]||(e[10]=l=>s.value.nombre=l),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:200,disabled:h.value,class:S([{"p-invalid":C.value&&(!s.value.nombre||s.value.nombre.length<10||s.value.nombre.length>200),"opacity-50 bg-gray-100 cursor-not-allowed":h.value},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"TOUR AL CERRO EL PITAL, ETC",onInput:ra,onKeypress:za,onPaste:Ba},null,8,["modelValue","disabled","class"])]),s.value.nombre&&s.value.nombre.length<10?(u(),m("small",us," El nombre debe tener al menos 10 caracteres. Actual: "+p(s.value.nombre.length)+"/10 ",1)):y("",!0),s.value.nombre&&s.value.nombre.length>=180&&s.value.nombre.length<=200?(u(),m("small",cs," Caracteres restantes: "+p(200-s.value.nombre.length)+". ",1)):y("",!0),C.value&&!s.value.nombre?(u(),m("small",ms," El nombre es obligatorio. ")):y("",!0)]),a("div",vs,[a("div",ps,[e[52]||(e[52]=a("label",{for:"incluye",class:"w-12 flex items-center gap-1 mt-2"}," Incluye: ",-1)),a("div",fs,[a("div",gs,[re(a("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>O.value=l),type:"text",placeholder:"Agregar nuevo elemento...",disabled:h.value,class:S([{"opacity-50 bg-gray-100 cursor-not-allowed":h.value},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),maxlength:"100",onKeyup:fa(Ye,["enter"])},null,42,bs),[[je,O.value]]),a("button",{type:"button",onClick:Ye,disabled:!O.value.trim()||h.value,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},[v(d(w),{icon:d(we),class:"h-5"},null,8,["icon"])],8,hs)]),a("small",xs,p(100-O.value.length)+" caracteres restantes ",1),a("div",ys,[(u(!0),m(H,null,W(F.value,(l,g)=>(u(),m("div",{key:g,class:"flex items-center justify-between bg-gray-50 p-2 rounded-md border"},[a("span",_s,p(l),1),a("button",{type:"button",onClick:L=>ya(g),disabled:h.value,class:"text-red-500 hover:text-red-700 p-1 disabled:text-gray-400 disabled:cursor-not-allowed"},[v(d(w),{icon:d(Ce),class:"h-5"},null,8,["icon"])],8,ws)]))),128))]),F.value.length===0?(u(),m("div",Cs," Sin elementos agregados. ")):y("",!0)])])]),a("div",Ds,[a("div",ks,[e[53]||(e[53]=a("label",{for:"no_incluye",class:"w-12 flex items-center gap-1 mt-2"}," No incluye: ",-1)),a("div",Es,[a("div",Ss,[re(a("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>$.value=l),type:"text",placeholder:"Agregar nuevo elemento...",disabled:h.value,class:S([{"opacity-50 bg-gray-100 cursor-not-allowed":h.value},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),maxlength:"100",onKeyup:fa(Je,["enter"])},null,42,As),[[je,$.value]]),a("button",{type:"button",onClick:Je,disabled:!$.value.trim()||h.value,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},[v(d(w),{icon:d(we),class:"h-5"},null,8,["icon"])],8,Is)]),a("small",Ts,p(100-$.value.length)+" caracteres restantes ",1),P.value.length>0?(u(),m("div",Ps,[(u(!0),m(H,null,W(P.value,(l,g)=>(u(),m("div",{key:g,class:"flex items-center justify-between bg-gray-50 p-2 rounded-md border"},[a("span",Fs,p(l),1),a("button",{type:"button",onClick:L=>_a(g),disabled:h.value,class:"text-red-500 hover:text-red-700 p-1 disabled:text-gray-400 disabled:cursor-not-allowed"},[v(d(w),{icon:d(Ce),class:"h-5"},null,8,["icon"])],8,Ns)]))),128))])):y("",!0),P.value.length===0?(u(),m("div",Vs," Sin elementos agregados. ")):y("",!0)])])]),a("div",Ls,[a("div",Rs,[e[54]||(e[54]=a("label",{for:"punto_salida",class:"flex w-12 items-center"},[D(" Punto salida: "),a("span",{class:"text-red-500 font-bold"}," * ")],-1)),v(o,{modelValue:s.value.punto_salida,"onUpdate:modelValue":e[13]||(e[13]=l=>s.value.punto_salida=l),modelModifiers:{trim:!0},id:"punto_salida",name:"punto_salida",maxlength:200,disabled:h.value,class:S([{"p-invalid":C.value&&(!s.value.punto_salida||s.value.punto_salida.length<5),"opacity-50 bg-gray-100 cursor-not-allowed":h.value},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"ATRIO DE CATEDRAL DE CHALATENANGO, ETC",onInput:ia,onPaste:ja},null,8,["modelValue","disabled","class"])]),s.value.punto_salida&&s.value.punto_salida.length<5?(u(),m("small",Ms,"Debe tener al menos 5 caracteres. Actual: "+p(s.value.punto_salida.length)+"/5",1)):y("",!0),s.value.punto_salida&&s.value.punto_salida.length>=180&&s.value.punto_salida.length<=200?(u(),m("small",Os,"Caracteres restantes: "+p(200-s.value.punto_salida.length),1)):y("",!0),C.value&&!s.value.punto_salida?(u(),m("small",$s,"El punto de salida es obligatorio.")):y("",!0),C.value&&s.value.punto_salida&&s.value.punto_salida.length<5?(u(),m("small",Us,"El punto de salida debe tener al menos 5 caracteres.")):y("",!0)]),a("div",qs,[a("div",zs,[e[55]||(e[55]=a("label",{for:"transporte_id",class:"w-24 flex items-center gap-1"},[D("Transporte:"),a("span",{class:"text-red-500 font-bold"},"*")],-1)),v(b,{modelValue:s.value.transporte_id,"onUpdate:modelValue":e[14]||(e[14]=l=>s.value.transporte_id=l),options:V.value,optionLabel:"nombre",optionValue:"id",id:"transporte_id",name:"transporte_id",disabled:h.value,class:S(["w-full rounded-md border-2 border-gray-400 hover:border-gray-500",{"p-invalid":C.value&&!s.value.transporte_id}]),placeholder:"Seleccionar",style:ie(h.value?"opacity: 0.5; background-color: #f3f4f6; cursor: not-allowed; pointer-events: none;":"")},null,8,["modelValue","options","disabled","class","style"])]),C.value&&!s.value.transporte_id?(u(),m("small",Bs,"El tipo de transporte es obligatorio.")):y("",!0)]),a("div",js,[a("div",Gs,[a("label",Hs,[e[56]||(e[56]=D(" Cupo mínimo: ")),e[57]||(e[57]=a("span",{class:"text-red-500 font-bold"},"*",-1)),s.value.transporte_id?(u(),m("small",Ws," (Mín: "+p(tt.value)+") ",1)):y("",!0)]),v(o,{modelValue:s.value.cupo_min,"onUpdate:modelValue":e[15]||(e[15]=l=>s.value.cupo_min=l),id:"cupo_min",name:"cupo_min",type:"number",inputmode:"numeric",min:"1",max:ee.value,class:S(["w-full border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":C.value&&!s.value.cupo_min||le.value}]),placeholder:`1-${ee.value}`,onKeydown:ma,onPaste:va,onInput:da},null,8,["modelValue","max","class","placeholder"]),C.value&&!s.value.cupo_min?(u(),m("small",Ks,"El cupo mínimo es obligatorio.")):y("",!0),le.value?(u(),m("small",Zs,p(le.value),1)):y("",!0)]),a("div",Qs,[a("label",Ys,[e[58]||(e[58]=D(" Cupo máximo: ")),e[59]||(e[59]=a("span",{class:"text-red-500 font-bold"},"*",-1)),s.value.transporte_id?(u(),m("small",Js,"(Máx: "+p(ee.value)+")",1)):y("",!0)]),v(o,{modelValue:s.value.cupo_max,"onUpdate:modelValue":e[16]||(e[16]=l=>s.value.cupo_max=l),id:"cupo_max",name:"cupo_max",type:"number",inputmode:"numeric",min:"1",max:ee.value,class:S(["w-full border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":C.value&&!s.value.cupo_max||oe.value}]),placeholder:`1-${ee.value}`,onKeydown:ma,onPaste:va,onInput:da},null,8,["modelValue","max","class","placeholder"]),C.value&&!s.value.cupo_max?(u(),m("small",Xs,"El cupo máximo es obligatorio.")):y("",!0),oe.value?(u(),m("small",el,p(oe.value),1)):y("",!0)])]),a("div",al,[a("div",tl,[e[60]||(e[60]=a("label",{for:"fecha_salida",class:"flex items-center gap-1 mb-2"},[D("Fecha y hora de salida:"),a("span",{class:"text-red-500 font-bold"},"*")],-1)),v(d(de),{modelValue:s.value.fecha_salida,"onUpdate:modelValue":e[17]||(e[17]=l=>s.value.fecha_salida=l),id:"fecha_salida",name:"fecha_salida",showIcon:"",showTime:"",hourFormat:"12",dateFormat:"yy-mm-dd",minDate:ua(),maxDate:Ha(),disabled:h.value,class:S([{"p-invalid":C.value&&!s.value.fecha_salida||s.value.fecha_salida&&!Pe()},"w-full border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),style:ie(h.value?"opacity: 0.5; background-color: #f3f4f6; cursor: not-allowed; pointer-events: none;":""),manualInput:!1,onDateSelect:Pe,onInput:Pe},null,8,["modelValue","minDate","maxDate","disabled","class","style"]),C.value&&!s.value.fecha_salida?(u(),m("small",sl,"Fecha y hora de salida requerida.")):y("",!0)]),a("div",ll,[e[61]||(e[61]=a("label",{for:"horaRegresoCalendar",class:"flex items-center gap-1 mb-2"},[D("Fecha y hora regreso:"),a("span",{class:"text-red-500 font-bold"},"*")],-1)),v(d(de),{modelValue:x.value,"onUpdate:modelValue":e[18]||(e[18]=l=>x.value=l),id:"horaRegresoCalendar",name:"horaRegresoCalendar",showIcon:"",showTime:"",hourFormat:"12",dateFormat:"yy-mm-dd",minDate:Ga(),manualInput:!1,disabled:h.value,class:S([{"p-invalid":C.value&&!x.value||x.value&&!Fe()},"w-full border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),style:ie(h.value?"opacity: 0.5; background-color: #f3f4f6; cursor: not-allowed; pointer-events: none;":""),onDateSelect:Fe,onInput:Fe},null,8,["modelValue","minDate","disabled","class","style"]),C.value&&!x.value?(u(),m("small",ol,"Fecha y hora de regreso requerida.")):y("",!0)])]),a("div",nl,[a("div",rl,[e[63]||(e[63]=a("label",{for:"precio",class:"w-24 flex items-center gap-1"},[D("Precio:"),a("span",{class:"text-red-500 font-bold"},"*")],-1)),a("div",il,[e[62]||(e[62]=a("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 pointer-events-none"},"$",-1)),v(o,{modelValue:s.value.precio,"onUpdate:modelValue":e[19]||(e[19]=l=>s.value.precio=l),id:"precio",name:"precio",type:"text",inputmode:"decimal",disabled:h.value,class:S(["w-full pl-8 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":C.value&&(!s.value.precio||s.value.precio<.01||s.value.precio>9999.99),"opacity-50 bg-gray-100 cursor-not-allowed":h.value}]),placeholder:"0.00",onKeydown:st,onPaste:lt},null,8,["modelValue","disabled","class"])])]),C.value&&(s.value.precio==null||s.value.precio<.01||s.value.precio>9999.99)?(u(),m("small",dl,"El precio es obligatorio, debe ser mayor o igual a 0.01 y menor o igual a 9999.99.")):y("",!0)]),a("div",ul,[a("div",cl,[e[64]||(e[64]=a("label",{for:"categoria",class:"w-24 flex items-center gap-1"},[D("Categoría:"),a("span",{class:"text-red-500 font-bold"},"*")],-1)),v(b,{modelValue:s.value.categoria,"onUpdate:modelValue":e[20]||(e[20]=l=>s.value.categoria=l),options:We.value,optionLabel:"label",optionValue:"value",id:"categoria",name:"categoria",disabled:h.value,class:S(["w-full rounded-md border-2 border-gray-400 hover:border-gray-500",{"p-invalid":C.value&&!s.value.categoria}]),placeholder:"Seleccionar",style:ie(h.value?"opacity: 0.5; background-color: #f3f4f6; cursor: not-allowed; pointer-events: none;":"")},null,8,["modelValue","options","disabled","class","style"])]),C.value&&!s.value.categoria?(u(),m("small",ml,"La categoría es obligatoria.")):y("",!0)]),a("div",vl,[a("div",pl,[e[67]||(e[67]=a("label",{for:"imagenes",class:"w-24 flex items-center gap-1"},[D("Imágenes:"),a("span",{class:"text-red-500 font-bold"},"*")],-1)),a("div",fl,[a("div",gl,[a("input",{type:"file",id:"imagenes",name:"imagenes[]",accept:"image/*",multiple:"",onChange:$a,class:"hidden",ref_key:"fileInput",ref:Ze},null,544),a("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 outline-none focus:outline-none active:outline-none disabled:opacity-50 disabled:cursor-not-allowed",onClick:Oa,disabled:Y.value||B.value||!Qe.value},[v(d(w),{icon:Y.value?d(K):B.value?d(K):d(we),class:S({"animate-spin":Y.value||B.value})},null,8,["icon","class"]),D(" "+p(xa.value),1)],8,bl),a("div",hl,[a("span",{class:S(["text-sm font-medium",k.value.length>=5?"text-red-600":"text-gray-600"])},p(k.value.length)+"/5 ",3),e[65]||(e[65]=a("span",{class:"text-xs text-gray-500"},"imágenes",-1))])]),e[66]||(e[66]=a("div",{class:"text-xs text-gray-500 mb-2"}," Máximo 5 imágenes por tour • Formatos: JPG, PNG, GIF • Tamaño máximo: 2MB por imagen ",-1))])]),C.value&&k.value.length===0?(u(),m("small",xl,"Las imágenes son obligatorias (al menos una).")):y("",!0)]),a("div",yl,[(u(!0),m(H,null,W(k.value,(l,g)=>(u(),m("div",{key:g,class:"relative w-24 sm:w-28 h-24 sm:h-28"},[a("img",{src:l.startsWith("data:image")?l:Ge+l,alt:"Vista previa",class:"w-full h-full object-cover rounded border"},null,8,_l),a("button",{onClick:L=>Ua(g),class:"absolute top-2 right-2 bg-gray-600/80 hover:bg-gray-700/80 text-white font-bold py-1 px-2 rounded-full shadow",style:{transform:"translate(50%, -50%)"}},e[68]||(e[68]=[a("i",{class:"pi pi-times text-xs"},null,-1)]),8,wl)]))),128))])])]),_:1},8,["visible","header","style"]),v(wt,{visible:q.value,"onUpdate:visible":e[22]||(e[22]=l=>q.value=l),"details-visible":Ee.value,"onUpdate:detailsVisible":e[23]||(e[23]=l=>Ee.value=l),"carousel-visible":Me.value,"onUpdate:carouselVisible":e[24]||(e[24]=l=>Me.value=l),"delete-visible":me.value,"onUpdate:deleteVisible":e[25]||(e[25]=l=>me.value=l),"unsaved-changes-visible":ve.value,"onUpdate:unsavedChangesVisible":e[26]||(e[26]=l=>ve.value=l),"carousel-index":$e.value,"onUpdate:carouselIndex":e[27]||(e[27]=l=>$e.value=l),tour:G.value||s.value,"dialog-style":ca.value,"selected-images":Oe.value,"image-path":Ge,"is-deleting":Le.value,"tour-delete-info":Te.value,onDuplicate:Za,onChangeStatus:Qa,onGenerateReport:Ya,onArchive:Ja,onDeleteTour:La,onCancelDelete:e[28]||(e[28]=()=>me.value=!1),onCloseWithoutSaving:na,onContinueEditing:Ma,onViewDetails:et,onViewReservations:Xa,onOpenImageModal:qa},null,8,["visible","details-visible","carousel-visible","delete-visible","unsaved-changes-visible","carousel-index","tour","dialog-style","selected-images","is-deleting","tour-delete-info"])])]),v(_,{visible:fe.value,"onUpdate:visible":e[32]||(e[32]=l=>fe.value=l),header:"Tours con Reservas Pendientes",modal:!0,style:ie(Wa.value),closable:!1,draggable:!1},{footer:A(()=>[a("div",lo,[a("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:e[31]||(e[31]=l=>fe.value=!1)},[v(d(w),{icon:d(Ce),class:"h-5"},null,8,["icon"]),e[82]||(e[82]=D(" Cerrar "))])])]),default:A(()=>[a("div",Al,[a("div",Il,[a("div",Tl,[v(d(w),{icon:d(ba),class:"h-4 w-4 text-gray-400"},null,8,["icon"])]),re(a("input",{"onUpdate:modelValue":e[29]||(e[29]=l=>N.value=l),type:"text",placeholder:"Buscar por nombre del cliente...",class:S(["w-full pl-10 pr-12 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-400 focus:border-gray-500 transition-all duration-200 text-sm placeholder-gray-500 shadow-sm",{"bg-gray-50 cursor-not-allowed":J.value,"bg-white":!J.value}]),disabled:J.value},null,10,Pl),[[je,N.value]]),a("div",Fl,[N.value?(u(),m("button",{key:0,onClick:e[30]||(e[30]=l=>N.value=""),class:"p-1 rounded-full text-gray-400 hover:text-red-500 hover:bg-red-50 transition-all duration-200",title:"Limpiar búsqueda",type:"button"},[v(d(w),{icon:d(Ce),class:"h-4 w-4"},null,8,["icon"])])):J.value?(u(),m("div",Nl,[v(d(w),{icon:d(K),class:"h-4 w-4 text-blue-500"},null,8,["icon"])])):y("",!0)])])]),J.value?(u(),m("div",Vl,e[70]||(e[70]=[a("i",{class:"fas fa-spinner animate-spin text-2xl text-blue-500 mb-2"},null,-1),a("p",{class:"text-gray-600"},"Cargando tours con reservas pendientes...",-1)]))):ge.value.length===0?(u(),m("div",Ll,e[71]||(e[71]=[a("i",{class:"fas fa-check-circle text-4xl text-green-500 mb-4"},null,-1),a("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"¡Excelente!",-1),a("p",{class:"text-gray-600"},"No hay tours con reservas pendientes en este momento.",-1)]))):N.value&&qe.value.length===0?(u(),m("div",Rl,[e[72]||(e[72]=a("i",{class:"fas fa-search text-4xl text-gray-400 mb-4"},null,-1)),e[73]||(e[73]=a("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Sin resultados",-1)),a("p",Ml,'No se encontraron reservas con el nombre "'+p(N.value)+'"',1)])):(u(),m("div",Ol,[a("div",$l,[a("div",Ul,[e[74]||(e[74]=a("i",{class:"fas fa-exclamation-triangle text-orange-500 text-sm"},null,-1)),a("span",ql,p(N.value?qe.value.length:ge.value.length)+" "+p(N.value?"resultado(s) encontrado(s)":"tour(s) pendiente(s)"),1)])]),e[81]||(e[81]=a("div",{class:"p-2 bg-blue-50 border border-blue-200 rounded-md text-xs text-blue-700 mb-3"},[a("i",{class:"fas fa-info-circle mr-1"}),a("strong",null,"Navegación:"),D(" Haz clic en cualquier tour para ir directamente a sus reservas pendientes. ")],-1)),a("div",zl,[(u(!0),m(H,null,W(qe.value,l=>(u(),m("div",{key:l.id,class:"border border-gray-200 rounded-lg p-3 hover:shadow-sm transition-shadow cursor-pointer hover:bg-gray-50",onClick:g=>Sa(l.id)},[a("div",jl,[a("h4",Gl,p(l.nombre),1),a("div",Hl,[a("span",Wl,p(l.reservas_pendientes_count),1),e[75]||(e[75]=a("i",{class:"fas fa-external-link-alt text-blue-500 text-xs"},null,-1))])]),a("div",Kl,[a("div",null,[e[76]||(e[76]=a("strong",null,"Fecha:",-1)),D(" "+p(l.fecha_salida_formatted),1)]),a("div",null,[e[77]||(e[77]=a("strong",null,"Estado:",-1)),D(" "+p(l.estado),1)]),a("div",null,[e[78]||(e[78]=a("strong",null,"Precio:",-1)),D(" $"+p(l.precio),1)]),a("div",Zl,[e[79]||(e[79]=a("strong",null,"Cupo mínimo:",-1)),l.cupo_minimo_alcanzado?(u(),m("span",Ql," ✓ Alcanzado ("+p(l.cupos_reservados)+"/"+p(l.cupo_min)+") ",1)):(u(),m("span",Yl," ✗ Pendiente ("+p(l.cupos_reservados)+"/"+p(l.cupo_min)+") ",1))])]),a("div",Jl,[e[80]||(e[80]=a("h5",{class:"font-medium text-gray-800 text-xs mb-1"},"Reservas:",-1)),a("div",Xl,[(u(!0),m(H,null,W(l.reservas_pendientes,g=>(u(),m("div",{key:g.id,class:"text-xs"},[a("div",eo,[a("span",ao,p(g.cliente_nombre),1),a("span",to,p(g.cupos_reservados)+" cupo(s)",1)]),a("div",so,p(g.fecha_reserva),1)]))),128))])])],8,Bl))),128))])]))]),_:1},8,["visible","style"])]),_:1})}}};export{vo as default};
