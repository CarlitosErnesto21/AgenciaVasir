import{r as u,E as q,w as Pe,n as Ce,o as Ga,a6 as Wa,N,k as ee,h as Ne,d as c,x as V,p as m,e as l,$ as d,a0 as Ka,q as F,a1 as Za,y as k,t as f,j as y,v as me,c as p,F as ae,l as te,a7 as Le,A as Ja,D as oa,a9 as na,a3 as Qa}from"./vendor-CqKcGHPa.js";import{A as Ya}from"./AuthenticatedLayout-CVGmrV7_.js";import{z as Xa,A as ve,F as I,q as le}from"./ui-DrLUz167.js";import{n as et,e as se,G as at,h as De,w as tt,i as lt,j as st,l as $e,k as ot}from"./index-BXYozc4i.js";import nt from"./Modales-CWgsbTNy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const rt={class:"container mx-auto px-4 py-6"},it={class:"bg-white rounded-lg shadow-md"},ut={class:"flex flex-col sm:flex-row lg:justify-between lg:items-center mb-4 gap-4 p-6"},dt={class:"w-full"},ct={class:"text-blue-600 text-xs text-center sm:text-start mt-1 font-medium flex items-center gap-1 justify-center sm:justify-start"},mt={class:"flex items-center gap-2 w-full justify-center lg:w-auto lg:justify-end"},vt={class:"block sm:hidden"},pt={class:"hidden sm:block"},ft={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},gt={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},ht={class:"flex items-center gap-3"},bt={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},yt=["disabled"],xt=["disabled"],_t={class:"space-y-3"},wt={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-5 gap-3"},Ct=["value"],Dt=["value"],St={class:"col-span-2 sm:col-span-1"},kt=["value"],It={class:"col-span-2 sm:col-span-1 md:col-span-1 lg:col-span-1 hidden sm:block"},Tt={class:"col-span-2 sm:col-span-1 md:col-span-1 lg:col-span-1 hidden sm:block"},Et={class:"flex w-80 sm:hidden"},Vt=["title"],Ft=["title"],At={class:"text-sm leading-relaxed"},Pt={class:"text-sm font-medium leading-relaxed"},Nt={class:"flex gap-2 justify-center items-center"},Lt=["onClick"],$t=["onClick"],Mt=["onClick"],Ut={class:"space-y-4"},Rt={class:"w-full flex flex-col"},Ot={class:"flex items-center gap-4"},qt={key:0,class:"text-red-500 ml-28"},jt={key:1,class:"text-orange-500 ml-28"},zt={key:2,class:"text-red-500 ml-28"},Bt={class:"w-full flex flex-col"},Ht={class:"flex items-start gap-4"},Gt={class:"flex w-full flex-col"},Wt={class:"flex gap-2 mb-3"},Kt=["disabled"],Zt={class:"space-y-2 max-h-40 overflow-y-auto"},Jt={class:"flex-1"},Qt=["onClick"],Yt={key:0,class:"text-gray-500 text-sm mt-2"},Xt={class:"w-full flex flex-col"},el={class:"flex items-start gap-4"},al={class:"flex w-full flex-col"},tl={class:"flex gap-2 mb-3"},ll=["disabled"],sl={key:0,class:"space-y-2 max-h-40 overflow-y-auto"},ol={class:"flex-1"},nl=["onClick"],rl={key:1,class:"text-gray-500 text-sm mt-2"},il={class:"w-full"},ul={class:"flex items-start gap-4"},dl={key:0,class:"text-red-500 ml-28"},cl={key:1,class:"text-orange-500 ml-28"},ml={key:2,class:"text-red-500 ml-28"},vl={key:3,class:"text-red-500 ml-28"},pl={class:"w-full flex flex-col"},fl={class:"flex items-center gap-3.5"},gl={key:0,class:"text-red-500 ml-28"},hl={class:"grid grid-cols-2 gap-4"},bl={class:"w-full"},yl={for:"cupo_min",class:"flex items-center gap-1 mb-2"},xl={key:0,class:"text-gray-500 text-xs"},_l={key:0,class:"text-red-500 block text-xs mt-1"},wl={key:1,class:"text-red-500 block text-xs mt-1"},Cl={class:"w-full"},Dl={for:"cupo_max",class:"flex items-center gap-1 mb-2"},Sl={key:0,class:"text-gray-500 text-xs"},kl={key:0,class:"text-red-500 block text-xs mt-1"},Il={key:1,class:"text-red-500 block text-xs mt-1"},Tl={class:"flex gap-4"},El={class:"flex-1"},Vl={key:0,class:"text-red-500 block text-xs mt-1"},Fl={class:"flex-1"},Al={key:0,class:"text-red-500 block text-xs mt-1"},Pl={class:"w-full flex flex-col"},Nl={class:"flex items-center gap-10 sm:gap-9"},Ll={class:"w-full relative"},$l={key:0,class:"text-red-500 ml-28"},Ml={class:"w-full flex flex-col"},Ul={class:"flex items-center gap-5"},Rl={key:0,class:"text-red-500 ml-28"},Ol={class:"w-full flex flex-col"},ql={class:"flex items-center gap-4"},jl={class:"flex-1"},zl={class:"flex items-center gap-3 mb-2"},Bl=["disabled"],Hl={class:"flex items-center gap-2"},Gl={key:0,class:"text-red-500 ml-28"},Wl={class:"grid grid-cols-3 ml-2 sm:ml-5 gap-y-2"},Kl=["src"],Zl=["onClick"],Jl={class:"flex justify-center gap-4 w-full mt-6"},Ql=["disabled"],Yl={key:0},Xl={key:1},es=["disabled"],pe="/api/tours",Me="/storage/tours/",is={__name:"Tours",setup(as){const v=Xa(),E=u([]),T=u([]),j=u(""),z=u(""),Se=u([]),a=u({id:null,nombre:"",categoria:null,incluye:"",no_incluye:"",cupo_min:null,cupo_max:null,punto_salida:"",fecha_salida:null,fecha_regreso:null,estado:"DISPONIBLE",precio:null,transporte_id:null,imagenes:[]}),x=u([]),oe=u([]),ne=u([]),Ue=u(null),L=u(!1),re=u(!1),$=u(!1),ie=u(!1),b=u(!1),B=u(!1),M=u(null),H=u(!1),ke=u(!1),G=u(!1),U=u(!1),R=u(!1),Z=u(!1),fe=u(!0),_=u({global:{value:null,matchMode:ve.CONTAINS},categoria:{value:null,matchMode:ve.EQUALS},"transporte.nombre":{value:null,matchMode:ve.EQUALS},estado:{value:null,matchMode:ve.EQUALS},fecha_salida:{value:null,matchMode:ve.DATE_IS}}),J=u(""),W=u(""),Q=u(""),D=u(null),S=u(null),Ie=u(10),ra=u([5,10,20,50]),ue=u("Guardar"),g=u(null),A=u([]),Re=u([{label:"Nacional",value:"NACIONAL"},{label:"Internacional",value:"INTERNACIONAL"}]),Oe=u([{label:"Disponible",value:"DISPONIBLE"},{label:"Completo",value:"COMPLETO"},{label:"En Curso",value:"EN_CURSO"},{label:"Finalizado",value:"FINALIZADO"},{label:"Cancelada",value:"CANCELADA"},{label:"Reprogramada",value:"REPROGRAMADA"}]),ge=u(!1),Te=u(!1),O=u(null),Ee=u([]),Ve=u(0),qe=u(null),Fe=q(()=>{let t=Se.value;if(_.value.global.value){const e=_.value.global.value.toLowerCase();t=t.filter(o=>o.nombre.toLowerCase().includes(e)||o.incluye&&o.incluye.toLowerCase().includes(e)||o.no_incluye&&o.no_incluye.toLowerCase().includes(e)||o.punto_salida.toLowerCase().includes(e))}return _.value.categoria.value&&(t=t.filter(e=>e.categoria===_.value.categoria.value)),_.value["transporte.nombre"].value&&(t=t.filter(e=>e["transporte.nombre"]===_.value["transporte.nombre"].value)),_.value.estado.value&&(t=t.filter(e=>e.estado===_.value.estado.value)),(D.value||S.value)&&(t=t.filter(e=>{if(!e.fecha_salida)return!1;const o=new Date(e.fecha_salida);let n=!0;if(D.value){const r=new Date(D.value);n=n&&o>=r}if(S.value){const r=new Date(S.value);r.setHours(23,59,59,999),n=n&&o<=r}return n})),t}),je=q(()=>x.value.length<5),ia=q(()=>G.value?"Cargando...":U.value?"Abriendo...":je.value?"Seleccionar":"Límite alcanzado"),Y=q(()=>{if(!a.value.cupo_min)return"";const t=parseInt(a.value.cupo_min)||0,e=parseInt(a.value.cupo_max)||0;if(t<=0)return"El cupo mínimo debe ser al menos 1.";const o=A.value.find(r=>r.id===a.value.transporte_id),n=o?o.capacidad:null;return n&&t>n?`El cupo mínimo no puede ser mayor que la capacidad del transporte (${n}).`:a.value.cupo_max&&e>0&&t>=e?"El cupo mínimo debe ser menor que el cupo máximo.":""}),X=q(()=>{if(!a.value.cupo_max)return"";const t=parseInt(a.value.cupo_min)||0,e=parseInt(a.value.cupo_max)||0;if(e<=0)return"El cupo máximo debe ser al menos 1.";const o=A.value.find(r=>r.id===a.value.transporte_id),n=o?o.capacidad:null;return n&&e>n?`El cupo máximo no puede ser mayor que la capacidad del transporte (${n}).`:a.value.cupo_min&&t>0&&e<=t?"El cupo máximo debe ser mayor que el cupo mínimo.":""}),K=q(()=>{const t=A.value.find(e=>e.id===a.value.transporte_id);return t?t.capacidad:30});Pe([a,g,E,T,x,ne],()=>{M.value&&L.value&&Ce(()=>{const t={...a.value,fecha_regreso:g.value,incluye_lista:[...E.value],no_incluye_lista:[...T.value],imagenes_actuales:[...x.value]},e=JSON.stringify(t)!==JSON.stringify({...M.value,imagenes_actuales:M.value.imagenes_originales})||ne.value.length>0,o=!M.value.id,n=a.value.nombre||a.value.punto_salida||a.value.fecha_salida||g.value||a.value.precio||a.value.categoria||a.value.transporte_id||E.value.length>0||T.value.length>0||x.value.length>0;B.value=e||o&&n})},{deep:!0,flush:"post"}),Pe(()=>a.value.transporte_id,(t,e)=>{if(t&&t!==e&&L.value){const o=A.value.find(n=>n.id===t);if(o){const n=o.capacidad;a.value.cupo_min&&a.value.cupo_min>n&&(a.value.cupo_min=n),a.value.cupo_max&&a.value.cupo_max>n&&(a.value.cupo_max=n)}}});function he(){a.value={id:null,nombre:"",categoria:null,incluye:"",no_incluye:"",cupo_min:null,cupo_max:null,punto_salida:"",fecha_salida:null,fecha_regreso:null,estado:"DISPONIBLE",precio:null,transporte_id:null,imagenes:[]},x.value=[],oe.value=[],ne.value=[],g.value=null,b.value=!1,E.value=[],T.value=[],j.value="",z.value=""}const ze=()=>{j.value.trim()&&(E.value.push(j.value.trim()),j.value="")},ua=t=>{E.value.splice(t,1)},Be=()=>{z.value.trim()&&(T.value.push(z.value.trim()),z.value="")},da=t=>{T.value.splice(t,1)},He=t=>t?t.split("|").filter(e=>e.trim()).map(e=>e.trim()):[],Ge=t=>t.join("|"),de=()=>{Ce(()=>{setTimeout(()=>{document.querySelectorAll(".p-select").forEach(e=>{const o=e.querySelector(".p-select-label, .p-placeholder");o&&(o.style.overflow="hidden",o.style.textOverflow="ellipsis",o.style.whiteSpace="nowrap",o.style.maxWidth="calc(100% - 2.5rem)",o.style.display="block")})},100)})};Ga(()=>{ca(),ma(),de(),typeof window<"u"&&window.addEventListener("resize",We)});const We=()=>{Ae.value=window.innerWidth};Wa(()=>{typeof window<"u"&&window.removeEventListener("resize",We)});const Ke=async()=>{fe.value=!0;try{const t=await N.get(pe);Se.value=t.data.map(e=>{var o,n,r;return{...e,imagenes:(e.imagenes||[]).map(i=>typeof i=="string"?i:i.nombre),transporte_nombre:((o=e.transporte)==null?void 0:o.nombre)||"",transporte_capacidad:((n=e.transporte)==null?void 0:n.capacidad)||"","transporte.nombre":(r=e.transporte)==null?void 0:r.nombre}}).sort((e,o)=>{const n=new Date(e.created_at);return new Date(o.created_at)-n})}catch{v.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los tours.",life:4e3})}finally{fe.value=!1}},ca=async()=>{fe.value=!0,v.add({severity:"info",summary:"Cargando tours...",life:2e3});try{const t=await N.get(pe);Se.value=t.data.map(e=>{var o,n,r;return{...e,imagenes:(e.imagenes||[]).map(i=>typeof i=="string"?i:i.nombre),transporte_nombre:((o=e.transporte)==null?void 0:o.nombre)||"",transporte_capacidad:((n=e.transporte)==null?void 0:n.capacidad)||"","transporte.nombre":(r=e.transporte)==null?void 0:r.nombre}}).sort((e,o)=>{const n=new Date(e.created_at);return new Date(o.created_at)-n}),v.add({severity:"success",summary:"Tours cargados",life:2e3})}catch{v.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los tours.",life:4e3})}finally{fe.value=!1}},ma=async()=>{try{const t=await N.get("/api/transportes");A.value=t.data||[]}catch{A.value=[],v.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los transportes.",life:4e3})}},va=()=>{_.value.categoria.value=J.value===""?null:J.value,de()},pa=()=>{if(W.value&&W.value!==""){const t=A.value.find(e=>e.id===W.value);_.value["transporte.nombre"].value=t?t.nombre:null}else _.value["transporte.nombre"].value=null;de()},fa=()=>{_.value.estado.value=Q.value===""?null:Q.value,de()},be=()=>{if(D.value&&S.value){const t=new Date(D.value),e=new Date(S.value);t>e&&(S.value=null,v.add({severity:"warn",summary:"Fecha ajustada",detail:"La fecha 'hasta' se limpió porque era anterior a la fecha 'desde'.",life:5e3}))}},ye=()=>{if(D.value&&S.value){const t=new Date(D.value);new Date(S.value)<t&&(D.value=null,v.add({severity:"warn",summary:"Fecha ajustada",detail:"La fecha 'desde' se limpió porque era posterior a la fecha 'hasta'.",life:5e3}))}};Pe([J,W,Q],()=>{de()},{deep:!0});const Ze=async()=>{R.value=!0;try{await new Promise(t=>setTimeout(t,300)),J.value="",W.value="",Q.value="",D.value=null,S.value=null,_.value.global.value=null,_.value.categoria.value=null,_.value["transporte.nombre"].value=null,_.value.estado.value=null,_.value.fecha_salida.value=null,v.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{R.value=!1}},ga=()=>{Z.value=!0},ha=()=>{he(),ue.value="Guardar",b.value=!1,L.value=!0,Ce(()=>{M.value={...a.value,fecha_regreso:g.value,incluye_lista:[...E.value],no_incluye_lista:[...T.value],imagenes_originales:[...x.value]},B.value=!1})},ba=async t=>{var e;try{const o=await N.get(`/api/tours/${t.id}/verificar-reservas`);if(o.data.success&&o.data.tiene_reservas){v.add({severity:"warn",summary:"No se puede editar",detail:`No puedes editar el tour "${o.data.tour_nombre}" porque tiene ${o.data.cantidad_reservas} reserva(s) asociada(s).`,life:5e3});return}}catch(o){console.error("Error verificando reservas:",o),v.add({severity:"error",summary:"Error",detail:"Error al verificar las reservas del tour",life:3e3});return}he(),b.value=!1,a.value={...t,transporte_id:((e=t.transporte)==null?void 0:e.id)||t.transporte_id||null},t.fecha_salida&&(typeof t.fecha_salida=="string"?a.value.fecha_salida=new Date(t.fecha_salida):a.value.fecha_salida=t.fecha_salida),t.fecha_regreso&&(typeof t.fecha_regreso=="string"?g.value=new Date(t.fecha_regreso):g.value=t.fecha_regreso),x.value=(t.imagenes||[]).map(o=>typeof o=="string"?o:o.nombre),E.value=He(t.incluye),T.value=He(t.no_incluye),B.value=!1,ue.value="Actualizar",L.value=!0,Ce(()=>{M.value={...a.value,fecha_regreso:g.value,incluye_lista:[...E.value],no_incluye_lista:[...T.value],imagenes_originales:[...x.value]},B.value=!1})},ya=async()=>{if(!a.value.fecha_salida||!g.value)return!0;try{const t=r=>{if(!r)return null;let i;return r instanceof Date?i=r:typeof r=="string"&&(r.includes("T")&&r.includes("Z")?i=new Date(r):i=new Date(r)),i.getFullYear()+"-"+String(i.getMonth()+1).padStart(2,"0")+"-"+String(i.getDate()).padStart(2,"0")+" "+String(i.getHours()).padStart(2,"0")+":"+String(i.getMinutes()).padStart(2,"0")+":"+String(i.getSeconds()).padStart(2,"0")},e=t(a.value.fecha_salida),o=t(g.value),n=await N.post("/api/tours/validar-fechas",{fecha_salida:e,fecha_regreso:o,tour_id:a.value.id});if(!n.data.success&&n.data.tiene_conflictos){const r=n.data.conflictos;let i=`Las fechas seleccionadas se superponen con ${r.length} tour(s) existente(s):

`;return r.forEach((w,C)=>{i+=`${C+1}. ${w.nombre}
`,i+=`   Fechas: ${w.fecha_salida} al ${w.fecha_regreso}

`}),i+="Por favor selecciona fechas que no se superpongan con tours existentes.",v.add({severity:"error",summary:"Conflicto de fechas",detail:i,life:8e3}),!1}return!0}catch(t){return console.error("Error al validar fechas:",t),v.add({severity:"error",summary:"Error de validación",detail:"No se pudieron validar las fechas. Inténtalo nuevamente.",life:4e3}),!1}},xa=async()=>{if(b.value=!0,!g.value){v.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos.",life:4e3});return}if(!a.value.nombre||a.value.nombre.length<10||a.value.nombre.length>200){v.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos y cumplan los requisitos.",life:4e3});return}if(!a.value.punto_salida||a.value.punto_salida.length<5||a.value.punto_salida.length>200){v.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos y cumplan los requisitos.",life:4e3});return}if(Y.value){v.add({severity:"warn",summary:"Error en cupo mínimo",detail:Y.value,life:4e3});return}if(X.value){v.add({severity:"warn",summary:"Error en cupo máximo",detail:X.value,life:4e3});return}if(a.value.cupo_min&&a.value.cupo_max&&a.value.cupo_min>=a.value.cupo_max){v.add({severity:"warn",summary:"Verificar datos",detail:"Por favor revisa los valores ingresados y corrige cualquier inconsistencia.",life:4e3});return}if(!_e()){v.add({severity:"warn",summary:"Verificar fechas",detail:"Por favor revisa las fechas ingresadas y asegúrate de que sean correctas.",life:4e3});return}if(!we()){v.add({severity:"warn",summary:"Verificar fechas",detail:"Por favor revisa las fechas ingresadas y asegúrate de que sean correctas.",life:4e3});return}if(!await ya())return;if(!a.value.fecha_salida||!a.value.precio||!a.value.categoria||!a.value.transporte_id||!a.value.cupo_min||!a.value.cupo_max||x.value.length===0){v.add({severity:"warn",summary:"Campos requeridos",detail:"Por favor verifica que todos los campos obligatorios estén completos.",life:4e3});return}if(x.value.length>5){v.add({severity:"warn",summary:"Demasiadas imágenes",detail:"No puedes subir más de 5 imágenes por tour.",life:4e3});return}const e=2*1024*1024;if(oe.value.filter(n=>n.size>e).length>0){v.add({severity:"warn",summary:"Verificar archivos",detail:"Por favor revisa el tamaño de las imágenes seleccionadas.",life:4e3});return}H.value=!0;try{const n=new FormData;if(n.append("nombre",a.value.nombre||""),E.value.length>0?n.append("incluye",Ge(E.value)):n.append("incluye",""),n.append("punto_salida",a.value.punto_salida||""),a.value.fecha_salida instanceof Date){const i=a.value.fecha_salida,w=i.getFullYear(),C=String(i.getMonth()+1).padStart(2,"0"),s=String(i.getDate()).padStart(2,"0"),h=String(i.getHours()).padStart(2,"0"),P=String(i.getMinutes()).padStart(2,"0"),ce=String(i.getSeconds()).padStart(2,"0");n.append("fecha_salida",`${w}-${C}-${s} ${h}:${P}:${ce}`)}else a.value.fecha_salida&&n.append("fecha_salida",a.value.fecha_salida);if(g.value instanceof Date){const i=g.value,w=i.getFullYear(),C=String(i.getMonth()+1).padStart(2,"0"),s=String(i.getDate()).padStart(2,"0"),h=String(i.getHours()).padStart(2,"0"),P=String(i.getMinutes()).padStart(2,"0"),ce=String(i.getSeconds()).padStart(2,"0");n.append("fecha_regreso",`${w}-${C}-${s} ${h}:${P}:${ce}`)}else g.value&&n.append("fecha_regreso",g.value);n.append("precio",a.value.precio||""),n.append("categoria",a.value.categoria||""),n.append("transporte_id",a.value.transporte_id||""),T.value.length>0?n.append("no_incluye",Ge(T.value)):n.append("no_incluye",""),a.value.cupo_min&&n.append("cupo_min",a.value.cupo_min),a.value.cupo_max&&n.append("cupo_max",a.value.cupo_max),oe.value.forEach(i=>n.append("imagenes[]",i)),ne.value.forEach(i=>{const w=i.includes("/")?i.split("/").pop():i;n.append("removed_images[]",w)});let r;a.value.id?(n.append("_method","PUT"),r=await N.post(`${pe}/${a.value.id}`,n,{headers:{"Content-Type":"multipart/form-data"}}),v.add({severity:"success",summary:"¡Éxito!",detail:"El tour ha sido actualizado correctamente.",life:5e3})):(r=await N.post(pe,n,{headers:{"Content-Type":"multipart/form-data"}}),v.add({severity:"success",summary:"¡Éxito!",detail:"El tour ha sido creado correctamente.",life:5e3})),await Ke(),L.value=!1,B.value=!1,M.value=null,he()}catch{v.add({severity:"warn",summary:"Error de validación",detail:"Por favor revisa los campos e intenta nuevamente.",life:6e3})}finally{H.value=!1}},xe=u(null),_a=async t=>{a.value={...t};try{const e=await N.get(`/api/tours/${t.id}/informacion-eliminacion`);e.data.success?xe.value=e.data:xe.value=null}catch(e){console.error("Error obteniendo información de eliminación:",e),xe.value=null}re.value=!0},wa=async()=>{ke.value=!0;try{await N.delete(`${pe}/${a.value.id}`),await Ke(),re.value=!1,v.add({severity:"success",summary:"¡Eliminado!",detail:"El tour ha sido eliminado correctamente.",life:5e3})}catch{v.add({severity:"error",summary:"Error",detail:"No se pudo eliminar el tour. Inténtalo de nuevo.",life:5e3})}finally{ke.value=!1}},Ca=()=>{B.value?ie.value=!0:Je()},Je=()=>{L.value=!1,ie.value=!1,B.value=!1,M.value=null,he()},Da=()=>{ie.value=!1},Sa=async()=>{U.value=!0,await new Promise(t=>setTimeout(t,300)),qe.value.click(),setTimeout(()=>{G.value||(U.value=!1)},1e3)},ka=async t=>{const e=t.target?t.target.files:t.files,o=2*1024*1024,n=5;if(U.value=!1,!e||e.length===0)return;const r=x.value.length,i=e.length;if(r+i>n){const C=n-r;v.add({severity:"warn",summary:"Límite de imágenes excedido",detail:`Solo puedes subir un máximo de ${n} imágenes por tour. Actualmente tienes ${r} imagen${r!==1?"es":""}, puedes agregar máximo ${C} más.`,life:6e3});return}G.value=!0;try{const C=[];let s=0;for(const h of e)if(h instanceof File){if(h.size>o){v.add({severity:"warn",summary:"Archivo muy grande",detail:`El archivo "${h.name}" excede el tamaño máximo de 2MB.`,life:5e3});continue}if(!h.type.startsWith("image/")){v.add({severity:"warn",summary:"Formato no válido",detail:`El archivo "${h.name}" no es una imagen válida.`,life:4e3});continue}oe.value.push(h),s++;const P=new Promise(ce=>{const sa=new FileReader;sa.onload=Ha=>{x.value.push(Ha.target.result),ce()},sa.readAsDataURL(h)});C.push(P)}await Promise.all(C),s>0&&v.add({severity:"success",summary:"Imágenes cargadas",detail:`${s} imagen${s>1?"es":""} cargada${s>1?"s":""} correctamente. Total: ${x.value.length}/${n}`,life:4e3})}catch{v.add({severity:"error",summary:"Error al cargar imágenes",detail:"Hubo un problema al procesar las imágenes. Inténtalo de nuevo.",life:4e3})}finally{G.value=!1,U.value=!1,t.target&&(t.target.value="")}},Ia=t=>{const e=x.value[t];typeof e=="string"&&e.startsWith("data:image")?(x.value.splice(t,1),oe.value.splice(t,1)):(ne.value.push(e),x.value.splice(t,1))},Ta=t=>{if(O.value&&O.value.imagenes&&O.value.imagenes.length>0){Ee.value=O.value.imagenes.map(o=>{const n=typeof o=="string"?o:o.nombre;return Me+n});const e=Math.max(0,Math.min(t,Ee.value.length-1));Ve.value=e,setTimeout(()=>{Te.value=!0},50)}else v.add({severity:"warn",summary:"Sin imágenes",detail:"No hay imágenes disponibles para mostrar.",life:5e3})},Qe=()=>{a.value.nombre&&(a.value.nombre=a.value.nombre.toUpperCase(),a.value.nombre=a.value.nombre.replace(/[^A-ZÁÉÍÓÚÑ0-9\s]/g,""),a.value.nombre=a.value.nombre.replace(/\s+/g," "),a.value.nombre.length>200&&(a.value.nombre=a.value.nombre.substring(0,200)),a.value.nombre=a.value.nombre.trim())},Ea=t=>{/[a-zA-ZáéíóúñÁÉÍÓÚÑ0-9\s]/.test(t.key)||t.preventDefault()},Va=t=>{t.preventDefault();const e=(t.clipboardData||window.clipboardData).getData("text");if(e){let o=e.toUpperCase();o=o.replace(/[^A-ZÁÉÍÓÚÑ0-9\s]/g,""),o=o.replace(/\s+/g," "),o=o.trim(),o.length>200&&(o=o.substring(0,200)),a.value.nombre=o,Qe()}},Fa=t=>{t.preventDefault();const e=(t.clipboardData||window.clipboardData).getData("text");if(e){let o=e.toUpperCase();o=o.replace(/\s+/g," "),o=o.trim(),o.length>200&&(o=o.substring(0,200)),a.value.punto_salida=o,Ye()}},Ye=()=>{a.value.punto_salida&&(a.value.punto_salida=a.value.punto_salida.toUpperCase(),a.value.punto_salida=a.value.punto_salida.replace(/\s+/g," "),a.value.punto_salida.length>200&&(a.value.punto_salida=a.value.punto_salida.substring(0,200)),a.value.punto_salida=a.value.punto_salida.trim())},Xe=()=>{const t=A.value.find(r=>r.id===a.value.transporte_id),e=t?t.capacidad:null,o=parseInt(a.value.cupo_min)||0,n=parseInt(a.value.cupo_max)||0;return a.value.cupo_min&&o<1||a.value.cupo_max&&n<1||e&&(a.value.cupo_min&&o>e||a.value.cupo_max&&n>e)?!1:a.value.cupo_min&&!a.value.cupo_max||a.value.cupo_max&&!a.value.cupo_min?!0:!(a.value.cupo_min&&a.value.cupo_max&&o>=n)},_e=()=>{if(!a.value.fecha_salida)return!0;const t=new Date,e=new Date(a.value.fecha_salida),o=new Date(t.getTime()+60*60*1e3);return!(e<o||g.value&&(new Date(g.value)-e)/(1e3*60*60)<1)},we=()=>{if(!g.value)return!0;const t=new Date(g.value);if(a.value.fecha_salida){const e=new Date(a.value.fecha_salida);if((t-e)/(1e3*60*60)<1)return!1}return!0},ea=()=>{const t=new Date;return t.setHours(t.getHours()+1),t},Aa=()=>{if(!a.value.fecha_salida)return ea();const t=new Date(a.value.fecha_salida);return t.setHours(t.getHours()+1),t},Pa=()=>{if(!g.value)return null;const t=new Date(g.value);return t.setHours(t.getHours()-1),t},Ae=u(typeof window<"u"?window.innerWidth:1024),aa=q(()=>Ae.value<640?{width:"95vw",maxWidth:"380px"}:Ae.value<768?{width:"400px"}:{width:"450px"}),Na=t=>{O.value=t,$.value=!0},La=t=>{v.add({severity:"info",summary:"Duplicar Tour",detail:`Funcionalidad de duplicar tour "${t.nombre}" en desarrollo.`,life:5e3}),$.value=!1},$a=t=>{$.value=!1},Ma=t=>{v.add({severity:"info",summary:"Generar Reporte",detail:`Funcionalidad de generar reporte del tour "${t.nombre}" en desarrollo.`,life:5e3}),$.value=!1},Ua=t=>{v.add({severity:"info",summary:"Archivar Tour",detail:`Funcionalidad de archivar tour "${t.nombre}" en desarrollo.`,life:5e3}),$.value=!1},Ra=t=>{Qa.visit(`/catalogos/reservas?tour=${t.id}`)},Oa=t=>{$.value=!1,O.value=t,ge.value=!0},qa=t=>{t.originalEvent.target.closest("button")||(O.value=t.data,ge.value=!0)},ta=t=>{const e=t.target.value,o=t.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(t.keyCode)||t.ctrlKey&&[65,67,86,88].includes(t.keyCode))return;if(!/[0-9]/.test(o)){t.preventDefault();return}const n=e+o,r=parseInt(n),i=K.value;if(n==="0"||e===""&&o==="0"){t.preventDefault();return}if(n.length>3||r>i||r<1){t.preventDefault();return}},la=t=>{t.preventDefault();const o=(t.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");if(o){let n=parseInt(o);const r=K.value;n<1?n=1:n>r&&(n=r),t.target.id.includes("cupo_min")?a.value.cupo_min=n:t.target.id.includes("cupo_max")&&(a.value.cupo_max=n)}},ja=q(()=>a.cupo_max?Math.max(1,a.cupo_max-1):1),za=t=>{const e=t.target.value,o=t.key;if([8,9,27,13,46,35,36,37,38,39,40].includes(t.keyCode)||t.ctrlKey&&[65,67,86,88].includes(t.keyCode))return;if(!/[0-9.]/.test(o)){t.preventDefault();return}if(o==="."&&e.includes(".")){t.preventDefault();return}if(o!=="."){const i=e.split(".");if(i[0].length>=4&&!e.includes(".")){t.preventDefault();return}if(i.length>1&&i[1].length>=2){t.preventDefault();return}}const n=e+o;if(parseFloat(n)>9999.99){t.preventDefault();return}},Ba=t=>{t.preventDefault();let o=(t.clipboardData||window.clipboardData).getData("text").replace(/[^\d.]/g,"");if(!o||o===".")return;if((o.match(/\./g)||[]).length>1){const C=o.indexOf(".");o=o.substring(0,C+1)+o.substring(C+1).replace(/\./g,"")}const r=parseFloat(o);if(isNaN(r))return;const w=Math.min(r,9999.99).toFixed(2);a.precio=w,t.target.value=w};return(t,e)=>{const o=ee("Toast"),n=ee("InputText"),r=ee("Column"),i=ee("DataTable"),w=ee("Select"),C=ee("Dialog");return c(),Ne(Ya,null,{default:V(()=>[m(d(Ka),{title:"Tours"}),m(o,{class:"z-[9999]"}),l("div",rt,[e[59]||(e[59]=l("div",{class:"mb-6"},[l("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Catálogo de Tours"),l("p",{class:"text-gray-600"},"Gestión completa de paquetes turísticos")],-1)),l("div",it,[l("div",ut,[l("div",dt,[e[30]||(e[30]=l("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold text-center sm:text-start"},"Lista de Tours",-1)),l("p",ct,[m(d(I),{icon:d(et),class:"h-4 w-4 text-yellow-500"},null,8,["icon"]),e[29]||(e[29]=F(" Haz clic en cualquier fila para ver los detalles. "))])]),l("div",mt,[m(d(Za),{href:t.route("transportes"),onClick:ga,class:k([{"opacity-50 cursor-not-allowed":Z.value},"bg-blue-500 border border-blue-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300 flex items-center gap-2"])},{default:V(()=>[m(d(I),{icon:Z.value?d(se):d(at),class:k({"animate-spin":Z.value,"h-4":!0})},null,8,["icon","class"]),l("span",vt,f(Z.value?"Cargando...":"Transportes"),1),l("span",pt,f(Z.value?"Cargando...":"Transportes"),1)]),_:1},8,["href","class"]),l("button",{class:"bg-red-500 flex border border-red-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:ha},[m(d(I),{icon:d(De),class:"h-4 w-4 mr-1 text-white"},null,8,["icon"]),e[31]||(e[31]=l("span",null,"Agregar",-1))])])]),m(i,{value:Fe.value,selection:Ue.value,"onUpdate:selection":e[8]||(e[8]=s=>Ue.value=s),dataKey:"id",paginator:!0,rows:Ie.value,rowsPerPageOptions:ra.value,rowsPerPage:Ie.value,"onUpdate:rowsPerPage":e[9]||(e[9]=s=>Ie.value=s),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} tours",class:"overflow-x-auto max-w-full px-auto",onRowClick:qa,responsiveLayout:"scroll",pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:V(()=>[l("div",ft,[l("div",gt,[l("div",ht,[e[32]||(e[32]=l("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[l("i",{class:"pi pi-filter text-blue-600 text-sm"}),l("span",null,"Filtros")],-1)),l("div",bt,f(Fe.value.length)+" resultado"+f(Fe.value.length!==1?"s":""),1),l("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:Ze,disabled:R.value},[R.value?(c(),Ne(d(I),{key:0,icon:d(se),class:"animate-spin h-3 w-3"},null,8,["icon"])):y("",!0),l("span",null,f(R.value?"Limp...":"Limpiar"),1)],8,yt)]),l("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:Ze,disabled:R.value},[R.value?(c(),Ne(d(I),{key:0,icon:d(se),class:"animate-spin h-3 w-3"},null,8,["icon"])):y("",!0),l("span",null,f(R.value?"Limpiando...":"Limpiar filtros"),1)],8,xt)]),l("div",_t,[l("div",null,[m(n,{modelValue:_.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=s=>_.value.global.value=s),placeholder:"?? Buscar tours...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),l("div",wt,[l("div",null,[me(l("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>J.value=s),onChange:va,class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[33]||(e[33]=l("option",{value:"",disabled:"",selected:"",hidden:""},"Categoría",-1)),(c(!0),p(ae,null,te(Re.value,s=>(c(),p("option",{key:s.value,value:s.value,class:"truncate text-gray-900 text-lg"},f(s.label),9,Ct))),128))],544),[[Le,J.value]])]),l("div",null,[me(l("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>W.value=s),onChange:pa,class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[34]||(e[34]=l("option",{value:"",disabled:"",selected:"",hidden:""},"Transporte",-1)),(c(!0),p(ae,null,te(A.value,s=>(c(),p("option",{key:s.id,value:s.id,class:"truncate text-gray-900 text-lg"},f(s.nombre),9,Dt))),128))],544),[[Le,W.value]])]),l("div",St,[me(l("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>Q.value=s),onChange:fa,class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[35]||(e[35]=l("option",{value:"",disabled:"",selected:"",hidden:""},"Estado",-1)),(c(!0),p(ae,null,te(Oe.value,s=>(c(),p("option",{key:s.value,value:s.value,class:"truncate text-gray-900 text-lg"},f(s.label),9,kt))),128))],544),[[Le,Q.value]])]),l("div",It,[m(d(le),{modelValue:D.value,"onUpdate:modelValue":e[4]||(e[4]=s=>D.value=s),placeholder:"Fecha desde",class:"w-full h-9 text-sm rounded-md border border-blue-300",onDateSelect:be,onClear:be,showIcon:!0,dateFormat:"dd/mm/yy",maxDate:S.value},null,8,["modelValue","maxDate"])]),l("div",Tt,[m(d(le),{modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=s=>S.value=s),placeholder:"Fecha hasta",class:"w-full h-9 text-sm rounded-md border border-blue-300",onDateSelect:ye,onClear:ye,showIcon:!0,dateFormat:"dd/mm/yy",minDate:D.value},null,8,["modelValue","minDate"])]),l("div",Et,[m(d(le),{modelValue:D.value,"onUpdate:modelValue":e[6]||(e[6]=s=>D.value=s),placeholder:"Fecha desde",class:"h-9 text-sm rounded-md",onDateSelect:be,onClear:be,showIcon:!0,dateFormat:"dd/mm/yy",maxDate:S.value},null,8,["modelValue","maxDate"]),m(d(le),{modelValue:S.value,"onUpdate:modelValue":e[7]||(e[7]=s=>S.value=s),placeholder:"Fecha hasta",class:"h-9 text-sm rounded-md",onDateSelect:ye,onClear:ye,showIcon:!0,dateFormat:"dd/mm/yy",minDate:D.value},null,8,["modelValue","minDate"])])])])])]),default:V(()=>[m(r,{field:"nombre",header:"Nombre",sortable:"",class:"w-36 min-w-24"},{body:V(s=>[l("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"85px","text-overflow":"ellipsis","white-space":"nowrap"},title:s.data.nombre},f(s.data.nombre),9,Vt)]),_:1}),m(r,{field:"punto_salida",header:"Punto salida",class:"w-32 min-w-32 hidden md:table-cell"},{body:V(s=>[l("div",{class:"text-sm leading-relaxed overflow-hidden",style:{"max-width":"128px","text-overflow":"ellipsis","white-space":"nowrap"},title:s.data.punto_salida},f(s.data.punto_salida),9,Ft)]),_:1}),m(r,{field:"fecha_salida",header:"Fecha salida",class:"w-36 min-w-36 hidden md:table-cell"},{body:V(s=>[l("div",At,f(s.data.fecha_salida?new Date(s.data.fecha_salida).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):""),1)]),_:1}),m(r,{field:"precio",header:"Precio",class:"w-24 min-w-18"},{body:V(s=>[l("div",Pt,f(isNaN(Number(s.data.precio))?"":`$${Number(s.data.precio).toFixed(2)}`),1)]),_:1}),m(r,{field:"estado",header:"Estado",class:"w-32 min-w-24 hidden lg:table-cell"},{body:V(s=>{var h;return[l("span",{class:k([{"bg-green-100 text-green-800":s.data.estado==="DISPONIBLE","bg-red-100 text-red-800":s.data.estado==="COMPLETO"||s.data.estado==="CANCELADA","bg-blue-100 text-blue-800":s.data.estado==="EN_CURSO","bg-gray-100 text-gray-800":s.data.estado==="FINALIZADO","bg-purple-100 text-purple-800":s.data.estado==="REPROGRAMADA"},"px-2 py-1 rounded-full text-xs font-medium"])},f(((h=Oe.value.find(P=>P.value===s.data.estado))==null?void 0:h.label)||s.data.estado),3)]}),_:1}),m(r,{exportable:!1,class:"w-52 min-w-36"},{header:V(()=>e[36]||(e[36]=[l("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:V(s=>[l("div",Nt,[l("button",{class:"flex bg-green-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:h=>Na(s.data),title:"Más acciones"},[m(d(I),{icon:d(tt),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[37]||(e[37]=l("span",{class:"hidden md:block text-white"},"Más",-1))],8,Lt),l("button",{class:"flex bg-blue-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:h=>ba(s.data)},[m(d(I),{icon:d(lt),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[38]||(e[38]=l("span",{class:"hidden md:block text-white"},"Editar",-1))],8,$t),l("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:h=>_a(s.data)},[m(d(I),{icon:d(st),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[39]||(e[39]=l("span",{class:"hidden md:block text-white"},"Eliminar",-1))],8,Mt)])]),_:1})]),_:1},8,["value","selection","rows","rowsPerPageOptions","rowsPerPage"]),m(C,{visible:L.value,"onUpdate:visible":e[21]||(e[21]=s=>L.value=s),header:ue.value+" Tour",modal:!0,style:Ja(aa.value),closable:!1,draggable:!1},{footer:V(()=>[l("div",Jl,[l("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:xa,disabled:H.value||!!Y.value||!!X.value},[m(d(I),{icon:H.value?d(se):d(ot),class:k(["h-5 text-white",{"animate-spin":H.value}])},null,8,["icon","class"]),H.value?(c(),p("span",Xl,f(ue.value==="Guardar"?"Guardando...":"Actualizando..."),1)):(c(),p("span",Yl,f(ue.value),1))],8,Ql),l("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Ca,disabled:H.value},[m(d(I),{icon:d($e),class:"h-5"},null,8,["icon"]),e[58]||(e[58]=F("Cancelar "))],8,es)])]),default:V(()=>[l("div",Ut,[l("div",Rt,[l("div",Ot,[e[40]||(e[40]=l("label",{for:"nombre",class:"flex items-center gap-1"},[F("Tour: "),l("span",{class:"text-red-500 font-bold"},"*")],-1)),m(n,{modelValue:a.value.nombre,"onUpdate:modelValue":e[10]||(e[10]=s=>a.value.nombre=s),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:200,class:k([{"p-invalid":b.value&&(!a.value.nombre||a.value.nombre.length<10||a.value.nombre.length>200)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"TOUR AL CERRO EL PITAL, ETC",onInput:Qe,onKeypress:Ea,onPaste:Va},null,8,["modelValue","class"])]),a.value.nombre&&a.value.nombre.length<10?(c(),p("small",qt," El nombre debe tener al menos 10 caracteres. Actual: "+f(a.value.nombre.length)+"/10 ",1)):y("",!0),a.value.nombre&&a.value.nombre.length>=180&&a.value.nombre.length<=200?(c(),p("small",jt," Caracteres restantes: "+f(200-a.value.nombre.length)+". ",1)):y("",!0),b.value&&!a.value.nombre?(c(),p("small",zt," El nombre es obligatorio. ")):y("",!0)]),l("div",Bt,[l("div",Ht,[e[41]||(e[41]=l("label",{for:"incluye",class:"w-12 flex items-center gap-1 mt-2"}," Incluye: ",-1)),l("div",Gt,[l("div",Wt,[me(l("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>j.value=s),type:"text",placeholder:"Agregar nuevo elemento...",class:"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",onKeyup:oa(ze,["enter"])},null,544),[[na,j.value]]),l("button",{type:"button",onClick:ze,disabled:!j.value.trim(),class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},[m(d(I),{icon:d(De),class:"h-5"},null,8,["icon"])],8,Kt)]),l("div",Zt,[(c(!0),p(ae,null,te(E.value,(s,h)=>(c(),p("div",{key:h,class:"flex items-center justify-between bg-gray-50 p-2 rounded-md border"},[l("span",Jt,f(s),1),l("button",{type:"button",onClick:P=>ua(h),class:"text-red-500 hover:text-red-700 p-1"},[m(d(I),{icon:d($e),class:"h-5"},null,8,["icon"])],8,Qt)]))),128))]),E.value.length===0?(c(),p("div",Yt," Sin elementos agregados. ")):y("",!0)])])]),l("div",Xt,[l("div",el,[e[42]||(e[42]=l("label",{for:"no_incluye",class:"w-12 flex items-center gap-1 mt-2"}," No incluye: ",-1)),l("div",al,[l("div",tl,[me(l("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>z.value=s),type:"text",placeholder:"Agregar nuevo elemento...",class:"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",onKeyup:oa(Be,["enter"])},null,544),[[na,z.value]]),l("button",{type:"button",onClick:Be,disabled:!z.value.trim(),class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},[m(d(I),{icon:d(De),class:"h-5"},null,8,["icon"])],8,ll)]),T.value.length>0?(c(),p("div",sl,[(c(!0),p(ae,null,te(T.value,(s,h)=>(c(),p("div",{key:h,class:"flex items-center justify-between bg-gray-50 p-2 rounded-md border"},[l("span",ol,f(s),1),l("button",{type:"button",onClick:P=>da(h),class:"text-red-500 hover:text-red-700 p-1"},[m(d(I),{icon:d($e),class:"h-5"},null,8,["icon"])],8,nl)]))),128))])):y("",!0),T.value.length===0?(c(),p("div",rl," Sin elementos agregados. ")):y("",!0)])])]),l("div",il,[l("div",ul,[e[43]||(e[43]=l("label",{for:"punto_salida",class:"flex w-12 items-center"},[F(" Punto salida: "),l("span",{class:"text-red-500 font-bold"}," * ")],-1)),m(n,{modelValue:a.value.punto_salida,"onUpdate:modelValue":e[13]||(e[13]=s=>a.value.punto_salida=s),modelModifiers:{trim:!0},id:"punto_salida",name:"punto_salida",maxlength:200,class:k([{"p-invalid":b.value&&(!a.value.punto_salida||a.value.punto_salida.length<5)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),placeholder:"ATRIO DE CHALATENANGO, ETC",onInput:Ye,onPaste:Fa},null,8,["modelValue","class"])]),a.value.punto_salida&&a.value.punto_salida.length<5?(c(),p("small",dl,"Debe tener al menos 5 caracteres. Actual: "+f(a.value.punto_salida.length)+"/5",1)):y("",!0),a.value.punto_salida&&a.value.punto_salida.length>=180&&a.value.punto_salida.length<=200?(c(),p("small",cl,"Caracteres restantes: "+f(200-a.value.punto_salida.length),1)):y("",!0),b.value&&!a.value.punto_salida?(c(),p("small",ml,"El punto de salida es obligatorio.")):y("",!0),b.value&&a.value.punto_salida&&a.value.punto_salida.length<5?(c(),p("small",vl,"El punto de salida debe tener al menos 5 caracteres.")):y("",!0)]),l("div",pl,[l("div",fl,[e[44]||(e[44]=l("label",{for:"transporte_id",class:"w-24 flex items-center gap-1"},[F("Transporte:"),l("span",{class:"text-red-500 font-bold"},"*")],-1)),m(w,{modelValue:a.value.transporte_id,"onUpdate:modelValue":e[14]||(e[14]=s=>a.value.transporte_id=s),options:A.value,optionLabel:"nombre",optionValue:"id",id:"transporte_id",name:"transporte_id",class:k(["w-full rounded-md border-2 border-gray-400 hover:border-gray-500",{"p-invalid":b.value&&!a.value.transporte_id}]),placeholder:"Seleccionar"},null,8,["modelValue","options","class"])]),b.value&&!a.value.transporte_id?(c(),p("small",gl,"El tipo de transporte es obligatorio.")):y("",!0)]),l("div",hl,[l("div",bl,[l("label",yl,[e[45]||(e[45]=F(" Cupo mínimo: ")),e[46]||(e[46]=l("span",{class:"text-red-500 font-bold"},"*",-1)),a.value.transporte_id?(c(),p("small",xl," (Mín: "+f(ja.value)+") ",1)):y("",!0)]),m(n,{modelValue:a.value.cupo_min,"onUpdate:modelValue":e[15]||(e[15]=s=>a.value.cupo_min=s),id:"cupo_min",name:"cupo_min",type:"number",inputmode:"numeric",min:"1",max:K.value,class:k(["w-full border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":b.value&&!a.value.cupo_min||Y.value}]),placeholder:`1-${K.value}`,onKeydown:ta,onPaste:la,onInput:Xe},null,8,["modelValue","max","class","placeholder"]),b.value&&!a.value.cupo_min?(c(),p("small",_l,"El cupo mínimo es obligatorio.")):y("",!0),Y.value?(c(),p("small",wl,f(Y.value),1)):y("",!0)]),l("div",Cl,[l("label",Dl,[e[47]||(e[47]=F(" Cupo máximo: ")),e[48]||(e[48]=l("span",{class:"text-red-500 font-bold"},"*",-1)),a.value.transporte_id?(c(),p("small",Sl,"(Máx: "+f(K.value)+")",1)):y("",!0)]),m(n,{modelValue:a.value.cupo_max,"onUpdate:modelValue":e[16]||(e[16]=s=>a.value.cupo_max=s),id:"cupo_max",name:"cupo_max",type:"number",inputmode:"numeric",min:"1",max:K.value,class:k(["w-full border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":b.value&&!a.value.cupo_max||X.value}]),placeholder:`1-${K.value}`,onKeydown:ta,onPaste:la,onInput:Xe},null,8,["modelValue","max","class","placeholder"]),b.value&&!a.value.cupo_max?(c(),p("small",kl,"El cupo máximo es obligatorio.")):y("",!0),X.value?(c(),p("small",Il,f(X.value),1)):y("",!0)])]),l("div",Tl,[l("div",El,[e[49]||(e[49]=l("label",{for:"fecha_salida",class:"flex items-center gap-1 mb-2"},[F("Fecha y hora de salida:"),l("span",{class:"text-red-500 font-bold"},"*")],-1)),m(d(le),{modelValue:a.value.fecha_salida,"onUpdate:modelValue":e[17]||(e[17]=s=>a.value.fecha_salida=s),id:"fecha_salida",name:"fecha_salida",showIcon:"",showTime:"",hourFormat:"12",dateFormat:"yy-mm-dd",minDate:ea(),maxDate:Pa(),class:k([{"p-invalid":b.value&&!a.value.fecha_salida||a.value.fecha_salida&&!_e()},"w-full border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),manualInput:!1,onDateSelect:_e,onInput:_e},null,8,["modelValue","minDate","maxDate","class"]),b.value&&!a.value.fecha_salida?(c(),p("small",Vl,"Fecha y hora de salida requerida.")):y("",!0)]),l("div",Fl,[e[50]||(e[50]=l("label",{for:"horaRegresoCalendar",class:"flex items-center gap-1 mb-2"},[F("Fecha y hora regreso:"),l("span",{class:"text-red-500 font-bold"},"*")],-1)),m(d(le),{modelValue:g.value,"onUpdate:modelValue":e[18]||(e[18]=s=>g.value=s),id:"horaRegresoCalendar",name:"horaRegresoCalendar",showIcon:"",showTime:"",hourFormat:"12",dateFormat:"yy-mm-dd",minDate:Aa(),manualInput:!1,class:k([{"p-invalid":b.value&&!g.value||g.value&&!we()},"w-full border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md"]),onDateSelect:we,onInput:we},null,8,["modelValue","minDate","class"]),b.value&&!g.value?(c(),p("small",Al,"Fecha y hora de regreso requerida.")):y("",!0)])]),l("div",Pl,[l("div",Nl,[e[52]||(e[52]=l("label",{for:"precio",class:"w-24 flex items-center gap-1"},[F("Precio:"),l("span",{class:"text-red-500 font-bold"},"*")],-1)),l("div",Ll,[e[51]||(e[51]=l("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 pointer-events-none"},"$",-1)),m(n,{modelValue:a.value.precio,"onUpdate:modelValue":e[19]||(e[19]=s=>a.value.precio=s),id:"precio",name:"precio",type:"text",inputmode:"decimal",class:k(["w-full pl-8 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md",{"p-invalid":b.value&&(!a.value.precio||a.value.precio<.01||a.value.precio>9999.99)}]),placeholder:"0.00",onKeydown:za,onPaste:Ba},null,8,["modelValue","class"])])]),b.value&&(a.value.precio==null||a.value.precio<.01||a.value.precio>9999.99)?(c(),p("small",$l,"El precio es obligatorio, debe ser mayor o igual a 0.01 y menor o igual a 9999.99.")):y("",!0)]),l("div",Ml,[l("div",Ul,[e[53]||(e[53]=l("label",{for:"categoria",class:"w-24 flex items-center gap-1"},[F("Categoría:"),l("span",{class:"text-red-500 font-bold"},"*")],-1)),m(w,{modelValue:a.value.categoria,"onUpdate:modelValue":e[20]||(e[20]=s=>a.value.categoria=s),options:Re.value,optionLabel:"label",optionValue:"value",id:"categoria",name:"categoria",class:k(["w-full rounded-md border-2 border-gray-400 hover:border-gray-500",{"p-invalid":b.value&&!a.value.categoria}]),placeholder:"Seleccionar"},null,8,["modelValue","options","class"])]),b.value&&!a.value.categoria?(c(),p("small",Rl,"La categoría es obligatoria.")):y("",!0)]),l("div",Ol,[l("div",ql,[e[56]||(e[56]=l("label",{for:"imagenes",class:"w-24 flex items-center gap-1"},[F("Imágenes:"),l("span",{class:"text-red-500 font-bold"},"*")],-1)),l("div",jl,[l("div",zl,[l("input",{type:"file",id:"imagenes",name:"imagenes[]",accept:"image/*",multiple:"",onChange:ka,class:"hidden",ref_key:"fileInput",ref:qe},null,544),l("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 outline-none focus:outline-none active:outline-none disabled:opacity-50 disabled:cursor-not-allowed",onClick:Sa,disabled:G.value||U.value||!je.value},[m(d(I),{icon:G.value?d(se):U.value?d(se):d(De),class:k({"animate-spin":G.value||U.value})},null,8,["icon","class"]),F(" "+f(ia.value),1)],8,Bl),l("div",Hl,[l("span",{class:k(["text-sm font-medium",x.value.length>=5?"text-red-600":"text-gray-600"])},f(x.value.length)+"/5 ",3),e[54]||(e[54]=l("span",{class:"text-xs text-gray-500"},"imágenes",-1))])]),e[55]||(e[55]=l("div",{class:"text-xs text-gray-500 mb-2"}," Máximo 5 imágenes por tour • Formatos: JPG, PNG, GIF • Tamaño máximo: 2MB por imagen ",-1))])]),b.value&&x.value.length===0?(c(),p("small",Gl,"Las imágenes son obligatorias (al menos una).")):y("",!0)]),l("div",Wl,[(c(!0),p(ae,null,te(x.value,(s,h)=>(c(),p("div",{key:h,class:"relative w-24 sm:w-28 h-24 sm:h-28"},[l("img",{src:s.startsWith("data:image")?s:Me+s,alt:"Vista previa",class:"w-full h-full object-cover rounded border"},null,8,Kl),l("button",{onClick:P=>Ia(h),class:"absolute top-2 right-2 bg-gray-600/80 hover:bg-gray-700/80 text-white font-bold py-1 px-2 rounded-full shadow",style:{transform:"translate(50%, -50%)"}},e[57]||(e[57]=[l("i",{class:"pi pi-times text-xs"},null,-1)]),8,Zl)]))),128))])])]),_:1},8,["visible","header","style"]),m(nt,{visible:$.value,"onUpdate:visible":e[22]||(e[22]=s=>$.value=s),"details-visible":ge.value,"onUpdate:detailsVisible":e[23]||(e[23]=s=>ge.value=s),"carousel-visible":Te.value,"onUpdate:carouselVisible":e[24]||(e[24]=s=>Te.value=s),"delete-visible":re.value,"onUpdate:deleteVisible":e[25]||(e[25]=s=>re.value=s),"unsaved-changes-visible":ie.value,"onUpdate:unsavedChangesVisible":e[26]||(e[26]=s=>ie.value=s),"carousel-index":Ve.value,"onUpdate:carouselIndex":e[27]||(e[27]=s=>Ve.value=s),tour:O.value||a.value,"dialog-style":aa.value,"selected-images":Ee.value,"image-path":Me,"is-deleting":ke.value,"tour-delete-info":xe.value,onDuplicate:La,onChangeStatus:$a,onGenerateReport:Ma,onArchive:Ua,onDeleteTour:wa,onCancelDelete:e[28]||(e[28]=()=>re.value=!1),onCloseWithoutSaving:Je,onContinueEditing:Da,onViewDetails:Oa,onViewReservations:Ra,onOpenImageModal:Ta},null,8,["visible","details-visible","carousel-visible","delete-visible","unsaved-changes-visible","carousel-index","tour","dialog-style","selected-images","is-deleting","tour-delete-info"])])])]),_:1})}}};export{is as default};
