import{r as h,o as G,a6 as U,E as g,_ as M,c as n,d as l,e as r,q as v,p as C,$ as s,I as T,j as d,v as F,a9 as W,t as u,F as V,l as z,y as L,h as R,A as Z}from"./vendor-gbh1WW5n.js";import{z as H}from"./vue-tel-input-nvsKEitw.js";import{z as $,F as I}from"./ui-BrU4k96Z.js";import{j,a as J}from"./index-CZ1H-pGg.js";const K={class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4"},Q={class:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r-lg"},X={class:"flex"},Y={class:"ml-3"},O={class:"text-xs text-blue-600 mt-2"},ee={class:"w-full flex flex-col"},oe={class:"flex items-center gap-4"},te={key:0,class:"ml-28 mt-1"},re={key:0,class:"text-red-500 block"},se={key:1,class:"text-gray-500 ml-28 mt-1"},ae={key:2,class:"text-orange-500 ml-28 mt-1"},le={class:"w-full flex flex-col"},ne={class:"flex items-start gap-4"},ie={class:"flex-1"},de={key:0,class:"ml-28 mt-1"},ue={key:0,class:"text-red-500 block"},ce={key:1,class:"ml-28 mt-1"},me={class:"flex justify-center w-full mt-6"},fe=["disabled"],ge={key:1},ve={key:2},be={__name:"FormularioDatosCompletos",props:{empleado:{type:Object,default:()=>({})},userId:{type:Number,required:!0}},emits:["close"],setup(N,{emit:S}){var E,k;const p=N,q=S,m=$(),x=h(window.innerWidth),b=()=>{x.value=window.innerWidth};G(()=>{window.addEventListener("resize",b)}),U(()=>{window.removeEventListener("resize",b)});const B=g(()=>x.value<640?{width:"95vw",maxWidth:"380px"}:x.value<768?{width:"400px"}:{width:"450px"}),e=M({cargo:((E=p.empleado)==null?void 0:E.cargo)||"PROPIETARIA",telefono:((k=p.empleado)==null?void 0:k.telefono)||"",user_id:p.userId}),a=h({isValid:!1,country:null,formattedNumber:"",mensaje:""}),y=h(!1),w=()=>{e.cargo&&(e.cargo=e.cargo.toUpperCase().replace(/[^A-Z\s]/g,"").substring(0,25))},D=o=>{try{o&&typeof o=="object"&&(a.value.isValid=o.valid===!0,a.value.country={name:o.country,code:o.countryCode},a.value.formattedNumber=o.formatted||"",a.value.international=o.international||"",o.valid===!0&&o.international&&(e.telefono=o.international),e.telefono&&o.valid===!1?a.value.mensaje="✗ Número de teléfono inválido para "+o.country:o.valid===!0?a.value.mensaje="✓ Número válido para "+o.country:a.value.mensaje="")}catch{a.value.mensaje="Error en validación"}},c=g(()=>{const o=[],t=e.cargo||"";return t.length>0&&t.length<2&&o.push("El cargo debe tener al menos 2 caracteres."),t.length>0&&/[^A-Z\s]/.test(t)&&o.push("El cargo solo puede contener letras y espacios (sin tildes ni números)."),t.length>25&&o.push("El cargo no puede exceder 25 caracteres."),o}),f=g(()=>{const o=[],t=e.telefono||"";return t.length>0&&!a.value.isValid&&o.push("El formato del teléfono no es válido."),t.length>30&&o.push("El teléfono no puede exceder 30 caracteres."),o}),_=g(()=>!(!e.errors.telefono||e.errors.telefono==="validation.required"||e.errors.telefono.includes("required")||e.errors.telefono.includes("requerido"))),P=()=>{q("close")},A=()=>{if(y.value=!0,w(),console.debug("[DEBUG] Enviando datos:",{cargo:e.cargo,telefono:e.telefono,telefonoValidation:a.value}),a.value.isValid&&a.value.international&&(e.telefono=a.value.international),c.value.length>0||f.value.length>0){console.debug("[DEBUG] Errores de validación:",{cargoErrors:c.value,telefonoErrors:f.value});return}e.post(route("empleado.completar-datos"),{preserveScroll:!0,onSuccess:()=>{m.add({severity:"success",summary:"¡Datos guardados!",detail:"Tus datos se han guardado correctamente.",life:4e3}),console.debug("[DEBUG] Guardado exitoso, cerrando modal"),P()},onError:o=>{console.debug("[DEBUG] Errores al guardar:",o),o.telefono?o.telefono.includes("required")||o.telefono==="validation.required"?m.add({severity:"warn",summary:"Campo requerido",detail:"El campo teléfono es requerido.",life:4e3}):m.add({severity:"warn",summary:"Error en teléfono",detail:o.telefono,life:4e3}):o.cargo?m.add({severity:"warn",summary:"Error en cargo",detail:o.cargo,life:4e3}):m.add({severity:"error",summary:"Error de validación",detail:"Por favor revisa los campos y completa la información requerida.",life:4e3})}})};return(o,t)=>(l(),n("div",K,[r("div",{class:"bg-white rounded-lg shadow-lg p-6",style:Z(B.value)},[t[8]||(t[8]=r("h2",{class:"text-2xl font-bold mb-4 text-blue-600"},"Completa tus datos de Administrador",-1)),r("div",Q,[r("div",X,[t[5]||(t[5]=r("div",{class:"flex-shrink-0"},[r("svg",{class:"h-5 w-5 text-blue-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[r("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})])],-1)),r("div",Y,[t[4]||(t[4]=r("p",{class:"text-sm text-blue-700"},[r("strong",null,"Información importante:"),v(" Estos datos se solicitarán solo una vez. Puedes modificar el cargo sugerido si es necesario. ")],-1)),r("p",O,[C(s(I),{icon:s(j),class:"mr-1 text-yellow-400"},null,8,["icon"]),t[2]||(t[2]=v(" Posteriormente podrás modificar toda la información en: ")),t[3]||(t[3]=r("span",{class:"font-medium"},"Mi Perfil → Editar Perfil → Información Personal",-1))])])])]),r("form",{onSubmit:T(A,["prevent"]),class:"space-y-5"},[r("div",ee,[r("div",oe,[t[6]||(t[6]=r("label",{for:"cargo",class:"w-24 flex items-center gap-1"},[v("Cargo "),r("span",{class:"text-red-500 font-bold"},"*")],-1)),F(r("input",{id:"cargo","onUpdate:modelValue":t[0]||(t[0]=i=>s(e).cargo=i),type:"text",class:"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-blue-500 focus:ring-0 focus:shadow-none rounded-md px-2 py-1",maxlength:"25",onInput:w,required:""},null,544),[[W,s(e).cargo]])]),s(e).errors.cargo||y.value&&c.value.length>0?(l(),n("div",te,[s(e).errors.cargo?(l(),n("small",re,u(s(e).errors.cargo),1)):d("",!0),(l(!0),n(V,null,z(c.value,i=>(l(),n("small",{key:i,class:"text-red-500 block"},u(i),1))),128))])):d("",!0),s(e).cargo&&s(e).cargo.length>0&&c.value.length===0?(l(),n("small",se," Caracteres: "+u(s(e).cargo.length)+"/25 ",1)):d("",!0),s(e).cargo&&s(e).cargo.length>=20&&s(e).cargo.length<=25&&c.value.length===0?(l(),n("small",ae," Caracteres restantes: "+u(25-s(e).cargo.length),1)):d("",!0)]),r("div",le,[r("div",ne,[t[7]||(t[7]=r("label",{for:"telefono",class:"w-24 flex items-center gap-1 mt-2"},[v("Teléfono "),r("span",{class:"text-red-500 font-bold"},"*")],-1)),r("div",ie,[C(s(H),{modelValue:s(e).telefono,"onUpdate:modelValue":t[1]||(t[1]=i=>s(e).telefono=i),id:"telefono",name:"telefono",defaultCountry:"SV",preferredCountries:["SV","GT","HN","CR","NI","PA","BZ"],validCharactersOnly:!0,dropdownOptions:{showDialCodeInSelection:!0,showFlags:!0,showSearchBox:!0,showDialCodeInList:!0},inputOptions:{placeholder:"Número de teléfono"},mode:"international",class:"w-full border border-gray-300 rounded-lg",onValidate:D,disabled:s(e).processing},null,8,["modelValue","disabled"])])]),_.value||y.value&&f.value.length>0?(l(),n("div",de,[_.value?(l(),n("small",ue,u(s(e).errors.telefono),1)):d("",!0),(l(!0),n(V,null,z(f.value,i=>(l(),n("small",{key:i,class:"text-red-500 block"},u(i),1))),128))])):d("",!0),a.value.mensaje?(l(),n("div",ce,[r("small",{class:L([a.value.isValid?"text-green-600":"text-red-500","block"])},u(a.value.mensaje),3)])):d("",!0)]),r("div",me,[r("button",{type:"submit",disabled:s(e).processing,class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed font-semibold"},[s(e).processing?d("",!0):(l(),R(s(I),{key:0,icon:s(J)},null,8,["icon"])),s(e).processing?(l(),n("span",ve,"Guardando...")):(l(),n("span",ge,"Guardar"))],8,fe)])],32)],4)]))}};export{be as default};
