import{r as d,E as ce,w as Ae,o as Ce,k as D,h as ee,d as f,x as m,p as i,e as t,$ as l,a0 as De,q as r,t as a,y as F,j as w,v as me,c as b,F as te,l as oe,a7 as ve,A as se,N as U,a5 as Ee}from"./vendor-gbh1WW5n.js";import{A as Pe}from"./AuthenticatedLayout-BLpeBUyv.js";import{z as Te,F as v}from"./ui-BrU4k96Z.js";import{p as q,b as Se,r as Fe,c as H,s as je,j as pe,e as $,k as Le,t as le,q as Me}from"./index-qi39o-TK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={class:"container mx-auto px-4 py-6"},Ie={class:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-8"},Re={class:"flex items-center justify-between text-white p-2 sm:p-4"},Ne={class:"text-xl sm:text-3xl font-bold"},Ue={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},$e={class:"flex items-center justify-between text-white p-2 sm:p-4"},Be={class:"text-xl sm:text-3xl font-bold"},ze={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},We={class:"flex items-center justify-between text-white p-2 sm:p-4"},qe={class:"text-xl sm:text-3xl font-bold"},He={class:"text-xs opacity-75 mt-1 flex items-center gap-1"},Oe={class:"flex items-center justify-between text-white p-2 sm:p-4"},Ge={class:"text-sm sm:text-3xl font-bold"},Je={class:"bg-white rounded-lg shadow-md"},Ke={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},Qe={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},Xe={class:"flex items-center gap-3"},Ye={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Ze=["disabled"],et=["disabled"],tt={class:"space-y-3"},ot={class:"relative"},st={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-3"},lt={class:"col-span-1"},at=["value"],it={class:"col-span-1"},nt=["value"],rt={class:"col-span-1 hidden md:block"},dt={class:"col-span-1 hidden md:block"},ut={class:"col-span-2 flex gap-3 md:hidden"},ct={class:"px-1 mt-3"},mt={class:"text-blue-600 text-xs font-medium flex items-center gap-1"},vt={class:"text-sm font-medium leading-relaxed"},pt=["title"],ft={class:"block text-xs text-gray-500"},gt=["title"],bt={class:"flex justify-center items-center"},xt=["onClick"],yt={key:0,class:"space-y-4"},ht={class:"grid grid-cols-2 gap-4"},_t={class:"text-green-600 font-medium"},wt={class:"col-span-2"},kt={key:0,class:"text-sm text-gray-600 mt-1"},At={key:0},Ct={key:0},Dt={class:"mt-1 p-3 bg-gray-50 rounded-lg"},Et={key:1,class:"p-3 bg-blue-50 rounded-lg"},Pt={class:"flex justify-center gap-4 w-full mt-6"},Tt={key:0,class:"text-center py-8"},St={key:1,class:"text-center py-8"},Ft={key:2,class:"space-y-4"},jt={class:"max-h-96 overflow-y-auto"},Lt={class:"flex-1"},Mt={class:"font-semibold text-gray-800"},Vt={class:"text-sm text-gray-500"},It={class:"flex gap-4 text-xs text-gray-600 mt-1"},Rt={key:0},Nt={class:"ml-4"},Ut={class:"border-t pt-4"},$t={class:"text-sm text-gray-600 mb-3"},Bt={class:"flex justify-center gap-4 w-full mt-6"},zt=["disabled"],Wt={key:0,class:"space-y-4"},qt={class:"flex items-center gap-3 p-4 rounded-lg border bg-red-50 border-red-200"},Ht={class:"bg-gray-50 p-4 rounded-lg border"},Ot={class:"space-y-2 text-sm"},Gt={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},Jt={class:"flex items-start gap-2"},Kt={class:"flex justify-center gap-4 w-full mt-6"},Qt=["disabled"],Xt=["disabled"],lo={__name:"Inventarios",setup(Yt){const k=Te(),j=d([]),A=d([]),x=d({}),ae=d(!1);d(!1);const B=d(""),C=d(!1);d(!1),d(!1);const z=d(!1),u=d(null),L=d(!1),T=d([]),M=d(""),S=d(""),O=d(!1),V=d(!1),g=d(null),E=d(!1),I=d(!1),n=d({producto_id:"",tipo_movimiento:"",fecha_desde:null,fecha_hasta:null});d({});const fe=[{label:"Entrada",value:"ENTRADA"},{label:"Salida",value:"SALIDA"},{label:"Ajuste",value:"AJUSTE"}],ie=d(typeof window<"u"?window.innerWidth:1024),G=ce(()=>{let s=j.value;if(n.value.producto_id&&n.value.producto_id!==""&&(s=s.filter(e=>e.producto_id==n.value.producto_id)),n.value.tipo_movimiento&&n.value.tipo_movimiento!==""&&(s=s.filter(e=>e.tipo_movimiento===n.value.tipo_movimiento)),n.value.fecha_desde&&(s=s.filter(e=>{const c=new Date(e.fecha_movimiento),p=new Date(n.value.fecha_desde);return c>=p})),n.value.fecha_hasta&&(s=s.filter(e=>{const c=new Date(e.fecha_movimiento),p=new Date(n.value.fecha_hasta);return c<=p})),B.value){const e=B.value.toLowerCase();s=s.filter(c=>{var p,y,P,h,R;return((y=(p=c.producto)==null?void 0:p.nombre)==null?void 0:y.toLowerCase().includes(e))||((P=c.motivo)==null?void 0:P.toLowerCase().includes(e))||((R=(h=c.user)==null?void 0:h.name)==null?void 0:R.toLowerCase().includes(e))})}return s}),J=ce(()=>ie.value<640?{width:"95vw",maxWidth:"380px"}:ie.value<768?{width:"400px"}:{width:"450px"}),K=async()=>{try{const s={};n.value.producto_id&&n.value.producto_id!==""&&(s.producto_id=n.value.producto_id),n.value.tipo_movimiento&&n.value.tipo_movimiento!==""&&(s.tipo_movimiento=n.value.tipo_movimiento),n.value.fecha_desde&&(s.fecha_desde=n.value.fecha_desde),n.value.fecha_hasta&&(s.fecha_hasta=n.value.fecha_hasta);const[e,c,p]=await Promise.all([U.get("/api/inventario",{params:s}),U.get("/api/productos"),U.get("/api/inventario/resumen")]);j.value=e.data.data||e.data||[];const y=c.data.data||c.data||[];A.value=Array.isArray(y)?y:[],A.value.length>0&&!Array.isArray(A.value)&&(console.warn("Los productos no tienen el formato esperado:",A.value),A.value=[]),x.value=p.data||{}}catch(s){console.error("Error al cargar datos:",s),j.value=[],A.value=[],x.value={},k.add({severity:"error",summary:"Error",detail:"Error al cargar los datos del inventario",life:4e3})}},ge=async()=>{ae.value=!0,k.add({severity:"info",summary:"Cargando inventario...",life:2e3});try{await K(),k.add({severity:"success",summary:"Inventario cargado",life:2e3})}finally{ae.value=!1}},ne=async()=>{C.value=!0;try{await new Promise(s=>setTimeout(s,300)),n.value={producto_id:"",tipo_movimiento:"",fecha_desde:null,fecha_hasta:null},k.add({severity:"success",summary:"Filtros limpiados",life:2e3}),await K()}finally{C.value=!1}},Q=async s=>{let e=0,c="";switch(s){case"disponibles":e=x.value.productos_disponibles||0,c="/api/admin/productos/disponibles",M.value="Productos Disponibles";break;case"agotados":e=x.value.productos_agotados||0,c="/api/inventario/agotados",M.value="Productos Agotados";break;case"stock_bajo":e=x.value.productos_stock_bajo||0,c="/api/inventario/stock-bajo",M.value="Productos con Stock Bajo";break}if(e===0){k.add({severity:"info",summary:"Sin registros",detail:`No hay productos en estado: ${M.value.toLowerCase()}`,life:3e3});return}S.value=s,O.value=!0;try{const p=await U.get(c);T.value=p.data.data||p.data||[],L.value=!0}catch{k.add({severity:"error",summary:"Error",detail:"Error al cargar los productos",life:4e3})}finally{O.value=!1}},be=s=>{s.originalEvent.target.closest("button")||(u.value=s.data,z.value=!0)},xe=s=>{g.value=s,V.value=!0},ye=async()=>{var s,e;if(g.value){E.value=!0;try{const c=await U.delete(`/api/inventario/${g.value.id}`),p=j.value.findIndex(y=>y.id===g.value.id);p!==-1&&j.value.splice(p,1),k.add({severity:"success",summary:"Éxito",detail:"Movimiento de inventario eliminado correctamente",life:3e3}),V.value=!1,g.value=null}catch(c){console.error("Error al eliminar movimiento:",c),k.add({severity:"error",summary:"Error",detail:((e=(s=c.response)==null?void 0:s.data)==null?void 0:e.message)||"Error al eliminar el movimiento de inventario",life:4e3})}finally{E.value=!1}}},he=()=>{V.value=!1,g.value=null},_e=()=>{I.value=!0,L.value=!1,Ee.visit("/productos")},X=s=>{const e=new Date(s);return window.innerWidth<640?e.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):e.toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},Y=s=>new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),W=s=>{const e={venta:"Venta",ajuste_aumento:"Ajuste (Aumento)",ajuste_reduccion:"Ajuste (Reducción)",entrada_manual:"Entrada Manual",cancelacion_venta:"Cancelación de Venta",eliminacion_venta:"Eliminación de Venta","":"Sin especificar",null:"Sin especificar",undefined:"Sin especificar"};return!e[s]&&s?s.charAt(0).toUpperCase()+s.slice(1).replace(/_/g," "):e[s]||"Sin especificar"},re=s=>s.tipo_movimiento||"Sin definir",we=s=>{const e=s.tipo_movimiento;return e==="ENTRADA"?"success":e==="SALIDA"?"danger":e==="AJUSTE"?"warning":"secondary"};return Ae(n,()=>{K()},{deep:!0}),Ce(()=>{ge()}),(s,e)=>{const c=D("Toast"),p=D("Card"),y=D("InputText"),P=D("DatePicker"),h=D("Column"),R=D("Tag"),ke=D("DataTable"),Z=D("Dialog");return f(),ee(Pe,null,{default:m(()=>[i(l(De),{title:"Inventarios"}),i(c,{class:"z-[9999]"}),t("div",Ve,[e[30]||(e[30]=t("div",{class:"mb-3 text-center sm:text-left"},[t("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Inventarios"),t("p",{class:"text-gray-600"},"Monitoreo y análisis del estado del inventario"),t("p",{class:"text-gray-500 text-sm text-center sm:text-start mt-1"},[r(" Para gestionar stock, ve a "),t("span",{class:"text-blue-600 font-medium"},"Productos > Más Acciones > Actualizar Stock")])],-1)),t("div",Ie,[i(p,{class:"bg-gradient-to-r from-green-500 to-green-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[0]||(e[0]=o=>Q("disponibles"))},{content:m(()=>[t("div",Re,[t("div",null,[e[18]||(e[18]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Productos Disponibles",-1)),t("p",Ne,a(x.value.productos_disponibles||0),1),t("p",Ue,[i(l(v),{icon:l(q),class:"h-3 w-3"},null,8,["icon"]),e[17]||(e[17]=r(" Clic para ver detalles "))])]),i(l(v),{icon:l(Se),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(p,{class:"bg-gradient-to-r from-red-500 to-red-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[1]||(e[1]=o=>Q("agotados"))},{content:m(()=>[t("div",$e,[t("div",null,[e[20]||(e[20]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Productos Agotados",-1)),t("p",Be,a(x.value.productos_agotados||0),1),t("p",ze,[i(l(v),{icon:l(q),class:"h-3 w-3"},null,8,["icon"]),e[19]||(e[19]=r(" Clic para ver detalles "))])]),i(l(v),{icon:l(Fe),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(p,{class:"bg-gradient-to-r from-yellow-500 to-yellow-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[2]||(e[2]=o=>Q("stock_bajo"))},{content:m(()=>[t("div",We,[t("div",null,[e[22]||(e[22]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Stock Bajo",-1)),t("p",qe,a(x.value.productos_stock_bajo||0),1),t("p",He,[i(l(v),{icon:l(q),class:"h-3 w-3"},null,8,["icon"]),e[21]||(e[21]=r(" Clic para ver detalles "))])]),i(l(v),{icon:l(H),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),i(p,{class:"bg-gradient-to-r from-blue-500 to-blue-600"},{content:m(()=>[t("div",Oe,[t("div",null,[e[23]||(e[23]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Valor Total",-1)),t("p",Ge,"$"+a(Y(x.value.valor_total_inventario)),1)]),i(l(v),{icon:l(je),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1})]),t("div",Je,[i(ke,{value:G.value,dataKey:"id",paginator:!0,rows:10,rowsPerPageOptions:[10,25,50],globalFilterFields:["producto.nombre","motivo","user.name"],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} movimientos",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:be,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:m(()=>[t("div",Ke,[t("div",Qe,[t("div",Xe,[e[24]||(e[24]=t("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[t("i",{class:"pi pi-filter text-blue-600 text-sm"}),t("span",null,"Filtros")],-1)),t("div",Ye,a(G.value.length)+" resultado"+a(G.value.length!==1?"s":""),1),t("button",{onClick:ne,disabled:C.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[C.value?(f(),ee(l(v),{key:0,icon:l($),class:"animate-spin h-3 w-3"},null,8,["icon"])):w("",!0),t("span",null,a(C.value?"Limpiando...":"Limpiar filtros"),1)],8,Ze)]),t("button",{onClick:ne,disabled:C.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[C.value?(f(),ee(l(v),{key:0,icon:l($),class:"animate-spin h-3 w-3"},null,8,["icon"])):w("",!0),t("span",null,a(C.value?"Limpiando...":"Limpiar filtros"),1)],8,et)]),t("div",tt,[t("div",ot,[i(l(v),{icon:l(Le),class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"},null,8,["icon"]),i(y,{modelValue:B.value,"onUpdate:modelValue":e[3]||(e[3]=o=>B.value=o),placeholder:"Buscar movimientos...",class:"w-full h-9 text-sm rounded-md pl-10",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),t("div",st,[t("div",lt,[me(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>n.value.producto_id=o),onChange:e[5]||(e[5]=(...o)=>s.aplicarFiltros&&s.aplicarFiltros(...o)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-700 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[25]||(e[25]=t("option",{value:"",disabled:"",selected:"",hidden:""},"Producto",-1)),(f(!0),b(te,null,oe(Array.isArray(A.value)?A.value:[],o=>(f(),b("option",{key:o.id,value:o.id,class:"truncate"},a(o.nombre),9,at))),128))],544),[[ve,n.value.producto_id]])]),t("div",it,[me(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>n.value.tipo_movimiento=o),onChange:e[7]||(e[7]=(...o)=>s.aplicarFiltros&&s.aplicarFiltros(...o)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-700 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[26]||(e[26]=t("option",{value:"",disabled:"",selected:"",hidden:""},"Tipo",-1)),(f(),b(te,null,oe(fe,o=>t("option",{key:o.value,value:o.value,class:"truncate"},a(o.label),9,nt)),64))],544),[[ve,n.value.tipo_movimiento]])]),t("div",rt,[i(P,{modelValue:n.value.fecha_desde,"onUpdate:modelValue":e[8]||(e[8]=o=>n.value.fecha_desde=o),placeholder:"Fecha desde",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),t("div",dt,[i(P,{modelValue:n.value.fecha_hasta,"onUpdate:modelValue":e[9]||(e[9]=o=>n.value.fecha_hasta=o),placeholder:"Fecha hasta",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),t("div",ut,[i(P,{modelValue:n.value.fecha_desde,"onUpdate:modelValue":e[10]||(e[10]=o=>n.value.fecha_desde=o),placeholder:"Fecha desde",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"]),i(P,{modelValue:n.value.fecha_hasta,"onUpdate:modelValue":e[11]||(e[11]=o=>n.value.fecha_hasta=o),placeholder:"Fecha hasta",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"])])]),t("div",ct,[t("p",mt,[i(l(v),{icon:l(q),class:"h-3 w-3 text-yellow-500"},null,8,["icon"]),e[27]||(e[27]=r(" Haz clic en cualquier fila para ver los detalles. "))])])])])]),default:m(()=>[i(h,{field:"fecha_movimiento",header:"Fecha",sortable:"",class:"w-32"},{body:m(({data:o})=>[t("div",vt,a(X(o.fecha_movimiento)),1)]),_:1}),i(h,{field:"producto.nombre",header:"Producto",sortable:"",class:"w-40"},{body:m(({data:o})=>{var _,N,de,ue;return[t("div",null,[t("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"150px","text-overflow":"ellipsis","white-space":"nowrap"},title:(_=o.producto)==null?void 0:_.nombre},a((N=o.producto)==null?void 0:N.nombre),9,pt),t("span",ft,a((ue=(de=o.producto)==null?void 0:de.categoria)==null?void 0:ue.nombre),1)])]}),_:1}),i(h,{field:"tipo_movimiento",header:"Tipo",sortable:"",class:"w-24 hidden sm:table-cell"},{body:m(({data:o})=>[i(R,{value:o.tipo_movimiento,severity:o.tipo_movimiento==="ENTRADA"?"success":o.tipo_movimiento==="SALIDA"?"danger":"warning",class:"text-xs"},null,8,["value","severity"])]),_:1}),i(h,{field:"cantidad",header:"Cantidad",sortable:"",class:"w-20 hidden sm:table-cell"},{body:m(({data:o})=>[t("span",{class:F([o.tipo_movimiento==="ENTRADA"?"text-green-600":o.tipo_movimiento==="SALIDA"?"text-red-600":"text-orange-600","text-sm font-medium"])},a(o.tipo_movimiento==="ENTRADA"?"+":o.tipo_movimiento==="SALIDA"?"-":"±")+a(o.cantidad),3)]),_:1}),i(h,{field:"motivo",header:"Motivo",sortable:"",class:"w-32 hidden md:table-cell"},{body:m(({data:o})=>[t("div",{class:"text-sm leading-relaxed overflow-hidden",style:{"max-width":"120px","text-overflow":"ellipsis","white-space":"nowrap"},title:W(o.motivo)},a(W(o.motivo)),9,gt)]),_:1}),i(h,{exportable:!1,class:"w-32 min-w-24"},{header:m(()=>e[28]||(e[28]=[t("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:m(({data:o})=>[t("div",bt,[t("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:_=>xe(o),title:"Eliminar movimiento"},[i(l(v),{icon:l(pe),class:"h-4 w-5 sm:h-4 sm:w-6 text-white"},null,8,["icon"]),e[29]||(e[29]=t("span",{class:"hidden lg:block text-white ml-1"},"Eliminar",-1))],8,xt)])]),_:1})]),_:1},8,["value"])])]),i(Z,{visible:z.value,"onUpdate:visible":e[13]||(e[13]=o=>z.value=o),modal:"",header:"Detalle del Movimiento",style:se(J.value),closable:!1,draggable:!1},{footer:m(()=>[t("div",Pt,[t("button",{type:"button",onClick:e[12]||(e[12]=o=>z.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[i(l(v),{icon:l(le),class:"h-5"},null,8,["icon"]),e[41]||(e[41]=r("Cerrar "))])])]),default:m(()=>{var o,_,N;return[u.value?(f(),b("div",yt,[t("div",ht,[t("div",null,[e[31]||(e[31]=t("strong",null,"Fecha:",-1)),r(" "+a(X(u.value.fecha_movimiento)),1)]),t("div",null,[e[32]||(e[32]=t("strong",null,"Tipo:",-1)),i(R,{value:re(u.value),severity:we(u.value)},{default:m(()=>[r(a(re(u.value)),1)]),_:1},8,["value","severity"])]),t("div",null,[e[33]||(e[33]=t("strong",null,"Producto:",-1)),r(" "+a((o=u.value.producto)==null?void 0:o.nombre),1)]),t("div",null,[e[34]||(e[34]=t("strong",null,"Precio:",-1)),t("span",_t," $"+a(Y((_=u.value.producto)==null?void 0:_.precio)),1)]),t("div",null,[e[35]||(e[35]=t("strong",null,"Cantidad:",-1)),t("span",{class:F(u.value.tipo_movimiento==="ENTRADA"?"text-green-600":"text-red-600")},a(u.value.tipo_movimiento==="ENTRADA"?"+":"-")+a(u.value.cantidad),3)]),t("div",wt,[e[38]||(e[38]=t("strong",null,"Usuario:",-1)),r(" "+a(((N=u.value.user)==null?void 0:N.name)||"Sistema")+" ",1),u.value.user?(f(),b("div",kt,[t("div",null,[e[36]||(e[36]=t("strong",null,"Email:",-1)),r(" "+a(u.value.user.email),1)]),u.value.user.roles&&u.value.user.roles.length>0?(f(),b("div",At,[e[37]||(e[37]=t("strong",null,"Rol:",-1)),r(" "+a(u.value.user.roles[0].name),1)])):w("",!0)])):w("",!0)]),t("div",null,[e[39]||(e[39]=t("strong",null,"Motivo:",-1)),r(" "+a(W(u.value.motivo)),1)])]),u.value.observacion?(f(),b("div",Ct,[e[40]||(e[40]=t("strong",null,"Observaciones:",-1)),t("p",Dt,a(u.value.observacion),1)])):w("",!0),u.value.venta_id?(f(),b("div",Et,[t("strong",null,"Relacionado con venta #"+a(u.value.venta_id),1)])):w("",!0)])):w("",!0)]}),_:1},8,["visible","style"]),i(Z,{visible:L.value,"onUpdate:visible":e[15]||(e[15]=o=>L.value=o),modal:"",header:M.value,style:se(J.value),closable:!1,draggable:!1},{footer:m(()=>[t("div",Bt,[t("button",{onClick:_e,disabled:I.value,class:"bg-red-500 hover:bg-red-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[i(l(v),{icon:I.value?l($):l(Me),class:F([{"animate-spin":I.value},"h-5"])},null,8,["icon","class"]),r(" "+a(I.value?"Cargando...":"Gestionar Productos"),1)],8,zt),t("button",{type:"button",onClick:e[14]||(e[14]=o=>L.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[i(l(v),{icon:l(le),class:"h-5"},null,8,["icon"]),e[47]||(e[47]=r("Cerrar "))])])]),default:m(()=>[O.value?(f(),b("div",Tt,[i(l(v),{icon:l($),class:"animate-spin h-8 w-8 text-blue-600 mb-3"},null,8,["icon"]),e[42]||(e[42]=t("p",{class:"text-gray-600"},"Cargando productos...",-1))])):T.value.length===0?(f(),b("div",St,[i(l(v),{icon:l(H),class:"h-12 w-12 text-gray-400 mb-3"},null,8,["icon"]),e[43]||(e[43]=t("p",{class:"text-gray-600"},"No se encontraron productos en este estado.",-1))])):(f(),b("div",Ft,[t("div",jt,[(f(!0),b(te,null,oe(T.value,o=>{var _;return f(),b("div",{key:o.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50"},[t("div",Lt,[t("h4",Mt,a(o.nombre),1),t("p",Vt,a(((_=o.categoria)==null?void 0:_.nombre)||"Sin categoría"),1),t("div",It,[t("span",null,[e[44]||(e[44]=r("Stock: ")),t("strong",null,a(o.stock_actual||0),1)]),t("span",null,[e[45]||(e[45]=r("Mínimo: ")),t("strong",null,a(o.stock_minimo||1),1)]),o.precio?(f(),b("span",Rt,[e[46]||(e[46]=r("Precio: ")),t("strong",null,"$"+a(Y(o.precio)),1)])):w("",!0)])]),t("div",Nt,[t("span",{class:F(["px-2 py-1 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":S.value==="disponibles","bg-red-100 text-red-800":S.value==="agotados","bg-yellow-100 text-yellow-800":S.value==="stock_bajo"}])},a(S.value==="disponibles"?"Disponible":S.value==="agotados"?"Agotado":"Stock Bajo"),3)])])}),128))]),t("div",Ut,[t("p",$t,[t("strong",null,a(T.value.length),1),r(" producto"+a(T.value.length!==1?"s":"")+" encontrado"+a(T.value.length!==1?"s":""),1)])])]))]),_:1},8,["visible","header","style"]),i(Z,{visible:V.value,"onUpdate:visible":e[16]||(e[16]=o=>V.value=o),header:"Eliminar movimiento de inventario",modal:!0,style:se(J.value),closable:!1,draggable:!1},{footer:m(()=>[t("div",Kt,[t("button",{class:"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:ye,disabled:E.value},[i(l(v),{icon:E.value?l($):l(pe),class:F(["h-4",{"animate-spin":E.value}])},null,8,["icon","class"]),r(" "+a(E.value?"Eliminando...":"Eliminar"),1)],8,Qt),t("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:he,disabled:E.value},[i(l(v),{icon:l(le),class:"h-4"},null,8,["icon"]),e[57]||(e[57]=r(" Cancelar "))],8,Xt)])]),default:m(()=>{var o;return[g.value?(f(),b("div",Wt,[t("div",qt,[i(l(v),{icon:l(H),class:"text-2xl text-red-500"},null,8,["icon"]),e[48]||(e[48]=t("div",null,[t("h4",{class:"text-lg font-semibold text-red-800"},"Eliminar Movimiento"),t("p",{class:"text-red-700"},"Esta acción no se puede deshacer.")],-1))]),t("div",Ht,[e[55]||(e[55]=t("h5",{class:"font-semibold text-gray-800 mb-2"},"Información del movimiento:",-1)),t("div",Ot,[t("div",null,[e[49]||(e[49]=t("strong",null,"ID:",-1)),r(" #"+a(g.value.id),1)]),t("div",null,[e[50]||(e[50]=t("strong",null,"Producto:",-1)),r(" "+a(((o=g.value.producto)==null?void 0:o.nombre)||"N/A"),1)]),t("div",null,[e[51]||(e[51]=t("strong",null,"Tipo:",-1)),t("span",{class:F("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-1 "+(g.value.tipo_movimiento==="ENTRADA"?"bg-green-100 text-green-800":g.value.tipo_movimiento==="SALIDA"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"))},a(g.value.tipo_movimiento),3)]),t("div",null,[e[52]||(e[52]=t("strong",null,"Cantidad:",-1)),r(" "+a(g.value.cantidad),1)]),t("div",null,[e[53]||(e[53]=t("strong",null,"Fecha:",-1)),r(" "+a(X(g.value.fecha_movimiento)),1)]),t("div",null,[e[54]||(e[54]=t("strong",null,"Motivo:",-1)),r(" "+a(W(g.value.motivo)),1)])])]),t("div",Gt,[t("div",Jt,[i(l(v),{icon:l(H),class:"text-yellow-500 text-sm mt-0.5"},null,8,["icon"]),e[56]||(e[56]=t("div",{class:"text-sm text-yellow-800"},[t("strong",null,"Importante:"),r(" Al eliminar este movimiento se perderá el historial del cambio de inventario. Esta acción es irreversible y puede afectar la trazabilidad del producto. ")],-1))])])])):w("",!0)]}),_:1},8,["visible","style"])]),_:1})}}};export{lo as default};
