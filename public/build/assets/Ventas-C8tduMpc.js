import{N as Q,r as m,w as Le,E as X,o as je,a6 as Ie,h as Y,d as _,x as u,p as n,e,$ as a,a0 as $e,t as r,y as b,c as L,j as B,v as de,F as ce,l as ue,a7 as ve,q as g,A as me,a5 as pe}from"./vendor-gbh1WW5n.js";import{A as Ne}from"./AuthenticatedLayout-BL1L8Chz.js";import{z as Te,A as fe,a as Be,F as c,e as ge,f as h,h as He,q as z,g as xe}from"./ui-BrU4k96Z.js";import{I as Re,l as Ue,m as H,s as Me,J as be,j as ze,v as We,e as j,K as he,k as Oe,p as qe,L as Ge,M as Ke,f as Je,N as Qe,c as ye}from"./index-CaK7jatL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Xe={class:"container mx-auto px-4 py-6"},Ye={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},Ze={class:"bg-gradient-to-r from-yellow-400 to-yellow-600 text-white rounded-lg p-4 shadow-md"},et={class:"flex items-center justify-between"},tt={class:"text-2xl font-bold"},at={class:"bg-gradient-to-r from-green-400 to-green-600 text-white rounded-lg p-4 shadow-md"},lt={class:"flex items-center justify-between"},st={class:"text-2xl font-bold"},ot={class:"bg-gradient-to-r from-red-400 to-red-600 text-white rounded-lg p-4 shadow-md"},nt={class:"flex items-center justify-between"},rt={class:"text-2xl font-bold"},it={class:"bg-gradient-to-r from-blue-400 to-blue-600 text-white rounded-lg p-4 shadow-md"},dt={class:"flex items-center justify-between"},ct={class:"text-2xl font-bold"},ut={class:"bg-white rounded-lg shadow-md"},vt={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},mt={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},pt={class:"flex flex-col sm:flex-row sm:items-center gap-3"},ft={class:"flex items-center gap-3"},gt={class:"text-base font-medium text-gray-800 flex items-center gap-2"},xt={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},bt={class:"grid grid-cols-2 gap-2 sm:hidden"},ht=["disabled"],yt=["disabled"],wt={class:"flex gap-2"},_t=["disabled"],Ct=["disabled"],kt={class:"space-y-3"},Dt={class:"relative"},Vt={class:"sm:hidden"},Et=["value"],Pt={class:"grid grid-cols-2 gap-3 sm:hidden"},Ft={class:"hidden sm:grid sm:grid-cols-3 gap-3"},St=["value"],At={class:"px-1 mt-3"},Lt={class:"text-blue-600 text-xs font-medium flex items-center gap-1"},jt={class:"text-sm leading-relaxed"},It={class:"flex items-center gap-2"},$t={class:"text-sm font-medium"},Nt={class:"text-sm font-bold text-green-600"},Tt={class:"text-sm text-center"},Bt={class:"flex flex-wrap gap-2 justify-center items-center"},Ht=["onClick"],Rt=["onClick"],Ut={key:0,class:"space-y-4"},Mt={class:"bg-white rounded-lg border p-4"},zt={class:"flex items-center justify-between mb-4"},Wt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ot={class:"space-y-3"},qt={class:"flex items-center gap-2"},Gt={class:"flex items-center gap-2"},Kt={class:"flex items-center gap-2"},Jt={class:"flex items-center gap-2"},Qt={class:"bg-white rounded-lg border p-4"},Xt={class:"text-lg font-semibold text-gray-800 mb-4"},Yt={class:"flex items-center gap-2"},Zt={class:"font-medium"},ea={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},ta={class:"font-medium"},aa={class:"font-bold text-green-600"},la={class:"flex justify-center gap-4 w-full mt-6"},sa={key:0,class:"space-y-4"},oa={class:"bg-gray-50 p-4 rounded-lg border"},na={class:"space-y-2 text-sm"},ra={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},ia={class:"flex items-start gap-2"},da={class:"text-sm text-yellow-800"},ca={class:"flex justify-center gap-4 w-full mt-6"},ua=["disabled"],va=["disabled"],ba={__name:"Ventas",props:{ventas:{type:[Array,Object],default:()=>[]}},setup(we){var ne;Q.defaults.withCredentials=!0;const x=Te(),R=we,C=m(Array.isArray(R.ventas)?R.ventas:((ne=R.ventas)==null?void 0:ne.data)||[]),y=m(null);Le(()=>R.ventas,o=>{C.value=Array.isArray(o)?o:(o==null?void 0:o.data)||[]},{deep:!0});const U=m(!1),D=m(!1),s=m({tipo:null,venta:null,titulo:"",mensaje:"",color:"",icono:null,textoBoton:"",importante:""}),V=m(!1),F=m(!1),w=m(!1),I=m(new Set),S=m(new Set),$=m(""),k=m(""),W=m({global:{value:null,matchMode:fe.CONTAINS},estado:{value:null,matchMode:fe.EQUALS}}),p=m({estado:null,fechaDesde:null,fechaHasta:null}),Z=m([{name:"Pendiente",value:"pendiente"},{name:"Completada",value:"completada"},{name:"Cancelada",value:"cancelada"}]),O=m(10),_e=m([5,10,20,50]),q=X(()=>{let o=C.value;if($.value){const t=$.value.toLowerCase();o=o.filter(l=>{var i,d,v;return((v=(d=(i=l.cliente)==null?void 0:i.user)==null?void 0:d.name)==null?void 0:v.toLowerCase().includes(t))||l.id.toString().includes(t)||l.estado.toLowerCase().includes(t)})}if(k.value&&(o=o.filter(t=>t.estado===k.value)),p.value.fechaDesde){const t=new Date(p.value.fechaDesde);o=o.filter(l=>new Date(l.fecha)>=t)}if(p.value.fechaHasta){const t=new Date(p.value.fechaHasta);o=o.filter(l=>new Date(l.fecha)<=t)}return o.sort((t,l)=>{const i={pendiente:1,completada:2,cancelada:3},d=i[t.estado.toLowerCase()]||4,v=i[l.estado.toLowerCase()]||4;if(d!==v)return d-v;const A=new Date(t.fecha);return new Date(l.fecha)-A})}),M=X(()=>{const o={pendientes:0,completadas:0,canceladas:0,totalVendido:0};return C.value.forEach(t=>{switch(t.estado){case"pendiente":o.pendientes++;break;case"completada":o.completadas++,o.totalVendido+=parseFloat(t.total||0);break;case"cancelada":o.canceladas++;break}}),o}),ee=m(typeof window<"u"?window.innerWidth:1024),te=X(()=>ee.value<640?{width:"95vw",maxWidth:"380px"}:ee.value<768?{width:"80vw"}:{width:"70vw",maxWidth:"900px"}),ae=()=>{W.value.estado.value=k.value===""?null:k.value},le=async()=>{V.value=!0;try{await new Promise(o=>setTimeout(o,300)),k.value="",$.value="",W.value.global.value=null,W.value.estado.value=null,p.value={estado:null,fechaDesde:null,fechaHasta:null},x.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{V.value=!1}},E=()=>{},se=async()=>{w.value=!0,x.add({severity:"info",summary:"Cargando ventas...",life:2e3});try{await pe.reload({only:["ventas"],preserveScroll:!0,preserveState:!0}),setTimeout(()=>{x.add({severity:"success",summary:"Ventas actualizadas",detail:`${C.value.length} registros cargados`,life:2e3})},300)}catch(o){console.error("Error al cargar las ventas:",o),x.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las ventas",life:3e3})}finally{setTimeout(()=>{w.value=!1},500)}},Ce=async()=>{const o=s.value.venta;if(o)try{console.warn("procesarVenta() - Función deshabilitada: las ventas se crean como completadas"),x.add({severity:"info",summary:"Información",detail:"Las ventas se procesan automáticamente al crear el pago",life:3e3}),D.value=!1,s.value={tipo:null,venta:null}}finally{I.value.delete(o.id)}},ke=o=>{s.value={tipo:"cancelar",venta:o,titulo:"¿Cancelar esta venta?",mensaje:"Esta acción cancelará la venta y restaurará el stock si estaba completada.",color:"orange",icono:H,textoBoton:"Sí, Cancelar",importante:"Si la venta estaba completada, se restaurará automáticamente el stock de todos los productos."},D.value=!0},De=async()=>{var t,l;const o=s.value.venta;if(o){S.value.add(o.id);try{const i=await Q.post(`/api/ventas/${o.id}/cancelar`),d=C.value.findIndex(v=>v.id===o.id);d!==-1&&(C.value[d]={...C.value[d],estado:"cancelada"}),x.add({severity:"success",summary:"Éxito",detail:"Venta cancelada correctamente",life:3e3}),D.value=!1,s.value={tipo:null,venta:null}}catch(i){x.add({severity:"error",summary:"Error",detail:((l=(t=i.response)==null?void 0:t.data)==null?void 0:l.message)||"Error al cancelar la venta",life:3e3})}finally{S.value.delete(o.id)}}},Ve=o=>{s.value={tipo:"eliminar",venta:o,titulo:"¿Eliminar esta venta?",mensaje:"Esta acción no se puede deshacer.",color:"red",icono:ye,textoBoton:"Sí, Eliminar",importante:o.estado==="completada"?"Se restaurará el stock de todos los productos de esta venta.":"Esta venta será eliminada permanentemente del sistema."},D.value=!0},Ee=async()=>{var t,l;const o=s.value.venta;if(o){F.value=!0;try{const i=await Q.delete(`/api/ventas/${o.id}/eliminar`),d=C.value.findIndex(v=>v.id===o.id);d!==-1&&C.value.splice(d,1),x.add({severity:"success",summary:"Éxito",detail:"Venta eliminada correctamente",life:3e3}),D.value=!1,s.value={tipo:null,venta:null}}catch(i){x.add({severity:"error",summary:"Error",detail:((l=(t=i.response)==null?void 0:t.data)==null?void 0:l.message)||"Error al eliminar la venta",life:3e3})}finally{F.value=!1}}},Pe=()=>{switch(s.value.tipo){case"procesar":Ce();break;case"cancelar":De();break;case"eliminar":Ee();break}},Fe=()=>{D.value=!1,s.value={tipo:null,venta:null}},Se=o=>{o.originalEvent.target.closest("button")||(y.value=o.data,U.value=!0)},oe=o=>o?new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",N=o=>o?parseFloat(o).toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",G=o=>{switch(o){case"pendiente":return"bg-yellow-100 text-yellow-800";case"completada":return"bg-green-100 text-green-800";case"cancelada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},K=o=>{switch(o){case"pendiente":return"Pendiente de Pago";case"completada":return"Completada";case"cancelada":return"Cancelada";default:return"Desconocido"}};let J=null;const Ae=()=>{pe.reload({only:["ventas"],preserveScroll:!0,preserveState:!0})};return je(()=>{x.add({severity:"info",summary:"Cargando ventas...",life:2e3}),setTimeout(()=>{x.add({severity:"success",summary:"Ventas cargadas",life:2e3})},1e3),J=setInterval(()=>{Ae()},3e4)}),Ie(()=>{J&&clearInterval(J)}),(o,t)=>(_(),Y(Ne,null,{default:u(()=>[n(a($e),{title:"Ventas"}),n(a(Be),{class:"z-[9999]"}),e("div",Xe,[t[22]||(t[22]=e("div",{class:"mb-6 text-center sm:text-left"},[e("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Gestión de Ventas"),e("p",{class:"text-gray-600"},"Control completo del sistema de ventas")],-1)),e("div",Ye,[e("div",Ze,[e("div",et,[e("div",null,[t[11]||(t[11]=e("div",{class:"text-yellow-100 text-sm"},"Ventas Pendientes",-1)),e("div",tt,r(M.value.pendientes),1)]),n(a(c),{icon:a(Re),class:"text-3xl text-yellow-200"},null,8,["icon"])])]),e("div",at,[e("div",lt,[e("div",null,[t[12]||(t[12]=e("div",{class:"text-green-100 text-sm"},"Ventas Completadas",-1)),e("div",st,r(M.value.completadas),1)]),n(a(c),{icon:a(Ue),class:"text-3xl text-green-200"},null,8,["icon"])])]),e("div",ot,[e("div",nt,[e("div",null,[t[13]||(t[13]=e("div",{class:"text-red-100 text-sm"},"Ventas Canceladas",-1)),e("div",rt,r(M.value.canceladas),1)]),n(a(c),{icon:a(H),class:"text-3xl text-red-200"},null,8,["icon"])])]),e("div",it,[e("div",dt,[e("div",null,[t[14]||(t[14]=e("div",{class:"text-blue-100 text-sm"},"Total Vendido",-1)),e("div",ct,"$"+r(N(M.value.totalVendido)),1)]),n(a(c),{icon:a(Me),class:"text-3xl text-blue-200"},null,8,["icon"])])])]),e("div",ut,[n(a(ge),{value:q.value,dataKey:"id",paginator:!0,rows:O.value,rowsPerPageOptions:_e.value,rowsPerPage:O.value,"onUpdate:rowsPerPage":t[7]||(t[7]=l=>O.value=l),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} ventas",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:Se,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:u(()=>[e("div",vt,[e("div",mt,[e("div",pt,[e("div",ft,[e("h3",gt,[n(a(c),{icon:a(We),class:"text-blue-600 text-sm"},null,8,["icon"]),t[15]||(t[15]=e("span",null,"Filtros",-1))]),e("div",xt,r(q.value.length)+" resultado"+r(q.value.length!==1?"s":""),1)]),e("div",bt,[e("button",{class:"bg-blue-500 hover:bg-blue-600 border border-blue-500 px-3 py-2 text-sm text-white shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",onClick:se,disabled:w.value},[n(a(c),{icon:w.value?a(j):a(he),class:b([{"animate-spin":w.value},"h-3 w-3"])},null,8,["icon","class"]),e("span",null,r(w.value?"Recargando...":"Recargar"),1)],8,ht),e("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-2 text-sm text-white shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",onClick:le,disabled:V.value},[V.value?(_(),Y(a(c),{key:0,icon:a(j),class:"animate-spin h-3 w-3"},null,8,["icon"])):B("",!0),e("span",null,r(V.value?"Limpiando...":"Limpiar"),1)],8,yt)])]),e("div",wt,[e("button",{class:"bg-blue-500 hover:bg-blue-600 border border-blue-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:se,disabled:w.value},[n(a(c),{icon:w.value?a(j):a(he),class:b([{"animate-spin":w.value},"h-3 w-3"])},null,8,["icon","class"]),e("span",null,r(w.value?"Recargando...":"Recargar"),1)],8,_t),e("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:le,disabled:V.value},[V.value?(_(),Y(a(c),{key:0,icon:a(j),class:"animate-spin h-3 w-3"},null,8,["icon"])):B("",!0),e("span",null,r(V.value?"Limpiando...":"Limpiar filtros"),1)],8,Ct)])]),e("div",kt,[e("div",Dt,[n(a(c),{icon:a(Oe),class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"},null,8,["icon"]),n(a(He),{modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=l=>$.value=l),placeholder:"Buscar ventas...",class:"w-full h-9 text-sm rounded-md pl-10",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),e("div",Vt,[de(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>k.value=l),onChange:ae,class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[t[16]||(t[16]=e("option",{value:"",disabled:"",selected:"",hidden:""},"Estado",-1)),(_(!0),L(ce,null,ue(Z.value,l=>(_(),L("option",{key:l.value,value:l.value,class:"truncate"},r(l.name),9,Et))),128))],544),[[ve,k.value]])]),e("div",Pt,[e("div",null,[n(a(z),{modelValue:p.value.fechaDesde,"onUpdate:modelValue":t[2]||(t[2]=l=>p.value.fechaDesde=l),placeholder:"Fecha Desde",class:"w-full h-9 text-sm border",style:{"background-color":"white","border-color":"#93c5fd"},onDateSelect:E,onClear:E,showIcon:!0,dateFormat:"dd/mm/yy",maxDate:p.value.fechaHasta},null,8,["modelValue","maxDate"])]),e("div",null,[n(a(z),{modelValue:p.value.fechaHasta,"onUpdate:modelValue":t[3]||(t[3]=l=>p.value.fechaHasta=l),placeholder:"Fecha Hasta",class:"w-full h-9 text-sm border",style:{"background-color":"white","border-color":"#93c5fd"},onDateSelect:E,onClear:E,showIcon:!0,dateFormat:"dd/mm/yy",minDate:p.value.fechaDesde},null,8,["modelValue","minDate"])])]),e("div",Ft,[e("div",null,[de(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>k.value=l),onChange:ae,class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[t[17]||(t[17]=e("option",{value:"",disabled:"",selected:"",hidden:""},"Estado",-1)),(_(!0),L(ce,null,ue(Z.value,l=>(_(),L("option",{key:l.value,value:l.value,class:"truncate text-gray-900"},r(l.name),9,St))),128))],544),[[ve,k.value]])]),e("div",null,[n(a(z),{modelValue:p.value.fechaDesde,"onUpdate:modelValue":t[5]||(t[5]=l=>p.value.fechaDesde=l),placeholder:"Fecha desde",class:"w-full h-9 text-sm border",style:{"background-color":"white","border-color":"#93c5fd"},onDateSelect:E,onClear:E,showIcon:!0,dateFormat:"dd/mm/yy",maxDate:p.value.fechaHasta},null,8,["modelValue","maxDate"])]),e("div",null,[n(a(z),{modelValue:p.value.fechaHasta,"onUpdate:modelValue":t[6]||(t[6]=l=>p.value.fechaHasta=l),placeholder:"Fecha hasta",class:"w-full h-9 text-sm border",style:{"background-color":"white","border-color":"#93c5fd"},onDateSelect:E,onClear:E,showIcon:!0,dateFormat:"dd/mm/yy",minDate:p.value.fechaDesde},null,8,["modelValue","minDate"])])]),e("div",At,[e("p",Lt,[n(a(c),{icon:a(qe),class:"h-3 w-3 text-yellow-500"},null,8,["icon"]),t[18]||(t[18]=g(" Haz clic en cualquier fila para ver los detalles. "))])])])])]),default:u(()=>[n(a(h),{field:"fecha",header:"Fecha",sortable:"",class:"w-24 hidden md:table-cell"},{body:u(l=>[e("div",jt,r(oe(l.data.fecha)),1)]),_:1}),n(a(h),{field:"cliente.user.name",header:"Cliente",sortable:"",class:"w-32 min-w-24"},{body:u(l=>{var i,d;return[e("div",It,[n(a(c),{icon:a(be),class:"text-gray-500 text-xs"},null,8,["icon"]),e("span",$t,r(((d=(i=l.data.cliente)==null?void 0:i.user)==null?void 0:d.name)||"N/A"),1)])]}),_:1}),n(a(h),{field:"total",header:"Total",class:"w-24"},{body:u(l=>[e("div",Nt," $"+r(N(l.data.total)),1)]),_:1}),n(a(h),{field:"estado",header:"Estado",class:"w-28 hidden sm:table-cell"},{body:u(l=>[e("span",{class:b("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+G(l.data.estado))},r(K(l.data.estado)),3)]),_:1}),n(a(h),{header:"Items",class:"w-16 hidden md:table-cell"},{body:u(l=>{var i;return[e("div",Tt,r(((i=l.data.detalle_ventas)==null?void 0:i.length)||0),1)]}),_:1}),n(a(h),{exportable:!1,class:"w-64 min-w-32"},{header:u(()=>t[19]||(t[19]=[e("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:u(l=>[e("div",Bt,[l.data.estado==="completada"?(_(),L("button",{key:0,class:"flex bg-orange-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:i=>ke(l.data),title:"Cancelar venta"},[n(a(c),{icon:a(H),class:"h-4 w-5 sm:h-4 sm:w-6 text-white"},null,8,["icon"]),t[20]||(t[20]=e("span",{class:"hidden lg:block text-white ml-1"},"Cancelar",-1))],8,Ht)):B("",!0),e("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:i=>Ve(l.data),title:"Eliminar venta"},[n(a(c),{icon:a(ze),class:"h-4 w-5 sm:h-4 sm:w-6 text-white"},null,8,["icon"]),t[21]||(t[21]=e("span",{class:"hidden lg:block text-white ml-1"},"Eliminar",-1))],8,Rt)])]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"])])]),n(a(xe),{visible:U.value,"onUpdate:visible":t[9]||(t[9]=l=>U.value=l),style:me(te.value),header:"Detalles de la Venta",modal:!0,closable:!1,draggable:!1},{footer:u(()=>[e("div",la,[e("button",{class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:t[8]||(t[8]=l=>U.value=!1)},[n(a(c),{icon:a(H),class:"h-5"},null,8,["icon"]),t[28]||(t[28]=g(" Cerrar "))])])]),default:u(()=>{var l,i,d,v,A;return[y.value?(_(),L("div",Ut,[e("div",Mt,[e("div",zt,[t[23]||(t[23]=e("h4",{class:"text-lg font-semibold text-gray-800"},"Información General",-1)),e("span",{class:b("inline-flex items-center px-3 py-1 rounded-full text-sm font-medium "+G(y.value.estado))},r(K(y.value.estado)),3)]),e("div",Wt,[e("div",Ot,[e("div",qt,[n(a(c),{icon:a(Ge),class:"text-gray-500 text-sm"},null,8,["icon"]),t[24]||(t[24]=e("strong",null,"ID:",-1)),g(" #"+r(y.value.id),1)]),e("div",Gt,[n(a(c),{icon:a(Ke),class:"text-gray-500 text-sm"},null,8,["icon"]),t[25]||(t[25]=e("strong",null,"Fecha:",-1)),g(" "+r(oe(y.value.fecha)),1)]),e("div",Kt,[n(a(c),{icon:a(be),class:"text-gray-500 text-sm"},null,8,["icon"]),t[26]||(t[26]=e("strong",null,"Cliente:",-1)),g(" "+r(((i=(l=y.value.cliente)==null?void 0:l.user)==null?void 0:i.name)||"N/A"),1)]),e("div",Jt,[n(a(c),{icon:a(Je),class:"text-gray-500 text-sm"},null,8,["icon"]),t[27]||(t[27]=e("strong",null,"Email:",-1)),g(" "+r(((v=(d=y.value.cliente)==null?void 0:d.user)==null?void 0:v.email)||"N/A"),1)])])])]),e("div",Qt,[e("h4",Xt," Productos Vendidos ("+r(((A=y.value.detalle_ventas)==null?void 0:A.length)||0)+") ",1),n(a(ge),{value:y.value.detalle_ventas,class:"text-sm",stripedRows:""},{default:u(()=>[n(a(h),{field:"producto.nombre",header:"Producto"},{body:u(({data:f})=>{var P;return[e("div",Yt,[n(a(c),{icon:a(Qe),class:"text-blue-500 text-sm"},null,8,["icon"]),e("span",Zt,r((P=f.producto)==null?void 0:P.nombre),1)])]}),_:1}),n(a(h),{field:"producto.categoria.nombre",header:"Categoría"},{body:u(({data:f})=>{var P,T;return[e("span",ea,r(((T=(P=f.producto)==null?void 0:P.categoria)==null?void 0:T.nombre)||"Sin categoría"),1)]}),_:1}),n(a(h),{field:"cantidad",header:"Cantidad",style:{width:"100px"}},{body:u(({data:f})=>[e("span",ta,r(f.cantidad),1)]),_:1}),n(a(h),{field:"precio_unitario",header:"Precio Unit.",style:{width:"120px"}},{body:u(({data:f})=>[e("span",null,"$"+r(N(f.precio_unitario)),1)]),_:1}),n(a(h),{field:"subtotal",header:"Subtotal",style:{width:"120px","font-size":"17px"}},{body:u(({data:f})=>[e("span",aa," $"+r(N(f.subtotal)),1)]),_:1})]),_:1},8,["value"])])])):B("",!0)]}),_:1},8,["visible","style"]),n(a(xe),{visible:D.value,"onUpdate:visible":t[10]||(t[10]=l=>D.value=l),style:me(te.value),header:s.value.titulo,modal:!0,closable:!1,draggable:!1},{footer:u(()=>{var l,i,d,v,A,f,P,T,re,ie;return[e("div",ca,[e("button",{class:b(["text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",s.value.color==="green"?"bg-green-500 hover:bg-green-600":s.value.color==="orange"?"bg-orange-500 hover:bg-orange-600":"bg-red-500 hover:bg-red-600"]),onClick:Pe,disabled:s.value.tipo==="procesar"&&I.value.has((l=s.value.venta)==null?void 0:l.id)||s.value.tipo==="cancelar"&&S.value.has((i=s.value.venta)==null?void 0:i.id)||s.value.tipo==="eliminar"&&F.value},[n(a(c),{icon:s.value.tipo==="procesar"&&I.value.has((d=s.value.venta)==null?void 0:d.id)?a(j):s.value.tipo==="cancelar"&&S.value.has((v=s.value.venta)==null?void 0:v.id)?a(j):s.value.tipo==="eliminar"&&F.value?a(j):s.value.icono,class:b(["h-4",{"animate-spin":s.value.tipo==="procesar"&&I.value.has((A=s.value.venta)==null?void 0:A.id)||s.value.tipo==="cancelar"&&S.value.has((f=s.value.venta)==null?void 0:f.id)||s.value.tipo==="eliminar"&&F.value}])},null,8,["icon","class"]),g(" "+r(s.value.tipo==="procesar"&&I.value.has((P=s.value.venta)==null?void 0:P.id)?"Procesando...":s.value.tipo==="cancelar"&&S.value.has((T=s.value.venta)==null?void 0:T.id)?"Cancelando...":s.value.tipo==="eliminar"&&F.value?"Eliminando...":s.value.textoBoton),1)],10,ua),e("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:Fe,disabled:s.value.tipo==="procesar"&&I.value.has((re=s.value.venta)==null?void 0:re.id)||s.value.tipo==="cancelar"&&S.value.has((ie=s.value.venta)==null?void 0:ie.id)||s.value.tipo==="eliminar"&&F.value},[n(a(c),{icon:a(H),class:"h-4"},null,8,["icon"]),t[36]||(t[36]=g(" Cerrar "))],8,va)])]}),default:u(()=>{var l,i,d,v;return[s.value.venta?(_(),L("div",sa,[e("div",{class:b(["flex items-center gap-3 p-4 rounded-lg border",s.value.color==="green"?"bg-green-50 border-green-200":s.value.color==="orange"?"bg-orange-50 border-orange-200":"bg-red-50 border-red-200"])},[n(a(c),{icon:s.value.icono,class:b(["text-2xl",s.value.color==="green"?"text-green-500":s.value.color==="orange"?"text-orange-500":"text-red-500"])},null,8,["icon","class"]),e("div",null,[e("h4",{class:b(["text-lg font-semibold",s.value.color==="green"?"text-green-800":s.value.color==="orange"?"text-orange-800":"text-red-800"])},r(s.value.titulo),3),e("p",{class:b([s.value.color==="green"?"text-green-700":s.value.color==="orange"?"text-orange-700":"text-red-700"])},r(s.value.mensaje),3)])],2),e("div",oa,[t[34]||(t[34]=e("h5",{class:"font-semibold text-gray-800 mb-2"},"Información de la venta:",-1)),e("div",na,[e("div",null,[t[29]||(t[29]=e("strong",null,"ID:",-1)),g(" #"+r(s.value.venta.id),1)]),e("div",null,[t[30]||(t[30]=e("strong",null,"Cliente:",-1)),g(" "+r(((i=(l=s.value.venta.cliente)==null?void 0:l.user)==null?void 0:i.name)||"N/A"),1)]),e("div",null,[t[31]||(t[31]=e("strong",null,"Email:",-1)),g(" "+r(((v=(d=s.value.venta.cliente)==null?void 0:d.user)==null?void 0:v.email)||"N/A"),1)]),e("div",null,[t[32]||(t[32]=e("strong",null,"Total:",-1)),g(" $"+r(N(s.value.venta.total)),1)]),e("div",null,[t[33]||(t[33]=e("strong",null,"Estado:",-1)),e("span",{class:b("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-1 "+G(s.value.venta.estado))},r(K(s.value.venta.estado)),3)])])]),e("div",ra,[e("div",ia,[n(a(c),{icon:a(ye),class:"text-yellow-500 text-sm mt-0.5"},null,8,["icon"]),e("div",da,[t[35]||(t[35]=e("strong",null,"Importante:",-1)),g(" "+r(s.value.importante),1)])])])])):B("",!0)]}),_:1},8,["visible","style","header"])]),_:1}))}};export{ba as default};
