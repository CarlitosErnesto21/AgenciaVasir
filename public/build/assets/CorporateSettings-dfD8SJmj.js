import{r as b,E as H,b as Q,w as O,n as j,c as y,d as h,e as o,p as l,$ as i,v as V,q as v,a9 as E,j as z,F as be,l as ve,y as K,t as U,h as fe,a5 as xe}from"./vendor-gbh1WW5n.js";import{z as he,F as u,a as we}from"./ui-BrU4k96Z.js";import{av as ye,at as X,ax as Ve,ay as Ee,az as Y,k as F,v as Z,l as Ce,Q as Se,aA as Ne,c as ke}from"./index-BL4yA-eF.js";import ee from"./UnsavedChangesModal-Cc9oe3lX.js";const De={class:"bg-white rounded-lg shadow-lg overflow-hidden"},_e={class:"bg-gradient-to-br from-red-600 via-red-700 to-red-800 px-4 sm:px-6 lg:px-8 py-6 sm:py-8 relative overflow-hidden"},Te={class:"relative"},Oe={class:"text-xl sm:text-2xl lg:text-3xl font-bold text-white flex items-center mb-2"},Je={class:"bg-gradient-to-br from-blue-500 to-blue-600 p-2 rounded-xl mr-3 shadow-lg"},Ae={class:"p-3 sm:p-4 lg:p-5"},qe={class:"space-y-4"},Ie={class:"bg-gradient-to-br from-white to-red-50/50 rounded-2xl p-6 border border-red-100/50 shadow-lg hover:shadow-xl transition-all duration-300"},$e={class:"flex items-center mb-6"},je={class:"bg-gradient-to-br from-red-500 to-red-600 p-3 rounded-xl shadow-lg mr-4"},ze={class:"mb-6"},Ue={class:"flex items-center text-sm font-semibold text-gray-700 mb-3"},Fe={class:"bg-gradient-to-br from-red-500 to-red-600 p-1.5 rounded-lg mr-2"},Me={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Re={class:"bg-gradient-to-br from-blue-50/50 to-white rounded-xl p-4 border border-blue-100/50"},Be={class:"flex items-center text-sm font-semibold text-gray-700 mb-3"},Pe={class:"bg-gradient-to-br from-blue-500 to-blue-600 p-1.5 rounded-lg mr-2"},Ge={class:"bg-gradient-to-br from-red-50/50 to-white rounded-xl p-4 border border-red-100/50"},Le={class:"flex items-center text-sm font-semibold text-gray-700 mb-3"},We={class:"bg-gradient-to-br from-red-500 to-red-600 p-1.5 rounded-lg mr-2"},He={class:"bg-gradient-to-br from-gray-50 to-red-50/30 rounded-2xl p-6 border border-red-100/50 shadow-lg"},Qe={class:"flex items-center justify-between mb-6"},Ke={class:"flex items-center"},Xe={class:"bg-gradient-to-br from-blue-500 to-blue-600 p-3 rounded-xl shadow-lg mr-4"},Ye={key:0,class:"bg-gradient-to-br from-white to-red-50/30 rounded-xl p-5 mb-4 border-2 border-red-200/50 shadow-lg"},Ze={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},et={class:"flex gap-2 mt-3"},tt=["disabled"],ot={class:"max-h-48 overflow-y-auto"},st={key:0,class:"flex items-start justify-between"},it={class:"flex-1 mr-3"},rt={class:"flex items-center gap-2"},lt={class:"text-sm font-semibold text-gray-800"},at={class:"text-xs text-gray-600 mt-1 line-clamp-2"},nt={class:"flex gap-1 flex-shrink-0"},dt=["onClick"],ut=["onClick"],ct={key:1,class:"space-y-2"},pt=["disabled"],mt={key:0,class:"text-center py-12"},gt={class:"bg-gradient-to-br from-purple-100 to-purple-200 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6 shadow-lg"},bt={class:"flex flex-col sm:flex-row sm:justify-end gap-4 mt-8 pt-6 border-t border-gradient-to-r from-transparent via-gray-200 to-transparent"},vt=["disabled"],ft=["disabled"],Vt={__name:"CorporateSettings",props:{settings:{type:Object,required:!0},companyValues:{type:Array,default:()=>[]},isSaving:{type:Boolean,default:!1}},emits:["save","reset","unsaved-changes","settings-updated"],setup(S,{emit:te}){const C=S,M=te,R=he(),g=b(!1),p=b({}),J=b({}),N=b(!1),B=s=>{if(!s)return;const e={description:s.description||"",mission:s.mission||"",vision:s.vision||"",...s};J.value=JSON.parse(JSON.stringify(e)),p.value=JSON.parse(JSON.stringify(e)),g.value=!1,N.value=!0},oe=H(()=>g.value),se=H(()=>g.value),f=b(!1),w=b(null),k=b(!1),D=b(!1),_=b(null),a=Q({titulo:"",descripcion:""}),d=Q({titulo:"",descripcion:""}),A=b([]),r=b([]),q=()=>{A.value=JSON.parse(JSON.stringify(C.companyValues)),r.value=JSON.parse(JSON.stringify(C.companyValues))},ie=()=>{const s=JSON.stringify(A.value),e=JSON.stringify(r.value);return s!==e},T=()=>{const s=JSON.stringify(p.value)!==JSON.stringify(J.value),e=ie(),t=f.value&&(a.titulo||a.descripcion),n=w.value!==null;g.value=s||e||t||n};O([p,r,f,a,w],()=>{N.value&&j(()=>{T()})},{deep:!0,flush:"post"}),O(()=>C.companyValues,s=>{g.value||q()},{immediate:!0,deep:!0}),O(()=>C.settings,s=>{g.value||(N.value=!1,B(s))},{immediate:!0,deep:!0}),O(g,s=>{M("unsaved-changes",s)});const re=async()=>{try{const s=g.value;g.value=!1;const e={description:p.value.description,mission:p.value.mission,vision:p.value.vision,companyValues:{new:r.value.filter(t=>t.isNew&&!t.isDeleted).map(t=>({titulo:t.titulo,descripcion:t.descripcion})),updated:r.value.filter(t=>t.isModified&&!t.isDeleted&&!t.isNew).map(t=>({id:t.id,titulo:t.titulo,descripcion:t.descripcion})),deleted:A.value.filter(t=>r.value.find(n=>n.id===t.id&&n.isDeleted)).map(t=>t.id)}};xe.post(route("settings.update"),e,{onSuccess:()=>{J.value=JSON.parse(JSON.stringify(p.value));const t=r.value.filter(n=>!n.isDeleted).map(n=>({id:n.id,titulo:n.titulo,descripcion:n.descripcion}));r.value=t,A.value=JSON.parse(JSON.stringify(t)),I(),$(),M("settings-updated"),j(()=>{T()})},onError:t=>{g.value=s,console.error("Error al guardar configuración corporativa:",t);const n=m=>{const c={"The mission field is required.":"El campo de misión es obligatorio.","The vision field is required.":"El campo de visión es obligatorio.","The description field is required.":"El campo de descripción es obligatorio.","The title field is required.":"El campo de título es obligatorio.",required:"es obligatorio","field is required":"es obligatorio"};return c[m]?c[m]:m.includes("field is required")?m.replace("field is required","es obligatorio").replace("The ","El campo "):m};let x="Error al guardar la configuración corporativa.";if(t&&typeof t=="object"){const m=[];if(t.mission){const c=Array.isArray(t.mission)?t.mission[0]:t.mission;m.push("• Misión: "+n(c))}if(t.vision){const c=Array.isArray(t.vision)?t.vision[0]:t.vision;m.push("• Visión: "+n(c))}if(t.description){const c=Array.isArray(t.description)?t.description[0]:t.description;m.push("• Descripción: "+n(c))}Object.keys(t).forEach(c=>{if(c.startsWith("company_values.")){const G=c.split(".")[1],L=c.split(".")[2],W=Array.isArray(t[c])?t[c][0]:t[c];L==="title"?m.push(`• Valor corporativo ${parseInt(G)+1} - Título: ${n(W)}`):L==="description"&&m.push(`• Valor corporativo ${parseInt(G)+1} - Descripción: ${n(W)}`)}}),m.length>0&&(x=`Por favor corrija los siguientes errores:

`+m.join(`
`))}R.add({severity:"error",summary:"Error de Validación",detail:x,life:6e3})}})}catch(s){console.error("Error al guardar configuración corporativa:",s),R.add({severity:"error",summary:"Error Interno",detail:"Ocurrió un error inesperado al guardar la configuración. Por favor, inténtalo de nuevo.",life:5e3})}},le=()=>{g.value?k.value=!0:P()},P=()=>{N.value=!1,p.value=JSON.parse(JSON.stringify(J.value)),g.value=!1,q(),I(),$(),N.value=!0},ae=()=>{k.value=!1,P()},ne=()=>{k.value=!1},de=()=>{if(!a.titulo||!a.descripcion)return;const s={id:`temp_${Date.now()}`,titulo:a.titulo,descripcion:a.descripcion,isNew:!0};r.value.push(s),a.titulo="",a.descripcion="",f.value=!1,T()},I=()=>{a.titulo="",a.descripcion="",f.value=!1},ue=s=>{w.value=s.id,d.titulo=s.titulo,d.descripcion=s.descripcion,j(()=>{setTimeout(()=>{const e=document.querySelector(`.value-container-${s.id}`);e&&e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)})},ce=()=>{if(!d.titulo||!d.descripcion)return;const s=r.value.findIndex(e=>e.id===w.value);s!==-1&&(r.value[s].titulo=d.titulo,r.value[s].descripcion=d.descripcion,r.value[s].isNew||(r.value[s].isModified=!0)),w.value=null,d.titulo="",d.descripcion="",T()},$=()=>{w.value=null,d.titulo="",d.descripcion=""},pe=s=>{_.value=s,D.value=!0},me=()=>{if(!_.value)return;const s=r.value.findIndex(e=>e.id===_.value);s!==-1&&(r.value[s].isNew?r.value.splice(s,1):r.value[s].isDeleted=!0),T(),D.value=!1,_.value=null},ge=()=>{D.value=!1,_.value=null};return O([()=>C.settings,()=>C.companyValues],([s,e])=>{s&&B(s),e&&q()},{deep:!0}),q(),(s,e)=>(h(),y("div",De,[o("div",_e,[e[13]||(e[13]=o("div",{class:"absolute inset-0 bg-gradient-to-r from-blue-500/10 via-white/5 to-blue-500/10"},null,-1)),o("div",Te,[o("h1",Oe,[o("div",Je,[l(i(u),{icon:i(ye),class:"w-5 h-5 sm:w-6 sm:h-6 text-white"},null,8,["icon"])]),e[11]||(e[11]=o("span",{class:"bg-gradient-to-r from-white to-red-100 bg-clip-text text-transparent"},[o("span",{class:"hidden sm:inline"},"Información Corporativa"),o("span",{class:"sm:hidden"},"Info Corporativa")],-1))]),e[12]||(e[12]=o("p",{class:"text-red-100 text-sm sm:text-base ml-14 hidden sm:block font-medium"},"Gestión integral de identidad y valores empresariales",-1))])]),o("div",Ae,[o("div",qe,[o("div",Ie,[o("div",$e,[o("div",je,[l(i(u),{icon:i(X),class:"w-5 h-5 text-white"},null,8,["icon"])]),e[14]||(e[14]=o("div",null,[o("h3",{class:"text-lg font-bold text-gray-900 mb-1"},"Identidad Empresarial"),o("p",{class:"text-sm text-red-600 font-medium"},"Definición de propósito y valores")],-1))]),o("div",ze,[o("label",Ue,[o("div",Fe,[l(i(u),{icon:i(X),class:"w-3 h-3 text-white"},null,8,["icon"])]),e[15]||(e[15]=v(" Descripción de la Empresa "))]),V(o("textarea",{"onUpdate:modelValue":e[0]||(e[0]=t=>p.value.description=t),rows:"4",class:"w-full px-4 py-4 text-sm border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-red-500/20 focus:border-red-500 resize-none shadow-md hover:shadow-lg transition-all duration-300 bg-gradient-to-br from-white to-red-50/10",placeholder:"Describe la identidad, propósito y servicios que ofrece la empresa a sus clientes..."},null,512),[[E,p.value.description]])]),o("div",Me,[o("div",Re,[o("label",Be,[o("div",Pe,[l(i(u),{icon:i(Ve),class:"w-3 h-3 text-white"},null,8,["icon"])]),e[16]||(e[16]=v(" Misión Corporativa "))]),V(o("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>p.value.mission=t),rows:"4",class:"w-full px-4 py-3 text-sm border-2 border-blue-200/50 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 resize-none shadow-sm hover:shadow-md transition-all duration-300 bg-white/80",placeholder:"Defina el propósito fundamental y los objetivos principales de la empresa..."},null,512),[[E,p.value.mission]])]),o("div",Ge,[o("label",Le,[o("div",We,[l(i(u),{icon:i(Ee),class:"w-3 h-3 text-white"},null,8,["icon"])]),e[17]||(e[17]=v(" Visión Corporativa "))]),V(o("textarea",{"onUpdate:modelValue":e[2]||(e[2]=t=>p.value.vision=t),rows:"4",class:"w-full px-4 py-3 text-sm border-2 border-red-200/50 rounded-xl focus:ring-4 focus:ring-red-500/20 focus:border-red-500 resize-none shadow-sm hover:shadow-md transition-all duration-300 bg-white/80",placeholder:"Describa las aspiraciones a largo plazo y el futuro deseado de la empresa..."},null,512),[[E,p.value.vision]])])])]),o("div",He,[o("div",Qe,[o("div",Ke,[o("div",Xe,[l(i(u),{icon:i(Y),class:"w-5 h-5 text-white"},null,8,["icon"])]),e[18]||(e[18]=o("div",null,[o("h3",{class:"text-lg font-bold text-gray-900 mb-1"},"Valores Corporativos"),o("p",{class:"text-sm text-blue-600 font-medium"},"Principios y ética empresarial")],-1))]),o("button",{onClick:e[3]||(e[3]=t=>f.value=!f.value),type:"button",class:"group px-4 py-2.5 text-sm bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-700 hover:to-red-700 transition-all duration-300 flex items-center shadow-lg hover:shadow-xl transform hover:scale-105 font-semibold"},[l(i(u),{icon:i(F),class:"w-3 h-3 mr-2 group-hover:scale-110 transition-transform"},null,8,["icon"]),e[19]||(e[19]=o("span",{class:"hidden sm:inline"},"Agregar Valor",-1)),e[20]||(e[20]=o("span",{class:"sm:hidden"},"Agregar",-1))])]),f.value?(h(),y("div",Ye,[o("div",Ze,[o("div",null,[e[21]||(e[21]=o("label",{class:"block text-xs font-semibold text-gray-600 mb-2 uppercase tracking-wider"},"Título del Valor",-1)),V(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>a.titulo=t),type:"text",maxlength:"100",class:"w-full px-4 py-3 text-sm border-2 border-red-200/50 rounded-xl focus:ring-4 focus:ring-red-500/20 focus:border-red-500 transition-all duration-300 bg-white/80 shadow-sm hover:shadow-md",placeholder:"Ej: Integridad, Excelencia, Compromiso"},null,512),[[E,a.titulo]])]),o("div",null,[e[22]||(e[22]=o("label",{class:"block text-xs font-semibold text-gray-600 mb-2 uppercase tracking-wider"},"Descripción",-1)),V(o("textarea",{"onUpdate:modelValue":e[5]||(e[5]=t=>a.descripcion=t),rows:"2",maxlength:"500",class:"w-full px-4 py-3 text-sm border-2 border-blue-200/50 rounded-xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 resize-none transition-all duration-300 bg-white/80 shadow-sm hover:shadow-md",placeholder:"Explique qué significa este valor para la empresa..."},null,512),[[E,a.descripcion]])])]),o("div",et,[o("button",{onClick:de,disabled:!a.titulo||!a.descripcion,type:"button",class:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all duration-200 flex items-center shadow-sm hover:shadow-md"},[l(i(u),{icon:i(F),class:"w-3 h-3 mr-2"},null,8,["icon"]),e[23]||(e[23]=v(" Agregar "))],8,tt),o("button",{onClick:I,type:"button",class:"px-4 py-2 text-sm border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 flex items-center"},[l(i(u),{icon:i(Z),class:"w-3 h-3 mr-2"},null,8,["icon"]),e[24]||(e[24]=v(" Cancelar "))])])])):z("",!0),o("div",ot,[(h(!0),y(be,null,ve(r.value.filter(t=>!t.isDeleted),(t,n)=>(h(),y("div",{key:t.id,class:K([`value-container-${t.id}`,"bg-gradient-to-br from-white to-gray-50/30 rounded-xl p-5 mb-4 border-2 border-gray-200/50 hover:border-purple-300/70 hover:shadow-lg transition-all duration-300 shadow-md group",{"border-green-400/70 bg-gradient-to-br from-green-50 to-white shadow-green-100":t.isNew,"border-blue-400/70 bg-gradient-to-br from-blue-50 to-white shadow-blue-100":t.isModified}])},[w.value!==t.id?(h(),y("div",st,[o("div",it,[o("div",rt,[o("h5",lt,U(t.titulo),1)]),o("p",at,U(t.descripcion),1)]),o("div",nt,[o("button",{onClick:x=>ue(t),type:"button",class:"px-3 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 flex items-center hover:shadow",title:"Editar valor"},[l(i(u),{icon:i(Ce),class:"mr-1"},null,8,["icon"]),e[25]||(e[25]=v(" Editar "))],8,dt),o("button",{onClick:x=>pe(t.id),type:"button",class:"px-3 py-2 text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors duration-200 flex items-center hover:shadow",title:"Eliminar valor"},[l(i(u),{icon:i(Se),class:"mr-1"},null,8,["icon"]),e[26]||(e[26]=v(" Eliminar "))],8,ut)])])):(h(),y("div",ct,[V(o("input",{"onUpdate:modelValue":e[6]||(e[6]=x=>d.titulo=x),type:"text",maxlength:"100",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Título"},null,512),[[E,d.titulo]]),V(o("textarea",{"onUpdate:modelValue":e[7]||(e[7]=x=>d.descripcion=x),rows:"2",maxlength:"500",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",placeholder:"Descripción"},null,512),[[E,d.descripcion]]),o("div",{class:K(["flex gap-2",`edit-buttons-${t.id}`])},[o("button",{onClick:ce,disabled:!d.titulo||!d.descripcion,type:"button",class:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all duration-200 flex items-center shadow-sm hover:shadow-md"},[l(i(u),{icon:i(Ne),class:"w-3 h-3 mr-2"},null,8,["icon"]),e[27]||(e[27]=v(" Guardar "))],8,pt),o("button",{onClick:$,type:"button",class:"px-4 py-2 text-sm border border-blue-500 text-white rounded-lg bg-blue-500 hover:bg-blue-600 transition-all duration-200 flex items-center"},[l(i(u),{icon:i(Z),class:"w-3 h-3 mr-2"},null,8,["icon"]),e[28]||(e[28]=v(" Cancelar "))])],2)]))],2))),128)),r.value.filter(t=>!t.isDeleted).length===0?(h(),y("div",mt,[o("div",gt,[l(i(u),{icon:i(Y),class:"w-10 h-10 text-purple-500"},null,8,["icon"])]),e[30]||(e[30]=o("h4",{class:"text-lg font-bold text-gray-700 mb-2"},"No hay valores corporativos definidos",-1)),e[31]||(e[31]=o("p",{class:"text-sm text-gray-500 mb-4 max-w-md mx-auto"},"Los valores corporativos definen la cultura y principios éticos de la empresa",-1)),o("button",{onClick:e[8]||(e[8]=t=>f.value=!0),class:"px-6 py-3 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-xl hover:from-purple-700 hover:to-purple-800 transition-all duration-300 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105"},[l(i(u),{icon:i(F),class:"mr-2"},null,8,["icon"]),e[29]||(e[29]=v(" Agregar Primer Valor "))])])):z("",!0)])])]),o("div",bt,[o("button",{onClick:le,disabled:!se.value||S.isSaving,type:"button",class:"px-6 py-3 text-sm border-2 border-blue-500 text-white rounded-xl bg-blue-500 hover:bg-blue-600 hover:border-blue-600 hover:shadow-lg disabled:bg-gray-100 disabled:text-gray-400 disabled:border-gray-200 disabled:cursor-not-allowed transition-all duration-300 font-semibold transform hover:scale-105"}," Restablecer ",8,vt),o("button",{onClick:re,disabled:!oe.value||S.isSaving,type:"button",class:"px-8 py-3 text-sm bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl hover:from-red-700 hover:to-red-800 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center font-semibold shadow-lg hover:shadow-xl transform hover:scale-105"},[S.isSaving?(h(),fe(i(u),{key:0,icon:i(ke),class:"animate-spin mr-3 w-4 h-4"},null,8,["icon"])):z("",!0),v(" "+U(S.isSaving?"Guardando configuración...":"Guardar Configuración"),1)],8,ft)])]),l(ee,{visible:k.value,"onUpdate:visible":e[9]||(e[9]=t=>k.value=t),title:"¿Restablecer todos los cambios?",message:"Esta acción restablecerá todos los campos a sus valores originales.",subtitle:"Los cambios no guardados se perderán.",continueText:"Cancelar",exitText:"Restablecer",onContinueEditing:ne,onExitWithoutSaving:ae},null,8,["visible"]),l(ee,{visible:D.value,"onUpdate:visible":e[10]||(e[10]=t=>D.value=t),title:"¿Eliminar valor corporativo?",message:"¿Estás seguro de que deseas eliminar este valor corporativo?",subtitle:"Esta acción no se puede deshacer una vez que guardes los cambios.",continueText:"Cancelar",exitText:"Eliminar",onContinueEditing:ge,onExitWithoutSaving:me},null,8,["visible"]),l(i(we))]))}};export{Vt as default};
