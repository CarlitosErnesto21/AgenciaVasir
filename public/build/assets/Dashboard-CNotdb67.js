import{A as oe}from"./AuthenticatedLayout-yva5xhgW.js";import{c as d,d as i,e,p,t as l,y,x as w,$ as h,a1 as I,q as Z,j as le,F as V,l as z,k as ie,E as ne,h as q,r as v,o as de,a0 as re,N as T}from"./vendor-BiysG-4G.js";import{s as G}from"./app-l6C6JTmy.js";import{A as J}from"./ui-CyD9Ijjf.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{e as K}from"./index-DRTZt2OH.js";const me={},ue={class:"flex justify-center items-center py-12"};function xe(a,b){return i(),d("div",ue,b[0]||(b[0]=[e("div",{class:"text-center"},[e("i",{class:"pi pi-spin pi-spinner text-5xl text-[#d7263d] mb-4"}),e("p",{class:"text-[#d7263d] text-lg font-semibold"},"Cargando datos del dashboard...")],-1)]))}const fe=ce(me,[["render",xe]]),be={class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},pe={class:"bg-gradient-to-br from-[#e2a5a5] via-[#d7a1a1] to-[#c98585] rounded-xl shadow-md border border-[#d7a1a1] p-4 sm:p-6 transition-all duration-200 hover:scale-105"},ge={class:"flex items-center justify-between"},ve={class:"min-w-0 flex-1"},he={class:"text-[#7b1f26] text-xs sm:text-sm font-medium opacity-90 truncate"},ye={class:"text-[#7b1f26] text-lg sm:text-2xl font-bold mt-1"},we={class:"p-1.5 sm:p-2 bg-white bg-opacity-30 rounded-lg flex-shrink-0 ml-2"},_e={class:"bg-gradient-to-br from-[#ffe082] via-[#ffd54f] to-[#ffca28] rounded-xl shadow-md border border-[#ffd54f] p-4 sm:p-6 transition-all duration-200 hover:scale-105"},$e={class:"flex items-center justify-between"},ke={class:"min-w-0 flex-1"},Ce={class:"text-[#a68700] text-xs sm:text-sm font-medium opacity-90 truncate"},je={class:"text-[#a68700] text-lg sm:text-2xl font-bold mt-1"},De={class:"hidden sm:inline"},Se={class:"sm:hidden"},Re={class:"p-1.5 sm:p-2 bg-white bg-opacity-30 rounded-lg flex-shrink-0 ml-2"},Me={class:"flex items-center justify-between"},Ae={class:"min-w-0 flex-1"},Le={class:"text-[#512da8] text-xs sm:text-sm font-medium opacity-90 truncate"},Be={class:"text-[#512da8] text-lg sm:text-2xl font-bold mt-1"},Fe={class:"p-1.5 sm:p-2 bg-white bg-opacity-30 rounded-lg flex-shrink-0 ml-2"},Pe={class:"flex items-center justify-between"},Te={class:"min-w-0 flex-1"},Ve={class:"text-[#1565c0] text-xs sm:text-sm font-medium opacity-90 truncate"},Ee={class:"text-[#1565c0] text-lg sm:text-2xl font-bold mt-1"},Oe={class:"p-1.5 sm:p-2 bg-white bg-opacity-30 rounded-lg flex-shrink-0 ml-2"},Ne={__name:"MetricasCard",props:{metrics:{type:Array,required:!0},dashboardData:{type:Object,required:!0},formatValueForMobile:{type:Function,required:!0}},setup(a){return(b,t)=>(i(),d("div",be,[e("div",pe,[e("div",ge,[e("div",ve,[e("p",he,l(a.metrics[0].label),1),e("p",ye,l(a.metrics[0].value),1)]),e("div",we,[e("i",{class:y(a.metrics[0].icon+" text-[#7b1f26] text-lg sm:text-xl")},null,2)])])]),e("div",_e,[e("div",$e,[e("div",ke,[e("p",Ce,l(a.metrics[1].label),1),e("p",je,[e("span",De,l(a.metrics[1].value),1),e("span",Se,l(a.formatValueForMobile(a.metrics[1].value,a.dashboardData.inventario)),1)])]),e("div",Re,[e("i",{class:y(a.metrics[1].icon+" text-[#a68700] text-lg sm:text-xl")},null,2)])])]),p(h(I),{href:"/gestion-reserva-tours",class:"bg-gradient-to-br from-[#b39ddb] via-[#9575cd] to-[#7e57c2] rounded-xl shadow-md border border-[#9575cd] p-4 sm:p-6 cursor-pointer transform transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 block"},{default:w(()=>[e("div",Me,[e("div",Ae,[e("p",Le,l(a.metrics[2].label),1),e("p",Be,l(a.metrics[2].value),1),t[0]||(t[0]=e("p",{class:"text-[#512da8] text-xs opacity-80 mt-1 hidden sm:block"},"Click para ver todas",-1)),t[1]||(t[1]=e("p",{class:"text-[#512da8] text-xs opacity-80 mt-1 sm:hidden"},"Tap aquí",-1))]),e("div",Fe,[e("i",{class:y(a.metrics[2].icon+" text-[#512da8] text-lg sm:text-xl")},null,2)])])]),_:1}),p(h(I),{href:"/tours",class:"bg-gradient-to-br from-[#90caf9] via-[#64b5f6] to-[#42a5f5] rounded-xl shadow-md border border-[#64b5f6] p-4 sm:p-6 cursor-pointer transform transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 block"},{default:w(()=>[e("div",Pe,[e("div",Te,[e("p",Ve,l(a.metrics[3].label),1),e("p",Ee,l(a.metrics[3].value),1),t[2]||(t[2]=e("p",{class:"text-[#1565c0] text-xs opacity-80 mt-1 hidden sm:block"},"Click para gestionar",-1)),t[3]||(t[3]=e("p",{class:"text-[#1565c0] text-xs opacity-80 mt-1 sm:hidden"},"Tap aquí",-1))]),e("div",Oe,[e("i",{class:y(a.metrics[3].icon+" text-[#1565c0] text-lg sm:text-xl")},null,2)])])]),_:1})]))}},qe={class:"lg:space-y-4 grid grid-cols-2 lg:grid-cols-1 gap-3 lg:gap-4"},Ie={class:"flex items-stretch min-w-0"},ze={class:"flex-1 p-4 sm:p-6 flex flex-col justify-center min-w-0"},He={class:"flex items-center justify-between min-w-0"},Ue={class:"min-w-0 flex-1 font-sans"},We={class:"text-xs sm:text-sm font-medium text-gray-700 truncate"},Ze={class:"text-lg sm:text-xl font-bold text-gray-900 mt-1"},Ge={class:"flex items-center justify-center shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-white/40 rounded-full overflow-hidden ml-2"},Ye={class:"flex items-stretch min-w-0"},Je={class:"flex-1 p-4 sm:p-6 flex flex-col justify-center min-w-0"},Ke={class:"flex items-center justify-between min-w-0"},Qe={class:"min-w-0 flex-1 font-sans"},Xe={class:"text-xs sm:text-sm font-medium text-gray-700 truncate"},et={class:"text-lg sm:text-xl font-bold text-gray-900 mt-1"},tt={class:"flex items-center justify-center shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-white/40 rounded-full overflow-hidden ml-2"},st={class:"p-0 rounded-2xl border-2 border-solid col-span-2 lg:col-span-1 bg-gradient-to-br from-[#b2f7e7] via-[#a0f2da] to-[#7ae6c8] shadow-md border-[#a0f2da] transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 cursor-pointer max-w-full"},at={class:"flex items-stretch min-w-0"},ot={class:"flex-1 p-4 sm:p-6 flex flex-col justify-center min-w-0"},lt={class:"flex items-center justify-between min-w-0"},it={class:"min-w-0 flex-1 font-sans"},nt={class:"text-xs sm:text-sm font-medium text-gray-700 truncate"},dt={class:"text-lg sm:text-xl font-bold text-gray-900 mt-1"},rt={class:"hidden sm:inline"},ct={class:"sm:hidden"},mt={class:"flex items-center justify-center shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-white/40 rounded-full overflow-hidden ml-2"},ut={__name:"WidgetsSecundarios",props:{widgets:{type:Array,required:!0},dashboardData:{type:Object,required:!0},formatValueForMobile:{type:Function,required:!0}},emits:["toggle-reservas-modal","toggle-stock-modal"],setup(a){return(b,t)=>(i(),d("div",qe,[e("div",{class:"p-0 rounded-2xl border-2 border-solid bg-gradient-to-br from-[#f7e7b2] via-[#f2daa0] to-[#e6c87a] shadow-md border-[#f2daa0] transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 cursor-pointer max-w-full",onClick:t[0]||(t[0]=s=>b.$emit("toggle-reservas-modal"))},[e("div",Ie,[t[5]||(t[5]=e("div",{class:"hidden md:block w-2 rounded-l-2xl bg-yellow-400"},null,-1)),e("div",ze,[e("div",He,[e("div",Ue,[e("p",We,l(a.widgets[0].title),1),t[2]||(t[2]=e("hr",{class:"my-2 border-t-2 border-gray-200 opacity-30"},null,-1)),e("p",Ze,l(a.widgets[0].value),1),t[3]||(t[3]=e("p",{class:"text-xs text-gray-500 mt-1 hidden sm:block"},"Click para ver detalles",-1)),t[4]||(t[4]=e("p",{class:"text-xs text-gray-500 mt-1 sm:hidden"},"Tap detalles",-1))]),e("div",Ge,[e("i",{class:y(a.widgets[0].icon+" text-base sm:text-xl "+a.widgets[0].iconColor)},null,2)])])])])]),e("div",{class:"p-0 rounded-2xl border-2 border-solid bg-gradient-to-br from-[#f5b8b8] via-[#e7a6a6] to-[#d88a8a] shadow-md border-[#e7a6a6] transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95 cursor-pointer max-w-full",onClick:t[1]||(t[1]=s=>b.$emit("toggle-stock-modal"))},[e("div",Ye,[t[9]||(t[9]=e("div",{class:"hidden md:block w-2 rounded-l-2xl bg-red-400"},null,-1)),e("div",Je,[e("div",Ke,[e("div",Qe,[e("p",Xe,l(a.widgets[1].title),1),t[6]||(t[6]=e("hr",{class:"my-2 border-t-2 border-gray-200 opacity-30"},null,-1)),e("p",et,l(a.widgets[1].value),1),t[7]||(t[7]=e("p",{class:"text-xs text-gray-500 mt-1 hidden sm:block"},"Click para ver productos",-1)),t[8]||(t[8]=e("p",{class:"text-xs text-gray-500 mt-1 sm:hidden"},"Ver productos",-1))]),e("div",tt,[e("i",{class:y(a.widgets[1].icon+" text-base sm:text-xl "+a.widgets[1].iconColor)},null,2)])])])])]),e("div",st,[e("div",at,[t[11]||(t[11]=e("div",{class:"hidden md:block w-2 rounded-l-2xl bg-green-400"},null,-1)),e("div",ot,[e("div",lt,[e("div",it,[e("p",nt,l(a.widgets[2].title),1),t[10]||(t[10]=e("hr",{class:"my-2 border-t-2 border-gray-200 opacity-30"},null,-1)),e("p",dt,[e("span",rt,l(a.widgets[2].value),1),e("span",ct,l(a.formatValueForMobile(a.widgets[2].value,a.dashboardData.inventario)),1)])]),e("div",mt,[e("i",{class:y(a.widgets[2].icon+" text-base sm:text-xl "+a.widgets[2].iconColor)},null,2)])])])])])]))}},xt={class:"bg-gray-50 rounded-lg shadow-xl border border-gray-100 p-4 sm:p-6"},ft={class:"space-y-2 sm:space-y-3 max-h-48 sm:max-h-64 overflow-y-auto"},bt={class:"flex items-center space-x-2 sm:space-x-3 min-w-0 flex-1"},pt={class:"min-w-0 flex-1"},gt={class:"text-xs sm:text-sm font-medium text-gray-900 truncate"},vt={class:"text-xs text-gray-500"},ht={class:"text-xs sm:text-sm font-semibold text-yellow-600 flex-shrink-0 ml-2"},yt={class:"hidden sm:inline"},wt={class:"sm:hidden"},_t={class:"flex items-center space-x-2 sm:space-x-3 min-w-0 flex-1"},$t={class:"min-w-0 flex-1"},kt={class:"text-xs sm:text-sm font-medium text-gray-900 truncate"},Ct={class:"text-xs text-gray-500 truncate"},jt={class:"hidden sm:inline"},Dt={class:"sm:hidden"},St={key:0,class:"text-center py-6 sm:py-8"},Rt={__name:"ActividadReciente",props:{dashboardData:{type:Object,required:!0},formatValueForMobile:{type:Function,required:!0}},setup(a){return(b,t)=>(i(),d("div",xt,[t[2]||(t[2]=e("h3",{class:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 tracking-wide"},[e("i",{class:"pi pi-clock text-blue-500 mr-2"}),Z(" Actividad Reciente ")],-1)),e("div",ft,[(i(!0),d(V,null,z((a.dashboardData.ventas||[]).slice(0,3),s=>(i(),d("div",{key:"venta-"+s.id,class:"flex items-center justify-between p-2 sm:p-3 bg-white rounded-lg border border-gray-100 shadow-sm"},[e("div",bt,[t[0]||(t[0]=e("div",{class:"p-1.5 sm:p-2 bg-yellow-100 rounded-full flex-shrink-0"},[e("i",{class:"pi pi-shopping-cart text-yellow-500 text-xs sm:text-sm"})],-1)),e("div",pt,[e("p",gt,"Venta #"+l(s.id),1),e("p",vt,l(new Date(s.fecha).toLocaleDateString("es-ES")),1)])]),e("span",ht,[e("span",yt,"$"+l(Number(s.total||0).toLocaleString("es-ES")),1),e("span",wt,"$"+l(a.formatValueForMobile("$"+(s.total||0))),1)])]))),128)),(i(!0),d(V,null,z((a.dashboardData.reservas||[]).slice(0,3),s=>(i(),d("div",{key:"reserva-"+s.id,class:y(["flex items-center justify-between p-2 sm:p-3 rounded-lg border shadow-sm bg-white",{"border-blue-100":s.estado&&s.estado.toLowerCase()==="pendiente","border-green-100":s.estado&&s.estado.toLowerCase()==="confirmada","border-red-100":s.estado&&s.estado.toLowerCase()==="rechazada","border-purple-100":s.estado&&s.estado.toLowerCase()==="completado"}])},[e("div",_t,[e("div",{class:y(["p-1.5 sm:p-2 rounded-full flex-shrink-0",{"bg-blue-100":s.estado&&s.estado.toLowerCase()==="pendiente","bg-green-100":s.estado&&s.estado.toLowerCase()==="confirmada","bg-red-100":s.estado&&s.estado.toLowerCase()==="rechazada","bg-purple-100":s.estado&&s.estado.toLowerCase()==="completado"}])},[e("i",{class:y(["pi pi-calendar text-xs sm:text-sm",{"text-blue-500":s.estado&&s.estado.toLowerCase()==="pendiente","text-green-500":s.estado&&s.estado.toLowerCase()==="confirmada","text-red-500":s.estado&&s.estado.toLowerCase()==="rechazada","text-purple-500":s.estado&&s.estado.toLowerCase()==="completado"}])},null,2)],2),e("div",$t,[e("p",kt,l(s.entidad_nombre||"Reserva"),1),e("p",Ct,l(s.cliente&&s.cliente.user&&s.cliente.user.name||s.cliente&&s.cliente.nombres||"Cliente no asignado"),1)])]),e("span",{class:y(["inline-flex px-2 sm:px-3 py-1 text-xs font-bold rounded-full flex-shrink-0 ml-2 shadow",{"bg-yellow-100 text-yellow-800":s.estado&&s.estado.toLowerCase()==="pendiente","bg-green-100 text-green-800":s.estado&&s.estado.toLowerCase()==="confirmada","bg-red-100 text-red-800":s.estado&&s.estado.toLowerCase()==="rechazada","bg-purple-100 text-purple-800":s.estado&&s.estado.toLowerCase()==="completado"}])},[e("span",jt,l(s.estado),1),e("span",Dt,l(s.estado?s.estado.substring(0,3):""),1)],2)],2))),128)),(!a.dashboardData.ventas||a.dashboardData.ventas.length===0)&&(!a.dashboardData.reservas||a.dashboardData.reservas.length===0)?(i(),d("div",St,t[1]||(t[1]=[e("i",{class:"pi pi-info-circle text-gray-400 text-xl sm:text-2xl mb-2"},null,-1),e("p",{class:"text-gray-500 text-xs sm:text-sm font-semibold"},"No hay actividad reciente",-1)]))):le("",!0)])]))}},Mt={class:"space-y-3 overflow-y-auto max-h-[60vh] sm:max-h-[70vh] px-2 sm:px-0"},At={key:0,class:"space-y-3"},Lt={class:"flex items-center justify-between"},Bt={class:"flex items-center space-x-3 flex-1 min-w-0"},Ft={class:"flex-1 min-w-0"},Pt={class:"font-medium text-gray-900 text-sm truncate"},Tt={class:"text-xs text-gray-600 truncate"},Vt={class:"text-xs text-gray-500"},Et={class:"text-right flex-shrink-0 ml-4"},Ot={class:"font-semibold text-gray-900 text-sm"},Nt={class:"text-xs text-amber-600"},qt={key:1,class:"text-center py-6 sm:py-8"},It={class:"flex justify-end gap-2 mt-4 pt-4 border-t border-gray-200"},zt={class:"space-y-3 overflow-y-auto max-h-[60vh] sm:max-h-[70vh] px-2 sm:px-0"},Ht={key:0,class:"space-y-3"},Ut={class:"flex items-center justify-between"},Wt={class:"flex items-center space-x-3 flex-1 min-w-0"},Zt={class:"flex-1 min-w-0"},Gt={class:"font-medium text-gray-900 text-sm truncate"},Yt={class:"text-xs text-gray-600 truncate"},Jt={class:"text-right flex-shrink-0 ml-4"},Kt={class:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2"},Qt={class:"px-2 py-1 bg-red-100 text-red-800 text-xs font-semibold rounded-full"},Xt={class:"text-xs text-gray-500"},es={class:"text-sm font-semibold text-gray-900 mt-1"},ts={key:1,class:"text-center py-6 sm:py-8"},ss={class:"flex justify-end gap-2 mt-4 pt-4 border-t border-gray-200"},as={__name:"ModalesInteractivos",props:{showReservasPendientesModal:{type:Boolean,required:!0},showProductosStockBajoModal:{type:Boolean,required:!0},dashboardData:{type:Object,required:!0}},emits:["close-reservas-modal","close-stock-modal"],setup(a){return(b,t)=>{const s=ie("Dialog");return i(),d(V,null,[p(s,{visible:a.showReservasPendientesModal,modal:"",draggable:!1,closable:!0,dismissableMask:!0,class:"mx-2 sm:mx-4",style:{width:"98vw",maxWidth:"36rem",maxHeight:"calc(100vh - 20px)",padding:"0"},baseZIndex:1e4,"onUpdate:visible":t[0]||(t[0]=o=>b.$emit("close-reservas-modal"))},{header:w(()=>t[2]||(t[2]=[e("div",{class:"flex items-center"},[e("i",{class:"pi pi-clock text-amber-500 mr-2"}),e("span",{class:"text-base sm:text-lg font-semibold text-gray-900"},"Reservas Pendientes")],-1)])),footer:w(()=>[e("div",It,[p(h(I),{href:"/gestion-reserva-tours",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},{default:w(()=>[p(h(J),{icon:h(K),class:"h-5 text-white"},null,8,["icon"]),t[5]||(t[5]=Z(" Ver Reservas "))]),_:1,__:[5]})])]),default:w(()=>[e("div",Mt,[a.dashboardData.reservas&&a.dashboardData.reservas.filter(o=>o.estado&&o.estado.toLowerCase()==="pendiente").length>0?(i(),d("div",At,[(i(!0),d(V,null,z(a.dashboardData.reservas.filter(o=>o.estado&&o.estado.toLowerCase()==="pendiente"),o=>(i(),d("div",{key:o.id,class:"bg-red-50 rounded-lg border border-red-200 hover:bg-red-100 transition-colors p-3 sm:p-4"},[e("div",Lt,[e("div",Bt,[t[3]||(t[3]=e("div",{class:"p-2 bg-red-100 rounded-full flex-shrink-0"},[e("i",{class:"pi pi-calendar text-red-600 text-sm"})],-1)),e("div",Ft,[e("h4",Pt,l(o.entidad_nombre||"Tour no especificado"),1),e("p",Tt,l(o.cliente&&o.cliente.user&&o.cliente.user.name||o.cliente&&o.cliente.nombres||"Cliente no asignado"),1),e("p",Vt,l(new Date(o.fecha_reserva||o.fecha).toLocaleDateString("es-ES")),1)])]),e("div",Et,[e("p",Ot,"$"+l(Number(o.total||0).toLocaleString("es-ES")),1),e("p",Nt,l(o.mayores_edad||0)+" adultos, "+l(o.menores_edad||0)+" niños",1)])])]))),128))])):(i(),d("div",qt,t[4]||(t[4]=[e("i",{class:"pi pi-check-circle text-green-400 text-3xl sm:text-4xl mb-3"},null,-1),e("p",{class:"text-gray-500 text-sm sm:text-base"},"¡Excelente! No hay reservas pendientes",-1)])))])]),_:1},8,["visible"]),p(s,{visible:a.showProductosStockBajoModal,modal:"",draggable:!1,closable:!0,dismissableMask:!0,class:"mx-2 sm:mx-4",style:{width:"98vw",maxWidth:"36rem",maxHeight:"calc(100vh - 20px)",padding:"0"},baseZIndex:1e4,"onUpdate:visible":t[1]||(t[1]=o=>b.$emit("close-stock-modal"))},{header:w(()=>t[6]||(t[6]=[e("div",{class:"flex items-center"},[e("i",{class:"pi pi-exclamation-triangle text-red-500 mr-2"}),e("span",{class:"text-base sm:text-lg font-semibold text-gray-900"},[e("span",{class:"hidden sm:inline"},"Productos con Stock Bajo"),e("span",{class:"sm:hidden"},"Stock Bajo")])],-1)])),footer:w(()=>[e("div",ss,[p(h(I),{href:"/productos",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},{default:w(()=>[p(h(J),{icon:h(K),class:"h-5 text-white"},null,8,["icon"]),t[9]||(t[9]=Z(" Gestionar Inventario "))]),_:1,__:[9]})])]),default:w(()=>[e("div",zt,[a.dashboardData.stockBajo&&a.dashboardData.stockBajo.length>0?(i(),d("div",Ht,[(i(!0),d(V,null,z(a.dashboardData.stockBajo,o=>{var f;return i(),d("div",{key:o.id,class:"bg-red-50 rounded-lg border border-red-200 hover:bg-red-100 transition-colors p-3 sm:p-4"},[e("div",Ut,[e("div",Wt,[t[7]||(t[7]=e("div",{class:"p-2 bg-red-100 rounded-full flex-shrink-0"},[e("i",{class:"pi pi-box text-red-600 text-sm"})],-1)),e("div",Zt,[e("h4",Gt,l(o.nombre),1),e("p",Yt,"Categoría: "+l(((f=o.categoria)==null?void 0:f.nombre)||"Sin categoría"),1)])]),e("div",Jt,[e("div",Kt,[e("span",Qt," Stock: "+l(o.stock_actual),1),e("span",Xt," Min: "+l(o.stock_minimo),1)]),e("p",es," $"+l(Number(o.precio||0).toLocaleString("es-ES")),1)])])])}),128))])):(i(),d("div",ts,t[8]||(t[8]=[e("i",{class:"pi pi-check-circle text-green-400 text-3xl sm:text-4xl mb-3"},null,-1),e("p",{class:"text-gray-500 text-sm sm:text-base"},"¡Perfecto! Todos los productos tienen stock suficiente",-1)])))])]),_:1},8,["visible"])],64)}}},os={class:"bg-gray-50 rounded-lg shadow-xl border border-[#fbeee6] p-4 sm:p-6 mt-4 sm:mt-6"},ls={class:"h-48 sm:h-64"},is={key:1,class:"flex items-center justify-center h-full"},ns={__name:"GraficosSection",props:{resumenReservasData:{type:Array,required:!1,default:()=>[]},reservasData:{type:Array,required:!1,default:()=>[]}},setup(a){const b=a,t={maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Tours Más Reservados",font:{size:18}},legend:{display:!0,position:"bottom",labels:{usePointStyle:!0,color:"#374151"}},tooltip:{callbacks:{label:function(o){return`${o.label}: ${o.parsed} reservas`}}}}},s=ne(()=>{const o={},f=b.resumenReservasData,r=b.reservasData;f&&f.length>0&&f.forEach(u=>{if(u.tipo==="tours"&&u.nombre){const g=(u.total_pendientes||0)+(u.total_confirmadas||0);if(g>0){const A=u.nombre.length>30?u.nombre.substring(0,27)+"...":u.nombre;o[A]=g}}}),Object.keys(o).length===0&&r&&r.length>0&&r.forEach(u=>{if(u.entidad_nombre){const g=u.entidad_nombre.length>30?u.entidad_nombre.substring(0,27)+"...":u.entidad_nombre;o[g]=(o[g]||0)+1}});let C=Object.entries(o).sort(([,u],[,g])=>g-u).slice(0,5);return C.length===0&&(C=[["Sin reservas",0]]),{labels:C.map(([u])=>u),datasets:[{label:"Tours Más Reservados",data:C.map(([,u])=>u),backgroundColor:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"]}]}});return(o,f)=>(i(),d("div",os,[f[1]||(f[1]=e("h3",{class:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4"},[e("i",{class:"pi pi-star text-yellow-500 mr-2"}),e("span",{class:"hidden sm:inline"},"Top 5 Tours Más Reservados"),e("span",{class:"sm:hidden"},"Top Tours")],-1)),e("div",ls,[s.value?(i(),q(h(G),{key:0,type:"doughnut",data:s.value,options:t,class:"w-full h-full"},null,8,["data"])):(i(),d("div",is,f[0]||(f[0]=[e("p",{class:"text-gray-500 text-xs sm:text-sm"},"No hay reservas registradas",-1)])))])]))}},ds={key:1,class:"px-2 sm:px-4 lg:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6 mt-1 sm:mt-1"},rs={class:"flex justify-between items-center"},cs=["disabled"],ms={class:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6"},us={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 sm:p-6"},xs={class:"h-48 sm:h-64"},fs={key:1,class:"flex items-center justify-center h-full"},bs={class:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 sm:p-6"},ps={class:"h-48 sm:h-64"},gs={key:1,class:"flex items-center justify-center h-full"},vs={class:"grid grid-cols-1 xl:grid-cols-2 gap-4 sm:gap-6"},hs=5*60*1e3,js={__name:"Dashboard",setup(a){const b=v(),t=v(),s=v(),o=v(),f=v(!0),r=v({}),C=v(null),u=v(null),g=v([{label:"Ventas Hoy",value:"0",icon:"pi pi-shopping-cart",color:"from-[#ef233c] to-[#d90429]",text:"text-[#7b1f26]",key:"ventas_hoy",category:"ventas",description:"Ventas del día"},{label:"Ingresos Hoy",value:"$0",icon:"pi pi-dollar",color:"from-[#ffd600] to-[#ffb700]",text:"text-[#a68700]",key:"ingresos_hoy",category:"ventas",description:"Ingresos del día"},{label:"Reservas del Mes",value:"0",icon:"pi pi-calendar-plus",color:"from-[#6c00f9] to-[#480ca8]",text:"text-[#240046]",key:"reservas_mes",category:"reservas",description:"Reservas este mes"},{label:"Tours Activos",value:"0",icon:"pi pi-map-marker",color:"from-[#0077b6] to-[#023e8a]",text:"text-[#03045e]",key:"tours_activos",category:"reservas",description:"Tours disponibles"}]),A=v([{title:"Reservas Pendientes",value:"0",icon:"pi pi-clock",color:"bg-[#fff3b0] border-[#ffd600]",iconColor:"text-[#ffd600]",key:"reservas_pendientes"},{title:"Productos Stock Bajo",value:"0",icon:"pi pi-exclamation-triangle",color:"bg-[#ffe5e5] border-[#ef233c]",iconColor:"text-[#d90429]",key:"productos_stock_bajo"},{title:"Valor Inventario",value:"$0",icon:"pi pi-wallet",color:"bg-[#e5daff] border-[#6c00f9]",iconColor:"text-[#480ca8]",key:"valor_total_inventario"},{title:"Clientes Activos",value:"0",icon:"pi pi-users",color:"bg-[#d0f1ff] border-[#0077b6]",iconColor:"text-[#023e8a]",key:"clientes_activos"}]),E=v(!1),O=v(!1),Q=()=>{E.value=!E.value},X=()=>{O.value=!O.value},H=(x,n=null)=>{if(x.includes("$")){let c;return n&&n.valor_total_inventario?c=parseFloat(n.valor_total_inventario):c=parseFloat(x.replace(/[$,.\s]/g,"")),isNaN(c)?"$0":c>=1e6?"$"+(c/1e6).toFixed(1)+"M":c>=1e3?"$"+(c/1e3).toFixed(0)+"k":"$"+c.toFixed(0)}return x},Y=async(x=!1)=>{const n=Date.now();if(!x&&C.value&&u.value&&n<u.value){r.value=C.value,U(r.value.inventario,r.value.ventas,r.value.reservas,r.value.resumenReservas,r.value.tours),W(r.value.inventario,r.value.ventas,r.value.stockBajo,r.value.reservas,r.value.resumenReservas),f.value=!1;return}f.value=!0;try{const c={headers:{Accept:"application/json"},timeout:1e4},[L,B,j,_,D,S]=await Promise.allSettled([T.get("/api/inventario/resumen",c),T.get("/api/ventas?desde="+new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],c),T.get("/api/inventario/stock-bajo?limit=20",c),T.get("/api/reservas?per_page=100&desde="+new Date(Date.now()-60*24*60*60*1e3).toISOString().split("T")[0],c),T.get("/api/reservas/resumen",c),T.get("/api/tours?estado=activo,disponible&limit=50",c)]),F=L.status==="fulfilled"?L.value.data.data||L.value.data||{}:{},$=B.status==="fulfilled"?B.value.data.data||B.value.data||[]:[],R=j.status==="fulfilled"?j.value.data.data||j.value.data||[]:[],P=_.status==="fulfilled"?_.value.data.data||_.value.data||[]:[],M=D.status==="fulfilled"?D.value.data.data||D.value.data||[]:[],N=S.status==="fulfilled"?S.value.data.data||S.value.data||[]:[];U(F,$,P,M,N),W(F,$,R,P,M),r.value={inventario:F,ventas:$,stockBajo:R,reservas:P,resumenReservas:M,tours:N},C.value={...r.value},u.value=Date.now()+hs}catch{U({},[],[],[],[]),W({},[],[],[])}finally{f.value=!1}},U=(x,n,c,L,B)=>{const j=Array.isArray(n)?n:[],_=Array.isArray(c)?c:[],D=Array.isArray(B)?B:[],S=new Date().toISOString().split("T")[0],F=j.filter(m=>m.fecha?m.fecha.split("T")[0]===S:!1).length,$=j.filter(m=>m.fecha?m.fecha.split("T")[0]===S:!1).reduce((m,k)=>m+(parseFloat(k.total)||0),0),R=new Date().getMonth(),P=new Date().getFullYear(),M=_.filter(m=>{if(!m.fecha_reserva&&!m.fecha)return!1;const k=new Date(m.fecha_reserva||m.fecha);return k.getMonth()===R&&k.getFullYear()===P}).length,N=D.filter(m=>!m.estado||m.estado.toLowerCase()==="activo"||m.estado.toLowerCase()==="disponible").length;g.value[0].value=F.toString(),g.value[1].value=`$${$.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}`,g.value[2].value=M.toString(),g.value[3].value=N.toString();const se=_.filter(m=>m.estado&&m.estado.toLowerCase()==="pendiente").length,ae=new Set(_.map(m=>{var k;return(k=m.cliente)==null?void 0:k.id}).filter(m=>m)).size;A.value[0].value=se.toString(),A.value[1].value=(x.productos_stock_bajo||0).toString(),A.value[2].value=`$${Number(x.valor_total_inventario||0).toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})}`,A.value[3].value=ae.toString()},W=(x,n,c,L,B)=>{const j=x.total_productos||0,_=x.productos_stock_bajo||0,D=x.productos_agotados||0,S=x.productos_disponibles||Math.max(0,j-_-D),F=Array.isArray(L)?L:[];b.value={labels:["Productos Disponibles","Stock Bajo","Agotados"],datasets:[{label:"Estado del Inventario",data:[S,_,D],backgroundColor:["#10b981","#f59e0b","#ef4444"],hoverBackgroundColor:["#34d399","#fbbf24","#f87171"]}]};const $=F.reduce((R,P)=>{const M=P.estado||"Sin estado";return R[M]=(R[M]||0)+1,R},{});Object.keys($).length===0&&($["Sin reservas"]=0),t.value={labels:Object.keys($),datasets:[{label:"Reservas por Estado",data:Object.values($),backgroundColor:["#f59e0b","#10b981","#ef4444","#3b82f6"]}]}},ee=()=>({maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Estado del Inventario",font:{size:18}},legend:{display:!0,position:"bottom",labels:{usePointStyle:!0,color:"#374151"}},tooltip:{callbacks:{label:function(x){return`${x.label}: ${x.parsed} productos`}}}}}),te=()=>({maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Reservas por Estado",font:{size:18}},legend:{display:!1},tooltip:{callbacks:{label:function(x){return`${x.label}: ${x.parsed.y} reservas`}}}},scales:{x:{ticks:{color:"#374151"},grid:{color:"#e5e7eb"}},y:{beginAtZero:!0,ticks:{color:"#374151"},grid:{color:"#e5e7eb"}}}});return de(()=>{s.value=ee(),o.value=te(),Y()}),(x,n)=>(i(),d(V,null,[p(h(re),{title:"Dashboard"}),p(oe,null,{default:w(()=>[f.value?(i(),q(fe,{key:0})):(i(),d("div",ds,[e("div",rs,[n[3]||(n[3]=e("h1",{class:"text-2xl sm:text-3xl font-bold text-blue-600"},"Dashboard administrativo",-1)),e("button",{onClick:n[0]||(n[0]=c=>Y(!0)),disabled:f.value,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white text-sm font-medium rounded-lg transition-colors duration-200"},[e("i",{class:y(["pi pi-refresh",{"animate-spin":f.value}])},null,2),e("span",null,l(f.value?"Actualizando...":"Actualizar"),1)],8,cs)]),p(Ne,{metrics:g.value,"dashboard-data":r.value,"format-value-for-mobile":H},null,8,["metrics","dashboard-data"]),e("div",ms,[p(ut,{widgets:A.value,"dashboard-data":r.value,"format-value-for-mobile":H,onToggleReservasModal:Q,onToggleStockModal:X},null,8,["widgets","dashboard-data"]),e("div",us,[n[5]||(n[5]=e("h3",{class:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4"},"Inventario por Estado",-1)),e("div",xs,[b.value?(i(),q(h(G),{key:0,type:"pie",data:b.value,options:s.value,class:"w-full h-full"},null,8,["data","options"])):(i(),d("div",fs,n[4]||(n[4]=[e("p",{class:"text-gray-500 text-xs sm:text-sm"},"No hay datos de inventario",-1)])))])]),e("div",bs,[n[7]||(n[7]=e("h3",{class:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4"},"Reservas por Estado",-1)),e("div",ps,[t.value?(i(),q(h(G),{key:0,type:"bar",data:t.value,options:o.value,class:"w-full h-full"},null,8,["data","options"])):(i(),d("div",gs,n[6]||(n[6]=[e("p",{class:"text-gray-500 text-xs sm:text-sm"},"No hay datos de reservas",-1)])))])])]),e("div",vs,[p(ns,{"resumen-reservas-data":r.value.resumenReservas,"reservas-data":r.value.reservas},null,8,["resumen-reservas-data","reservas-data"]),p(Rt,{"dashboard-data":r.value,"format-value-for-mobile":H},null,8,["dashboard-data"])])])),p(as,{"show-reservas-pendientes-modal":E.value,"show-productos-stock-bajo-modal":O.value,"dashboard-data":r.value,onCloseReservasModal:n[1]||(n[1]=c=>E.value=!1),onCloseStockModal:n[2]||(n[2]=c=>O.value=!1)},null,8,["show-reservas-pendientes-modal","show-productos-stock-bajo-modal","dashboard-data"])]),_:1})],64))}};export{js as default};
