import{p as F,r as n,s as G,B as v,i as j,f as q,o as P,a as o,u as l,g as T,w as d,b as r,z as K,K as p,j as O,D as X,X as V,Y,c as C,h as k,Z as E,$ as N,e as A,t as Z,F as H}from"./app-DP8tsAem.js";import{_ as J}from"./AuthenticatedLayout-BvfF3yw2.js";import{s as z}from"./index-CPLYCsb2.js";import"./logo-DN1bLr27.js";import"./index-ClJ1gEnJ.js";const Q={class:"py-6 px-2 sm:px-4 md:px-6 mt-10 mx-auto bg-red-50 shadow-md rounded-lg max-w-3xl"},R={class:"flex justify-between items-center mb-4"},W={class:"flex flex-col md:flex-row items-center gap-4 mt-6 mb-2"},ee={class:"flex flex-col gap-3"},ae={class:"flex flex-col gap-3"},le={class:"mb-4"},ue={__name:"ControlPaisesProvincias",setup(oe){const m=F(),w=n([]),U=n([]),i=n("País"),y=n(""),c=n(!1),b=n(!1),f=n(!1),u=n({id:null,nombre:"",pais_id:null}),t=n({id:null,nombre:"",pais_id:null}),g=n(null);G(()=>{x(),$()});const x=async()=>{try{const s=await v.get("/api/paises");w.value=s.data}catch{m.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los países"})}},$=async()=>{try{const s=await v.get("/api/provincias?_expand=pais");U.value=s.data}catch{m.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las provincias"})}},_=j(()=>{let s=i.value==="País"?w.value:U.value;return y.value&&(s=s.filter(e=>e.nombre.toLowerCase().includes(y.value.toLowerCase()))),s});function B(){u.value={id:null,nombre:"",pais_id:null},c.value=!0}async function S(){try{i.value==="País"?(await v.post("/api/paises",{nombre:u.value.nombre}),await x()):(await v.post("/api/provincias",{nombre:u.value.nombre,pais_id:u.value.pais_id}),await $()),m.add({severity:"success",summary:"Guardado",detail:`${i.value} agregado correctamente`}),c.value=!1}catch{m.add({severity:"error",summary:"Error",detail:"No se pudo guardar"})}}function h(s){t.value={...s},i.value==="Provincia"&&(t.value.pais_id=s.pais.id),b.value=!0}async function I(){try{i.value==="País"?(await v.put(`/api/paises/${t.value.id}`,{nombre:t.value.nombre}),await x()):(await v.put(`/api/provincias/${t.value.id}`,{nombre:t.value.nombre,pais_id:t.value.pais_id}),await $()),m.add({severity:"success",summary:"Actualizado",detail:`${i.value} actualizado correctamente`}),b.value=!1}catch{m.add({severity:"error",summary:"Error",detail:"No se pudo actualizar"})}}function L(s){g.value=s,f.value=!0}async function M(){try{i.value==="País"?(await v.delete(`/api/paises/${g.value.id}`),await x()):(await v.delete(`/api/provincias/${g.value.id}`),await $()),m.add({severity:"warn",summary:"Eliminado",detail:`${i.value} eliminado correctamente`}),f.value=!1}catch{m.add({severity:"error",summary:"Error",detail:"No se pudo eliminar"})}}return(s,e)=>(P(),q(H,null,[o(l(T),{title:"Países y Provincias"}),o(J,null,{default:d(()=>[o(l(K)),r("div",Q,[r("div",R,[e[12]||(e[12]=r("h3",{class:"text-xl font-bold"},"Control de Países y Provincias",-1)),o(l(p),{label:`Agregar ${i.value}`,icon:"pi pi-plus",class:"p-button-danger",onClick:B},null,8,["label"])]),r("div",W,[e[14]||(e[14]=r("label",{for:"tipo-estado",class:"font-semibold mb-0"},"Ver:",-1)),O(r("select",{id:"tipo-estado","onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),class:"p-2 rounded border border-gray-300 w-36"},e[13]||(e[13]=[r("option",{value:"País"},"Países",-1),r("option",{value:"Provincia"},"Provincias",-1)]),512),[[X,i.value]]),o(l(V),{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=a=>y.value=a),placeholder:"Buscar por nombre...",class:"w-64"},null,8,["modelValue"])]),o(l(Y),{value:_.value,class:"mb-4 min-w-[400px] w-full",rows:8,paginator:_.value.length>8,rowsPerPageOptions:[8,16]},{default:d(()=>[o(l(E),{field:"nombre",header:"Nombre"}),i.value==="Provincia"?(P(),C(l(E),{key:0,field:"pais.nombre",header:"País"})):k("",!0),o(l(E),{header:"Acciones"},{body:d(a=>[o(l(p),{label:"",icon:"pi pi-pencil",class:"p-button-rounded p-button-warn mr-2",onClick:D=>h(a.data)},null,8,["onClick"]),o(l(p),{label:"",icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:D=>L(a.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","paginator"]),o(l(N),{visible:c.value,"onUpdate:visible":e[5]||(e[5]=a=>c.value=a),header:`Agregar ${i.value}`,modal:!0,closable:!1,style:{width:"350px"}},{footer:d(()=>[o(l(p),{label:"Cancelar",icon:"pi pi-times",class:"p-button-rounded p-button-danger p-button-sm mr-2",onClick:e[4]||(e[4]=a=>c.value=!1)}),o(l(p),{label:"Guardar",icon:"pi pi-check",class:"p-button-rounded p-button-warn p-button-sm mr-2",onClick:S,disabled:!u.value.nombre},null,8,["disabled"])]),default:d(()=>[r("div",ee,[o(l(V),{modelValue:u.value.nombre,"onUpdate:modelValue":e[2]||(e[2]=a=>u.value.nombre=a),placeholder:"Nombre",class:"w-full"},null,8,["modelValue"]),i.value==="Provincia"?(P(),C(l(z),{key:0,modelValue:u.value.pais_id,"onUpdate:modelValue":e[3]||(e[3]=a=>u.value.pais_id=a),options:w.value,optionLabel:"nombre",optionValue:"id",placeholder:"Seleccione un país",class:"w-full"},null,8,["modelValue","options"])):k("",!0)])]),_:1},8,["visible","header"]),o(l(N),{visible:b.value,"onUpdate:visible":e[9]||(e[9]=a=>b.value=a),header:`Editar ${i.value}`,modal:!0,closable:!1,style:{width:"350px"}},{footer:d(()=>[o(l(p),{label:"Cancelar",icon:"pi pi-times",class:"p-button-rounded p-button-danger p-button-md mr-2",onClick:e[8]||(e[8]=a=>b.value=!1)}),o(l(p),{label:"Actualizar",icon:"pi pi-check",class:"p-button-rounded p-button-warn p-button-md mr-2",onClick:I,disabled:!t.value.nombre},null,8,["disabled"])]),default:d(()=>[r("div",ae,[o(l(V),{modelValue:t.value.nombre,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.nombre=a),placeholder:"Nombre",class:"w-full"},null,8,["modelValue"]),i.value==="Provincia"?(P(),C(l(z),{key:0,modelValue:t.value.pais_id,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.pais_id=a),options:w.value,optionLabel:"nombre",optionValue:"id",placeholder:"Seleccione un país",class:"w-full"},null,8,["modelValue","options"])):k("",!0)])]),_:1},8,["visible","header"]),o(l(N),{visible:f.value,"onUpdate:visible":e[11]||(e[11]=a=>f.value=a),header:`Eliminar ${i.value}`,modal:!0,closable:!1,style:{width:"350px"}},{footer:d(()=>[o(l(p),{label:"Cancelar",icon:"pi pi-times",class:"p-button-rounded p-button-danger p-button-md mr-2",onClick:e[10]||(e[10]=a=>f.value=!1)}),o(l(p),{label:"Eliminar",icon:"pi pi-trash",class:"p-button-rounded p-button-warn p-button-md mr-2",onClick:M})]),default:d(()=>{var a;return[r("div",le,[e[15]||(e[15]=A("¿Seguro que deseas eliminar ")),r("b",null,Z((a=g.value)==null?void 0:a.nombre),1),e[16]||(e[16]=A("?"))])]}),_:1},8,["visible","header"])])]),_:1})],64))}};export{ue as default};
