import{A as U}from"./AuthenticatedLayout-Dj3unYzy.js";import{r as u,E as y,o as q,h as _,d as v,x as d,p as a,e,$ as s,a0 as z,t as o,a1 as H,j as C,c as W,q as P,y as G}from"./vendor-CqKcGHPa.js";import{z as K,F as X,a as J,A as i,e as Q,f as V,h as Y,o as Z,g as ee}from"./ui-CVJOYm3g.js";import{H as te,a0 as se,a as le,ab as ae,q as oe,o as ne,f as S,g as de}from"./index-BBUgHj35.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={class:"container mx-auto px-4 py-6"},re={class:"mb-6 bg-white rounded-lg shadow-md p-6"},ce={class:"flex items-center justify-between"},ue={class:"flex items-center gap-4"},me={class:"flex items-center gap-2"},pe={class:"text-lg font-semibold text-gray-800"},ge={class:"flex items-center gap-2"},xe={class:"text-sm text-gray-600"},be={class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-4 gap-4 mb-6"},fe={class:"bg-white rounded-lg shadow-md p-3"},ve={class:"flex flex-col items-center text-center"},he={class:"p-1.5 rounded-full bg-blue-100 mb-2"},we={class:"text-lg font-bold text-gray-900"},ye={class:"bg-white rounded-lg shadow-md p-3"},_e={class:"flex flex-col items-center text-center"},Ce={class:"p-1.5 rounded-full bg-green-100 mb-2"},Pe={class:"text-lg font-bold text-gray-900"},Ve={class:"bg-white rounded-lg shadow-md p-3"},ke={class:"flex flex-col items-center text-center"},Le={class:"p-1.5 rounded-full bg-green-100 mb-2"},Fe={class:"text-lg font-bold text-gray-900"},De={class:"bg-white rounded-lg shadow-md"},Te={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},$e={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},Ne={class:"flex items-center gap-3"},Se={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Ae=["disabled"],Re=["disabled"],je={class:"space-y-3"},Ee={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Ie={class:"font-medium text-blue-600"},Me={class:"text-sm"},Oe={class:"text-sm font-semibold text-green-600"},Be={key:0,class:"space-y-4"},Ue={class:"grid grid-cols-1 gap-4"},qe={class:"bg-gray-50 p-4 rounded-lg"},ze={class:"space-y-2"},He={class:"text-lg font-semibold text-green-600"},We={class:"flex justify-center w-full"},Ye={__name:"VentasCliente",props:{cliente:{type:Object,required:!0},ventas:{type:Array,default:()=>[]}},setup(m){const g=m,k=K(),h=u(10),A=u([5,10,20,50]),p=u(""),r=u(null),x=u(!1),c=u(!1),R=u([{label:"Todos",value:null},{label:"Completadas",value:"completada"},{label:"Canceladas",value:"cancelada"}]),b=u({global:{value:null,matchMode:X.CONTAINS}}),w=y(()=>{let l=g.ventas;if(p.value&&(l=l.filter(t=>t.estado===p.value)),b.value.global.value){const t=b.value.global.value.toLowerCase();l=l.filter(f=>f.id.toString().includes(t))}return l}),j=y(()=>g.ventas.reduce((l,t)=>l+parseFloat(t.total),0)),E=y(()=>g.ventas.filter(l=>l.estado==="completada").length),L=l=>new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"}),I=l=>{switch(l){case"completada":return"bg-green-100 text-green-800";case"cancelada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},M=l=>{switch(l){case"completada":return"Completada";case"cancelada":return"Cancelada";default:return l}},O=l=>{r.value=l.data,x.value=!0},B=()=>{x.value=!1,r.value=null},F=async()=>{c.value=!0,await new Promise(l=>setTimeout(l,300)),p.value="",c.value=!1,k.add({severity:"success",summary:"Filtros limpiados",detail:"Los filtros han sido limpiados exitosamente",life:3e3})};return q(()=>{k.add({severity:"success",summary:"Ventas cargadas",detail:`Se encontraron ${g.ventas.length} ventas para este cliente.`,life:3e3})}),(l,t)=>(v(),_(U,null,{default:d(()=>{var f,D,T,$,N;return[a(s(z),{title:`Ventas de ${((D=(f=m.cliente)==null?void 0:f.user)==null?void 0:D.name)||"Cliente"}`},null,8,["title"]),a(s(J),{class:"z-[9999]"}),e("div",ie,[e("div",re,[e("div",ce,[e("div",null,[t[4]||(t[4]=e("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Ventas del Cliente",-1)),e("div",ue,[e("div",me,[a(s(i),{icon:s(te),class:"text-blue-500"},null,8,["icon"]),e("span",pe,o((($=(T=m.cliente)==null?void 0:T.user)==null?void 0:$.name)||"Cliente no encontrado"),1)]),e("div",ge,[a(s(i),{icon:s(se),class:"text-gray-500"},null,8,["icon"]),e("span",xe,o(((N=m.cliente)==null?void 0:N.numero_identificacion)||"N/A"),1)])])]),a(s(H),{href:l.route("clientes"),class:"bg-blue-500 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 text-sm"},{default:d(()=>[a(s(i),{icon:s(le),class:"h-4 w-4"},null,8,["icon"]),t[5]||(t[5]=e("span",{class:"hidden sm:inline"},"Volver a Clientes",-1)),t[6]||(t[6]=e("span",{class:"sm:hidden"},"Volver",-1))]),_:1,__:[5,6]},8,["href"])])]),e("div",be,[e("div",fe,[e("div",ve,[e("div",he,[a(s(i),{icon:s(ae),class:"h-4 w-4 text-blue-600"},null,8,["icon"])]),t[7]||(t[7]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Total",-1)),e("p",we,o(m.ventas.length),1)])]),e("div",ye,[e("div",_e,[e("div",Ce,[a(s(i),{icon:s(oe),class:"h-4 w-4 text-green-600"},null,8,["icon"])]),t[8]||(t[8]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Monto",-1)),e("p",Pe,"$"+o(j.value.toFixed(0)),1)])]),e("div",Ve,[e("div",ke,[e("div",Le,[a(s(i),{icon:s(ne),class:"h-4 w-4 text-green-600"},null,8,["icon"])]),t[9]||(t[9]=e("p",{class:"text-xs font-medium text-gray-500 mb-1"},"Completadas",-1)),e("p",Fe,o(E.value),1)])])]),e("div",De,[t[11]||(t[11]=e("h3",{class:"text-2xl text-blue-600 font-bold mb-4"},"Historial de Ventas",-1)),a(s(Q),{value:w.value,dataKey:"id",paginator:!0,rows:h.value,rowsPerPageOptions:A.value,rowsPerPage:h.value,"onUpdate:rowsPerPage":t[2]||(t[2]=n=>h.value=n),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} ventas",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:O,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-16 text-sm hover:bg-blue-50 transition-colors duration-200 cursor-pointer"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:d(()=>[e("div",Te,[e("div",$e,[e("div",Ne,[t[10]||(t[10]=e("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[e("i",{class:"pi pi-filter text-blue-600 text-sm"}),e("span",null,"Filtros")],-1)),e("div",Se,o(w.value.length)+" resultado"+o(w.value.length!==1?"s":""),1),e("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:F,disabled:c.value},[c.value?(v(),_(s(i),{key:0,icon:s(S),class:"animate-spin h-3 w-3"},null,8,["icon"])):C("",!0),e("span",null,o(c.value?"Limpiando...":"Limpiar filtros"),1)],8,Ae)]),e("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:F,disabled:c.value},[c.value?(v(),_(s(i),{key:0,icon:s(S),class:"animate-spin h-3 w-3"},null,8,["icon"])):C("",!0),e("span",null,o(c.value?"Limpiando...":"Limpiar filtros"),1)],8,Re)]),e("div",je,[e("div",Ee,[a(s(Y),{modelValue:b.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=n=>b.value.global.value=n),placeholder:"üîç Buscar ventas...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"]),a(s(Z),{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=n=>p.value=n),options:R.value,optionLabel:"label",optionValue:"value",placeholder:"Filtrar por estado",class:"w-full text-sm border border-blue-300",pt:{root:{class:"h-9"},input:{class:"text-sm"},dropdown:{class:"text-sm"}}},null,8,["modelValue","options"])])])])]),default:d(()=>[a(s(V),{field:"id",header:"ID",sortable:"",class:"w-16"},{body:d(n=>[e("span",Ie,"#"+o(n.data.id),1)]),_:1}),a(s(V),{field:"fecha",header:"Fecha",sortable:"",class:"w-28"},{body:d(n=>[e("span",Me,o(L(n.data.fecha)),1)]),_:1}),a(s(V),{field:"total",header:"Total",sortable:"",class:"w-24"},{body:d(n=>[e("span",Oe," $"+o(Number(n.data.total).toFixed(2)),1)]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"])])]),a(s(ee),{visible:x.value,"onUpdate:visible":t[3]||(t[3]=n=>x.value=n),header:"Detalles de la Venta",modal:!0,style:{width:"90vw",maxWidth:"600px"},closable:!0,draggable:!1},{footer:d(()=>[e("div",We,[e("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:B},[a(s(i),{icon:s(de),class:"h-5"},null,8,["icon"]),t[17]||(t[17]=P(" Cerrar "))])])]),default:d(()=>[r.value?(v(),W("div",Be,[e("div",Ue,[e("div",qe,[t[16]||(t[16]=e("h4",{class:"font-semibold text-gray-800 mb-3"},"Informaci√≥n General",-1)),e("div",ze,[e("p",null,[t[12]||(t[12]=e("strong",null,"ID de Venta:",-1)),P(" #"+o(r.value.id),1)]),e("p",null,[t[13]||(t[13]=e("strong",null,"Fecha:",-1)),P(" "+o(L(r.value.fecha)),1)]),e("p",null,[t[14]||(t[14]=e("strong",null,"Estado:",-1)),e("span",{class:G([I(r.value.estado),"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-2"])},o(M(r.value.estado)),3)]),e("p",null,[t[15]||(t[15]=e("strong",null,"Total:",-1)),e("span",He,"$"+o(Number(r.value.total).toFixed(2)),1)])])])])])):C("",!0)]),_:1},8,["visible"])]}),_:1}))}};export{Ye as default};
