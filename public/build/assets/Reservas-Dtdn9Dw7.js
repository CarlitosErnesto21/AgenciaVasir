import{r as u,E as P,w as xe,o as Pe,k,h as N,d as h,x as b,p as d,e,$ as o,a0 as $e,t as c,q as Ue,j as O,y as Y,c as F,v as be,F as ge,l as he,a7 as ye,N as _,n as Be}from"./vendor-CqKcGHPa.js";import{A as Ge}from"./AuthenticatedLayout-Chsf1Jli.js";import{z as Ze,F as x}from"./ui-DrLUz167.js";import{A as we,h as _e,B as Re,i as Ae,q as De,l as We,b as T,C as Ce,D as ee,E as Ee,v as Xe,y as Je}from"./index-XGUaz6Tt.js";import Ke from"./Modales-CaiKKmqz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DtyEsSN9.js";const Qe={class:"container mx-auto px-4 py-6"},Ye={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 sm:gap-6 mb-8"},ea={class:"flex items-center justify-between text-white p-2 sm:p-4"},aa={class:"text-xl sm:text-3xl font-bold"},sa={class:"flex items-center justify-between text-white p-2 sm:p-4"},ta={class:"text-xl sm:text-3xl font-bold"},la={class:"flex items-center justify-between text-white p-2 sm:p-4"},oa={class:"text-xl sm:text-3xl font-bold"},ra={class:"flex items-center justify-between text-white p-2 sm:p-4"},na={class:"text-xl sm:text-3xl font-bold"},ia={class:"flex items-center justify-between text-white p-2 sm:p-4"},da={class:"text-sm sm:text-3xl font-bold"},ca={class:"bg-white rounded-lg shadow-md"},ua={class:"flex flex-col sm:flex-row lg:justify-between lg:items-center mb-4 gap-4 p-6"},ma={class:"text-blue-600 text-xs text-center sm:text-start mt-1 font-medium"},va={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4 mx-4"},fa={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},pa={class:"flex items-center gap-3"},xa={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},ba={class:"grid grid-cols-3 gap-2 w-full sm:hidden mt-2"},ga=["disabled"],ha={class:"truncate"},ya=["disabled"],wa={class:"truncate"},_a=["disabled"],Ra={key:2,class:"truncate"},Aa={class:"flex gap-2"},Da=["disabled"],Ca=["disabled"],Ea=["disabled"],za={key:2,class:"hidden sm:inline"},Na={class:"space-y-3"},ka={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-3"},Fa={class:"col-span-1"},Ta=["value"],Ia={class:"col-span-1"},Sa=["disabled"],La=["value"],Va={class:"col-span-1 hidden md:block"},Oa={class:"col-span-1 hidden md:block"},Ma={class:"col-span-2 flex gap-3 md:hidden"},ja={key:0,class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},qa={class:"flex items-center justify-between text-sm"},Ha={class:"flex items-center gap-2"},Pa={class:"text-blue-800 font-semibold"},$a={class:"text-blue-600"},Ua={class:"font-medium"},Ba={class:"text-center py-12"},Ga={class:"text-xs sm:text-sm"},Za={class:"font-medium"},Wa={class:"flex items-center gap-1 sm:gap-3"},Xa={class:"w-6 h-6 sm:w-8 sm:h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0"},Ja={class:"min-w-0 flex-1"},Ka=["title"],Qa=["title"],Ya={class:"min-w-0"},es=["title"],as={class:"text-center"},ss={class:"text-xs sm:text-sm flex items-center justify-center gap-1"},ts={class:"font-medium"},ls={class:"text-xs text-gray-500"},os={class:"text-right"},rs={class:"font-medium text-green-600 flex items-center justify-end gap-1 text-xs sm:text-sm"},ns={class:"truncate"},is={class:"hidden xl:inline"},ds={class:"xl:hidden"},cs={class:"flex justify-center"},us=["onClick"],ys={__name:"Reservas",setup(ms){const f=Ze(),m=u([]),I=u([]),M=u(!1),$=u(!1),r=u({busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:"",estadoTour:null,tourSeleccionado:""}),C=u(!1),U=u(!1),B=u(!1),G=u(!1);u(!1);const Z=u(null),E=u(null);u(""),u(null),u(""),u("");const ae=u(typeof window<"u"?window.innerWidth:1024),R=u(!1),S=u(!1),W=u(!1),X=u(!1),J=u(!1),K=u(!1),y=u(!1),A=u(!1),L=[{label:"Pendientes",value:"PENDIENTE",severity:"warn",color:"bg-yellow-100 text-yellow-800",icon:we},{label:"Confirmadas",value:"CONFIRMADA",severity:"success",color:"bg-green-100 text-green-800",icon:_e},{label:"Rechazadas",value:"RECHAZADA",severity:"danger",color:"bg-red-100 text-red-800",icon:Ae},{label:"Reprogramadas",value:"REPROGRAMADA",severity:"info",color:"bg-blue-100 text-blue-800",icon:Re},{label:"Finalizadas",value:"FINALIZADA",severity:"secondary",color:"bg-gray-100 text-gray-800",icon:ee}],ze=[{label:"Disponible",value:"DISPONIBLE",color:"bg-green-100 text-green-800"},{label:"Agotado",value:"AGOTADO",color:"bg-red-100 text-red-800"},{label:"En Curso",value:"EN_CURSO",color:"bg-blue-100 text-blue-800"},{label:"Completado",value:"COMPLETADO",color:"bg-gray-100 text-gray-800"},{label:"Cancelado",value:"CANCELADO",color:"bg-red-100 text-red-800"},{label:"Suspendido",value:"SUSPENDIDO",color:"bg-orange-100 text-orange-800"},{label:"Reprogramado",value:"REPROGRAMADO",color:"bg-purple-100 text-purple-800"}],se=P(()=>{let a=m.value;if(r.value.estadoReserva&&(a=a.filter(l=>l.estado===r.value.estadoReserva)),r.value.busqueda){const l=r.value.busqueda.toLowerCase();a=a.filter(n=>{var p,v,i,g,t,w;return(((v=(p=n.cliente)==null?void 0:p.user)==null?void 0:v.name)||((i=n.cliente)==null?void 0:i.nombres)||"").toLowerCase().includes(l)||(n.entidad_nombre||"").toLowerCase().includes(l)||(((t=(g=n.cliente)==null?void 0:g.user)==null?void 0:t.email)||((w=n.cliente)==null?void 0:w.correo)||"").toLowerCase().includes(l)})}return r.value.fechaDesde&&(a=a.filter(l=>new Date(l.fecha_reserva)>=new Date(r.value.fechaDesde))),r.value.fechaHasta&&(a=a.filter(l=>new Date(l.fecha_reserva)<=new Date(r.value.fechaHasta))),a.sort((l,n)=>{const p={PENDIENTE:1,CONFIRMADA:2,REPROGRAMADA:3,FINALIZADA:4,RECHAZADA:5},v=p[l.estado]||6,i=p[n.estado]||6;return v!==i?v-i:new Date(n.fecha_reserva)-new Date(l.fecha_reserva)})}),V=P(()=>({pendientes:m.value.filter(a=>a.estado==="PENDIENTE").length,confirmadas:m.value.filter(a=>a.estado==="CONFIRMADA").length,reprogramadas:m.value.filter(a=>a.estado==="REPROGRAMADA").length,rechazadas:m.value.filter(a=>a.estado==="RECHAZADA").length,finalizadas:m.value.filter(a=>a.estado==="FINALIZADA").length,totalIngresos:m.value.filter(a=>["CONFIRMADA","FINALIZADA"].includes(a.estado)).reduce((a,s)=>a+(Number(s.total)||0),0)})),j=P(()=>{if(!r.value.tourSeleccionado||r.value.tourSeleccionado==="")return null;const a=I.value.find(l=>l.id==r.value.tourSeleccionado),s=se.value.length;return{nombre:(a==null?void 0:a.nombre)||"Tour no encontrado",totalReservas:s}}),Ne=P(()=>ae.value<640?{width:"95vw",maxWidth:"380px"}:ae.value<768?{width:"400px"}:{width:"450px"}),q=async()=>{M.value=!0;try{const a={busqueda:r.value.busqueda||void 0,fecha_inicio:r.value.fechaDesde||void 0,fecha_fin:r.value.fechaHasta||void 0,tour_id:r.value.tourSeleccionado||void 0},s=await _.get("/api/reservas",{params:a,withCredentials:!0});m.value=Array.isArray(s.data)?s.data:s.data.data||[]}catch(a){console.error("Error cargando reservas:",a),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:4e3}),m.value=[]}finally{M.value=!1}},ke=async()=>{M.value=!0,f.add({severity:"info",summary:"Cargando reservas...",life:2e3});try{const a={busqueda:r.value.busqueda||void 0,fecha_inicio:r.value.fechaDesde||void 0,fecha_fin:r.value.fechaHasta||void 0,tour_id:r.value.tourSeleccionado||void 0},s=await _.get("/api/reservas",{params:a,withCredentials:!0});m.value=s.data.data||[],f.add({severity:"success",summary:"Reservas cargadas",life:2e3})}catch(a){console.error("Error cargando reservas:",a),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:4e3}),m.value=[]}finally{M.value=!1}},te=async()=>{$.value=!0;try{const a=await _.get("/api/tours");I.value=a.data||[]}catch(a){console.error("Error cargando tours:",a),I.value=[]}finally{$.value=!1}},Fe=async a=>{var s,l,n,p,v;W.value=!0;try{const i=await _.put(`/api/reservas/${a.id}/confirmar`),g=m.value.findIndex(t=>t.id===a.id);g!==-1&&(m.value[g].estado="CONFIRMADA"),f.add({severity:"success",summary:"Â¡Confirmada!",detail:`Reserva de ${((l=(s=a.cliente)==null?void 0:s.user)==null?void 0:l.name)||((n=a.cliente)==null?void 0:n.nombres)} confirmada correctamente`,life:4e3})}catch(i){console.error("Error confirmando reserva:",i),f.add({severity:"error",summary:"Error",detail:((v=(p=i.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo confirmar la reserva",life:4e3})}finally{W.value=!1}},Te=async a=>{var s,l,n,p,v;K.value=!0;try{await _.put(`/api/reservas/${a.id}/finalizar`);const i=m.value.findIndex(g=>g.id===a.id);i!==-1&&(m.value[i].estado="FINALIZADA"),f.add({severity:"success",summary:"Â¡Finalizada!",detail:`Reserva de ${((l=(s=a.cliente)==null?void 0:s.user)==null?void 0:l.name)||((n=a.cliente)==null?void 0:n.nombres)} finalizada correctamente. Email de confirmaciÃ³n enviado.`,life:4e3})}catch(i){console.error("Error finalizando reserva:",i),f.add({severity:"error",summary:"Error",detail:((v=(p=i.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo finalizar la reserva",life:4e3})}finally{K.value=!1}},le=a=>{Z.value=a,G.value=!0},Ie=a=>{Z.value=a;const s=I.value.find(l=>{var n;return((n=a.detallesTours)==null?void 0:n.some(p=>p.tour_id===l.id))||a.entidad_nombre===l.nombre});E.value=s,C.value=!0},Se=a=>{a.originalEvent.target.closest("button")||le(a.data)},Le=a=>{const s=L.find(l=>l.value===a);return(s==null?void 0:s.color)||"bg-gray-100 text-gray-800"},Ve=a=>a?new Date(a).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",Q=async()=>{R.value=!0;try{await new Promise(a=>setTimeout(a,300)),r.value={busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:"",estadoTour:null,tourSeleccionado:""},f.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{R.value=!1}},oe=async()=>{y.value=!0,f.add({severity:"info",summary:"Cargando reservas...",life:2e3});try{await q(),setTimeout(()=>{f.add({severity:"success",summary:"Reservas actualizadas",detail:`${m.value.length} registros cargados`,life:2e3})},300)}catch(a){console.error("Error al cargar las reservas:",a),f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:3e3})}finally{setTimeout(()=>{y.value=!1},500)}},re=async()=>{var a,s;try{A.value=!0;const n=(await _.post("/api/reservas/finalizar-automaticamente")).data;n.success?(f.add({severity:"success",summary:"Â¡FinalizaciÃ³n automÃ¡tica completada!",detail:`${n.reservas_finalizadas} reserva(s) finalizada(s) de ${n.reservas_procesadas} procesada(s)`,life:6e3}),await q()):f.add({severity:"warn",summary:"Sin cambios",detail:n.message||"No hay reservas pendientes de finalizaciÃ³n",life:4e3})}catch(l){console.error("Error en finalizaciÃ³n automÃ¡tica:",l),f.add({severity:"error",summary:"Error",detail:((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.message)||"Error al ejecutar la finalizaciÃ³n automÃ¡tica",life:4e3})}finally{A.value=!1}},Oe=async a=>{await Fe(a),C.value=!1},Me=async a=>{var s,l,n,p,v;X.value=!0,S.value=!0;try{await _.put(`/api/reservas/${a.reserva.id}/rechazar`,{motivo:a.motivo});const i=m.value.findIndex(g=>g.id===a.reserva.id);i!==-1&&(m.value[i].estado="RECHAZADA"),B.value=!1,C.value=!1,f.add({severity:"success",summary:"Â¡Rechazada!",detail:`Reserva de ${((l=(s=a.reserva.cliente)==null?void 0:s.user)==null?void 0:l.name)||((n=a.reserva.cliente)==null?void 0:n.nombres)} rechazada correctamente`,life:4e3})}catch(i){console.error("Error rechazando reserva:",i),f.add({severity:"error",summary:"Error",detail:((v=(p=i.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo rechazar la reserva",life:4e3})}finally{S.value=!1,X.value=!1}},je=async a=>{var s,l,n,p,v;J.value=!0,S.value=!0;try{const i={fecha_nueva:a.fechaNueva,motivo:a.motivo,observaciones:a.observaciones};if(await _.put(`/api/reservas/${a.reserva.id}/reprogramar`,i),E.value)try{const t=new Date(E.value.fecha_salida),z=new Date(E.value.fecha_regreso).getTime()-t.getTime(),D=new Date(new Date(a.fechaNueva).getTime()+z),H={estado:"REPROGRAMADO",fecha_salida:a.fechaNueva,fecha_regreso:D,motivo_reprogramacion:`Reprogramado por reserva: ${a.motivo}`,observaciones:a.observaciones};await _.put(`/api/tours/${E.value.id}/cambiar-estado`,H),f.add({severity:"info",summary:"Tour actualizado",detail:`El tour "${E.value.nombre}" tambiÃ©n ha sido reprogramado`,life:4e3})}catch(t){console.error("Error reprogramando tour:",t),f.add({severity:"warn",summary:"Advertencia",detail:"La reserva fue reprogramada pero hubo un error al actualizar el tour",life:4e3})}const g=m.value.findIndex(t=>t.id===a.reserva.id);g!==-1&&(m.value[g].estado="REPROGRAMADA",m.value[g].fecha_reserva=a.fechaNueva),U.value=!1,C.value=!1,await Promise.all([q(),te()]),f.add({severity:"success",summary:"Â¡Reprogramada!",detail:`Reserva de ${((l=(s=a.reserva.cliente)==null?void 0:s.user)==null?void 0:l.name)||((n=a.reserva.cliente)==null?void 0:n.nombres)} reprogramada correctamente`,life:4e3})}catch(i){console.error("Error reprogramando reserva:",i),f.add({severity:"error",summary:"Error",detail:((v=(p=i.response)==null?void 0:p.data)==null?void 0:v.message)||"No se pudo reprogramar la reserva",life:4e3})}finally{S.value=!1,J.value=!1}},qe=async a=>{await Te(a),C.value=!1},He=a=>{le(a)};xe(()=>[r.value.busqueda,r.value.fechaDesde,r.value.fechaHasta,r.value.tourSeleccionado],()=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{q()},500)},{deep:!0});const ne=()=>{Be(()=>{setTimeout(()=>{document.querySelectorAll(".p-select").forEach(s=>{const l=s.querySelector(".p-select-label, .p-placeholder");l&&(l.style.overflow="hidden",l.style.textOverflow="ellipsis",l.style.whiteSpace="nowrap",l.style.maxWidth="calc(100% - 2.5rem)",l.style.display="block")})},100)})};return xe([r],()=>{ne()},{deep:!0}),Pe(()=>{Q().then(()=>{Promise.all([ke(),te()]),ne()})}),(a,s)=>{const l=k("Toast"),n=k("Card"),p=k("InputText"),v=k("DatePicker"),i=k("Column"),g=k("DataTable");return h(),N(Ge,null,{default:b(()=>[d(o($e),{title:"GestiÃ³n de Reservas"}),d(l,{class:"z-[9999]"}),e("div",Qe,[s[27]||(s[27]=e("div",{class:"mb-6"},[e("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"GestiÃ³n de Reservas de Tours"),e("p",{class:"text-gray-600"},"Administra todas las reservas de tours")],-1)),e("div",Ye,[d(n,{class:"bg-gradient-to-r from-yellow-500 to-yellow-600"},{content:b(()=>[e("div",ea,[e("div",null,[s[11]||(s[11]=e("p",{class:"text-xs sm:text-sm opacity-90"},"Pendientes",-1)),e("p",aa,c(V.value.pendientes),1)]),d(o(x),{icon:o(we),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),d(n,{class:"bg-gradient-to-r from-green-500 to-green-600"},{content:b(()=>[e("div",sa,[e("div",null,[s[12]||(s[12]=e("p",{class:"text-xs sm:text-sm opacity-90"},"Confirmadas",-1)),e("p",ta,c(V.value.confirmadas),1)]),d(o(x),{icon:o(_e),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),d(n,{class:"bg-gradient-to-r from-blue-500 to-blue-600"},{content:b(()=>[e("div",la,[e("div",null,[s[13]||(s[13]=e("p",{class:"text-xs sm:text-sm opacity-90"},"Reprogramadas",-1)),e("p",oa,c(V.value.reprogramadas),1)]),d(o(x),{icon:o(Re),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),d(n,{class:"bg-gradient-to-r from-red-500 to-red-600"},{content:b(()=>[e("div",ra,[e("div",null,[s[14]||(s[14]=e("p",{class:"text-xs sm:text-sm opacity-90"},"Rechazadas",-1)),e("p",na,c(V.value.rechazadas),1)]),d(o(x),{icon:o(Ae),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),d(n,{class:"bg-gradient-to-r from-purple-500 to-purple-600"},{content:b(()=>[e("div",ia,[e("div",null,[s[15]||(s[15]=e("p",{class:"text-xs sm:text-sm opacity-90"},"Ingresos",-1)),e("p",da,"$"+c(V.value.totalIngresos.toFixed(2)),1)]),d(o(x),{icon:o(De),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1})]),e("div",ca,[e("div",ua,[e("div",null,[s[17]||(s[17]=e("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold text-center sm:text-start"},"Lista de reservas",-1)),e("p",ma,[d(o(x),{icon:o(We),class:"h-4 w-4 text-yellow-500"},null,8,["icon"]),s[16]||(s[16]=Ue(" Haz clic en cualquier fila para ver los detalles. "))])])]),e("div",va,[e("div",fa,[e("div",pa,[s[18]||(s[18]=e("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[e("i",{class:"pi pi-filter text-blue-600 text-sm"}),e("span",null,"Filtros")],-1)),e("div",xa,c(m.value.length)+" resultado"+c(m.value.length!==1?"s":""),1)]),e("div",ba,[e("button",{onClick:Q,disabled:R.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-2 py-1 text-xs text-white shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1"},[R.value?(h(),N(o(x),{key:0,icon:o(T),class:"animate-spin h-3 w-3"},null,8,["icon"])):O("",!0),e("span",ha,c(R.value?"Limpiando...":"Limpiar"),1)],8,ga),e("button",{onClick:oe,disabled:y.value,class:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 text-xs shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1"},[d(o(x),{icon:y.value?o(T):o(Ce),class:Y([{"animate-spin":y.value},"h-3 w-3"])},null,8,["icon","class"]),e("span",wa,c(y.value?"Recargando...":"Recargar"),1)],8,ya),e("button",{onClick:re,disabled:A.value,class:"bg-purple-500 hover:bg-purple-600 text-white px-2 py-1 text-xs shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-1",title:"Finaliza automÃ¡ticamente las reservas cuyas fechas de tour han pasado"},[A.value?(h(),N(o(x),{key:0,icon:o(T),class:"animate-spin h-3 w-3"},null,8,["icon"])):(h(),N(o(x),{key:1,icon:o(ee),class:"h-3"},null,8,["icon"])),A.value?O("",!0):(h(),F("span",Ra,"Finalizar"))],8,_a)]),e("div",Aa,[e("button",{onClick:Q,disabled:R.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[R.value?(h(),N(o(x),{key:0,icon:o(T),class:"animate-spin h-3 w-3"},null,8,["icon"])):O("",!0),e("span",null,c(R.value?"Limpiando...":"Limpiar filtros"),1)],8,Da),e("button",{onClick:oe,disabled:y.value,class:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 text-sm shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2 hidden sm:flex"},[d(o(x),{icon:y.value?o(T):o(Ce),class:Y([{"animate-spin":y.value},"h-3 w-3"])},null,8,["icon","class"]),e("span",null,c(y.value?"Recargando...":"Recargar"),1)],8,Ca),e("button",{onClick:re,disabled:A.value,class:"bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 text-sm shadow-md rounded-md disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2 hidden sm:flex",title:"Finaliza automÃ¡ticamente las reservas cuyas fechas de tour han pasado"},[A.value?(h(),N(o(x),{key:0,icon:o(T),class:"animate-spin h-3 w-3"},null,8,["icon"])):(h(),N(o(x),{key:1,icon:o(ee),class:"h-3"},null,8,["icon"])),A.value?O("",!0):(h(),F("span",za,"FinalizaciÃ³n AutomÃ¡tica"))],8,Ea)])]),e("div",Na,[e("div",null,[d(p,{modelValue:r.value.busqueda,"onUpdate:modelValue":s[0]||(s[0]=t=>r.value.busqueda=t),placeholder:"ðŸ” Buscar reservas...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),e("div",ka,[e("div",Fa,[be(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>r.value.estadoReserva=t),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[s[19]||(s[19]=e("option",{value:"",disabled:"",selected:"",hidden:""},"Estado",-1)),(h(),F(ge,null,he(L,t=>e("option",{key:t.value,value:t.value,class:"truncate text-gray-900"},c(t.label),9,Ta)),64))],512),[[ye,r.value.estadoReserva]])]),e("div",Ia,[be(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>r.value.tourSeleccionado=t),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate",disabled:$.value},[s[20]||(s[20]=e("option",{value:"",disabled:"",selected:"",hidden:""},"Filtrar por Tour",-1)),(h(!0),F(ge,null,he(I.value,t=>(h(),F("option",{key:t.id,value:t.id,class:"truncate text-gray-900"},c(t.nombre),9,La))),128))],8,Sa),[[ye,r.value.tourSeleccionado]])]),e("div",Va,[d(v,{modelValue:r.value.fechaDesde,"onUpdate:modelValue":s[3]||(s[3]=t=>r.value.fechaDesde=t),placeholder:"Fecha desde",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),e("div",Oa,[d(v,{modelValue:r.value.fechaHasta,"onUpdate:modelValue":s[4]||(s[4]=t=>r.value.fechaHasta=t),placeholder:"Fecha hasta",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),e("div",Ma,[d(v,{modelValue:r.value.fechaDesde,"onUpdate:modelValue":s[5]||(s[5]=t=>r.value.fechaDesde=t),placeholder:"Fecha desde",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"]),d(v,{modelValue:r.value.fechaHasta,"onUpdate:modelValue":s[6]||(s[6]=t=>r.value.fechaHasta=t),placeholder:"Fecha hasta",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"])])]),j.value?(h(),F("div",ja,[e("div",qa,[e("div",Ha,[s[21]||(s[21]=e("span",{class:"text-blue-600 font-medium"},"ðŸï¸ Mostrando reservas para:",-1)),e("span",Pa,c(j.value.nombre),1)]),e("div",$a,[e("span",Ua,c(j.value.totalReservas),1),e("span",null,c(j.value.totalReservas===1?" reserva encontrada":" reservas encontradas"),1)])])])):O("",!0)])]),d(g,{value:se.value,paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} reservas",responsiveLayout:"scroll",class:"mt-2 sm:mt-4 overflow-x-auto",onRowClick:Se,pt:{root:{class:"text-xs sm:text-sm"},wrapper:{class:"text-xs sm:text-sm overflow-x-auto"},table:{class:"text-xs sm:text-sm min-w-full"},thead:{class:"text-xs sm:text-sm"},headerRow:{class:"text-xs sm:text-sm"},headerCell:{class:"text-xs sm:text-sm font-medium py-2 sm:py-3 px-1 sm:px-2"},tbody:{class:"text-xs sm:text-sm"},bodyRow:{class:"text-xs sm:text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-2 sm:py-3 px-1 sm:px-2 text-xs sm:text-sm"}}},{empty:b(()=>[e("div",Ba,[d(o(x),{icon:o(Je),class:"text-4xl text-gray-400 mb-4"},null,8,["icon"]),s[22]||(s[22]=e("p",{class:"text-gray-500 text-lg"},"No se encontraron reservas",-1)),s[23]||(s[23]=e("p",{class:"text-gray-400 text-sm mt-2"}," Ajusta los filtros para encontrar las reservas que buscas ",-1))])]),loading:b(()=>s[24]||(s[24]=[e("div",{class:"text-center py-12"},[e("i",{class:"pi pi-spin pi-spinner text-3xl text-blue-500 mb-4"}),e("p",{class:"text-gray-500 text-lg"},"Cargando reservas...")],-1)])),default:b(()=>[d(i,{field:"fecha_reserva",header:"Fecha",sortable:"",class:"w-16 sm:w-20 lg:w-24 min-w-14"},{body:b(t=>[e("div",Ga,[e("div",Za,c(Ve(t.data.fecha_reserva)),1)])]),_:1}),d(i,{field:"cliente.nombres",header:"Cliente",sortable:"",class:"w-24 sm:w-32 lg:w-40 min-w-20 hidden sm:table-cell"},{body:b(t=>{var w,z,D,H,ie,de,ce,ue,me,ve,fe,pe;return[e("div",Wa,[e("div",Xa,[d(o(x),{icon:o(Ee),class:"text-blue-600 text-xs sm:text-sm"},null,8,["icon"])]),e("div",Ja,[e("div",{class:"font-medium text-gray-900 text-xs sm:text-sm truncate",title:((z=(w=t.data.cliente)==null?void 0:w.user)==null?void 0:z.name)||((D=t.data.cliente)==null?void 0:D.nombres)||"N/A"},c(((ie=(H=t.data.cliente)==null?void 0:H.user)==null?void 0:ie.name)||((de=t.data.cliente)==null?void 0:de.nombres)||"N/A"),9,Ka),e("div",{class:"text-xs text-gray-500 truncate hidden sm:block",title:((ue=(ce=t.data.cliente)==null?void 0:ce.user)==null?void 0:ue.email)||((me=t.data.cliente)==null?void 0:me.correo)||"N/A"},c(((fe=(ve=t.data.cliente)==null?void 0:ve.user)==null?void 0:fe.email)||((pe=t.data.cliente)==null?void 0:pe.correo)||"N/A"),9,Qa)])])]}),_:1}),d(i,{field:"entidad_nombre",header:"Servicio",sortable:"",class:"w-24 sm:w-32 lg:w-48 min-w-20"},{body:b(t=>[e("div",Ya,[e("div",{class:"text-xs sm:text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"120px","text-overflow":"ellipsis","white-space":"nowrap"},title:t.data.entidad_nombre},c(t.data.entidad_nombre||"N/A"),9,es),s[25]||(s[25]=e("div",{class:"text-xs text-gray-500 capitalize hidden sm:block"}," Tours ",-1))])]),_:1}),d(i,{header:"Personas",class:"w-16 sm:w-20 lg:w-24 min-w-14 hidden md:table-cell"},{body:b(t=>[e("div",as,[e("div",ss,[d(o(x),{icon:o(Ee),class:"text-gray-400 text-xs"},null,8,["icon"]),e("span",ts,c((t.data.mayores_edad||0)+(t.data.menores_edad||0)),1)]),e("div",ls,c(t.data.mayores_edad||0)+"A â€¢ "+c(t.data.menores_edad||0)+"N ",1)])]),_:1}),d(i,{field:"total",header:"Total",sortable:"",class:"w-16 sm:w-20 lg:w-24 min-w-14"},{body:b(t=>[e("div",os,[e("div",rs,[d(o(x),{icon:o(De),class:"text-xs"},null,8,["icon"]),e("span",ns,c(Number(t.data.total||0).toFixed(2)),1)])])]),_:1}),d(i,{field:"estado",header:"Estado",class:"w-20 sm:w-24 lg:w-32 min-w-16 hidden lg:table-cell"},{body:b(t=>{var w,z;return[e("span",{class:Y([Le(t.data.estado),"px-1 sm:px-2 py-1 rounded-full text-xs font-medium"])},[e("span",is,c(((w=L.find(D=>D.value===t.data.estado))==null?void 0:w.label)||t.data.estado),1),e("span",ds,c((((z=L.find(D=>D.value===t.data.estado))==null?void 0:z.label)||t.data.estado).substring(0,4)),1)],2)]}),_:1}),d(i,{header:"Acciones",class:"w-20 sm:w-24 lg:w-28 min-w-16"},{body:b(t=>[e("div",cs,[e("button",{class:"bg-green-500 hover:bg-green-600 text-white px-2 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-1 text-xs shadow-md hover:shadow-lg hover:-translate-y-1",onClick:w=>Ie(t.data),title:"MÃ¡s acciones"},[d(o(x),{icon:o(Xe),class:"h-3 w-4 sm:h-4 sm:w-5"},null,8,["icon"]),s[26]||(s[26]=e("span",{class:"hidden md:inline"},"MÃ¡s",-1))],8,us)])]),_:1})]),_:1},8,["value"]),d(Ke,{visible:C.value,"onUpdate:visible":s[7]||(s[7]=t=>C.value=t),"detalles-visible":G.value,"onUpdate:detallesVisible":s[8]||(s[8]=t=>G.value=t),"rechazar-visible":B.value,"onUpdate:rechazarVisible":s[9]||(s[9]=t=>B.value=t),"reprogramar-visible":U.value,"onUpdate:reprogramarVisible":s[10]||(s[10]=t=>U.value=t),reserva:Z.value,tour:E.value,"dialog-style":Ne.value,procesando:S.value,"confirmando-reserva":W.value,"rechazando-reserva":X.value,"reprogramando-reserva":J.value,"finalizando-reserva":K.value,"estados-reservas":L,"estados-tours":ze,onConfirmar:Oe,onRechazar:Me,onReprogramar:je,onFinalizar:qe,onVerDetalles:He},null,8,["visible","detalles-visible","rechazar-visible","reprogramar-visible","reserva","tour","dialog-style","procesando","confirmando-reserva","rechazando-reserva","reprogramando-reserva","finalizando-reserva"])])])]),_:1})}}};export{ys as default};
