import{N as z,r as _,E as ve,w as Fe,o as Ie,k as E,c as R,d as D,p as s,$ as l,a0 as Le,x as p,e as a,t as o,q as b,F as le,l as ge,y as oe,j as F}from"./vendor-MWUC2OHw.js";import{A as Ve}from"./AuthenticatedLayout-NCt8z6zL.js";import{z as Oe,A as c}from"./ui-C5wTtX7s.js";import{p as $e,e as re,d as P,q as K,r as ne,i as Se,s as ie,t as pe,o as Me,u as fe,g as Pe}from"./index-DNF_ZrrQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const qe={class:"px-auto md:px-2 mt-6"},Ue={class:"flex flex-col lg:flex-row lg:justify-between lg:items-center mb-6 gap-4"},He={class:"grid grid-cols-2 lg:grid-cols-5 gap-2 lg:gap-4 text-center"},je={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},Ge={class:"text-lg font-bold text-yellow-600"},Ze={class:"bg-green-50 border border-green-200 rounded-lg p-3"},Be={class:"text-lg font-bold text-green-600"},Xe={class:"bg-blue-50 border border-blue-200 rounded-lg p-3"},Je={class:"text-lg font-bold text-blue-600"},Ke={class:"bg-red-50 border border-red-200 rounded-lg p-3"},Qe={class:"text-lg font-bold text-red-600"},We={class:"bg-gray-50 border border-gray-200 rounded-lg p-3"},Ye={class:"text-lg font-bold text-green-600"},ea={class:"bg-blue-50 p-4 rounded-lg shadow-sm border mb-6"},aa={class:"flex flex-col sm:flex-row items-center justify-between mb-3 gap-3"},ta={class:"flex items-center gap-3"},sa={class:"text-base font-medium text-gray-800 flex items-center gap-2"},la={class:"bg-blue-100 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},oa={class:"flex flex-col sm:flex-row gap-2"},ra=["disabled"],na={key:0},ia={key:1},da={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ua={class:"bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full text-xs"},ca={class:"text-center py-12"},ma={class:"text-gray-500 text-lg"},va={class:"text-gray-400 text-sm mt-2"},ga={class:"text-sm"},pa={class:"font-medium"},fa={class:"text-xs text-gray-500"},xa={class:"flex items-center gap-3"},ba={class:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center"},ya={class:"font-medium text-gray-900"},ha={class:"text-sm text-gray-500"},_a=["title"],wa={class:"text-sm text-gray-500 capitalize"},Aa={class:"text-center"},Ra={class:"text-sm flex items-center justify-center gap-1"},Da={class:"font-medium"},Ca={class:"text-xs text-gray-500"},Ea={class:"text-right"},Na={class:"font-medium text-green-600 flex items-center justify-end gap-1"},Ta={class:"flex gap-1 flex-wrap justify-center"},ka=["onClick"],za=["onClick"],Fa=["onClick"],Ia=["onClick"],La=["onClick"],Va={key:0,class:"space-y-6"},Oa={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},$a={class:"font-semibold text-blue-800 mb-3 flex items-center gap-2"},Sa={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm"},Ma={class:"ml-2"},Pa={class:"ml-2"},qa={class:"ml-2"},Ua={class:"ml-2"},Ha={class:"bg-gray-50 border border-gray-200 rounded-lg p-4"},ja={class:"font-semibold text-gray-800 mb-3 flex items-center gap-2"},Ga={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm"},Za={class:"ml-2"},Ba={class:"ml-2 capitalize"},Xa={class:"ml-2"},Ja={class:"bg-green-50 border border-green-200 rounded-lg p-4"},Ka={class:"font-semibold text-green-800 mb-3 flex items-center gap-2"},Qa={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm"},Wa={class:"ml-2"},Ya={class:"ml-2"},et={class:"ml-2 font-bold text-green-600"},at={class:"flex justify-center w-full"},tt={class:"space-y-4"},st={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4"},lt={class:"flex items-center gap-3 mb-3"},ot={class:"text-sm space-y-1"},rt={class:"text-gray-500 text-xs mt-1"},nt={class:"flex justify-center gap-3 w-full"},it=["disabled"],dt={class:"space-y-6"},ut={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},ct={class:"flex items-center gap-3 mb-3"},mt={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm"},vt={class:"ml-2"},gt={class:"ml-2"},pt={class:"ml-2"},ft={class:"ml-2 font-bold text-green-600"},xt={key:1,class:"bg-purple-50 border border-purple-200 rounded-lg p-4"},bt={class:"flex items-center gap-3 mb-3"},yt={class:"text-sm space-y-1"},ht={class:"grid grid-cols-1 sm:grid-cols-1 gap-4"},_t={class:"text-gray-500 text-xs mt-1"},wt={class:"text-gray-500 text-xs mt-1"},At={class:"flex justify-center gap-3 w-full"},Rt=["disabled"],zt={__name:"ReservaTours",setup(Dt){z.defaults.withCredentials=!0;const h=Oe(),v=_([]),W=_([]),L=_(!1),de=_(!1),g=_({tipo:"tours",busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:null,estadoTour:null}),q=_(!1),U=_(!1),Q=_(!1);_(!1);const n=_(null),T=_(null),V=_(""),k=_(null),I=_(""),O=_(""),Y=_(0),$=[{label:"Pendientes",value:"PENDIENTE",severity:"warn",color:"bg-yellow-100 text-yellow-800",icon:$e},{label:"Confirmadas",value:"CONFIRMADA",severity:"success",color:"bg-green-100 text-green-800",icon:re},{label:"Rechazadas",value:"RECHAZADA",severity:"danger",color:"bg-red-100 text-red-800",icon:P},{label:"Reprogramadas",value:"REPROGRAMADA",severity:"info",color:"bg-blue-100 text-blue-800",icon:K},{label:"Finalizadas",value:"FINALIZADA",severity:"secondary",color:"bg-gray-100 text-gray-800",icon:ne}],ue=[{label:"Disponible",value:"DISPONIBLE",color:"bg-green-100 text-green-800"},{label:"Agotado",value:"AGOTADO",color:"bg-red-100 text-red-800"},{label:"En Curso",value:"EN_CURSO",color:"bg-blue-100 text-blue-800"},{label:"Completado",value:"COMPLETADO",color:"bg-gray-100 text-gray-800"},{label:"Cancelado",value:"CANCELADO",color:"bg-red-100 text-red-800"},{label:"Suspendido",value:"SUSPENDIDO",color:"bg-orange-100 text-orange-800"},{label:"Reprogramado",value:"REPROGRAMADO",color:"bg-purple-100 text-purple-800"}],xe=ve(()=>{var u;const t=(u=$[Y.value])==null?void 0:u.value;let e=v.value.filter(d=>d.estado===t);if(g.value.busqueda){const d=g.value.busqueda.toLowerCase();e=e.filter(f=>{var m,x,w,C,S,M;return(((x=(m=f.cliente)==null?void 0:m.user)==null?void 0:x.name)||((w=f.cliente)==null?void 0:w.nombres)||"").toLowerCase().includes(d)||(f.entidad_nombre||"").toLowerCase().includes(d)||(((S=(C=f.cliente)==null?void 0:C.user)==null?void 0:S.email)||((M=f.cliente)==null?void 0:M.correo)||"").toLowerCase().includes(d)})}return g.value.fechaDesde&&(e=e.filter(d=>new Date(d.fecha_reserva)>=new Date(g.value.fechaDesde))),g.value.fechaHasta&&(e=e.filter(d=>new Date(d.fecha_reserva)<=new Date(g.value.fechaHasta))),e}),H=ve(()=>({pendientes:v.value.filter(t=>t.estado==="PENDIENTE").length,confirmadas:v.value.filter(t=>t.estado==="CONFIRMADA").length,reprogramadas:v.value.filter(t=>t.estado==="REPROGRAMADA").length,rechazadas:v.value.filter(t=>t.estado==="RECHAZADA").length,finalizadas:v.value.filter(t=>t.estado==="FINALIZADA").length,totalIngresos:v.value.filter(t=>["CONFIRMADA","FINALIZADA"].includes(t.estado)).reduce((t,e)=>t+(Number(e.total)||0),0)})),j=async()=>{L.value=!0;try{const t={tipo:g.value.tipo,busqueda:g.value.busqueda||void 0,fecha_inicio:g.value.fechaDesde||void 0,fecha_fin:g.value.fechaHasta||void 0},e=await z.get("/api/reservas",{params:t,withCredentials:!0});v.value=e.data.data||[]}catch(t){console.error("Error cargando reservas:",t),h.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las reservas",life:4e3}),v.value=[]}finally{L.value=!1}},ce=async()=>{de.value=!0;try{const t=await z.get("/api/tours");W.value=t.data||[]}catch(t){console.error("Error cargando tours:",t),W.value=[]}finally{de.value=!1}},be=async t=>{var e,u,d,f,m;try{const x=await z.put(`/api/reservas/${t.id}/confirmar`),w=v.value.findIndex(C=>C.id===t.id);w!==-1&&(v.value[w].estado="CONFIRMADA"),h.add({severity:"success",summary:"¡Confirmada!",detail:`Reserva de ${((u=(e=t.cliente)==null?void 0:e.user)==null?void 0:u.name)||((d=t.cliente)==null?void 0:d.nombres)} confirmada correctamente`,life:4e3})}catch(x){console.error("Error confirmando reserva:",x),h.add({severity:"error",summary:"Error",detail:((m=(f=x.response)==null?void 0:f.data)==null?void 0:m.message)||"No se pudo confirmar la reserva",life:4e3})}},ye=t=>{n.value=t,V.value="",U.value=!0},he=async()=>{var t,e,u,d,f;if(!V.value.trim()){h.add({severity:"warn",summary:"Campo requerido",detail:"Debe ingresar un motivo para rechazar la reserva",life:4e3});return}try{await z.put(`/api/reservas/${n.value.id}/rechazar`,{motivo:V.value});const m=v.value.findIndex(x=>x.id===n.value.id);m!==-1&&(v.value[m].estado="RECHAZADA"),U.value=!1,h.add({severity:"success",summary:"¡Rechazada!",detail:`Reserva de ${((e=(t=n.value.cliente)==null?void 0:t.user)==null?void 0:e.name)||((u=n.value.cliente)==null?void 0:u.nombres)} rechazada correctamente`,life:4e3})}catch(m){console.error("Error rechazando reserva:",m),h.add({severity:"error",summary:"Error",detail:((f=(d=m.response)==null?void 0:d.data)==null?void 0:f.message)||"No se pudo rechazar la reserva",life:4e3})}},_e=t=>{n.value=t,k.value=null,I.value="",O.value="";const e=W.value.find(u=>{var d;return((d=t.detallesTours)==null?void 0:d.some(f=>f.tour_id===u.id))||t.entidad_nombre===u.nombre});T.value=e,q.value=!0},we=async()=>{var t,e,u,d,f;if(!k.value||!I.value.trim()){h.add({severity:"warn",summary:"Campos requeridos",detail:"Debe ingresar una nueva fecha y motivo para reprogramar",life:4e3});return}try{const m={fecha_nueva:k.value,motivo:I.value,observaciones:O.value};if(await z.put(`/api/reservas/${n.value.id}/reprogramar`,m),T.value)try{const w=new Date(T.value.fecha_salida),S=new Date(T.value.fecha_regreso).getTime()-w.getTime(),M=new Date(new Date(k.value).getTime()+S),ae={estado:"REPROGRAMADO",fecha_salida:k.value,fecha_regreso:M,motivo_reprogramacion:`Reprogramado por reserva: ${I.value}`,observaciones:O.value};await z.put(`/api/tours/${T.value.id}/cambiar-estado`,ae),h.add({severity:"info",summary:"Tour actualizado",detail:`El tour "${T.value.nombre}" también ha sido reprogramado`,life:4e3})}catch(w){console.error("Error reprogramando tour:",w),h.add({severity:"warn",summary:"Advertencia",detail:"La reserva fue reprogramada pero hubo un error al actualizar el tour",life:4e3})}const x=v.value.findIndex(w=>w.id===n.value.id);x!==-1&&(v.value[x].estado="REPROGRAMADA",v.value[x].fecha_reserva=k.value),q.value=!1,await Promise.all([j(),ce()]),h.add({severity:"success",summary:"¡Reprogramada!",detail:`Reserva de ${((e=(t=n.value.cliente)==null?void 0:t.user)==null?void 0:e.name)||((u=n.value.cliente)==null?void 0:u.nombres)} reprogramada correctamente`,life:4e3})}catch(m){console.error("Error reprogramando reserva:",m),h.add({severity:"error",summary:"Error",detail:((f=(d=m.response)==null?void 0:d.data)==null?void 0:f.message)||"No se pudo reprogramar la reserva",life:4e3})}},Ae=async t=>{var e,u,d,f,m;try{await z.put(`/api/reservas/${t.id}/finalizar`);const x=v.value.findIndex(w=>w.id===t.id);x!==-1&&(v.value[x].estado="FINALIZADA"),h.add({severity:"success",summary:"¡Finalizada!",detail:`Reserva de ${((u=(e=t.cliente)==null?void 0:e.user)==null?void 0:u.name)||((d=t.cliente)==null?void 0:d.nombres)} finalizada correctamente. Email de confirmación enviado.`,life:4e3})}catch(x){console.error("Error finalizando reserva:",x),h.add({severity:"error",summary:"Error",detail:((m=(f=x.response)==null?void 0:f.data)==null?void 0:m.message)||"No se pudo finalizar la reserva",life:4e3})}},Re=t=>{n.value=t,Q.value=!0},G=t=>{switch(t.estado){case"PENDIENTE":return["confirmar","rechazar","reprogramar","detalles"];case"CONFIRMADA":return["rechazar","reprogramar","finalizar","detalles"];case"REPROGRAMADA":return["rechazar","finalizar","detalles"];case"RECHAZADA":return["detalles"];case"FINALIZADA":return["detalles"];default:return["detalles"]}},me=t=>{const e=$.find(u=>u.value===t);return(e==null?void 0:e.color)||"bg-gray-100 text-gray-800"},De=t=>{const e=ue.find(u=>u.value===t);return(e==null?void 0:e.color)||"bg-gray-100 text-gray-800"},ee=t=>t?new Date(t).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",Ce=t=>t?new Date(t).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",Ee=()=>{g.value={tipo:"tours",busqueda:"",fechaDesde:null,fechaHasta:null,estadoReserva:null,estadoTour:null},j()},Ne=()=>new Date,Te=async()=>{var t,e;try{L.value=!0;const d=(await z.post("/api/reservas/finalizar-automaticamente")).data;d.success?(h.add({severity:"success",summary:"¡Finalización automática completada!",detail:`${d.reservas_finalizadas} reserva(s) finalizada(s) de ${d.reservas_procesadas} procesada(s)`,life:6e3}),await j()):h.add({severity:"warn",summary:"Sin cambios",detail:d.message||"No hay reservas pendientes de finalización",life:4e3})}catch(u){console.error("Error en finalización automática:",u),h.add({severity:"error",summary:"Error",detail:((e=(t=u.response)==null?void 0:t.data)==null?void 0:e.message)||"Error al ejecutar la finalización automática",life:4e3})}finally{L.value=!1}};return Fe(()=>[g.value.busqueda,g.value.fechaDesde,g.value.fechaHasta],()=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{j()},500)},{deep:!0}),Ie(()=>{Promise.all([j(),ce()])}),(t,e)=>{const u=E("Toast"),d=E("Select"),f=E("InputText"),m=E("DatePicker"),x=E("Tab"),w=E("TabList"),C=E("Column"),S=E("DataTable"),M=E("TabPanel"),ae=E("TabPanels"),ke=E("Tabs"),te=E("Dialog"),se=E("Textarea");return D(),R(le,null,[s(l(Le),{title:"Gestión de Reservas"}),s(Ve,null,{default:p(()=>[s(u,{class:"z-[9999]"}),a("div",qe,[a("div",Ue,[e[20]||(e[20]=a("div",null,[a("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold"},"Gestión de Reservas"),a("p",{class:"text-gray-600 mt-1"},"Administra todas las reservas de tours, hoteles y aerolíneas")],-1)),a("div",He,[a("div",je,[a("div",Ge,o(H.value.pendientes),1),e[15]||(e[15]=a("div",{class:"text-xs text-yellow-600"},"Pendientes",-1))]),a("div",Ze,[a("div",Be,o(H.value.confirmadas),1),e[16]||(e[16]=a("div",{class:"text-xs text-green-600"},"Confirmadas",-1))]),a("div",Xe,[a("div",Je,o(H.value.reprogramadas),1),e[17]||(e[17]=a("div",{class:"text-xs text-blue-600"},"Reprogramadas",-1))]),a("div",Ke,[a("div",Qe,o(H.value.rechazadas),1),e[18]||(e[18]=a("div",{class:"text-xs text-red-600"},"Rechazadas",-1))]),a("div",We,[a("div",Ye,"$"+o(H.value.totalIngresos.toFixed(2)),1),e[19]||(e[19]=a("div",{class:"text-xs text-gray-600"},"Ingresos",-1))])])]),a("div",ea,[a("div",aa,[a("div",ta,[a("h3",sa,[s(l(c),{icon:l(Se),class:"text-blue-600 text-sm"},null,8,["icon"]),e[21]||(e[21]=a("span",null,"Filtros",-1))]),a("div",la,o(v.value.length)+" reserva"+o(v.value.length!==1?"s":"")+" total"+o(v.value.length!==1?"es":""),1)]),a("div",oa,[a("button",{class:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md text-sm transition-colors duration-200 flex items-center gap-2 justify-center",onClick:Ee},[s(l(c),{icon:l(P),class:"h-4"},null,8,["icon"]),e[22]||(e[22]=b(" Limpiar filtros "))]),a("button",{class:"bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-md text-sm transition-colors duration-200 flex items-center gap-2 justify-center",onClick:Te,disabled:L.value,title:"Finaliza automáticamente las reservas cuyas fechas de tour han pasado"},[s(l(c),{icon:l(ne),class:"h-4"},null,8,["icon"]),L.value?(D(),R("span",ia,"Procesando...")):(D(),R("span",na,"Finalización Automática"))],8,ra)])]),a("div",da,[a("div",null,[e[23]||(e[23]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de Reserva",-1)),s(d,{modelValue:g.value.tipo,"onUpdate:modelValue":e[0]||(e[0]=i=>g.value.tipo=i),options:[{label:"Tours",value:"tours"},{label:"Hoteles",value:"hoteles"},{label:"Aerolíneas",value:"aerolineas"}],optionLabel:"label",optionValue:"value",class:"w-full h-9",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),a("div",null,[e[24]||(e[24]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Buscar",-1)),s(f,{modelValue:g.value.busqueda,"onUpdate:modelValue":e[1]||(e[1]=i=>g.value.busqueda=i),placeholder:"🔍 Cliente, servicio, email...",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),a("div",null,[e[25]||(e[25]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha desde",-1)),s(m,{modelValue:g.value.fechaDesde,"onUpdate:modelValue":e[2]||(e[2]=i=>g.value.fechaDesde=i),dateFormat:"dd/mm/yy",class:"w-full h-9",showIcon:"",placeholder:"Fecha inicio",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),a("div",null,[e[26]||(e[26]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha hasta",-1)),s(m,{modelValue:g.value.fechaHasta,"onUpdate:modelValue":e[3]||(e[3]=i=>g.value.fechaHasta=i),dateFormat:"dd/mm/yy",class:"w-full h-9",showIcon:"",placeholder:"Fecha fin",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])])])]),s(ke,{value:Y.value,"onUpdate:value":e[4]||(e[4]=i=>Y.value=i),class:"bg-white rounded-lg shadow"},{default:p(()=>[s(w,null,{default:p(()=>[(D(),R(le,null,ge($,(i,N)=>s(x,{key:i.value,value:N,class:"flex items-center gap-2"},{default:p(()=>[s(l(c),{icon:i.icon,class:"h-4"},null,8,["icon"]),b(" "+o(i.label)+" ",1),a("span",ua,o(v.value.filter(r=>r.estado===i.value).length),1)]),_:2},1032,["value"])),64))]),_:1}),s(ae,null,{default:p(()=>[(D(),R(le,null,ge($,(i,N)=>s(M,{key:i.value,value:N},{default:p(()=>[s(S,{value:xe.value,loading:L.value,paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} reservas",responsiveLayout:"scroll",class:"mt-4",pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"text-sm hover:bg-gray-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"}}},{empty:p(()=>[a("div",ca,[s(l(c),{icon:l(fe),class:"text-4xl text-gray-400 mb-4"},null,8,["icon"]),a("p",ma,"No hay reservas "+o(i.label.toLowerCase()),1),a("p",va,o(i.value==="PENDIENTE"?"Las nuevas reservas aparecerán aquí":"No se encontraron registros"),1)])]),loading:p(()=>e[27]||(e[27]=[a("div",{class:"text-center py-12"},[a("i",{class:"pi pi-spin pi-spinner text-3xl text-blue-500 mb-4"}),a("p",{class:"text-gray-500 text-lg"},"Cargando reservas...")],-1)])),default:p(()=>[s(C,{field:"fecha_reserva",header:"Fecha",sortable:"",class:"w-24 min-w-20"},{body:p(r=>[a("div",ga,[a("div",pa,o(ee(r.data.fecha_reserva)),1),a("div",fa,o(new Date(r.data.fecha_reserva).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})),1)])]),_:1}),s(C,{field:"cliente.nombres",header:"Cliente",sortable:"",class:"w-40 min-w-32"},{body:p(r=>{var y,A,Z,B,X,J;return[a("div",xa,[a("div",ba,[s(l(c),{icon:l(ie),class:"text-blue-600 text-sm"},null,8,["icon"])]),a("div",null,[a("div",ya,o(((A=(y=r.data.cliente)==null?void 0:y.user)==null?void 0:A.name)||((Z=r.data.cliente)==null?void 0:Z.nombres)||"N/A"),1),a("div",ha,o(((X=(B=r.data.cliente)==null?void 0:B.user)==null?void 0:X.email)||((J=r.data.cliente)==null?void 0:J.correo)||"N/A"),1)])])]}),_:1}),s(C,{field:"entidad_nombre",header:"Servicio",sortable:"",class:"w-48 min-w-40"},{body:p(r=>[a("div",null,[a("div",{class:"font-medium text-gray-900 overflow-hidden",style:{"max-width":"180px","text-overflow":"ellipsis","white-space":"nowrap"},title:r.data.entidad_nombre},o(r.data.entidad_nombre||"N/A"),9,_a),a("div",wa,o(r.data.tipo||"N/A"),1)])]),_:1}),s(C,{header:"Personas",class:"w-24 min-w-20 hidden md:table-cell"},{body:p(r=>[a("div",Aa,[a("div",Ra,[s(l(c),{icon:l(ie),class:"text-gray-400 text-xs"},null,8,["icon"]),a("span",Da,o((r.data.mayores_edad||0)+(r.data.menores_edad||0)),1)]),a("div",Ca,o(r.data.mayores_edad||0)+"A • "+o(r.data.menores_edad||0)+"N ",1)])]),_:1}),s(C,{field:"total",header:"Total",sortable:"",class:"w-24 min-w-20"},{body:p(r=>[a("div",Ea,[a("div",Na,[s(l(c),{icon:l(pe),class:"text-xs"},null,8,["icon"]),b(" "+o(Number(r.data.total||0).toFixed(2)),1)])])]),_:1}),s(C,{field:"estado",header:"Estado",class:"w-32 min-w-28 hidden lg:table-cell"},{body:p(r=>{var y;return[a("span",{class:oe([me(r.data.estado),"px-2 py-1 rounded-full text-xs font-medium"])},o(((y=$.find(A=>A.value===r.data.estado))==null?void 0:y.label)||r.data.estado),3)]}),_:2},1024),s(C,{header:"Acciones",class:"w-56 min-w-48"},{body:p(r=>[a("div",Ta,[G(r.data).includes("detalles")?(D(),R("button",{key:0,class:"bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:y=>Re(r.data),title:"Ver detalles"},[s(l(c),{icon:l(Me),class:"text-xs"},null,8,["icon"]),e[28]||(e[28]=a("span",{class:"hidden sm:inline"},"Detalles",-1))],8,ka)):F("",!0),G(r.data).includes("confirmar")?(D(),R("button",{key:1,class:"bg-green-500 hover:bg-green-600 text-white px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:y=>be(r.data),title:"Confirmar reserva"},[s(l(c),{icon:l(re),class:"text-xs"},null,8,["icon"]),e[29]||(e[29]=a("span",{class:"hidden sm:inline"},"Confirmar",-1))],8,za)):F("",!0),G(r.data).includes("rechazar")?(D(),R("button",{key:2,class:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:y=>ye(r.data),title:"Rechazar reserva"},[s(l(c),{icon:l(P),class:"text-xs"},null,8,["icon"]),e[30]||(e[30]=a("span",{class:"hidden sm:inline"},"Rechazar",-1))],8,Fa)):F("",!0),G(r.data).includes("reprogramar")?(D(),R("button",{key:3,class:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:y=>_e(r.data),title:"Reprogramar reserva"},[s(l(c),{icon:l(K),class:"text-xs"},null,8,["icon"]),e[31]||(e[31]=a("span",{class:"hidden sm:inline"},"Reprogramar",-1))],8,Ia)):F("",!0),G(r.data).includes("finalizar")?(D(),R("button",{key:4,class:"bg-purple-500 hover:bg-purple-600 text-white px-2 py-1 rounded text-xs transition-colors flex items-center gap-1",onClick:y=>Ae(r.data),title:"Finalizar reserva"},[s(l(c),{icon:l(ne),class:"text-xs"},null,8,["icon"]),e[32]||(e[32]=a("span",{class:"hidden sm:inline"},"Finalizar",-1))],8,La)):F("",!0)])]),_:1})]),_:2},1032,["value","loading"])]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["value"]),s(te,{visible:Q.value,"onUpdate:visible":e[6]||(e[6]=i=>Q.value=i),modal:"",header:"Detalles de la Reserva",style:{width:"600px"},closable:!1,draggable:!1},{footer:p(()=>[a("div",at,[a("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded transition-colors flex items-center gap-2",onClick:e[5]||(e[5]=i=>Q.value=!1)},[s(l(c),{icon:l(P),class:"h-4"},null,8,["icon"]),e[47]||(e[47]=b(" Cerrar "))])])]),default:p(()=>{var i,N,r,y,A,Z,B,X,J;return[n.value?(D(),R("div",Va,[a("div",Oa,[a("h4",$a,[s(l(c),{icon:l(ie),class:"text-blue-600"},null,8,["icon"]),e[33]||(e[33]=b(" Información del Cliente "))]),a("div",Sa,[a("div",null,[e[34]||(e[34]=a("span",{class:"font-medium text-gray-700"},"Nombre:",-1)),a("span",Ma,o(((N=(i=n.value.cliente)==null?void 0:i.user)==null?void 0:N.name)||((r=n.value.cliente)==null?void 0:r.nombres)||"N/A"),1)]),a("div",null,[e[35]||(e[35]=a("span",{class:"font-medium text-gray-700"},"Email:",-1)),a("span",Pa,o(((A=(y=n.value.cliente)==null?void 0:y.user)==null?void 0:A.email)||((Z=n.value.cliente)==null?void 0:Z.correo)||"N/A"),1)]),a("div",null,[e[36]||(e[36]=a("span",{class:"font-medium text-gray-700"},"Teléfono:",-1)),a("span",qa,o(((B=n.value.cliente)==null?void 0:B.telefono)||"N/A"),1)]),a("div",null,[e[37]||(e[37]=a("span",{class:"font-medium text-gray-700"},"Documento:",-1)),a("span",Ua,o(((X=n.value.cliente)==null?void 0:X.numero_documento)||"N/A"),1)])])]),a("div",Ha,[a("h4",ja,[s(l(c),{icon:l(K),class:"text-gray-600"},null,8,["icon"]),e[38]||(e[38]=b(" Información del Servicio "))]),a("div",Ga,[a("div",null,[e[39]||(e[39]=a("span",{class:"font-medium text-gray-700"},"Servicio:",-1)),a("span",Za,o(n.value.entidad_nombre||"N/A"),1)]),a("div",null,[e[40]||(e[40]=a("span",{class:"font-medium text-gray-700"},"Tipo:",-1)),a("span",Ba,o(n.value.tipo||"N/A"),1)]),a("div",null,[e[41]||(e[41]=a("span",{class:"font-medium text-gray-700"},"Fecha:",-1)),a("span",Xa,o(Ce(n.value.fecha_reserva)),1)]),a("div",null,[e[42]||(e[42]=a("span",{class:"font-medium text-gray-700"},"Estado:",-1)),a("span",{class:oe([me(n.value.estado),"ml-2 px-2 py-1 rounded-full text-xs font-medium"])},o(((J=$.find(ze=>ze.value===n.value.estado))==null?void 0:J.label)||n.value.estado),3)])])]),a("div",Ja,[a("h4",Ka,[s(l(c),{icon:l(pe),class:"text-green-600"},null,8,["icon"]),e[43]||(e[43]=b(" Detalles de la Reserva "))]),a("div",Qa,[a("div",null,[e[44]||(e[44]=a("span",{class:"font-medium text-gray-700"},"Adultos:",-1)),a("span",Wa,o(n.value.mayores_edad||0),1)]),a("div",null,[e[45]||(e[45]=a("span",{class:"font-medium text-gray-700"},"Niños:",-1)),a("span",Ya,o(n.value.menores_edad||0),1)]),a("div",null,[e[46]||(e[46]=a("span",{class:"font-medium text-gray-700"},"Total:",-1)),a("span",et,"$"+o(Number(n.value.total||0).toFixed(2)),1)])])])])):F("",!0)]}),_:1},8,["visible"]),s(te,{visible:U.value,"onUpdate:visible":e[9]||(e[9]=i=>U.value=i),modal:"",header:"Rechazar Reserva",style:{width:"500px"},closable:!1,draggable:!1},{footer:p(()=>[a("div",nt,[a("button",{class:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded transition-colors flex items-center gap-2",onClick:e[8]||(e[8]=i=>U.value=!1)},[s(l(c),{icon:l(P),class:"h-4"},null,8,["icon"]),e[54]||(e[54]=b(" Cancelar "))]),a("button",{class:"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded transition-colors flex items-center gap-2",onClick:he,disabled:!V.value.trim()},[s(l(c),{icon:l(re),class:"h-4"},null,8,["icon"]),e[55]||(e[55]=b(" Rechazar Reserva "))],8,it)])]),default:p(()=>{var i,N,r;return[a("div",tt,[n.value?(D(),R("div",st,[a("div",lt,[s(l(c),{icon:l(Pe),class:"text-red-600 text-lg"},null,8,["icon"]),e[48]||(e[48]=a("h4",{class:"font-medium text-red-800"},"Confirmar Rechazo",-1))]),a("div",ot,[a("p",null,[e[49]||(e[49]=a("strong",null,"Cliente:",-1)),b(" "+o(((N=(i=n.value.cliente)==null?void 0:i.user)==null?void 0:N.name)||((r=n.value.cliente)==null?void 0:r.nombres)||"N/A"),1)]),a("p",null,[e[50]||(e[50]=a("strong",null,"Servicio:",-1)),b(" "+o(n.value.entidad_nombre),1)]),a("p",null,[e[51]||(e[51]=a("strong",null,"Fecha:",-1)),b(" "+o(ee(n.value.fecha_reserva)),1)]),a("p",null,[e[52]||(e[52]=a("strong",null,"Total:",-1)),b(" $"+o(Number(n.value.total||0).toFixed(2)),1)])])])):F("",!0),a("div",null,[e[53]||(e[53]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[b(" Motivo del rechazo "),a("span",{class:"text-red-500"},"*")],-1)),s(se,{modelValue:V.value,"onUpdate:modelValue":e[7]||(e[7]=y=>V.value=y),placeholder:"Especifica el motivo por el cual se rechaza esta reserva...",rows:"4",class:"w-full",maxlength:"500"},null,8,["modelValue"]),a("small",rt,o(V.value.length)+"/500 caracteres ",1)])])]}),_:1},8,["visible"]),s(te,{visible:q.value,"onUpdate:visible":e[14]||(e[14]=i=>q.value=i),modal:"",header:"Reprogramar Reserva",style:{width:"650px"},closable:!1,draggable:!1},{footer:p(()=>[a("div",At,[a("button",{class:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded transition-colors flex items-center gap-2",onClick:e[13]||(e[13]=i=>q.value=!1)},[s(l(c),{icon:l(P),class:"h-4"},null,8,["icon"]),e[68]||(e[68]=b(" Cancelar "))]),a("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded transition-colors flex items-center gap-2",onClick:we,disabled:!k.value||!I.value.trim()},[s(l(c),{icon:l(K),class:"h-4"},null,8,["icon"]),e[69]||(e[69]=b(" Reprogramar "))],8,Rt)])]),default:p(()=>{var i,N,r,y;return[a("div",dt,[n.value?(D(),R("div",ut,[a("div",ct,[s(l(c),{icon:l(K),class:"text-blue-600 text-lg"},null,8,["icon"]),e[56]||(e[56]=a("h4",{class:"font-medium text-blue-800"},"Información de la Reserva",-1))]),a("div",mt,[a("div",null,[e[57]||(e[57]=a("span",{class:"font-medium text-gray-700"},"Cliente:",-1)),a("span",vt,o(((N=(i=n.value.cliente)==null?void 0:i.user)==null?void 0:N.name)||((r=n.value.cliente)==null?void 0:r.nombres)||"N/A"),1)]),a("div",null,[e[58]||(e[58]=a("span",{class:"font-medium text-gray-700"},"Servicio:",-1)),a("span",gt,o(n.value.entidad_nombre),1)]),a("div",null,[e[59]||(e[59]=a("span",{class:"font-medium text-gray-700"},"Fecha actual:",-1)),a("span",pt,o(ee(n.value.fecha_reserva)),1)]),a("div",null,[e[60]||(e[60]=a("span",{class:"font-medium text-gray-700"},"Total:",-1)),a("span",ft,"$"+o(Number(n.value.total||0).toFixed(2)),1)])])])):F("",!0),T.value?(D(),R("div",xt,[a("div",bt,[s(l(c),{icon:l(fe),class:"text-purple-600 text-lg"},null,8,["icon"]),e[61]||(e[61]=a("h4",{class:"font-medium text-purple-800"},"Tour Asociado",-1))]),a("div",yt,[a("p",null,[e[62]||(e[62]=a("strong",null,"Nombre:",-1)),b(" "+o(T.value.nombre),1)]),a("p",null,[e[63]||(e[63]=a("strong",null,"Estado actual:",-1)),a("span",{class:oe([De(T.value.estado),"px-2 py-1 rounded-full text-xs font-medium ml-1"])},o(((y=ue.find(A=>A.value===T.value.estado))==null?void 0:y.label)||T.value.estado),3)]),e[64]||(e[64]=a("p",{class:"text-purple-600 text-xs mt-2"},' ℹ️ Al reprogramar esta reserva, el tour también será marcado como "REPROGRAMADO" ',-1))])])):F("",!0),a("div",ht,[a("div",null,[e[65]||(e[65]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[b(" Nueva fecha "),a("span",{class:"text-red-500"},"*")],-1)),s(m,{modelValue:k.value,"onUpdate:modelValue":e[10]||(e[10]=A=>k.value=A),showTime:"",dateFormat:"dd/mm/yy",class:"w-full",showIcon:"",placeholder:"Seleccione la nueva fecha y hora",minDate:Ne()},null,8,["modelValue","minDate"])])]),a("div",null,[e[66]||(e[66]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[b(" Motivo de la reprogramación "),a("span",{class:"text-red-500"},"*")],-1)),s(se,{modelValue:I.value,"onUpdate:modelValue":e[11]||(e[11]=A=>I.value=A),placeholder:"Especifica el motivo de la reprogramación...",rows:"3",class:"w-full",maxlength:"255"},null,8,["modelValue"]),a("small",_t,o(I.value.length)+"/255 caracteres ",1)]),a("div",null,[e[67]||(e[67]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Observaciones adicionales (opcional) ",-1)),s(se,{modelValue:O.value,"onUpdate:modelValue":e[12]||(e[12]=A=>O.value=A),placeholder:"Información adicional sobre la reprogramación...",rows:"2",class:"w-full",maxlength:"500"},null,8,["modelValue"]),a("small",wt,o(O.value.length)+"/500 caracteres ",1)])])]}),_:1},8,["visible"])])]),_:1})],64)}}};export{zt as default};
