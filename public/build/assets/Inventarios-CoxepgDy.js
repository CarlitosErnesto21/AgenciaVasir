import{r as u,E as re,w as we,o as he,k as w,h as L,d as i,x as d,p as a,e as t,$ as n,a0 as _e,t as l,q as m,y as E,j as y,v as de,c,F as K,l as Q,a7 as ue,A as X,a1 as ke,N as I}from"./vendor-B6SkOXHv.js";import{A as Ae}from"./AuthenticatedLayout-DUHXS_xX.js";import{A as Ce,D as b}from"./ui-IQIjmUCy.js";import{t as Se,u as je,h as ce,v as De,f as $,c as Ve,w as Y,l as Te}from"./index-CWeCUdu2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Pe={class:"container mx-auto px-4 py-6"},Fe={class:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-8"},Le={class:"flex items-center justify-between text-white p-2 sm:p-4"},Ee={class:"text-xl sm:text-3xl font-bold"},Me={class:"flex items-center justify-between text-white p-2 sm:p-4"},Re={class:"text-xl sm:text-3xl font-bold"},Ne={class:"flex items-center justify-between text-white p-2 sm:p-4"},Ue={class:"text-xl sm:text-3xl font-bold"},Ie={class:"flex items-center justify-between text-white p-2 sm:p-4"},$e={class:"text-sm sm:text-3xl font-bold"},Be={class:"bg-white rounded-lg shadow-md"},We={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},ze={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},Oe={class:"flex items-center gap-3"},qe={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},Je=["disabled"],Ge=["disabled"],He={class:"space-y-3"},Ke={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-3"},Qe={class:"col-span-1"},Xe=["value"],Ye={class:"col-span-1"},Ze=["value"],et={class:"col-span-1 hidden md:block"},tt={class:"col-span-1 hidden md:block"},ot={class:"col-span-2 flex gap-3 md:hidden"},st={class:"text-sm font-medium leading-relaxed"},lt=["title"],at={class:"block text-xs text-gray-500"},nt=["title"],it={class:"text-sm leading-relaxed"},rt={class:"space-y-4"},dt={key:0,class:"p-error"},ut={key:0,class:"p-4 bg-blue-50 rounded-lg"},ct={class:"text-sm text-blue-700"},mt={key:0,class:"p-error"},vt={class:"flex justify-center gap-4 w-full mt-6"},pt=["disabled"],bt={key:2},gt={key:3},ft=["disabled"],xt={key:0,class:"space-y-4"},yt={class:"grid grid-cols-2 gap-4"},wt={class:"col-span-2"},ht={key:0,class:"text-sm text-gray-600 mt-1"},_t={key:0},kt={key:0},At={class:"mt-1 p-3 bg-gray-50 rounded-lg"},Ct={key:1,class:"p-3 bg-blue-50 rounded-lg"},St={class:"flex justify-center gap-4 w-full mt-6"},jt={key:0,class:"text-center py-8"},Dt={key:1,class:"text-center py-8"},Vt={key:2,class:"space-y-4"},Tt={class:"max-h-96 overflow-y-auto"},Pt={class:"flex-1"},Ft={class:"font-semibold text-gray-800"},Lt={class:"text-sm text-gray-500"},Et={class:"flex gap-4 text-xs text-gray-600 mt-1"},Mt={key:0},Rt={class:"ml-4"},Nt={class:"border-t pt-4"},Ut={class:"text-sm text-gray-600 mb-3"},It={class:"flex justify-center gap-4 w-full mt-6"},Jt={__name:"Inventarios",setup($t){const C=Ce(),B=u([]),f=u([]),h=u({}),Z=u(!1),M=u(!1),R=u(""),N=u(null),k=u(!1);u(!1),u(!1);const U=u(!1),r=u(null),V=u(!1),S=u([]),T=u(""),j=u(""),W=u(!1),v=u({producto_id:"",tipo_movimiento:"",fecha_desde:null,fecha_hasta:null}),D=u({}),me=[{label:"Entrada",value:"ENTRADA"},{label:"Salida",value:"SALIDA"},{label:"Ajuste",value:"AJUSTE"}],ee=u(typeof window<"u"?window.innerWidth:1024),z=re(()=>{let s=B.value;if(R.value){const e=R.value.toLowerCase();s=s.filter(g=>{var p,P,A,_,F;return((P=(p=g.producto)==null?void 0:p.nombre)==null?void 0:P.toLowerCase().includes(e))||((A=g.motivo)==null?void 0:A.toLowerCase().includes(e))||((F=(_=g.user)==null?void 0:_.name)==null?void 0:F.toLowerCase().includes(e))})}return s}),O=re(()=>ee.value<640?{width:"95vw",maxWidth:"380px"}:ee.value<768?{width:"400px"}:{width:"450px"}),q=async()=>{try{const[s,e,g]=await Promise.all([I.get("/api/inventario",{params:v.value}),I.get("/api/productos"),I.get("/api/inventario/resumen")]);B.value=s.data.data||s.data||[];const p=e.data.data||e.data||[];f.value=Array.isArray(p)?p:[],f.value.length>0&&!Array.isArray(f.value)&&(console.warn("Los productos no tienen el formato esperado:",f.value),f.value=[]),h.value=g.data||{}}catch(s){console.error("Error al cargar datos:",s),B.value=[],f.value=[],h.value={},C.add({severity:"error",summary:"Error",detail:"Error al cargar los datos del inventario",life:4e3})}},ve=async()=>{Z.value=!0,C.add({severity:"info",summary:"Cargando inventario...",life:2e3});try{await q(),C.add({severity:"success",summary:"Inventario cargado",life:2e3})}finally{Z.value=!1}},te=async()=>{k.value=!0;try{await new Promise(s=>setTimeout(s,300)),v.value={producto_id:"",tipo_movimiento:"",fecha_desde:null,fecha_hasta:null},C.add({severity:"success",summary:"Filtros limpiados",life:2e3}),await q()}finally{k.value=!1}},pe=()=>{if(formAjustar.value.producto_id&&Array.isArray(f.value)){const s=f.value.find(e=>e.id===formAjustar.value.producto_id);N.value=(s==null?void 0:s.stock_actual)||0}else N.value=null},J=async s=>{let e=0,g="";switch(s){case"disponibles":e=h.value.productos_disponibles||0,g="/api/admin/productos/disponibles",T.value="Productos Disponibles";break;case"agotados":e=h.value.productos_agotados||0,g="/api/inventario/agotados",T.value="Productos Agotados";break;case"stock_bajo":e=h.value.productos_stock_bajo||0,g="/api/inventario/stock-bajo",T.value="Productos con Stock Bajo";break}if(e===0){C.add({severity:"info",summary:"Sin registros",detail:`No hay productos en estado: ${T.value.toLowerCase()}`,life:3e3});return}j.value=s,W.value=!0;try{const p=await I.get(g);S.value=p.data.data||p.data||[],V.value=!0}catch{C.add({severity:"error",summary:"Error",detail:"Error al cargar los productos",life:4e3})}finally{W.value=!1}},be=s=>{s.originalEvent.target.closest("button")||(r.value=s.data,U.value=!0)},oe=s=>{const e=new Date(s);return window.innerWidth<640?e.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):e.toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},se=s=>new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),G=s=>{const e={venta:"Venta",ajuste_aumento:"Ajuste (Aumento)",ajuste_reduccion:"Ajuste (Reducci칩n)",entrada_manual:"Entrada Manual",cancelacion_venta:"Cancelaci칩n de Venta",eliminacion_venta:"Eliminaci칩n de Venta","":"Sin especificar",null:"Sin especificar",undefined:"Sin especificar"};return!e[s]&&s?s.charAt(0).toUpperCase()+s.slice(1).replace(/_/g," "):e[s]||"Sin especificar"},le=s=>s.tipo_movimiento||"Sin definir",ge=s=>{const e=s.tipo_movimiento;return e==="ENTRADA"?"success":e==="SALIDA"?"danger":e==="AJUSTE"?"warning":"secondary"};return we(v,()=>{q()},{deep:!0}),he(()=>{ve()}),(s,e)=>{const g=w("Toast"),p=w("Card"),P=w("InputText"),A=w("DatePicker"),_=w("Column"),F=w("Tag"),fe=w("DataTable"),xe=w("Select"),ye=w("Textarea"),H=w("Dialog");return i(),L(Ae,null,{default:d(()=>[a(n(_e),{title:"Inventarios"}),a(g,{class:"z-[9999]"}),t("div",Pe,[e[34]||(e[34]=t("div",{class:"mb-6"},[t("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"Inventarios"),t("p",{class:"text-gray-600"},"Monitoreo y an치lisis del estado del inventario")],-1)),t("div",Fe,[a(p,{class:"bg-gradient-to-r from-green-500 to-green-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[0]||(e[0]=o=>J("disponibles"))},{content:d(()=>[t("div",Le,[t("div",null,[e[23]||(e[23]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Productos Disponibles",-1)),t("p",Ee,l(h.value.productos_disponibles||0),1),e[24]||(e[24]=t("p",{class:"text-xs opacity-75 mt-1"},"游녡 Clic para ver detalles",-1))]),a(n(b),{icon:n(Se),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),a(p,{class:"bg-gradient-to-r from-red-500 to-red-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[1]||(e[1]=o=>J("agotados"))},{content:d(()=>[t("div",Me,[t("div",null,[e[25]||(e[25]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Productos Agotados",-1)),t("p",Re,l(h.value.productos_agotados||0),1),e[26]||(e[26]=t("p",{class:"text-xs opacity-75 mt-1"},"游녡 Clic para ver detalles",-1))]),a(n(b),{icon:n(je),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),a(p,{class:"bg-gradient-to-r from-yellow-500 to-yellow-600 cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:e[2]||(e[2]=o=>J("stock_bajo"))},{content:d(()=>[t("div",Ne,[t("div",null,[e[27]||(e[27]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Stock Bajo",-1)),t("p",Ue,l(h.value.productos_stock_bajo||0),1),e[28]||(e[28]=t("p",{class:"text-xs opacity-75 mt-1"},"游녡 Clic para ver detalles",-1))]),a(n(b),{icon:n(ce),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1}),a(p,{class:"bg-gradient-to-r from-blue-500 to-blue-600"},{content:d(()=>[t("div",Ie,[t("div",null,[e[29]||(e[29]=t("p",{class:"text-xs sm:text-sm opacity-90"},"Valor Total",-1)),t("p",$e,"$"+l(se(h.value.valor_total_inventario)),1)]),a(n(b),{icon:n(De),class:"text-2xl sm:text-4xl opacity-75"},null,8,["icon"])])]),_:1})]),t("div",Be,[e[33]||(e[33]=t("div",{class:"flex flex-col sm:flex-row lg:justify-between lg:items-center mb-4 gap-4 p-6"},[t("div",null,[t("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold text-center sm:text-start"},"Historial de Movimientos"),t("p",{class:"text-gray-500 text-sm text-center sm:text-start mt-1"},[m(" 游늵 Vista de solo lectura - Para gestionar stock, ve a "),t("span",{class:"text-blue-600 font-medium"},"Productos > M치s Acciones > Actualizar Stock")])])],-1)),a(fe,{value:z.value,dataKey:"id",paginator:!0,rows:10,rowsPerPageOptions:[10,25,50],globalFilterFields:["producto.nombre","motivo","user.name"],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} movimientos",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:be,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:d(()=>[t("div",We,[t("div",ze,[t("div",Oe,[e[30]||(e[30]=t("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[t("i",{class:"pi pi-filter text-blue-600 text-sm"}),t("span",null,"Filtros")],-1)),t("div",qe,l(z.value.length)+" resultado"+l(z.value.length!==1?"s":""),1),t("button",{onClick:te,disabled:k.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[k.value?(i(),L(n(b),{key:0,icon:n($),class:"animate-spin h-3 w-3"},null,8,["icon"])):y("",!0),t("span",null,l(k.value?"Limpiando...":"Limpiar filtros"),1)],8,Je)]),t("button",{onClick:te,disabled:k.value,class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2"},[k.value?(i(),L(n(b),{key:0,icon:n($),class:"animate-spin h-3 w-3"},null,8,["icon"])):y("",!0),t("span",null,l(k.value?"Limpiando...":"Limpiar filtros"),1)],8,Ge)]),t("div",He,[t("div",null,[a(P,{modelValue:R.value,"onUpdate:modelValue":e[3]||(e[3]=o=>R.value=o),placeholder:"游댌 Buscar movimientos...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])]),t("div",Ke,[t("div",Qe,[de(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>v.value.producto_id=o),onChange:e[5]||(e[5]=(...o)=>s.aplicarFiltros&&s.aplicarFiltros(...o)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-700 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[31]||(e[31]=t("option",{value:"",disabled:"",selected:"",hidden:""},"Producto",-1)),(i(!0),c(K,null,Q(Array.isArray(f.value)?f.value:[],o=>(i(),c("option",{key:o.id,value:o.id,class:"truncate"},l(o.nombre),9,Xe))),128))],544),[[ue,v.value.producto_id]])]),t("div",Ye,[de(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>v.value.tipo_movimiento=o),onChange:e[7]||(e[7]=(...o)=>s.aplicarFiltros&&s.aplicarFiltros(...o)),class:"w-full h-9 text-sm border border-blue-300 rounded-md px-3 py-1 bg-white text-gray-700 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 truncate"},[e[32]||(e[32]=t("option",{value:"",disabled:"",selected:"",hidden:""},"Tipo",-1)),(i(),c(K,null,Q(me,o=>t("option",{key:o.value,value:o.value,class:"truncate"},l(o.label),9,Ze)),64))],544),[[ue,v.value.tipo_movimiento]])]),t("div",et,[a(A,{modelValue:v.value.fecha_desde,"onUpdate:modelValue":e[8]||(e[8]=o=>v.value.fecha_desde=o),placeholder:"Fecha desde",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),t("div",tt,[a(A,{modelValue:v.value.fecha_hasta,"onUpdate:modelValue":e[9]||(e[9]=o=>v.value.fecha_hasta=o),placeholder:"Fecha hasta",dateFormat:"yy-mm-dd",class:"w-full h-9 text-sm",style:{"background-color":"white","border-color":"#93c5fd"},showIcon:""},null,8,["modelValue"])]),t("div",ot,[a(A,{modelValue:v.value.fecha_desde,"onUpdate:modelValue":e[10]||(e[10]=o=>v.value.fecha_desde=o),placeholder:"Fecha desde",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"]),a(A,{modelValue:v.value.fecha_hasta,"onUpdate:modelValue":e[11]||(e[11]=o=>v.value.fecha_hasta=o),placeholder:"Fecha hasta",dateFormat:"dd/mm/yy",class:"flex-1 h-9 text-sm rounded-md border border-blue-300",showIcon:""},null,8,["modelValue"])])])])])]),default:d(()=>[a(_,{field:"fecha_movimiento",header:"Fecha",sortable:"",class:"w-32"},{body:d(({data:o})=>[t("div",st,l(oe(o.fecha_movimiento)),1)]),_:1}),a(_,{field:"producto.nombre",header:"Producto",sortable:"",class:"w-40"},{body:d(({data:o})=>{var x,ae,ne,ie;return[t("div",null,[t("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"150px","text-overflow":"ellipsis","white-space":"nowrap"},title:(x=o.producto)==null?void 0:x.nombre},l((ae=o.producto)==null?void 0:ae.nombre),9,lt),t("span",at,l((ie=(ne=o.producto)==null?void 0:ne.categoria)==null?void 0:ie.nombre),1)])]}),_:1}),a(_,{field:"tipo_movimiento",header:"Tipo",sortable:"",class:"w-24 hidden sm:table-cell"},{body:d(({data:o})=>[a(F,{value:o.tipo_movimiento,severity:o.tipo_movimiento==="ENTRADA"?"success":o.tipo_movimiento==="SALIDA"?"danger":"warning",class:"text-xs"},null,8,["value","severity"])]),_:1}),a(_,{field:"cantidad",header:"Cantidad",sortable:"",class:"w-20 hidden sm:table-cell"},{body:d(({data:o})=>[t("span",{class:E([o.tipo_movimiento==="ENTRADA"?"text-green-600":o.tipo_movimiento==="SALIDA"?"text-red-600":"text-orange-600","text-sm font-medium"])},l(o.tipo_movimiento==="ENTRADA"?"+":o.tipo_movimiento==="SALIDA"?"-":"췀")+l(o.cantidad),3)]),_:1}),a(_,{field:"motivo",header:"Motivo",sortable:"",class:"w-32 hidden md:table-cell"},{body:d(({data:o})=>[t("div",{class:"text-sm leading-relaxed overflow-hidden",style:{"max-width":"120px","text-overflow":"ellipsis","white-space":"nowrap"},title:G(o.motivo)},l(G(o.motivo)),9,nt)]),_:1}),a(_,{field:"user.name",header:"Usuario",sortable:"",class:"w-28 hidden lg:table-cell"},{body:d(({data:o})=>{var x;return[t("div",it,l(((x=o.user)==null?void 0:x.name)||"Sistema"),1)]}),_:1})]),_:1},8,["value"])])]),a(H,{visible:s.mostrarModalAjustar,"onUpdate:visible":e[17]||(e[17]=o=>s.mostrarModalAjustar=o),modal:"",header:"Ajustar Stock",style:X(O.value)},{footer:d(()=>[t("div",vt,[t("button",{onClick:e[15]||(e[15]=(...o)=>s.ajustarStock&&s.ajustarStock(...o)),disabled:M.value,class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[M.value?(i(),L(n(b),{key:0,icon:n($),class:"animate-spin h-5 text-white"},null,8,["icon"])):(i(),L(n(b),{key:1,icon:n(Ve),class:"h-5"},null,8,["icon"])),M.value?(i(),c("span",gt,"Ajustando...")):(i(),c("span",bt,"Ajustar Stock"))],8,pt),t("button",{type:"button",onClick:e[16]||(e[16]=o=>s.mostrarModalAjustar=!1),disabled:M.value,class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[a(n(b),{icon:n(Y),class:"h-5"},null,8,["icon"]),e[39]||(e[39]=m("Cancelar "))],8,ft)])]),default:d(()=>[t("div",rt,[t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Producto",-1)),a(xe,{modelValue:s.formAjustar.producto_id,"onUpdate:modelValue":e[12]||(e[12]=o=>s.formAjustar.producto_id=o),options:Array.isArray(f.value)?f.value:[],optionLabel:"nombre",optionValue:"id",placeholder:"Seleccionar producto",class:E(["w-full",{"p-invalid":D.value.producto_id}]),onChange:pe},null,8,["modelValue","options","class"]),D.value.producto_id?(i(),c("small",dt,l(D.value.producto_id[0]),1)):y("",!0)]),N.value!==null?(i(),c("div",ut,[t("p",ct,[e[36]||(e[36]=t("strong",null,"Stock actual:",-1)),m(" "+l(N.value)+" unidades ",1)])])):y("",!0),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nuevo Stock",-1)),a(P,{modelValue:s.formAjustar.nuevo_stock,"onUpdate:modelValue":e[13]||(e[13]=o=>s.formAjustar.nuevo_stock=o),placeholder:"Nuevo stock",type:"number",min:"0",class:E(["w-full",{"p-invalid":D.value.nuevo_stock}])},null,8,["modelValue","class"]),D.value.nuevo_stock?(i(),c("small",mt,l(D.value.nuevo_stock[0]),1)):y("",!0)]),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Observaciones",-1)),a(ye,{modelValue:s.formAjustar.observacion,"onUpdate:modelValue":e[14]||(e[14]=o=>s.formAjustar.observacion=o),placeholder:"Motivo del ajuste",rows:"3",class:"w-full"},null,8,["modelValue"])])])]),_:1},8,["visible","style"]),a(H,{visible:U.value,"onUpdate:visible":e[19]||(e[19]=o=>U.value=o),modal:"",header:"Detalle del Movimiento",style:X(O.value),closable:!1,draggable:!1},{footer:d(()=>[t("div",St,[t("button",{type:"button",onClick:e[18]||(e[18]=o=>U.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[a(n(b),{icon:n(Y),class:"h-5"},null,8,["icon"]),e[49]||(e[49]=m("Cerrar "))])])]),default:d(()=>{var o,x;return[r.value?(i(),c("div",xt,[t("div",yt,[t("div",null,[e[40]||(e[40]=t("strong",null,"Fecha:",-1)),m(" "+l(oe(r.value.fecha_movimiento)),1)]),t("div",null,[e[41]||(e[41]=t("strong",null,"Tipo:",-1)),a(F,{value:le(r.value),severity:ge(r.value)},{default:d(()=>[m(l(le(r.value)),1)]),_:1},8,["value","severity"])]),t("div",null,[e[42]||(e[42]=t("strong",null,"Producto:",-1)),m(" "+l((o=r.value.producto)==null?void 0:o.nombre),1)]),t("div",null,[e[43]||(e[43]=t("strong",null,"Cantidad:",-1)),t("span",{class:E(r.value.tipo_movimiento==="ENTRADA"?"text-green-600":"text-red-600")},l(r.value.tipo_movimiento==="ENTRADA"?"+":"-")+l(r.value.cantidad),3)]),t("div",wt,[e[46]||(e[46]=t("strong",null,"Usuario:",-1)),m(" "+l(((x=r.value.user)==null?void 0:x.name)||"Sistema")+" ",1),r.value.user?(i(),c("div",ht,[t("div",null,[e[44]||(e[44]=t("strong",null,"Email:",-1)),m(" "+l(r.value.user.email),1)]),r.value.user.roles&&r.value.user.roles.length>0?(i(),c("div",_t,[e[45]||(e[45]=t("strong",null,"Rol:",-1)),m(" "+l(r.value.user.roles[0].name),1)])):y("",!0)])):y("",!0)]),t("div",null,[e[47]||(e[47]=t("strong",null,"Motivo:",-1)),m(" "+l(G(r.value.motivo)),1)])]),r.value.observacion?(i(),c("div",kt,[e[48]||(e[48]=t("strong",null,"Observaciones:",-1)),t("p",At,l(r.value.observacion),1)])):y("",!0),r.value.venta_id?(i(),c("div",Ct,[t("strong",null,"Relacionado con venta #"+l(r.value.venta_id),1)])):y("",!0)])):y("",!0)]}),_:1},8,["visible","style"]),a(H,{visible:V.value,"onUpdate:visible":e[22]||(e[22]=o=>V.value=o),modal:"",header:T.value,style:X(O.value),closable:!1,draggable:!1},{footer:d(()=>[t("div",It,[a(n(ke),{href:"/productos",onClick:e[20]||(e[20]=o=>V.value=!1),class:"bg-green-500 hover:bg-green-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},{default:d(()=>[a(n(b),{icon:n(Te),class:"h-5"},null,8,["icon"]),e[55]||(e[55]=m(" Gestionar Productos "))]),_:1,__:[55]}),t("button",{type:"button",onClick:e[21]||(e[21]=o=>V.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[a(n(b),{icon:n(Y),class:"h-5"},null,8,["icon"]),e[56]||(e[56]=m("Cerrar "))])])]),default:d(()=>[W.value?(i(),c("div",jt,[a(n(b),{icon:n($),class:"animate-spin h-8 w-8 text-blue-600 mb-3"},null,8,["icon"]),e[50]||(e[50]=t("p",{class:"text-gray-600"},"Cargando productos...",-1))])):S.value.length===0?(i(),c("div",Dt,[a(n(b),{icon:n(ce),class:"h-12 w-12 text-gray-400 mb-3"},null,8,["icon"]),e[51]||(e[51]=t("p",{class:"text-gray-600"},"No se encontraron productos en este estado.",-1))])):(i(),c("div",Vt,[t("div",Tt,[(i(!0),c(K,null,Q(S.value,o=>{var x;return i(),c("div",{key:o.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50"},[t("div",Pt,[t("h4",Ft,l(o.nombre),1),t("p",Lt,l(((x=o.categoria)==null?void 0:x.nombre)||"Sin categor칤a"),1),t("div",Et,[t("span",null,[e[52]||(e[52]=m("Stock: ")),t("strong",null,l(o.stock_actual||0),1)]),t("span",null,[e[53]||(e[53]=m("M칤nimo: ")),t("strong",null,l(o.stock_minimo||1),1)]),o.precio?(i(),c("span",Mt,[e[54]||(e[54]=m("Precio: ")),t("strong",null,"$"+l(se(o.precio)),1)])):y("",!0)])]),t("div",Rt,[t("span",{class:E(["px-2 py-1 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":j.value==="disponibles","bg-red-100 text-red-800":j.value==="agotados","bg-yellow-100 text-yellow-800":j.value==="stock_bajo"}])},l(j.value==="disponibles"?"Disponible":j.value==="agotados"?"Agotado":"Stock Bajo"),3)])])}),128))]),t("div",Nt,[t("p",Ut,[t("strong",null,l(S.value.length),1),m(" producto"+l(S.value.length!==1?"s":"")+" encontrado"+l(S.value.length!==1?"s":""),1)])])]))]),_:1},8,["visible","header","style"])]),_:1})}}};export{Jt as default};
