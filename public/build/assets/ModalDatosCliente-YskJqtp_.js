import{a4 as B,r as _,E as $,o as G,N as D,h as O,d as f,x as h,e as o,q as r,t as c,I as P,p as s,c as v,j as g,$ as t,y as x}from"./vendor-DcS5GX9S.js";import{A as j,D as p,o as I,h as M,q as z,m as R,g as X}from"./ui-DN6aYgk-.js";import{a3 as Y,ag as Z,ah as H,Z as J,Y as K,g as Q,ai as W,C as ee}from"./index-00cYtq1U.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"text-xl font-bold text-red-700 flex items-center gap-2"},le={class:"py-4"},te={class:"bg-blue-50 rounded-lg p-4 mb-6"},ie={class:"text-sm text-blue-700"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={class:"block text-sm font-medium text-gray-700 mb-2"},re={key:0,class:"p-error"},de={key:0,class:"p-error"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ce={class:"block text-sm font-medium text-gray-700 mb-2"},me={key:0,class:"p-error"},pe={class:"block text-sm font-medium text-gray-700 mb-2"},fe={key:0,class:"p-error"},ve={class:"block text-sm font-medium text-gray-700 mb-2"},ge={key:0,class:"p-error"},be={class:"block text-sm font-medium text-gray-700 mb-2"},_e={key:0,class:"p-error"},ye={class:"flex justify-end gap-3"},xe=["disabled"],Ve=["disabled"],we={__name:"ModalDatosCliente",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","cliente-guardado"],setup(U,{emit:q}){const V=q,S=B(),y=j(),b=_(!1),m=_([]),w=_(!0),k=$(()=>{var u;return(u=S.props.auth)==null?void 0:u.user}),i=_({numero_identificacion:"",fecha_nacimiento:null,genero:"",direccion:"",telefono:"",tipo_documento_id:null}),A=[{label:"Masculino",value:"MASCULINO"},{label:"Femenino",value:"FEMENINO"}],a=_({});G(async()=>{await F()});const F=async()=>{var u,e,d;try{w.value=!0;const n=await D.get("/api/tipo-documentos"),l=n.data.tipos||n.data.data||n.data||[];m.value=l.map(N=>({nombre:N.nombre,id:N.id})),m.value.length===0&&console.warn("No se encontraron tipos de documento"),m.value.length>0&&(i.value.tipo_documento_id=m.value[0].id)}catch(n){console.error("Error al cargar tipos de documento:",n),console.error("Response data:",(u=n.response)==null?void 0:u.data),m.value=[{id:1,nombre:"DUI"},{id:2,nombre:"CÉDULA"},{id:3,nombre:"PASAPORTE"}];let l="No se pudieron cargar los tipos de documento. Usando valores por defecto.";((e=n.response)==null?void 0:e.status)===401?l="No estás autorizado para acceder a esta información":((d=n.response)==null?void 0:d.status)===404&&(l="Servicio no encontrado"),y.add({severity:"error",summary:"Error",detail:l,life:3e3})}finally{w.value=!1}},C=()=>{V("update:visible",!1),T()},T=()=>{i.value={numero_identificacion:"",fecha_nacimiento:null,genero:"",direccion:"",telefono:"",tipo_documento_id:m.value.length>0?m.value[0].id:null},a.value={}},L=()=>(a.value={},i.value.numero_identificacion.trim()||(a.value.numero_identificacion="El número de identificación es requerido"),i.value.fecha_nacimiento||(a.value.fecha_nacimiento="La fecha de nacimiento es requerida"),i.value.genero||(a.value.genero="El género es requerido"),i.value.direccion.trim()||(a.value.direccion="La dirección es requerida"),i.value.telefono.trim()||(a.value.telefono="El teléfono es requerido"),i.value.tipo_documento_id||(a.value.tipo_documento_id="El tipo de documento es requerido"),Object.keys(a.value).length===0),E=async()=>{var u,e,d,n;if(!L()){y.add({severity:"warn",summary:"Formulario incompleto",detail:"Por favor completa todos los campos requeridos",life:3e3});return}try{b.value=!0;const l=await D.post("/api/registro-cliente",i.value);y.add({severity:"success",summary:"Información guardada",detail:"Tus datos han sido guardados correctamente",life:3e3}),V("cliente-guardado",l.data.data||l.data),C()}catch(l){console.error("Error al guardar cliente:",l),(e=(u=l.response)==null?void 0:u.data)!=null&&e.errors&&(a.value=l.response.data.errors),y.add({severity:"error",summary:"Error al guardar",detail:((n=(d=l.response)==null?void 0:d.data)==null?void 0:n.message)||"No se pudo guardar la información",life:5e3})}finally{b.value=!1}};return(u,e)=>(f(),O(t(X),{visible:U.visible,"onUpdate:visible":e[6]||(e[6]=d=>V("update:visible",d)),modal:"",closable:!1,class:"max-w-2xl w-full mx-4",draggable:!1},{header:h(()=>[o("h3",ae,[s(t(p),{icon:t(ee)},null,8,["icon"]),e[7]||(e[7]=r(" Completar información de cliente "))])]),footer:h(()=>[o("div",ye,[o("button",{type:"button",class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:C,disabled:b.value},[s(t(p),{icon:t(Q)},null,8,["icon"]),e[18]||(e[18]=r(" Cancelar "))],8,xe),o("button",{type:"button",class:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50",onClick:E,disabled:b.value},[s(t(p),{icon:t(W)},null,8,["icon"]),r(" "+c(b.value?"Guardando...":"Guardar y Continuar"),1)],8,Ve)])]),default:h(()=>{var d,n;return[o("div",le,[o("div",te,[e[10]||(e[10]=o("h4",{class:"font-semibold text-blue-800 mb-2"},"Información de tu cuenta:",-1)),o("div",ie,[o("p",null,[e[8]||(e[8]=o("strong",null,"Nombre:",-1)),r(" "+c((d=k.value)==null?void 0:d.name),1)]),o("p",null,[e[9]||(e[9]=o("strong",null,"Email:",-1)),r(" "+c((n=k.value)==null?void 0:n.email),1)])])]),o("form",{onSubmit:P(E,["prevent"]),class:"space-y-6"},[o("div",ne,[o("div",null,[o("label",se,[s(t(p),{icon:t(Y),class:"mr-2"},null,8,["icon"]),e[11]||(e[11]=r(" Tipo de documento * "))]),s(t(I),{modelValue:i.value.tipo_documento_id,"onUpdate:modelValue":e[0]||(e[0]=l=>i.value.tipo_documento_id=l),options:m.value,optionLabel:"nombre",optionValue:"id",placeholder:"Selecciona el tipo",loading:w.value,class:"w-full"},null,8,["modelValue","options","loading"]),a.value.tipo_documento_id?(f(),v("small",re,c(a.value.tipo_documento_id),1)):g("",!0)]),o("div",null,[e[12]||(e[12]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Número de identificación * ",-1)),s(t(M),{modelValue:i.value.numero_identificacion,"onUpdate:modelValue":e[1]||(e[1]=l=>i.value.numero_identificacion=l),placeholder:"Ingresa tu número de identificación",class:x(["w-full",{"p-invalid":a.value.numero_identificacion}])},null,8,["modelValue","class"]),a.value.numero_identificacion?(f(),v("small",de,c(a.value.numero_identificacion),1)):g("",!0)])]),o("div",ue,[o("div",null,[o("label",ce,[s(t(p),{icon:t(Z),class:"mr-2"},null,8,["icon"]),e[13]||(e[13]=r(" Fecha de nacimiento * "))]),s(t(z),{modelValue:i.value.fecha_nacimiento,"onUpdate:modelValue":e[2]||(e[2]=l=>i.value.fecha_nacimiento=l),placeholder:"Selecciona tu fecha de nacimiento",dateFormat:"dd/mm/yy",showIcon:!0,maxDate:new Date,class:x(["w-full",{"p-invalid":a.value.fecha_nacimiento}])},null,8,["modelValue","maxDate","class"]),a.value.fecha_nacimiento?(f(),v("small",me,c(a.value.fecha_nacimiento),1)):g("",!0)]),o("div",null,[o("label",pe,[s(t(p),{icon:t(H),class:"mr-2"},null,8,["icon"]),e[14]||(e[14]=r(" Género * "))]),s(t(I),{modelValue:i.value.genero,"onUpdate:modelValue":e[3]||(e[3]=l=>i.value.genero=l),options:A,optionLabel:"label",optionValue:"value",placeholder:"Selecciona tu género",class:"w-full"},null,8,["modelValue"]),a.value.genero?(f(),v("small",fe,c(a.value.genero),1)):g("",!0)])]),o("div",null,[o("label",ve,[s(t(p),{icon:t(J),class:"mr-2"},null,8,["icon"]),e[15]||(e[15]=r(" Dirección * "))]),s(t(R),{modelValue:i.value.direccion,"onUpdate:modelValue":e[4]||(e[4]=l=>i.value.direccion=l),placeholder:"Ingresa tu dirección completa",rows:"3",class:x(["w-full",{"p-invalid":a.value.direccion}])},null,8,["modelValue","class"]),a.value.direccion?(f(),v("small",ge,c(a.value.direccion),1)):g("",!0)]),o("div",null,[o("label",be,[s(t(p),{icon:t(K),class:"mr-2"},null,8,["icon"]),e[16]||(e[16]=r(" Teléfono * "))]),s(t(M),{modelValue:i.value.telefono,"onUpdate:modelValue":e[5]||(e[5]=l=>i.value.telefono=l),placeholder:"Ingresa tu número de teléfono",class:x(["w-full",{"p-invalid":a.value.telefono}])},null,8,["modelValue","class"]),a.value.telefono?(f(),v("small",_e,c(a.value.telefono),1)):g("",!0)]),e[17]||(e[17]=o("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[o("p",{class:"text-sm text-yellow-800"},[o("strong",null,"Nota:"),r(" Esta información es necesaria para procesar tu compra y generar la factura correspondiente. ")])],-1))],32)])]}),_:1},8,["visible"]))}},Ne=oe(we,[["__scopeId","data-v-092fe4e4"]]);export{Ne as default};
