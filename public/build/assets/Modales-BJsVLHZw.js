import{z as be,a as ye,F as r,g as W,m as he}from"./ui-BrU4k96Z.js";import{E as M,r as F,w as L,o as Ee,a6 as we,c as m,d as c,p as d,$ as t,x as D,e as o,q as u,t as i,j as y,h as O,A as Y,y as B,F as Ae,N as Ce}from"./vendor-gbh1WW5n.js";import{s as ee,i as oe,c as $,a as U,p as ke,v as q,b as Ne,L as Re,f as J,M as ae,N as te,O as De,P as Ie,Q as Pe,H as Oe}from"./index-B6nVaz6S.js";import{f as _e}from"./index-DtyEsSN9.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ze={class:"space-y-4"},Te={class:"text-center mb-4"},Ve={class:"text-lg font-semibold text-gray-800"},Me={class:"text-blue-600"},Fe={class:"text-sm text-gray-600 mt-1"},Le={class:"grid grid-cols-1 gap-3"},$e={key:1,class:"bg-orange-50 border border-orange-200 rounded-lg p-3"},je={class:"flex items-center gap-2 mb-2"},Ge=["disabled"],We={class:"text-left flex-1"},Be={class:"font-medium"},Ue={class:"text-xs opacity-90"},qe=["disabled"],Je={class:"text-left flex-1"},Ze={class:"font-medium"},He={class:"text-xs opacity-90"},Ke={class:"flex justify-center gap-4 w-full mt-6"},Qe={class:"w-full"},Xe={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},Ye={class:"flex flex-col sm:flex-row gap-3 sm:items-center"},eo={class:"flex items-center gap-2"},oo={class:"flex items-center gap-2"},ao={class:"text-right"},to={class:"text-sm font-bold text-blue-700 leading-tight"},so={key:0,class:"space-y-4 sm:space-y-6"},lo={class:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4"},no={class:"font-semibold text-blue-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},ro={class:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 text-xs sm:text-sm"},io={class:"break-words"},co={class:"ml-2"},uo={class:"ml-2"},go={class:"flex flex-col gap-1"},mo={key:0,class:"flex flex-wrap items-center gap-2"},vo={class:"text-xs sm:text-sm break-all"},po={key:1,class:"text-gray-500 italic text-xs sm:text-sm"},fo={class:"flex flex-col gap-1"},xo={key:0,class:"flex flex-wrap items-center gap-2"},bo={class:"text-xs sm:text-sm"},yo={class:"flex gap-1"},ho=["href"],Eo=["href"],wo={key:1,class:"text-gray-500 italic text-xs sm:text-sm"},Ao={class:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4"},Co={class:"font-semibold text-green-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},ko={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 text-xs sm:text-sm"},No={class:"ml-2"},Ro={class:"ml-2"},Do={class:"ml-2 font-bold text-green-600"},Io={class:"bg-slate-50 border border-slate-200 rounded-lg p-3 sm:p-4"},Po={class:"font-semibold text-slate-800 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base"},Oo={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},_o={class:"flex items-center gap-2"},So={class:"flex items-center gap-2"},zo={key:0,class:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border-2 border-yellow-300 p-4"},To={class:"flex items-center justify-between mb-4"},Vo={class:"flex items-center gap-2"},Mo={class:"flex items-center gap-2"},Fo={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},Lo={class:"space-y-3"},$o={class:"text-sm text-gray-600"},jo={key:0,class:"flex justify-center"},Go=["disabled"],Wo={key:1,class:"space-y-3"},Bo={class:"bg-white rounded-lg border border-yellow-300 p-4"},Uo={class:"flex items-center justify-between mb-2"},qo={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},Jo={class:"bg-gray-50 rounded-md p-3 mb-3"},Zo={class:"text-sm text-gray-800 break-all font-mono"},Ho={class:"flex items-center justify-between text-xs text-gray-500 mb-3"},Ko={class:"flex flex-wrap gap-2 justify-center"},Qo={class:"bg-blue-50 border border-blue-200 rounded-lg p-3"},Xo={class:"text-sm font-medium text-blue-800 mb-2"},Yo={class:"flex justify-center gap-4 w-full mt-6"},ea={class:"space-y-3 sm:space-y-4"},oa={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4 mb-4"},aa={class:"flex items-start gap-2 sm:gap-3"},ta={class:"flex-1"},sa={class:"bg-white bg-opacity-60 rounded p-2 text-xs sm:text-sm space-y-1"},la={class:"break-words"},na={class:"break-words"},ra={class:"text-gray-500 text-xs mt-1"},ia={class:"flex justify-center gap-4 w-full mt-6"},da=["disabled"],ca={key:2},ua={key:3},ga=["disabled"],ma={__name:"Modales",props:{visible:{type:Boolean,default:!1},detallesVisible:{type:Boolean,default:!1},rechazarVisible:{type:Boolean,default:!1},reserva:{type:Object,default:()=>({})},tour:{type:Object,default:()=>({})},dialogStyle:{type:Object,default:()=>({})},procesando:{type:Boolean,default:!1},confirmandoReserva:{type:Boolean,default:!1},rechazandoReserva:{type:Boolean,default:!1},estadosReservas:{type:Array,default:()=>[]},estadosTours:{type:Array,default:()=>[]}},emits:["update:visible","update:detallesVisible","update:rechazarVisible","confirmar","rechazar","verDetalles","actualizar-reserva"],setup(a,{emit:se}){const j=be(),l=a,_=se,h=M({get:()=>l.visible,set:s=>_("update:visible",s)}),w=M({get:()=>l.detallesVisible,set:s=>_("update:detallesVisible",s)}),A=M({get:()=>l.rechazarVisible,set:s=>_("update:rechazarVisible",s)}),C=F(""),k=F(!1),p=F(null),I=F(!1),T=s=>{if(!s||!s.estado)return[];switch(s.estado){case"PENDIENTE":return["confirmar","rechazar","detalles"];case"CONFIRMADA":return["rechazar","detalles"];case"REPROGRAMADA":return["rechazar","detalles"];case"CANCELADA":return["detalles"];case"FINALIZADA":return["detalles"];default:return["detalles"]}},le=s=>{const e=l.estadosReservas.find(n=>n.value===s);return(e==null?void 0:e.color)||"bg-gray-100 text-gray-800"},Z=s=>{if(!s)return"N/A";const e=new Date(s);return e.getHours()===0&&e.getMinutes()===0?e.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):e.toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},ne=()=>{_("confirmar",l.reserva)},re=()=>{C.value="",h.value=!1,A.value=!0},ie=()=>{_("rechazar",{reserva:l.reserva,motivo:C.value})},de=async()=>{h.value=!1,w.value=!0},ce=()=>{C.value="",p.value=null,I.value=!1,k.value=!1},G=()=>{document.body.style.overflow="hidden",document.body.style.paddingRight="15px"},V=()=>{document.body.style.overflow="",document.body.style.paddingRight=""},ue=()=>{A.value=!1,ce()},ge=s=>{if(!s)return;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?window.location.href=`mailto:${s}`:window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${s}`,"_blank")},me=async()=>{var s,e,n,v,b,N,S;if(l.reserva){k.value=!0,p.value=null,I.value=!1;try{const g=l.reserva,E={id:((s=l.tour)==null?void 0:s.id)||g.tour_id||1,nombre:((e=l.tour)==null?void 0:e.nombre)||g.entidad_nombre||"Tour reservado",cupos_adultos:g.mayores_edad||0,cupos_menores:g.menores_edad||0,total:parseFloat(g.total)},z=((v=(n=g.cliente)==null?void 0:n.user)==null?void 0:v.email)||((b=g.cliente)==null?void 0:b.correo);if(!z)throw new Error("No se encontrÃ³ email del cliente para generar el enlace de pago");const P={reserva_id:g.id,amount:parseFloat(g.total),customer_email:z,tour_data:E};console.log("ðŸ”— Enviando datos a Wompi:",P);const R=await Ce.post("/api/wompi/payment-link-tour",P);if(R.data.success)p.value={url:R.data.payment_link,reference:R.data.reference,amount:P.amount},I.value=!0,console.log("âœ… Enlace generado exitosamente:",p.value);else throw new Error(R.data.message||"Error al generar enlace")}catch(g){console.error("âŒ Error generando enlace Wompi:",g);let E="Error al generar enlace de pago";(S=(N=g.response)==null?void 0:N.data)!=null&&S.message?E=g.response.data.message:g.message&&(E=g.message),j.add({severity:"error",summary:"Error",detail:E,life:5e3})}finally{k.value=!1}}},ve=async()=>{var s;if((s=p.value)!=null&&s.url)try{await navigator.clipboard.writeText(p.value.url),j.add({severity:"success",summary:"Ã‰xito",detail:"Enlace copiado al portapapeles",life:3e3})}catch(e){console.error("Error copiando enlace:",e);const n=document.createElement("textarea");n.value=p.value.url,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),j.add({severity:"success",summary:"Ã‰xito",detail:"Enlace copiado al portapapeles",life:3e3})}},pe=()=>{var s;(s=p.value)!=null&&s.url&&window.open(p.value.url,"_blank")},H=()=>{p.value=null,I.value=!1},fe=s=>{if(!s)return!1;const e=["PENDIENTE","pendiente"],n=s.pago_activo&&s.pago_activo.estado==="approved";return e.includes(s.estado)&&!n},xe=M(()=>{var e;if(!l.reserva)return!0;console.log("=================================================="),console.log("ðŸ” DEBUG SÃšPER DETALLADO - PAGO ACTIVO"),console.log("=================================================="),console.log("1. DATOS GENERALES DE RESERVA:"),console.log("   - ID de reserva:",l.reserva.id),console.log("   - Estado de reserva:",l.reserva.estado),console.log("   - Objeto reserva completo:",JSON.stringify(l.reserva,null,2)),console.log("2. VERIFICACIÃ“N PAGO_ACTIVO:"),console.log("   - pago_activo existe (boolean):",!!l.reserva.pago_activo),console.log("   - pago_activo es null:",l.reserva.pago_activo===null),console.log("   - pago_activo es undefined:",l.reserva.pago_activo===void 0),console.log("   - typeof pago_activo:",typeof l.reserva.pago_activo),l.reserva.pago_activo?(console.log("3. DATOS DE PAGO_ACTIVO:"),console.log("   - ID del pago:",l.reserva.pago_activo.id),console.log("   - Estado del pago:",l.reserva.pago_activo.estado),console.log("   - Tipo de estado (typeof):",typeof l.reserva.pago_activo.estado),console.log('   - Estado === "approved":',l.reserva.pago_activo.estado==="approved"),console.log('   - Estado == "approved":',l.reserva.pago_activo.estado=="approved"),console.log("   - Referencia Wompi:",l.reserva.pago_activo.referencia_wompi),console.log("   - Monto:",l.reserva.pago_activo.monto),console.log("   - Moneda:",l.reserva.pago_activo.moneda),console.log("   - Created at:",l.reserva.pago_activo.created_at),console.log("   - Updated at:",l.reserva.pago_activo.updated_at),console.log("   - Objeto pago_activo completo:",JSON.stringify(l.reserva.pago_activo,null,2))):(console.log("3. PAGO_ACTIVO ES NULL/UNDEFINED - VERIFICANDO PAGOS ARRAY:"),console.log("   - props.reserva.pagos existe:",!!l.reserva.pagos),console.log("   - props.reserva.pagos length:",(e=l.reserva.pagos)==null?void 0:e.length),l.reserva.pagos&&l.reserva.pagos.length>0&&(console.log("   - Todos los pagos:",JSON.stringify(l.reserva.pagos,null,2)),l.reserva.pagos.forEach((n,v)=>{console.log(`   - Pago ${v}: ID=${n.id}, Estado=${n.estado}, Ref=${n.referencia_wompi}`)}))),console.log("4. LÃ“GICA DE DECISIÃ“N:");const s=!l.reserva.pago_activo||l.reserva.pago_activo.estado!=="approved";return console.log("   - Resultado tienePagoPendiente:",s),console.log("   - RazÃ³n:",l.reserva.pago_activo?l.reserva.pago_activo.estado!=="approved"?`Estado "${l.reserva.pago_activo.estado}" no es "approved"`:"Pago estÃ¡ aprobado":"No hay pago_activo"),console.log("=================================================="),l.reserva.pago_activo?l.reserva.pago_activo.estado!=="approved":!0});return L(h,s=>{s?G():!w.value&&!A.value&&V()}),L(w,s=>{s?G():(H(),!h.value&&!A.value&&V())}),L(()=>l.reserva,(s,e)=>{console.log("ðŸ“Š WATCHER - CAMBIO EN PROPS.RESERVA:"),console.log("   - Reserva anterior:",e),console.log("   - Reserva nueva:",s),console.log("   - ID anterior:",e==null?void 0:e.id),console.log("   - ID nuevo:",s==null?void 0:s.id),console.log("   - pago_activo anterior:",e==null?void 0:e.pago_activo),console.log("   - pago_activo nuevo:",s==null?void 0:s.pago_activo),s!=null&&s.pago_activo&&(console.log("   - Estado nuevo del pago:",s.pago_activo.estado),console.log("   - Referencia nueva del pago:",s.pago_activo.referencia_wompi))},{deep:!0}),L(A,s=>{s?G():!h.value&&!w.value&&V()}),Ee(()=>{var s,e,n;console.log("ðŸš€ COMPONENTE MONTADO - DATOS INICIALES:"),console.log("   - Props reserva completa:",JSON.stringify(l.reserva,null,2)),console.log("   - pago_activo inicial:",(s=l.reserva)==null?void 0:s.pago_activo),console.log("   - Estado inicial del pago:",(n=(e=l.reserva)==null?void 0:e.pago_activo)==null?void 0:n.estado)}),we(()=>{V()}),(s,e)=>(c(),m(Ae,null,[d(t(ye)),d(t(W),{visible:h.value,"onUpdate:visible":e[1]||(e[1]=n=>h.value=n),header:"MÃ¡s Acciones",modal:!0,style:Y(a.dialogStyle),closable:!1,draggable:!1},{footer:D(()=>[o("div",Ke,[o("button",{type:"button",onClick:e[0]||(e[0]=n=>h.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[d(t(r),{icon:t(q),class:"h-5"},null,8,["icon"]),e[16]||(e[16]=u(" Cerrar "))])])]),default:D(()=>{var n,v,b;return[o("div",ze,[o("div",Te,[o("h4",Ve,[e[10]||(e[10]=u(" Reserva: ")),o("span",Me,i(a.reserva.entidad_nombre||"Reserva"),1)]),o("p",Fe," Cliente: "+i(((v=(n=a.reserva.cliente)==null?void 0:n.user)==null?void 0:v.name)||((b=a.reserva.cliente)==null?void 0:b.nombres)||"N/A"),1),e[11]||(e[11]=o("p",{class:"text-xs text-gray-500 mt-1"},"Selecciona una acciÃ³n a realizar",-1))]),o("div",Le,[T(a.reserva).includes("detalles")?(c(),m("button",{key:0,class:"w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-md transition-all duration-200 ease-in-out flex items-center gap-3 justify-start",onClick:de},[d(t(r),{icon:t(ee),class:"h-5 w-5"},null,8,["icon"]),e[12]||(e[12]=o("div",{class:"text-left flex-1"},[o("div",{class:"font-medium"},"Ver Detalles"),o("div",{class:"text-xs opacity-90"},"InformaciÃ³n completa de la reserva")],-1))])):y("",!0),T(a.reserva).includes("confirmar")&&xe.value?(c(),m("div",$e,[o("div",je,[d(t(r),{icon:t(oe),class:"h-4 w-4 text-orange-600"},null,8,["icon"]),e[13]||(e[13]=o("span",{class:"font-semibold text-orange-800 text-sm"},"Pago Pendiente",-1)),e[14]||(e[14]=o("span",{class:"px-2 py-0.5 bg-orange-200 text-orange-800 text-xs font-medium rounded-full ml-auto"}," No Confirmar ",-1))]),e[15]||(e[15]=o("p",{class:"text-orange-700 text-xs leading-relaxed"},[u(" El cliente no ha pagado. Revisa el estado en "),o("span",{class:"font-semibold"},'"Ver Detalles"'),u(" antes de confirmar. ")],-1))])):y("",!0),T(a.reserva).includes("confirmar")?(c(),m("button",{key:2,class:"w-full bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-md transition-all duration-200 ease-in-out flex items-center gap-3 justify-start disabled:opacity-50 disabled:cursor-not-allowed",onClick:ne,disabled:a.confirmandoReserva},[a.confirmandoReserva?(c(),O(t(r),{key:0,icon:t($),class:"h-5 w-5 animate-spin"},null,8,["icon"])):(c(),O(t(r),{key:1,icon:t(U),class:"h-5 w-5"},null,8,["icon"])),o("div",We,[o("div",Be,i(a.confirmandoReserva?"Confirmando...":"Confirmar Reserva"),1),o("div",Ue,i(a.confirmandoReserva?"Procesando la confirmaciÃ³n":"Aprobar la reserva del cliente"),1)])],8,Ge)):y("",!0),T(a.reserva).includes("rechazar")?(c(),m("button",{key:3,class:"w-full bg-red-500 hover:bg-red-600 text-white px-4 py-3 rounded-md transition-all duration-200 ease-in-out flex items-center gap-3 justify-start disabled:opacity-50 disabled:cursor-not-allowed",onClick:re,disabled:a.rechazandoReserva},[a.rechazandoReserva?(c(),O(t(r),{key:0,icon:t($),class:"h-5 w-5 animate-spin"},null,8,["icon"])):(c(),O(t(r),{key:1,icon:t(ke),class:"h-5 w-5"},null,8,["icon"])),o("div",Je,[o("div",Ze,i(a.rechazandoReserva?"Rechazando...":"Rechazar Reserva"),1),o("div",He,i(a.rechazandoReserva?"Procesando el rechazo":"Rechazar con motivo especificado"),1)])],8,qe)):y("",!0)])])]}),_:1},8,["visible","style"]),d(t(W),{visible:w.value,"onUpdate:visible":e[7]||(e[7]=n=>w.value=n),modal:"",style:{width:"95vw",maxWidth:"800px"},closable:!1,draggable:!1},{header:D(()=>{var n;return[o("div",Qe,[o("div",Xe,[e[17]||(e[17]=o("div",null,[o("h3",{class:"text-lg sm:text-xl font-bold text-gray-800 mb-1"}," Detalles de la Reserva ")],-1)),o("div",Ye,[o("div",eo,[o("span",{class:B([le(a.reserva.estado),"px-3 py-1.5 rounded-full text-sm font-bold shadow-md border-2 border-white"])},i(((n=a.estadosReservas.find(v=>v.value===a.reserva.estado))==null?void 0:n.label)||a.reserva.estado),3)]),o("div",oo,[d(t(r),{icon:t(Oe),class:"text-blue-600 text-lg"},null,8,["icon"]),o("div",ao,[o("p",to,i(Z(a.reserva.fecha_reserva)),1)])])])])])]}),footer:D(()=>[o("div",Yo,[o("button",{type:"button",onClick:e[6]||(e[6]=n=>w.value=!1),class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[d(t(r),{icon:t(q),class:"h-5"},null,8,["icon"]),e[44]||(e[44]=u("Cerrar "))])])]),default:D(()=>{var n,v,b,N,S,g,E,z,P,R,K;return[a.reserva?(c(),m("div",so,[o("div",lo,[o("h4",no,[d(t(r),{icon:t(ee),class:"text-blue-600 text-sm sm:text-base"},null,8,["icon"]),e[18]||(e[18]=u(" InformaciÃ³n del Cliente "))]),o("div",ro,[o("div",io,[e[19]||(e[19]=o("span",{class:"font-medium text-gray-700"},"Nombre:",-1)),o("span",co,i(((v=(n=a.reserva.cliente)==null?void 0:n.user)==null?void 0:v.name)||((b=a.reserva.cliente)==null?void 0:b.nombres)||"Problema al obtener nombre o no existe"),1)]),o("div",null,[e[20]||(e[20]=o("span",{class:"font-medium text-gray-700"},"Documento:",-1)),o("span",uo,i(((N=a.reserva.cliente)==null?void 0:N.numero_identificacion)||"Problema al obtener documento o no existe"),1)]),o("div",go,[e[22]||(e[22]=o("span",{class:"font-medium text-gray-700"},"Email:",-1)),(g=(S=a.reserva.cliente)==null?void 0:S.user)!=null&&g.email||(E=a.reserva.cliente)!=null&&E.correo?(c(),m("div",mo,[o("span",vo,i(((P=(z=a.reserva.cliente)==null?void 0:z.user)==null?void 0:P.email)||((R=a.reserva.cliente)==null?void 0:R.correo)),1),o("a",{onClick:e[2]||(e[2]=x=>{var f,Q,X;return ge(((Q=(f=a.reserva.cliente)==null?void 0:f.user)==null?void 0:Q.email)||((X=a.reserva.cliente)==null?void 0:X.correo))}),href:"#",class:"inline-flex items-center gap-1 px-2 py-1 bg-red-500 hover:bg-red-600 text-white text-xs rounded-md transition-colors duration-200 cursor-pointer",title:"Abrir Gmail para enviar correo"},[d(t(r),{icon:t(Ne),class:"h-3 w-3"},null,8,["icon"]),e[21]||(e[21]=o("span",{class:"hidden sm:inline"},"Enviar Email",-1))])])):(c(),m("span",po,"Problema al obtener email o no existe"))]),o("div",fo,[e[25]||(e[25]=o("span",{class:"font-medium text-gray-700"},"TelÃ©fono:",-1)),(K=a.reserva.cliente)!=null&&K.telefono?(c(),m("div",xo,[o("span",bo,i(a.reserva.cliente.telefono),1),o("div",yo,[o("a",{href:`https://wa.me/${a.reserva.cliente.telefono.replace(/[^0-9]/g,"")}`,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center gap-1 px-2 py-1 bg-green-500 hover:bg-green-600 text-white text-xs rounded-md transition-colors duration-200",title:"Enviar mensaje por WhatsApp"},[d(t(r),{icon:t(_e),class:"h-3 w-3"},null,8,["icon"]),e[23]||(e[23]=o("span",{class:"hidden sm:inline"},"WhatsApp",-1))],8,ho),o("a",{href:`tel:${a.reserva.cliente.telefono}`,class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white text-xs rounded-md transition-colors duration-200",title:"Llamar por telÃ©fono"},[d(t(r),{icon:t(Re),class:"h-3 w-3"},null,8,["icon"]),e[24]||(e[24]=o("span",{class:"hidden sm:inline"},"Llamar",-1))],8,Eo)])])):(c(),m("span",wo,"Problema al obtener telÃ©fono o no existe"))])])]),o("div",Ao,[o("h4",Co,[d(t(r),{icon:t(J),class:"text-green-600 text-sm sm:text-base"},null,8,["icon"]),e[26]||(e[26]=u(" Detalles de la Reserva "))]),o("div",ko,[o("div",null,[e[27]||(e[27]=o("span",{class:"font-medium text-gray-700"},"Adultos:",-1)),o("span",No,i(a.reserva.mayores_edad||0),1)]),o("div",null,[e[28]||(e[28]=o("span",{class:"font-medium text-gray-700"},"NiÃ±os:",-1)),o("span",Ro,i(a.reserva.menores_edad||0),1)]),o("div",null,[e[29]||(e[29]=o("span",{class:"font-medium text-gray-700"},"Total:",-1)),o("span",Do,"$"+i(Number(a.reserva.total||0).toFixed(2)),1)])])]),o("div",Io,[o("h4",Po,[d(t(r),{icon:t(ae),class:"text-slate-600 text-sm sm:text-base"},null,8,["icon"]),e[30]||(e[30]=u(" InformaciÃ³n de Pagos "))]),o("div",Oo,[o("div",_o,[e[31]||(e[31]=o("span",{class:"font-medium text-gray-700"},"Estado de Pago:",-1)),o("span",{class:B(["px-2 py-1 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":a.reserva.pago_activo&&a.reserva.pago_activo.estado==="approved","bg-yellow-100 text-yellow-800":!a.reserva.pago_activo||a.reserva.pago_activo.estado!=="approved"}]),onClick:e[3]||(e[3]=x=>{var f;return console.log("ðŸŽ¯ CLICK EN ESTADO - pago_activo:",a.reserva.pago_activo,"estado:",(f=a.reserva.pago_activo)==null?void 0:f.estado)})},i((()=>{var f;console.log("ðŸŽ¨ RENDERIZANDO ESTADO DE PAGO:"),console.log("   - reserva.pago_activo:",a.reserva.pago_activo),console.log("   - reserva.pago_activo?.estado:",(f=a.reserva.pago_activo)==null?void 0:f.estado),console.log("   - CondiciÃ³n completa:",a.reserva.pago_activo&&a.reserva.pago_activo.estado==="approved");const x=a.reserva.pago_activo&&a.reserva.pago_activo.estado==="approved"?"Pagado":"Pendiente de Pago";return console.log("   - Texto que se mostrarÃ¡:",x),x})()),3)]),o("div",So,[e[32]||(e[32]=o("span",{class:"font-medium text-gray-700"},"Ref. Wompi:",-1)),a.reserva.pago_activo&&a.reserva.pago_activo.referencia_wompi?(c(),m("span",{key:0,class:"text-xs bg-gray-100 px-2 py-1 rounded font-mono",onClick:e[4]||(e[4]=x=>{var f;return console.log("ðŸŽ¯ CLICK EN REFERENCIA - pago_activo:",a.reserva.pago_activo,"referencia:",(f=a.reserva.pago_activo)==null?void 0:f.referencia_wompi)})},i((()=>{var x;return console.log("ðŸ“‹ RENDERIZANDO REFERENCIA WOMPI:"),console.log("   - reserva.pago_activo:",a.reserva.pago_activo),console.log("   - reserva.pago_activo?.referencia_wompi:",(x=a.reserva.pago_activo)==null?void 0:x.referencia_wompi),console.log("   - CondiciÃ³n v-if:",a.reserva.pago_activo&&a.reserva.pago_activo.referencia_wompi),console.log("   - Referencia que se mostrarÃ¡:",a.reserva.pago_activo.referencia_wompi),a.reserva.pago_activo.referencia_wompi})()),1)):(c(),m("span",{key:1,class:"text-gray-400 italic text-sm",onClick:e[5]||(e[5]=x=>console.log("ðŸš« CLICK EN SIN REFERENCIA - pago_activo:",a.reserva.pago_activo,"condiciÃ³n v-else ejecutada"))},i((()=>{var x,f;return console.log('âŒ RENDERIZANDO "SIN REFERENCIA":'),console.log("   - reserva.pago_activo:",a.reserva.pago_activo),console.log("   - reserva.pago_activo?.referencia_wompi:",(x=a.reserva.pago_activo)==null?void 0:x.referencia_wompi),console.log("   - Â¿Por quÃ© v-else? No cumple:",a.reserva.pago_activo&&a.reserva.pago_activo.referencia_wompi),console.log("   - Razones posibles:"),console.log("     - No hay pago_activo:",!a.reserva.pago_activo),console.log("     - No hay referencia_wompi:",!((f=a.reserva.pago_activo)!=null&&f.referencia_wompi)),"Sin referencia"})()),1))])])]),fe(a.reserva)?(c(),m("div",zo,[o("div",To,[o("div",Vo,[d(t(r),{icon:t(te),class:"text-orange-600 text-lg"},null,8,["icon"]),e[33]||(e[33]=o("h4",{class:"text-lg font-semibold text-gray-800"},"Generar Enlace de Pago Wompi",-1))]),o("div",Mo,[o("span",Fo,[d(t(r),{icon:t(ae),class:"mr-1"},null,8,["icon"]),u(" Total: $"+i(Number(a.reserva.total||0).toFixed(2)),1)])])]),o("div",Lo,[o("p",$o,[d(t(r),{icon:t(J),class:"text-blue-500 mr-1"},null,8,["icon"]),e[34]||(e[34]=o("strong",null,"Â¿El cliente aÃºn no ha pagado?",-1)),e[35]||(e[35]=o("br",null,null,-1)),e[36]||(e[36]=u(" Genera un enlace de pago personalizado para que el cliente pueda pagar esta reserva directamente. "))]),I.value?y("",!0):(c(),m("div",jo,[o("button",{onClick:me,disabled:k.value,class:"bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg transition-all duration-200 flex items-center gap-2 shadow-lg hover:shadow-xl"},[d(t(r),{icon:k.value?t($):t(te),class:B({"animate-spin":k.value})},null,8,["icon","class"]),u(" "+i(k.value?"Generando enlace...":"Generar Enlace de Pago"),1)],8,Go)])),I.value&&p.value?(c(),m("div",Wo,[o("div",Bo,[o("div",Uo,[e[38]||(e[38]=o("span",{class:"text-sm font-medium text-gray-700"},"Enlace de Pago Generado:",-1)),o("span",qo,[d(t(r),{icon:t(U),class:"mr-1"},null,8,["icon"]),e[37]||(e[37]=u(" Â¡Listo para usar! "))])]),o("div",Jo,[o("p",Zo,i(p.value.url),1)]),o("div",Ho,[o("span",null,"Referencia: "+i(p.value.reference),1),o("span",null,"Monto: $"+i(p.value.amount.toFixed(2)),1)])]),o("div",Ko,[o("button",{onClick:ve,class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2 text-sm font-medium"},[d(t(r),{icon:t(De)},null,8,["icon"]),e[39]||(e[39]=u(" Copiar Enlace "))]),o("button",{onClick:pe,class:"bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2 text-sm font-medium"},[d(t(r),{icon:t(Ie)},null,8,["icon"]),e[40]||(e[40]=u(" Ver Enlace "))]),o("button",{onClick:H,class:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2 text-sm font-medium"},[d(t(r),{icon:t(Pe)},null,8,["icon"]),e[41]||(e[41]=u(" Limpiar "))])]),o("div",Qo,[o("h5",Xo,[d(t(r),{icon:t(J),class:"mr-1"},null,8,["icon"]),e[42]||(e[42]=u(" Instrucciones de uso: "))]),e[43]||(e[43]=o("ul",{class:"text-xs text-blue-700 space-y-1"},[o("li",null,"â€¢ Copia el enlace y envÃ­alo al cliente por WhatsApp, email o SMS"),o("li",null,"â€¢ El cliente podrÃ¡ pagar su reserva de manera segura"),o("li",null,"â€¢ RecibirÃ¡s notificaciÃ³n automÃ¡tica cuando se complete el pago"),o("li",null,"â€¢ El enlace es seguro y estÃ¡ protegido por Wompi")],-1))])])):y("",!0)])])):y("",!0)])):y("",!0)]}),_:1},8,["visible"]),d(t(W),{visible:A.value,"onUpdate:visible":e[9]||(e[9]=n=>A.value=n),modal:"",header:"Rechazar Reserva",style:Y(a.dialogStyle),closable:!1,draggable:!1},{footer:D(()=>[o("div",ia,[o("button",{onClick:ie,disabled:!C.value.trim()||a.procesando,class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[a.procesando?(c(),O(t(r),{key:0,icon:t($),class:"animate-spin h-5 text-white"},null,8,["icon"])):(c(),O(t(r),{key:1,icon:t(U),class:"h-5"},null,8,["icon"])),a.procesando?(c(),m("span",ua,"Eliminando...")):(c(),m("span",ca,"Eliminar Reserva Definitivamente"))],8,da),o("button",{type:"button",onClick:ue,disabled:a.procesando,class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2"},[d(t(r),{icon:t(q),class:"h-5"},null,8,["icon"]),e[52]||(e[52]=u("Cancelar "))],8,ga)])]),default:D(()=>{var n,v,b;return[o("div",ea,[a.reserva?(c(),m("div",oa,[o("div",aa,[d(t(r),{icon:t(oe),class:"text-red-600 text-base sm:text-lg mt-1 flex-shrink-0"},null,8,["icon"]),o("div",ta,[e[49]||(e[49]=o("h4",{class:"font-semibold text-red-800 text-sm sm:text-base mb-2"},"Rechazar Reserva",-1)),e[50]||(e[50]=o("div",{class:"text-xs sm:text-sm text-red-700 mb-3 space-y-1"},[o("p",null,[o("strong",null,"â€¢ AcciÃ³n permanente:"),u(" elimina la reserva y notifica al cliente")]),o("p",null,"â€¢ Los cupos se liberan automÃ¡ticamente")],-1)),o("div",sa,[o("p",la,[e[45]||(e[45]=o("strong",null,"Cliente:",-1)),u(" "+i(((v=(n=a.reserva.cliente)==null?void 0:n.user)==null?void 0:v.name)||((b=a.reserva.cliente)==null?void 0:b.nombres)||"N/A"),1)]),o("p",na,[e[46]||(e[46]=o("strong",null,"Servicio:",-1)),u(" "+i(a.reserva.entidad_nombre),1)]),o("p",null,[e[47]||(e[47]=o("strong",null,"Fecha:",-1)),u(" "+i(Z(a.reserva.fecha_reserva)),1)]),o("p",null,[e[48]||(e[48]=o("strong",null,"Total:",-1)),u(" $"+i(Number(a.reserva.total||0).toFixed(2)),1)])])])])])):y("",!0),o("div",null,[e[51]||(e[51]=o("label",{class:"block text-xs sm:text-sm font-medium text-gray-700 mb-2"},[u(" Motivo del rechazo "),o("span",{class:"text-red-500"},"*")],-1)),d(t(he),{modelValue:C.value,"onUpdate:modelValue":e[8]||(e[8]=N=>C.value=N),placeholder:"Especifica el motivo por el cual se rechaza esta reserva...",rows:"4",class:"w-full text-xs sm:text-sm",maxlength:"500",pt:{root:"w-full",textarea:"text-xs sm:text-sm p-2 sm:p-3"}},null,8,["modelValue"]),o("small",ra,i(C.value.length)+"/500 caracteres ",1)])])]}),_:1},8,["visible","style"])],64))}},ya=Se(ma,[["__scopeId","data-v-f2b658c4"]]);export{ya as default};
