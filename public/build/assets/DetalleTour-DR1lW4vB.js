import Q from"./Catalogo-3xOAUxvL.js";import Y from"./ModalReservaTour-D9QBFIz9.js";import Z from"./ModalAuthRequerido-DF4Lz3DA.js";import{l as ee,i as M,q as te,r as v,m as se,s as ae,am as le,y as ne,p as re,o as l,w as $,b as e,a as f,c as n,f as y,u as B,S as F,n as g,h as u,t as o,A as h,B as _,W as oe}from"./app-WKwrJkJC.js";import"./logo-DN1bLr27.js";import"./index-Cz7jU3Cp.js";import"./ResumenTour-VD5jKeA5.js";import"./FormularioDatosPersonales-CciqR48P.js";import"./SelectorCupos-BkPL4KO9.js";const ie={class:"min-h-screen bg-gray-50 py-4 sm:py-8"},ue={class:"max-w-7xl mx-auto px-3 sm:px-4 lg:px-8"},me={class:"mb-4 sm:mb-8"},de={class:"flex items-center space-x-1 sm:space-x-2 text-xs sm:text-sm"},ce={class:"text-gray-900 font-medium truncate"},xe={key:0,class:"bg-white rounded-lg shadow-lg overflow-hidden p-8"},ve={class:"flex items-center justify-center"},ge={key:1,class:"bg-white rounded-lg shadow-lg overflow-hidden p-8"},pe={class:"text-center"},be={class:"text-gray-600 mb-4"},fe={key:2,class:"bg-white rounded-lg shadow-lg overflow-hidden"},ye={key:0,class:"relative w-full h-full flex items-center justify-center"},he=["src","alt"],_e={key:0,class:"absolute inset-0 flex items-center justify-between p-2 sm:p-4 pointer-events-none"},ke={key:1,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-10"},we={class:"flex space-x-2"},Ce=["onClick"],Ie={key:1,class:"w-full h-full bg-gray-300 flex items-center justify-center rounded-t-lg"},Te={class:"p-4 sm:p-6 md:p-8"},Se={class:"grid grid-cols-1 xl:grid-cols-2 gap-6 lg:gap-8"},Ne={class:"order-2 xl:order-1"},je={class:"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-3 sm:mb-4"},De={class:"mb-4 sm:mb-6"},Ae={class:"inline-flex items-center px-3 py-1 rounded-full text-xs sm:text-sm font-medium bg-blue-100 text-blue-800"},$e={class:"space-y-3 sm:space-y-4 mb-4 sm:mb-6"},Le={class:"flex items-start text-gray-600 text-sm sm:text-base"},Re={class:"flex items-start text-gray-600 text-sm sm:text-base"},qe={class:"flex items-start text-gray-600 text-sm sm:text-base"},Ee={class:"flex items-start text-gray-600 text-sm sm:text-base"},Me={key:0,class:"flex items-start text-gray-600 text-sm sm:text-base"},Be={key:1,class:"flex items-start text-gray-600 text-sm sm:text-base"},Fe={class:"mb-4 sm:mb-6 order-1 xl:order-none"},Oe={class:"text-2xl sm:text-3xl font-bold text-red-600"},Pe={class:"order-3 xl:order-2"},Ue={class:"mb-4 sm:mb-6"},ze={class:"sm:hidden"},Ve={class:"grid grid-cols-2 gap-2"},He={class:"bg-green-50 rounded-lg p-2"},We={key:0,class:"space-y-1"},Xe={key:1,class:"text-gray-500 text-xs italic"},Ge={class:"bg-red-50 rounded-lg p-2"},Je={key:0,class:"space-y-1"},Ke={key:1,class:"text-gray-500 text-xs italic"},Qe={class:"hidden sm:block"},Ye={class:"mb-4 sm:mb-6"},Ze={class:"bg-green-50 rounded-lg p-3 sm:p-4"},et={key:0,class:"space-y-2"},tt={key:1,class:"text-gray-500 text-sm sm:text-base italic"},st={class:"mb-4 sm:mb-6"},at={class:"bg-red-50 rounded-lg p-3 sm:p-4"},lt={key:0,class:"space-y-2"},nt={key:1,class:"text-gray-500 text-sm sm:text-base italic"},rt={class:"mt-4 sm:mt-8 text-center px-4"},ot="/api/tours",bt={__name:"DetalleTour",props:{tour:{type:Object,required:!0},tipo:{type:String,required:!0,validator:m=>["nacional","internacional"].includes(m)}},setup(m){const O=ee(),k=M(()=>O.props.auth.user),L=te(),p=v(!1),S=v(!1),b=m,w=v({}),C=v(!0),I=v(null),c=v(0),T=v(null),s=M(()=>Object.keys(w.value).length>0?w.value:b.tour),R=async()=>{var a;if(!((a=b.tour)!=null&&a.id)){C.value=!1;return}try{C.value=!0,I.value=null;const t=b.tour.id,d=`${ot}/${t}`,r=await fetch(d,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!r.ok)throw new Error(`Error ${r.status}: ${r.statusText}`);const i=await r.json();w.value=i}catch(t){console.error("Error al obtener el tour:",t),I.value=t.message,w.value=b.tour||{}}finally{C.value=!1}},q=a=>a?new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"",P=(a,t)=>{if(!a||!t)return"1 dÃ­a";const d=new Date(a),r=new Date(t);d.setHours(0,0,0,0),r.setHours(0,0,0,0);const i=r.getTime()-d.getTime(),A=Math.floor(i/(1e3*60*60*24))+1;return A===1?"1 dÃ­a":`${A} dÃ­as`},x=a=>a?a.split("|").filter(t=>t.trim()).map(t=>t.trim()):[],U=()=>{var d;if(!((d=s.value)!=null&&d.imagenes)||s.value.imagenes.length===0)return"https://via.placeholder.com/800x500/2563eb/ffffff?text=Sin+Imagen+Disponible";const a=s.value.imagenes[c.value];return`/images/tours/${typeof a=="string"?a:a.nombre}`},z=()=>{s.value.imagenes&&s.value.imagenes.length>1&&(c.value=c.value===0?s.value.imagenes.length-1:c.value-1,D())},V=()=>{s.value.imagenes&&s.value.imagenes.length>1&&(c.value=(c.value+1)%s.value.imagenes.length,D())},H=a=>{c.value=a,D()},N=()=>{s.value.imagenes&&s.value.imagenes.length>1&&(T.value=setInterval(()=>{c.value=(c.value+1)%s.value.imagenes.length},3e3))},j=()=>{T.value&&(clearInterval(T.value),T.value=null)},D=()=>{j(),setTimeout(()=>{N()},1e3)},W=()=>{j()},X=()=>{N()},G=()=>{k.value?p.value=!0:S.value=!0},E=()=>{try{const a=sessionStorage.getItem("tour_reserva_pendiente"),t=sessionStorage.getItem("reserva_session_activa");if(a&&t==="true"&&k.value&&s.value){const d=JSON.parse(a);s.value.id===d.tourId?(p.value=!0,sessionStorage.removeItem("tour_reserva_pendiente"),sessionStorage.removeItem("reserva_session_activa"),setTimeout(()=>{L.add({severity:"success",summary:"ðŸŽ¯ Continuando con tu reserva",detail:`Â¡Perfecto! Ahora puedes completar la reserva para: ${s.value.nombre}`,life:6e3})},500)):(sessionStorage.removeItem("tour_reserva_pendiente"),sessionStorage.removeItem("reserva_session_activa"))}else a&&t!=="true"&&(sessionStorage.removeItem("tour_reserva_pendiente"),sessionStorage.removeItem("reserva_session_activa"))}catch{sessionStorage.removeItem("tour_reserva_pendiente"),sessionStorage.removeItem("reserva_session_activa")}},J=a=>{L.add({severity:"success",summary:"Reserva Confirmada",detail:"Tu reserva ha sido registrada. Te contactaremos pronto.",life:5e3}),p.value=!1};se(k,a=>{try{a&&s.value&&E()}catch(t){console.error("Error en watcher de usuario:",t)}},{immediate:!1}),ae(async()=>{await R(),E(),N()}),le(()=>{j()});const K=()=>{const a=b.tipo==="nacional"?"/tours-nacionales":"/tours-internacionales";oe.visit(a)};return(a,t)=>{const d=ne("Toast");return l(),re(Q,null,{default:$(()=>[e("div",ie,[e("div",ue,[e("nav",me,[e("ol",de,[e("li",null,[f(B(F),{href:"/",class:g(m.tipo==="nacional"?"text-red-600 hover:text-red-800":"text-blue-600 hover:text-blue-800")},{default:$(()=>t[2]||(t[2]=[u(" Inicio ")])),_:1,__:[2]},8,["class"])]),t[3]||(t[3]=e("li",{class:"text-gray-500"},"/",-1)),e("li",null,[f(B(F),{href:m.tipo==="nacional"?"/tours-nacionales":"/tours-internacionales",class:g(m.tipo==="nacional"?"text-red-600 hover:text-red-800":"text-blue-600 hover:text-blue-800")},{default:$(()=>[u(o(m.tipo==="nacional"?"Tours Nacionales":"Tours Internacionales"),1)]),_:1},8,["href","class"])]),t[4]||(t[4]=e("li",{class:"text-gray-500"},"/",-1)),e("li",ce,o(s.value.nombre),1)])]),C.value?(l(),n("div",xe,[e("div",ve,[e("div",{class:g(["animate-spin rounded-full h-12 w-12 border-b-2",m.tipo==="nacional"?"border-red-600":"border-blue-600"])},null,2),t[5]||(t[5]=e("span",{class:"ml-3 text-gray-600"},"Cargando detalles del tour...",-1))])])):I.value?(l(),n("div",ge,[e("div",pe,[t[6]||(t[6]=e("div",{class:"text-red-600 mb-4"},[e("svg",{class:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t[7]||(t[7]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Error al cargar el tour",-1)),e("p",be,o(I.value),1),e("button",{onClick:R,class:g([m.tipo==="nacional"?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700","px-4 py-2 text-white rounded-lg transition-colors"])}," Reintentar ",2)])])):s.value?(l(),n("div",fe,[e("div",{class:"relative w-full h-64 sm:h-72 md:h-80 lg:h-96 bg-gray-100 rounded-t-lg overflow-hidden flex items-center justify-center",onMouseenter:W,onMouseleave:X},[s.value.imagenes&&s.value.imagenes.length>0?(l(),n("div",ye,[e("img",{src:U(),alt:s.value.nombre,class:"max-w-full max-h-full object-contain transition-opacity duration-500"},null,8,he),s.value.imagenes.length>1?(l(),n("div",_e,[e("button",{onClick:z,class:"bg-black/50 text-white hover:bg-black/70 rounded-full p-2 sm:p-3 transition-all duration-200 pointer-events-auto flex items-center justify-center"},t[8]||(t[8]=[e("i",{class:"pi pi-chevron-left text-sm sm:text-lg"},null,-1)])),e("button",{onClick:V,class:"bg-black/50 text-white hover:bg-black/70 rounded-full p-2 sm:p-3 transition-all duration-200 pointer-events-auto flex items-center justify-center"},t[9]||(t[9]=[e("i",{class:"pi pi-chevron-right text-sm sm:text-lg"},null,-1)]))])):y("",!0),s.value.imagenes.length>1?(l(),n("div",ke,[e("div",we,[(l(!0),n(h,null,_(s.value.imagenes,(r,i)=>(l(),n("button",{key:i,onClick:A=>H(i),class:g(["w-3 h-3 rounded-full transition-all duration-200 hover:scale-110",c.value===i?"bg-white":"bg-white/50 hover:bg-white/70"])},null,10,Ce))),128))])])):y("",!0)])):(l(),n("div",Ie,t[10]||(t[10]=[e("span",{class:"text-gray-500 text-lg"},"Sin imagen disponible",-1)])))],32),e("div",Te,[e("div",Se,[e("div",Ne,[e("h1",je,o(s.value.nombre),1),e("div",De,[e("span",Ae,o(s.value.categoria==="NACIONAL"?"Nacional":s.value.categoria==="INTERNACIONAL"?"Internacional":"CategorÃ­a no asignada"),1)]),e("div",$e,[e("div",Le,[t[12]||(t[12]=e("i",{class:"pi pi-calendar mr-2 sm:mr-3 text-blue-600 mt-0.5 text-sm sm:text-base"},null,-1)),e("span",null,[t[11]||(t[11]=e("strong",null,"Fecha de salida:",-1)),u(" "+o(q(s.value.fecha_salida)),1)])]),e("div",Re,[t[14]||(t[14]=e("i",{class:"pi pi-calendar mr-2 sm:mr-3 text-blue-600 mt-0.5 text-sm sm:text-base"},null,-1)),e("span",null,[t[13]||(t[13]=e("strong",null,"Fecha de regreso:",-1)),u(" "+o(q(s.value.fecha_regreso)),1)])]),e("div",qe,[t[16]||(t[16]=e("i",{class:"pi pi-clock mr-2 sm:mr-3 text-blue-600 mt-0.5 text-sm sm:text-base"},null,-1)),e("span",null,[t[15]||(t[15]=e("strong",null,"DuraciÃ³n:",-1)),u(" "+o(P(s.value.fecha_salida,s.value.fecha_regreso)),1)])]),e("div",Ee,[t[18]||(t[18]=e("i",{class:"pi pi-map-marker mr-2 sm:mr-3 text-blue-600 mt-0.5 text-sm sm:text-base"},null,-1)),e("span",null,[t[17]||(t[17]=e("strong",null,"Punto de salida:",-1)),u(" "+o(s.value.punto_salida),1)])]),s.value.transporte?(l(),n("div",Me,[t[20]||(t[20]=e("i",{class:"pi pi-car mr-2 sm:mr-3 text-blue-600 mt-0.5 text-sm sm:text-base"},null,-1)),e("span",null,[t[19]||(t[19]=e("strong",null,"Transporte:",-1)),u(" "+o(s.value.transporte.nombre),1)])])):y("",!0),s.value.cupo_min&&s.value.cupo_max?(l(),n("div",Be,[t[22]||(t[22]=e("i",{class:"pi pi-users mr-2 sm:mr-3 text-blue-600 mt-0.5 text-sm sm:text-base"},null,-1)),e("span",null,[t[21]||(t[21]=e("strong",null,"Cupo:",-1)),u(" "+o(s.value.cupo_min)+" - "+o(s.value.cupo_max)+" personas",1)])])):y("",!0)]),e("div",Fe,[e("div",Oe," $"+o(parseFloat(s.value.precio).toLocaleString("en-US",{minimumFractionDigits:2})),1),t[23]||(t[23]=e("div",{class:"text-gray-600 text-sm sm:text-base"},"Por persona",-1))]),e("button",{onClick:G,class:g(["w-full text-white font-semibold py-2 sm:py-3 px-4 sm:px-6 rounded-lg transition-colors duration-200 text-sm sm:text-base",m.tipo==="nacional"?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"])}," Reservar Tour ",2)]),e("div",Pe,[e("div",Ue,[e("div",ze,[e("div",Ve,[e("div",null,[t[25]||(t[25]=e("h3",{class:"text-sm font-semibold text-gray-900 mb-2 flex items-center"},[e("i",{class:"pi pi-check-circle mr-1 text-green-600 text-xs"}),e("span",{class:"truncate"},"Lo que incluye")],-1)),e("div",He,[x(s.value.incluye).length>0?(l(),n("ul",We,[(l(!0),n(h,null,_(x(s.value.incluye),(r,i)=>(l(),n("li",{key:i,class:"text-gray-700 text-xs leading-tight flex items-start"},[t[24]||(t[24]=e("span",{class:"text-green-600 mr-1 mt-0.5 text-xs"},"â–¶",-1)),e("span",null,o(r),1)]))),128))])):(l(),n("p",Xe,"No hay informaciÃ³n disponible"))])]),e("div",null,[t[27]||(t[27]=e("h3",{class:"text-sm font-semibold text-gray-900 mb-2 flex items-center"},[e("i",{class:"pi pi-times-circle mr-1 text-red-600 text-xs"}),e("span",{class:"truncate"},"No incluye")],-1)),e("div",Ge,[x(s.value.no_incluye).length>0?(l(),n("ul",Je,[(l(!0),n(h,null,_(x(s.value.no_incluye),(r,i)=>(l(),n("li",{key:i,class:"text-gray-700 text-xs leading-tight flex items-start"},[t[26]||(t[26]=e("span",{class:"text-red-600 mr-1 mt-0.5 text-xs"},"â–¶",-1)),e("span",null,o(r),1)]))),128))])):(l(),n("p",Ke,"No hay informaciÃ³n disponible"))])])])]),e("div",Qe,[e("div",Ye,[t[29]||(t[29]=e("h3",{class:"text-lg sm:text-xl font-semibold text-gray-900 mb-2 sm:mb-3 flex items-center"},[e("i",{class:"pi pi-check-circle mr-2 text-green-600 text-sm sm:text-base"}),u(" Lo que incluye ")],-1)),e("div",Ze,[x(s.value.incluye).length>0?(l(),n("ul",et,[(l(!0),n(h,null,_(x(s.value.incluye),(r,i)=>(l(),n("li",{key:i,class:"text-gray-700 text-sm sm:text-base flex items-start"},[t[28]||(t[28]=e("span",{class:"text-green-600 mr-2 mt-1 text-sm"},"â–¶",-1)),e("span",null,o(r),1)]))),128))])):(l(),n("p",tt,"No hay informaciÃ³n disponible"))])]),e("div",st,[t[31]||(t[31]=e("h3",{class:"text-lg sm:text-xl font-semibold text-gray-900 mb-2 sm:mb-3 flex items-center"},[e("i",{class:"pi pi-times-circle mr-2 text-red-600 text-sm sm:text-base"}),u(" Lo que NO incluye ")],-1)),e("div",at,[x(s.value.no_incluye).length>0?(l(),n("ul",lt,[(l(!0),n(h,null,_(x(s.value.no_incluye),(r,i)=>(l(),n("li",{key:i,class:"text-gray-700 text-sm sm:text-base flex items-start"},[t[30]||(t[30]=e("span",{class:"text-red-600 mr-2 mt-1 text-sm"},"â–¶",-1)),e("span",null,o(r),1)]))),128))])):(l(),n("p",nt,"No hay informaciÃ³n disponible"))])])])]),t[32]||(t[32]=e("div",{class:"bg-blue-50 rounded-lg p-3 sm:p-4"},[e("h3",{class:"text-base sm:text-lg font-semibold text-blue-900 mb-2"},[e("i",{class:"pi pi-info-circle mr-2 text-sm sm:text-base"}),u(" InformaciÃ³n importante ")]),e("ul",{class:"text-blue-800 space-y-1 text-xs sm:text-sm"},[e("li",null,"â€¢ Confirmar disponibilidad antes de realizar el pago"),e("li",null,"â€¢ Los precios pueden variar segÃºn la temporada"),e("li",null,"â€¢ Se requiere documento de identidad vigente"),e("li",null,"â€¢ Cancelaciones con 48 horas de anticipaciÃ³n")])],-1))])])])])):y("",!0),e("div",rt,[e("button",{onClick:K,class:g(["inline-flex items-center text-white text-sm sm:text-base py-2 sm:py-3 px-4 sm:px-6 rounded-lg transition-colors duration-200",m.tipo==="nacional"?"bg-red-400 hover:bg-red-500":"bg-blue-400 hover:bg-blue-500"])},t[33]||(t[33]=[e("i",{class:"pi pi-arrow-left mr-2"},null,-1),u(" Regresar a Tours ")]),2)])])]),f(d),f(Y,{visible:p.value,"onUpdate:visible":t[0]||(t[0]=r=>p.value=r),"tour-seleccionado":s.value,user:k.value,onConfirmarReserva:J},null,8,["visible","tour-seleccionado","user"]),f(Z,{visible:S.value,"onUpdate:visible":t[1]||(t[1]=r=>S.value=r),"tour-info":s.value},null,8,["visible","tour-info"])]),_:1})}}};export{bt as default};
