import{A as ve}from"./AuthenticatedLayout-CUy_OMuD.js";import{b as fe,r as i,E as q,w as ge,n as V,o as xe,h as $,d as m,x as c,p as r,e as s,$ as o,a0 as ye,t as p,j as A,A as M,c as w,q as j,y as R,N as L}from"./vendor-CaDzpwPW.js";import{z as he,a as we,A as u,e as Ce,f as Z,h as J,g as F}from"./ui-BjYE_i4I.js";import{b as Ee,c as H,d as ke,f as N,e as K,g as X,h as Q,i as _e}from"./index-BSa8eY-g.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Te={class:"container mx-auto px-4 py-6"},Pe={class:"bg-white rounded-lg shadow-md"},De={class:"flex flex-col sm:flex-row lg:justify-between lg:items-center mb-4 gap-4 p-6"},Ae={class:"flex items-center gap-2 w-full justify-center lg:w-auto lg:justify-end"},Le={class:"bg-blue-50 p-3 rounded-lg shadow-sm border mb-4"},je={class:"flex flex-col sm:flex-row items-center justify-between mb-3"},Ne={class:"flex items-center gap-3"},Se={class:"bg-blue-50 border border-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium"},ze=["disabled"],Oe=["disabled"],Ue={class:"space-y-3"},Ve=["title"],$e={class:"flex gap-2 justify-center items-center"},Me=["onClick"],Re=["onClick"],Fe={class:"space-y-4"},Be={class:"w-full flex flex-col"},Ie={class:"flex items-center gap-4"},Ge={key:0,class:"text-red-500 ml-28"},We={key:1,class:"text-orange-500 ml-28"},qe={key:2,class:"text-red-500 ml-28"},Ze={class:"flex justify-center gap-4 w-full mt-6"},Je=["disabled"],He={key:0},Ke={key:1},Xe=["disabled"],Qe={class:"flex items-center gap-3"},Ye={class:"flex flex-col"},es={class:"flex justify-center gap-4 w-full"},ss=["disabled"],ts={key:0},as={key:1},os=["disabled"],ls={class:"flex items-center gap-3"},rs={class:"flex justify-center gap-3 w-full"},ms={__name:"TiposDocumento",props:{tipoDocumentos:{type:Array,default:()=>[]}},setup(Y){const ee=Y,d=he(),l=fe({id:null,nombre:""}),C=i(null),E=i(ee.tipoDocumentos||[]),b=i(!1),x=i(!1),f=i(!1),S=i(!0),y=i(!1),k=i(!1),_=i(!1),v=i(!1),T=i(!1),P=i(null),h=i(!1),g=i(null),z=i(10),se=i([5,10,20,50]),D=i({global:{value:null,matchMode:"contains"}}),O=q(()=>({width:"95vw",maxWidth:"500px",maxHeight:"95vh"})),U=q(()=>{let a=E.value;if(D.value.global.value){const e=D.value.global.value.toLowerCase();a=a.filter(t=>t.nombre.toLowerCase().includes(e))}return a});ge([l],()=>{g.value&&(v.value||T.value)&&V(()=>{const a={...l},e=JSON.stringify(a)!==JSON.stringify(g.value),t=!g.value.id,n=l.nombre;h.value=e||t&&n})},{deep:!0,flush:"post"});const te=()=>{Object.assign(l,{id:null,nombre:""}),y.value=!1,v.value=!0,V(()=>{g.value={...l},h.value=!1})},ae=a=>{C.value=a.data},oe=a=>{P.value=a,Object.assign(l,{id:a.id,nombre:a.nombre}),y.value=!1,T.value=!0,V(()=>{g.value={...l},h.value=!1})},le=a=>{C.value=a,k.value=!0},re=async()=>{var a,e;x.value=!0;try{if((await L.delete(`/api/tipo-documentos/${C.value.id}`)).data.success){const n=E.value.findIndex(be=>be.id===C.value.id);n!==-1&&E.value.splice(n,1),d.add({severity:"success",summary:"Â¡Eliminado!",detail:"El tipo de documento ha sido eliminado correctamente.",life:5e3}),k.value=!1,C.value=null}}catch(t){console.error("Error al eliminar tipo:",t),k.value=!1;const n=((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||t.message||"Error desconocido al eliminar el tipo de documento";d.add({severity:"error",summary:"Error",detail:n,life:6e3})}finally{x.value=!1}},B=async()=>{f.value=!0;try{await new Promise(a=>setTimeout(a,300)),D.value.global.value=null,d.add({severity:"success",summary:"Filtros limpiados",life:2e3})}finally{f.value=!1}},ne=async()=>{var a,e;if(y.value=!0,!l.nombre||l.nombre.length<3||l.nombre.length>20){d.add({severity:"warn",summary:"Campos requeridos",detail:"El nombre debe tener entre 3 y 20 caracteres.",life:4e3});return}b.value=!0;try{(await L.post("/api/tipo-documentos",{nombre:l.nombre.trim()})).data.success&&(await W(),v.value=!1,h.value=!1,g.value=null,d.add({severity:"success",summary:"Â¡Ã‰xito!",detail:"El tipo de documento ha sido creado correctamente.",life:5e3}),Object.assign(l,{id:null,nombre:""}))}catch(t){console.error("Error al crear tipo:",t);const n=((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||"Error al crear el tipo de documento";d.add({severity:"error",summary:"Error",detail:n,life:4e3})}finally{b.value=!1}},ie=async()=>{var a,e;if(y.value=!0,!l.nombre||l.nombre.length<3||l.nombre.length>20||!P.value){d.add({severity:"warn",summary:"Campos requeridos",detail:"El nombre debe tener entre 3 y 20 caracteres.",life:4e3});return}b.value=!0;try{(await L.put(`/api/tipo-documentos/${P.value.id}`,{nombre:l.nombre.trim()})).data.success&&(await W(),T.value=!1,h.value=!1,g.value=null,P.value=null,d.add({severity:"success",summary:"Â¡Ã‰xito!",detail:"El tipo de documento ha sido actualizado correctamente.",life:5e3}),Object.assign(l,{id:null,nombre:""}))}catch(t){console.error("Error al actualizar tipo:",t);const n=((e=(a=t.response)==null?void 0:a.data)==null?void 0:e.message)||"Error al actualizar el tipo de documento";d.add({severity:"error",summary:"Error",detail:n,life:4e3})}finally{b.value=!1}},I=()=>{h.value?_.value=!0:G()},G=()=>{v.value=!1,T.value=!1,_.value=!1,h.value=!1,g.value=null,P.value=null,Object.assign(l,{id:null,nombre:""}),y.value=!1},de=()=>{_.value=!1},ue=()=>{l.nombre&&l.nombre.length>20&&(l.nombre=l.nombre.substring(0,20))},ce=a=>{const e=a.target.value,t=e.match(/[^a-zA-ZÃ¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘\s]/g);t&&t.length>0&&d.add({severity:"warn",summary:"Caracteres no permitidos",detail:"Solo se permiten letras, espacios y acentos. Se han removido los caracteres no vÃ¡lidos.",life:3e3});const n=e.replace(/[^a-zA-ZÃ¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘\s]/g,"").toLocaleUpperCase("es-ES");a.target.value=n,l.nombre=n,ue()},me=a=>{a.preventDefault();const e=(a.clipboardData||window.clipboardData).getData("text"),t=e.replace(/[^a-zA-ZÃ¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘\s]/g,"").replace(/\s+/g," ").trim().toLocaleUpperCase("es-ES");t!==e.toLocaleUpperCase("es-ES")&&d.add({severity:"info",summary:"Texto limpiado",detail:"Se han removido nÃºmeros y caracteres especiales del texto pegado y convertido a mayÃºsculas.",life:3e3});const n=t.length>20?t.substring(0,20):t;l.nombre=n,a.target.value=n},W=async()=>{try{const a=await L.get("/api/tipo-documentos");a.data.success&&(E.value=a.data.tipos)}catch(a){console.error("Error loading tipos:",a),d.add({severity:"error",summary:"Error",detail:"Error al cargar los tipos de documento",life:3e3})}},pe=async()=>{S.value=!0,d.add({severity:"info",summary:"Cargando tipos de documento...",life:2e3});try{const a=await L.get("/api/tipo-documentos");a.data.success&&(E.value=a.data.tipos),d.add({severity:"success",summary:"Tipos de documento cargados",life:2e3})}catch(a){console.error("Error loading tipos:",a),d.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los tipos de documento.",life:4e3})}finally{S.value=!1}};return xe(()=>{E.value.length===0?pe():S.value=!1}),(a,e)=>(m(),$(ve,null,{default:c(()=>[r(o(ye),{title:"Tipos de Documento"}),r(o(we),{class:"z-[9999]"}),s("div",Te,[e[23]||(e[23]=s("div",{class:"mb-6"},[s("h1",{class:"text-3xl font-bold text-blue-600 mb-2"},"GestiÃ³n de Tipos de Documento"),s("p",{class:"text-gray-600"},"AdministraciÃ³n completa de tipos de documentos del sistema")],-1)),s("div",Pe,[s("div",De,[e[9]||(e[9]=s("h3",{class:"text-2xl sm:text-3xl text-blue-600 font-bold text-center sm:text-start"},"Lista de Tipos de Documento",-1)),s("div",Ae,[s("button",{class:"bg-red-500 border border-red-500 p-2 text-sm text-white shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:te},[r(o(u),{icon:o(Ee),class:"h-4 w-4 mr-1 text-white"},null,8,["icon"]),e[8]||(e[8]=s("span",null,"Â Agregar tipo",-1))])])]),r(o(Ce),{value:U.value,dataKey:"id",paginator:!0,rows:z.value,rowsPerPageOptions:se.value,rowsPerPage:z.value,"onUpdate:rowsPerPage":e[1]||(e[1]=t=>z.value=t),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} tipos de documento",class:"overflow-x-auto max-w-full",responsiveLayout:"scroll",onRowClick:ae,pt:{root:{class:"text-sm"},wrapper:{class:"text-sm"},table:{class:"text-sm"},thead:{class:"text-sm"},headerRow:{class:"text-sm"},headerCell:{class:"text-sm font-medium py-3 px-2"},tbody:{class:"text-sm"},bodyRow:{class:"h-20 text-sm cursor-pointer hover:bg-blue-50 transition-colors duration-200"},bodyCell:{class:"py-3 px-2 text-sm"},paginator:{class:"text-xs sm:text-sm"},paginatorWrapper:{class:"flex flex-wrap justify-center sm:justify-between items-center gap-2 p-2"}}},{header:c(()=>[s("div",Le,[s("div",je,[s("div",Ne,[e[10]||(e[10]=s("h3",{class:"text-base font-medium text-gray-800 flex items-center gap-2"},[s("i",{class:"pi pi-filter text-blue-600 text-sm"}),s("span",null,"Filtros")],-1)),s("div",Se,p(U.value.length)+" resultado"+p(U.value.length!==1?"s":""),1),s("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md flex sm:hidden disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:B,disabled:f.value},[f.value?(m(),$(o(u),{key:0,icon:o(N),class:"animate-spin h-3 w-3"},null,8,["icon"])):A("",!0),s("span",null,p(f.value?"Limpiando...":"Limpiar filtros"),1)],8,ze)]),s("button",{class:"bg-red-500 hover:bg-red-600 border border-red-500 px-3 py-1 text-sm text-white shadow-md rounded-md hidden sm:flex disabled:opacity-50 disabled:cursor-not-allowed items-center gap-2",onClick:B,disabled:f.value},[f.value?(m(),$(o(u),{key:0,icon:o(N),class:"animate-spin h-3 w-3"},null,8,["icon"])):A("",!0),s("span",null,p(f.value?"Limpiando...":"Limpiar filtros"),1)],8,Oe)]),s("div",Ue,[s("div",null,[r(o(J),{modelValue:D.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=t=>D.value.global.value=t),placeholder:"ðŸ” Buscar tipos de documento...",class:"w-full h-9 text-sm rounded-md",style:{"background-color":"white","border-color":"#93c5fd"}},null,8,["modelValue"])])])])]),default:c(()=>[r(o(Z),{field:"nombre",header:"Nombre",sortable:"",class:"w-64"},{body:c(t=>[s("div",{class:"text-sm font-medium leading-relaxed overflow-hidden",style:{"max-width":"150px","text-overflow":"ellipsis","white-space":"nowrap"},title:t.data.nombre},p(t.data.nombre),9,Ve)]),_:1}),r(o(Z),{exportable:!1,class:"w-52 min-w-36"},{header:c(()=>e[11]||(e[11]=[s("div",{class:"text-center w-full font-bold"}," Acciones ",-1)])),body:c(t=>[s("div",$e,[s("button",{class:"flex bg-blue-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:n=>oe(t.data)},[r(o(u),{icon:o(H),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[12]||(e[12]=s("span",{class:"hidden md:block text-white"},"Editar",-1))],8,Me),s("button",{class:"flex bg-red-500 border p-1 py-2 sm:p-2 text-sm shadow-md hover:shadow-lg rounded-md hover:-translate-y-1 transition-transform duration-300",onClick:n=>le(t.data)},[r(o(u),{icon:o(ke),class:"h-3 w-6 sm:h-4 sm:w-7 text-white"},null,8,["icon"]),e[13]||(e[13]=s("span",{class:"hidden md:block text-white"},"Eliminar",-1))],8,Re)])]),_:1})]),_:1},8,["value","rows","rowsPerPageOptions","rowsPerPage"])]),r(o(F),{visible:v.value||T.value,"onUpdate:visible":e[4]||(e[4]=t=>!t&&I()),header:(v.value?"Guardar":"Actualizar")+" Tipo de Documento",modal:!0,style:M(O.value),closable:!1,draggable:!1},{footer:c(()=>[s("div",Ze,[s("button",{class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:e[3]||(e[3]=t=>v.value?ne():ie()),disabled:b.value},[r(o(u),{icon:b.value?o(N):o(K),class:R(["h-5 text-white",{"animate-spin":b.value}])},null,8,["icon","class"]),b.value?(m(),w("span",Ke,p(v.value?"Guardando...":"Actualizando..."),1)):(m(),w("span",He,p(v.value?"Guardar":"Actualizar"),1))],8,Je),s("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:I,disabled:b.value},[r(o(u),{icon:o(X),class:"h-5"},null,8,["icon"]),e[15]||(e[15]=j("Cancelar "))],8,Xe)])]),default:c(()=>[s("div",Fe,[s("div",Be,[s("div",Ie,[e[14]||(e[14]=s("label",{for:"nombre",class:"w-24 flex items-center gap-1"},[j(" Nombre: "),s("span",{class:"text-red-500 font-bold"},"*")],-1)),r(o(J),{modelValue:l.nombre,"onUpdate:modelValue":e[2]||(e[2]=t=>l.nombre=t),modelModifiers:{trim:!0},id:"nombre",name:"nombre",maxlength:20,class:R([{"p-invalid":y.value&&(!l.nombre||l.nombre.length<3||l.nombre.length>20)},"flex-1 border-2 border-gray-400 hover:border-gray-500 focus:border-gray-500 focus:ring-0 focus:shadow-none rounded-md uppercase"]),placeholder:"DUI, PASAPORTE, ETC.",onInput:ce,onPaste:me},null,8,["modelValue","class"])]),l.nombre&&l.nombre.length<3?(m(),w("small",Ge," El nombre debe tener al menos 3 caracteres. Actual: "+p(l.nombre.length)+"/3 ",1)):A("",!0),l.nombre&&l.nombre.length>=18&&l.nombre.length<=20?(m(),w("small",We," Caracteres restantes: "+p(20-l.nombre.length),1)):A("",!0),y.value&&!l.nombre?(m(),w("small",qe," El nombre es obligatorio. ")):A("",!0)])])]),_:1},8,["visible","header","style"]),r(o(F),{visible:k.value,"onUpdate:visible":e[6]||(e[6]=t=>k.value=t),header:"Eliminar tipo de documento",modal:!0,style:M(O.value),closable:!1,draggable:!1},{footer:c(()=>[s("div",es,[s("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:re,disabled:x.value},[r(o(u),{icon:x.value?o(N):o(K),class:R(["h-5",{"animate-spin":x.value}])},null,8,["icon","class"]),x.value?(m(),w("span",as,"Eliminando...")):(m(),w("span",ts,"Eliminar"))],8,ss),s("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:e[5]||(e[5]=t=>k.value=!1),disabled:x.value},[r(o(u),{icon:o(X),class:"h-5"},null,8,["icon"]),e[19]||(e[19]=s("span",null,"Cancelar",-1))],8,os)])]),default:c(()=>{var t;return[s("div",Qe,[r(o(u),{icon:o(Q),class:"h-8 w-8 text-red-500"},null,8,["icon"]),s("div",Ye,[s("span",null,[e[16]||(e[16]=j("Â¿EstÃ¡s seguro de eliminar el tipo de documento: ")),s("b",null,p((t=C.value)==null?void 0:t.nombre),1),e[17]||(e[17]=j("?"))]),e[18]||(e[18]=s("span",{class:"text-red-600 text-sm font-medium mt-1"},"Esta acciÃ³n es irreversible.",-1))])])]}),_:1},8,["visible","style"]),r(o(F),{visible:_.value,"onUpdate:visible":e[7]||(e[7]=t=>_.value=t),header:"Cambios sin guardar",modal:!0,style:M(O.value),closable:!1,draggable:!1},{footer:c(()=>[s("div",rs,[s("button",{type:"button",class:"bg-red-500 hover:bg-red-700 text-white border-none px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:G},[r(o(u),{icon:o(_e),class:"h-4"},null,8,["icon"]),e[21]||(e[21]=s("span",null,"Salir sin guardar",-1))]),s("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-all duration-200 ease-in-out flex items-center gap-2",onClick:de},[r(o(u),{icon:o(H),class:"h-4"},null,8,["icon"]),e[22]||(e[22]=s("span",null,"Continuar",-1))])])]),default:c(()=>[s("div",ls,[r(o(u),{icon:o(Q),class:"h-8 w-8 text-red-500"},null,8,["icon"]),e[20]||(e[20]=s("div",{class:"flex flex-col"},[s("span",null,"Â¡Tienes informaciÃ³n sin guardar!"),s("span",{class:"text-red-600 text-sm font-medium mt-1"},"Â¿Deseas salir sin guardar?")],-1))])]),_:1},8,["visible","style"])])]),_:1}))}};export{ms as default};
